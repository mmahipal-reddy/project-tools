{"ast":null,"code":"import _objectSpread from\"/Users/mmoola/Documents/GitHub/project-tools/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect,useRef,useCallback}from'react';import{useAuth}from'../context/AuthContext';import Sidebar from'../components/Sidebar';import useSidebarWidth from'../hooks/useSidebarWidth';import QueueStatusDashboard from'../components/QueueStatusDashboard';import QueueStatusScheduleManager from'../components/QueueStatusScheduleManager';import{Menu,LogOut,Search,RefreshCw,Send,Loader,Download,AlertCircle,BarChart3,Clock}from'lucide-react';import apiClient from'../config/api';import toast from'react-hot-toast';import*as XLSX from'xlsx';import BookmarkButton from'../components/BookmarkButton';import{getAllowedTransitions,isValidTransition,getTransitionDescription}from'./QueueStatusManagement/transitionRules';import'../styles/QueueStatusManagement.css';import'../styles/Sidebar.css';import'../styles/GlobalHeader.css';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const QueueStatusManagement=()=>{const{user,logout}=useAuth();const[sidebarOpen,setSidebarOpen]=useState(true);const sidebarWidth=useSidebarWidth(sidebarOpen);const[loading,setLoading]=useState(true);const[contributorProjects,setContributorProjects]=useState([]);const[filteredContributorProjects,setFilteredContributorProjects]=useState([]);const[searchTerm,setSearchTerm]=useState('');const[statusFilter,setStatusFilter]=useState('');const[queueStatusFilter,setQueueStatusFilter]=useState('');const[hasMoreProjects,setHasMoreProjects]=useState(false);const[loadingMore,setLoadingMore]=useState(false);const[selectedProjects,setSelectedProjects]=useState([]);const[queueStatusUpdates,setQueueStatusUpdates]=useState({});// { projectId: queueStatus }\nconst[bulkQueueStatus,setBulkQueueStatus]=useState('');// Bulk update queue status for selected projects\nconst[publishing,setPublishing]=useState(false);const[activeTab,setActiveTab]=useState('management');// 'management', 'dashboard', 'schedule'\n// Refs for infinite scroll\nconst infiniteScrollRef=useRef(null);const tableContainerRef=useRef(null);const contributorProjectsRef=useRef([]);const hasMoreProjectsRef=useRef(false);const loadingMoreRef=useRef(false);const searchTermRef=useRef('');const statusFilterRef=useRef('');const queueStatusFilterRef=useRef('');// Queue Status picklist values\nconst queueStatusOptions=['--None--','Calibration Queue','Production Queue','Test Queue'];const fetchContributorProjects=async function(){let append=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;if(append){setLoadingMore(true);}else{setLoading(true);setHasMoreProjects(false);}try{const offset=append?contributorProjects.length:0;// Build query parameters with filters\nconst params=new URLSearchParams({limit:'1000',offset:offset.toString()});// Add search term if provided\nif(searchTerm&&searchTerm.trim()!==''){params.append('searchTerm',searchTerm.trim());}// Add status filter if provided\nif(statusFilter&&statusFilter!==''){params.append('statusFilter',statusFilter);}// Add queue status filter if provided\nif(queueStatusFilter&&queueStatusFilter!==''){params.append('queueStatusFilter',queueStatusFilter);}const response=await apiClient.get(\"/queue-status-management/contributor-projects?\".concat(params.toString()));if(response.data.success){if(append){setContributorProjects(prev=>[...prev,...(response.data.projects||[])]);}else{setContributorProjects(response.data.projects||[]);setQueueStatusUpdates({});setSelectedProjects([]);setBulkQueueStatus('');}setHasMoreProjects(response.data.hasMore||false);}}catch(error){var _error$response,_error$response$data,_error$response2,_error$response2$data;const errorMessage=((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.error)||((_error$response2=error.response)===null||_error$response2===void 0?void 0:(_error$response2$data=_error$response2.data)===null||_error$response2$data===void 0?void 0:_error$response2$data.message)||error.message||'Failed to fetch contributor projects';toast.error(errorMessage);}finally{if(append){setLoadingMore(false);}else{setLoading(false);}}};// Refresh handler that ensures proper reset\nconst handleRefresh=useCallback(e=>{if(e){e.preventDefault();e.stopPropagation();}// Clear existing projects\nsetContributorProjects([]);// Reset refs\ncontributorProjectsRef.current=[];hasMoreProjectsRef.current=false;setHasMoreProjects(false);// Fetch fresh data\nfetchContributorProjects(false);},[]);useEffect(()=>{fetchContributorProjects();// eslint-disable-next-line react-hooks/exhaustive-deps\n},[]);// Filter is now done server-side, so we just use the projects as-is\n// But we still need to update when filters change to trigger a new fetch\nuseEffect(()=>{// When filters change, reset and fetch with new filters (don't append)\nif(!loading){setContributorProjects([]);// Clear existing projects\nfetchContributorProjects(false);// Fetch from beginning\n}// eslint-disable-next-line react-hooks/exhaustive-deps\n},[searchTerm,statusFilter,queueStatusFilter]);// Update filtered list when projects change (no client-side filtering needed)\nuseEffect(()=>{setFilteredContributorProjects(contributorProjects);},[contributorProjects]);// Synchronize refs with state\nuseEffect(()=>{contributorProjectsRef.current=contributorProjects;},[contributorProjects]);useEffect(()=>{hasMoreProjectsRef.current=hasMoreProjects;},[hasMoreProjects]);useEffect(()=>{loadingMoreRef.current=loadingMore;},[loadingMore]);useEffect(()=>{searchTermRef.current=searchTerm;},[searchTerm]);useEffect(()=>{statusFilterRef.current=statusFilter;},[statusFilter]);useEffect(()=>{queueStatusFilterRef.current=queueStatusFilter;},[queueStatusFilter]);// Function to load more projects (for infinite scroll)\nconst loadMoreProjects=useCallback(()=>{const currentHasMore=hasMoreProjectsRef.current;const currentLoading=loadingMoreRef.current;if(currentLoading||!currentHasMore){return;}const currentOffset=contributorProjectsRef.current.length;// Prevent multiple simultaneous loads\nif(loadingMoreRef.current){return;}loadingMoreRef.current=true;setLoadingMore(true);const params=new URLSearchParams({limit:'1000',offset:currentOffset.toString()});// Get current filter values from refs\nconst currentSearchTerm=searchTermRef.current;const currentStatusFilter=statusFilterRef.current;const currentQueueStatusFilter=queueStatusFilterRef.current;if(currentSearchTerm&&currentSearchTerm.trim()!==''){params.append('searchTerm',currentSearchTerm.trim());}if(currentStatusFilter&&currentStatusFilter!==''){params.append('statusFilter',currentStatusFilter);}if(currentQueueStatusFilter&&currentQueueStatusFilter!==''){params.append('queueStatusFilter',currentQueueStatusFilter);}apiClient.get(\"/queue-status-management/contributor-projects?\".concat(params.toString())).then(response=>{if(response.data.success){setContributorProjects(prev=>{const newProjects=[...prev,...(response.data.projects||[])];return newProjects;});setHasMoreProjects(response.data.hasMore||false);hasMoreProjectsRef.current=response.data.hasMore||false;}}).catch(error=>{var _error$response3,_error$response3$data,_error$response4,_error$response4$data;const errorMessage=((_error$response3=error.response)===null||_error$response3===void 0?void 0:(_error$response3$data=_error$response3.data)===null||_error$response3$data===void 0?void 0:_error$response3$data.error)||((_error$response4=error.response)===null||_error$response4===void 0?void 0:(_error$response4$data=_error$response4.data)===null||_error$response4$data===void 0?void 0:_error$response4$data.message)||error.message||'Failed to fetch more contributor projects';toast.error(errorMessage);}).finally(()=>{loadingMoreRef.current=false;setLoadingMore(false);});},[]);// Set up IntersectionObserver for infinite scroll\nuseEffect(()=>{if(!hasMoreProjects){return;}const element=infiniteScrollRef.current;const tableContainer=tableContainerRef.current;if(!element||!tableContainer||loadingMore){return;}let loadTriggered=false;const handleIntersection=entries=>{const entry=entries[0];if(entry.isIntersecting&&!loadTriggered&&hasMoreProjectsRef.current&&!loadingMoreRef.current){loadTriggered=true;loadMoreProjects();setTimeout(()=>{loadTriggered=false;},2000);}};const handleScroll=()=>{if(loadTriggered||loadingMoreRef.current||!hasMoreProjectsRef.current){return;}if(!element||!tableContainer)return;const containerRect=tableContainer.getBoundingClientRect();const elementRect=element.getBoundingClientRect();const isVisible=elementRect.top<=containerRect.bottom+200;if(isVisible){loadTriggered=true;loadMoreProjects();setTimeout(()=>{loadTriggered=false;},2000);}};try{const observer=new IntersectionObserver(handleIntersection,{root:tableContainer,rootMargin:'200px',threshold:[0,0.1,0.5,1.0]});observer.observe(element);tableContainer.addEventListener('scroll',handleScroll,{passive:true});const checkVisibility=()=>{if(!element||!tableContainer)return;const containerRect=tableContainer.getBoundingClientRect();const elementRect=element.getBoundingClientRect();const isVisible=elementRect.top<containerRect.bottom+200;if(isVisible&&hasMoreProjectsRef.current&&!loadingMoreRef.current&&!loadTriggered){loadTriggered=true;loadMoreProjects();setTimeout(()=>{loadTriggered=false;},2000);}};const visibilityTimeout=setTimeout(checkVisibility,300);return()=>{try{observer.disconnect();}catch(e){// Ignore disconnect errors\n}tableContainer.removeEventListener('scroll',handleScroll);clearTimeout(visibilityTimeout);};}catch(error){// If IntersectionObserver is not supported, just return\nreturn;}},[hasMoreProjects,loadingMore,loadMoreProjects]);const toggleSelection=projectId=>{setSelectedProjects(prev=>{if(prev.includes(projectId)){const newSelected=prev.filter(id=>id!==projectId);// Clear bulk status if less than 2 projects are selected\nif(newSelected.length<2){setBulkQueueStatus('');}return newSelected;}else{const newSelected=[...prev,projectId];return newSelected;}});};const handleSelectAll=checked=>{if(checked){const allSelected=filteredContributorProjects.map(p=>p.id);setSelectedProjects(allSelected);// Clear bulk status if less than 2 projects are selected\nif(allSelected.length<2){setBulkQueueStatus('');}}else{setSelectedProjects([]);setBulkQueueStatus('');// Clear bulk status when deselecting all\n}};const handleQueueStatusChange=(projectId,value)=>{// Find the project to get current status\nconst project=contributorProjects.find(p=>p.id===projectId);const currentStatus=(project===null||project===void 0?void 0:project.currentQueueStatus)||null;// Validate transition\nif(!isValidTransition(currentStatus,value)){toast.error(\"Invalid transition: Cannot change from \\\"\".concat(currentStatus||'--None--',\"\\\" to \\\"\").concat(value,\"\\\". \").concat(getTransitionDescription(currentStatus)));return;}setQueueStatusUpdates(prev=>_objectSpread(_objectSpread({},prev),{},{[projectId]:value==='--None--'?null:value}));// Clear bulk status when individual change is made\nsetBulkQueueStatus('');};const handleBulkQueueStatusChange=value=>{// Validate transitions for all selected projects\nconst invalidProjects=[];selectedProjects.forEach(projectId=>{const project=contributorProjects.find(p=>p.id===projectId);const currentStatus=(project===null||project===void 0?void 0:project.currentQueueStatus)||null;if(!isValidTransition(currentStatus,value)){invalidProjects.push((project===null||project===void 0?void 0:project.contributorProjectName)||projectId);}});if(invalidProjects.length>0){toast.error(\"Invalid transitions for \".concat(invalidProjects.length,\" project(s). Please check individual transitions.\"));return;}setBulkQueueStatus(value);// Apply bulk status to all selected projects\nconst updates={};selectedProjects.forEach(projectId=>{updates[projectId]=value==='--None--'?null:value;});setQueueStatusUpdates(prev=>_objectSpread(_objectSpread({},prev),updates));};// Check if publish button should be enabled\nconst canPublish=()=>{if(selectedProjects.length===0)return false;// If bulk status is set, check if it's different from current status for at least one project\nif(bulkQueueStatus&&bulkQueueStatus!==''){const bulkStatus=bulkQueueStatus==='--None--'?null:bulkQueueStatus;return selectedProjects.some(projectId=>{const project=contributorProjects.find(p=>p.id===projectId);if(!project)return false;const currentStatus=project.currentQueueStatus||null;return currentStatus!==bulkStatus;});}// If no bulk status is set, check individual updates\nreturn selectedProjects.some(projectId=>{const project=contributorProjects.find(p=>p.id===projectId);if(!project)return false;const currentStatus=project.currentQueueStatus||null;const updateStatus=queueStatusUpdates[projectId]!==undefined?queueStatusUpdates[projectId]:currentStatus;return currentStatus!==updateStatus;});};const handleExportToExcel=()=>{if(filteredContributorProjects.length===0){toast.error('No data to export');return;}try{// Prepare data for export - only table columns\nconst exportData=filteredContributorProjects.map(project=>({'Contributor Project Name':project.contributorProjectName||'N/A','Project':project.project||'N/A','Status':project.status||'N/A','Current Queue Status':project.currentQueueStatus||'N/A'}));// Create workbook and worksheet\nconst ws=XLSX.utils.json_to_sheet(exportData);const wb=XLSX.utils.book_new();XLSX.utils.book_append_sheet(wb,ws,'Queue Status');// Generate filename with timestamp\nconst filename=\"Queue_Status_Management_\".concat(new Date().toISOString().split('T')[0],\".xlsx\");// Write and download\nXLSX.writeFile(wb,filename);toast.success(\"Exported \".concat(exportData.length,\" records to Excel\"));}catch(error){console.error('Error exporting to Excel:',error);toast.error('Failed to export to Excel');}};const handlePublish=async()=>{if(!canPublish()){toast.error('Please select at least one project and choose a Queue Status to update');return;}// Prepare updates for selected projects\nconst updates=selectedProjects.map(projectId=>{const project=contributorProjects.find(p=>p.id===projectId);if(!project)return null;const currentStatus=project.currentQueueStatus||null;let updateStatus;// Use bulk status if set, otherwise use individual update\nif(bulkQueueStatus&&bulkQueueStatus!==''){updateStatus=bulkQueueStatus==='--None--'?null:bulkQueueStatus;}else{updateStatus=queueStatusUpdates[projectId]!==undefined?queueStatusUpdates[projectId]:currentStatus;}// Only include if status has changed\nif(currentStatus!==updateStatus){return{projectId:projectId,queueStatus:updateStatus,currentStatus:currentStatus// Include for server-side validation\n};}return null;}).filter(update=>update!==null);if(updates.length===0){toast.error('No changes to publish');return;}setPublishing(true);try{const response=await apiClient.post('/queue-status-management/update-queue-status',{updates});if(response.data.success){toast.success(\"Successfully published \".concat(response.data.updatedCount,\" project(s) to Salesforce\"));setSelectedProjects([]);setQueueStatusUpdates({});setBulkQueueStatus('');fetchContributorProjects();}}catch(error){var _error$response5,_error$response5$data;const errorMessage=((_error$response5=error.response)===null||_error$response5===void 0?void 0:(_error$response5$data=_error$response5.data)===null||_error$response5$data===void 0?void 0:_error$response5$data.error)||'Failed to publish queue status updates';toast.error(errorMessage);}finally{setPublishing(false);}};if(loading){return/*#__PURE__*/_jsxs(\"div\",{className:\"dashboard-layout\",children:[/*#__PURE__*/_jsx(Sidebar,{isOpen:sidebarOpen,toggleSidebar:()=>setSidebarOpen(!sidebarOpen)}),/*#__PURE__*/_jsx(\"div\",{className:\"queue-status-management\",style:{marginLeft:\"\".concat(sidebarWidth,\"px\"),width:\"calc(100% - \".concat(sidebarWidth,\"px)\"),transition:'margin-left 0.2s ease, width 0.2s ease',height:'100vh',display:'flex',alignItems:'center',justifyContent:'center'},children:/*#__PURE__*/_jsxs(\"div\",{className:\"loading-container\",children:[/*#__PURE__*/_jsx(Loader,{className:\"spinning\",size:24}),/*#__PURE__*/_jsx(\"p\",{children:\"Loading queue status management data...\"})]})})]});}return/*#__PURE__*/_jsxs(\"div\",{className:\"dashboard-layout\",children:[/*#__PURE__*/_jsx(Sidebar,{isOpen:sidebarOpen,toggleSidebar:()=>setSidebarOpen(!sidebarOpen)}),/*#__PURE__*/_jsx(\"div\",{className:\"queue-status-management\",style:{marginLeft:\"\".concat(sidebarWidth,\"px\"),width:\"calc(100% - \".concat(sidebarWidth,\"px)\"),transition:'margin-left 0.2s ease, width 0.2s ease'},children:/*#__PURE__*/_jsxs(\"div\",{className:\"queue-status-management-container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"queue-status-management-header\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"header-content\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"header-left\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"header-menu-toggle\",onClick:()=>setSidebarOpen(!sidebarOpen),\"aria-label\":\"Toggle sidebar\",children:/*#__PURE__*/_jsx(Menu,{size:20})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"page-title\",children:\"Queue Status Management\"}),/*#__PURE__*/_jsx(\"p\",{className:\"page-subtitle\",children:\"Manage Queue Status for Contributor Projects\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"header-user-profile\",children:[/*#__PURE__*/_jsx(BookmarkButton,{pageName:\"Queue Status Management\",pageType:\"page\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"user-profile\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"user-avatar\",children:((user===null||user===void 0?void 0:user.email)||'U').charAt(0).toUpperCase()}),/*#__PURE__*/_jsx(\"span\",{className:\"user-name\",children:(user===null||user===void 0?void 0:user.email)||'User'}),/*#__PURE__*/_jsx(\"button\",{className:\"logout-btn\",onClick:logout,title:\"Logout\",children:/*#__PURE__*/_jsx(LogOut,{size:18})})]})]})]})}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'8px',marginBottom:'24px',borderBottom:'2px solid var(--border-color)'},children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setActiveTab('management'),style:{padding:'12px 20px',background:'none',border:'none',borderBottom:activeTab==='management'?'2px solid #0176d3':'2px solid transparent',color:activeTab==='management'?'#0176d3':'#666',fontWeight:activeTab==='management'?'600':'400',cursor:'pointer',fontSize:'14px',marginBottom:'-2px'},children:\"Management\"}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setActiveTab('dashboard'),style:{padding:'12px 20px',background:'none',border:'none',borderBottom:activeTab==='dashboard'?'2px solid #0176d3':'2px solid transparent',color:activeTab==='dashboard'?'#0176d3':'#666',fontWeight:activeTab==='dashboard'?'600':'400',cursor:'pointer',fontSize:'14px',marginBottom:'-2px',display:'flex',alignItems:'center',gap:'6px'},children:[/*#__PURE__*/_jsx(BarChart3,{size:16}),\"Analytics\"]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setActiveTab('schedule'),style:{padding:'12px 20px',background:'none',border:'none',borderBottom:activeTab==='schedule'?'2px solid #0176d3':'2px solid transparent',color:activeTab==='schedule'?'#0176d3':'#666',fontWeight:activeTab==='schedule'?'600':'400',cursor:'pointer',fontSize:'14px',marginBottom:'-2px',display:'flex',alignItems:'center',gap:'6px'},children:[/*#__PURE__*/_jsx(Clock,{size:16}),\"Schedule & Automation\"]})]}),activeTab==='dashboard'&&/*#__PURE__*/_jsx(QueueStatusDashboard,{}),activeTab==='schedule'&&/*#__PURE__*/_jsx(QueueStatusScheduleManager,{}),activeTab==='management'&&/*#__PURE__*/_jsxs(\"div\",{className:\"contributor-projects-list\",children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:'16px',flexWrap:'wrap',gap:'16px'},children:[/*#__PURE__*/_jsxs(\"h2\",{style:{fontSize:'18px',fontWeight:'600',margin:0},children:[\"Contributor Projects (\",filteredContributorProjects.length,\")\"]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'12px',alignItems:'center',flexWrap:'wrap'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{position:'relative',minWidth:'250px',maxWidth:'400px'},children:[/*#__PURE__*/_jsx(Search,{size:16,style:{position:'absolute',left:'12px',top:'50%',transform:'translateY(-50%)',color:'#666',zIndex:1,pointerEvents:'none'}}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Search contributor projects...\",value:searchTerm,onChange:e=>setSearchTerm(e.target.value),style:{paddingLeft:'36px',fontSize:'14px',padding:'10px 16px 10px 36px',width:'100%',border:'1px solid var(--border-color)',borderRadius:'var(--radius-md)',background:'var(--surface)',color:'var(--text-primary)',boxSizing:'border-box'}})]}),/*#__PURE__*/_jsxs(\"select\",{value:statusFilter,onChange:e=>setStatusFilter(e.target.value),style:{fontSize:'14px',padding:'10px 16px',border:'1px solid var(--border-color)',borderRadius:'var(--radius-md)',background:'var(--surface)',color:'var(--text-primary)',minWidth:'150px',cursor:'pointer'},children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"All Status\"}),Array.from(new Set(contributorProjects.map(p=>p.status).filter(Boolean))).sort().map(status=>/*#__PURE__*/_jsx(\"option\",{value:status,children:status},status))]}),/*#__PURE__*/_jsxs(\"select\",{value:queueStatusFilter,onChange:e=>setQueueStatusFilter(e.target.value),style:{fontSize:'14px',padding:'10px 16px',border:'1px solid var(--border-color)',borderRadius:'var(--radius-md)',background:'var(--surface)',color:'var(--text-primary)',minWidth:'180px',cursor:'pointer'},children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"All Queue Status\"}),/*#__PURE__*/_jsx(\"option\",{value:\"--None--\",children:\"--None--\"}),Array.from(new Set(contributorProjects.map(p=>p.currentQueueStatus).filter(Boolean))).sort().map(queueStatus=>/*#__PURE__*/_jsx(\"option\",{value:queueStatus,children:queueStatus},queueStatus))]}),/*#__PURE__*/_jsxs(\"button\",{className:\"btn-secondary\",onClick:handleRefresh,disabled:loading,style:{display:'flex',alignItems:'center',gap:'8px',whiteSpace:'nowrap'},title:\"Refresh table\",children:[/*#__PURE__*/_jsx(RefreshCw,{size:16,className:loading?'spinning':''}),\"Refresh\"]}),/*#__PURE__*/_jsxs(\"button\",{className:\"btn-secondary\",onClick:handleExportToExcel,disabled:filteredContributorProjects.length===0,style:{display:'flex',alignItems:'center',gap:'8px',whiteSpace:'nowrap'},title:\"Export table data to Excel\",children:[/*#__PURE__*/_jsx(Download,{size:16}),\"Export to Excel\"]}),selectedProjects.length>=2&&(()=>{// Get common allowed transitions for all selected projects\nconst getCommonAllowedTransitions=()=>{if(selectedProjects.length===0)return queueStatusOptions;const transitionsPerProject=selectedProjects.map(projectId=>{const project=contributorProjects.find(p=>p.id===projectId);const currentStatus=(project===null||project===void 0?void 0:project.currentQueueStatus)||null;return getAllowedTransitions(currentStatus);});// Find intersection of all allowed transitions\nif(transitionsPerProject.length===0)return queueStatusOptions;return transitionsPerProject.reduce((common,transitions)=>common.filter(t=>transitions.includes(t)));};const commonTransitions=getCommonAllowedTransitions();return/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',gap:'8px',padding:'0 8px',margin:'0 4px',flexShrink:0,whiteSpace:'nowrap'},children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"bulk-queue-status-select\",style:{fontSize:'13px',fontWeight:'500',whiteSpace:'nowrap',color:'var(--text-primary)',margin:0},children:\"Update Queue Status:\"}),/*#__PURE__*/_jsxs(\"select\",{id:\"bulk-queue-status-select\",value:bulkQueueStatus,onChange:e=>handleBulkQueueStatusChange(e.target.value),style:{fontSize:'14px',padding:'8px 12px',border:'1px solid var(--border-color)',borderRadius:'var(--radius-md)',background:'var(--surface)',color:'var(--text-primary)',minWidth:'180px',cursor:'pointer'},children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"--Select--\"}),commonTransitions.map(option=>/*#__PURE__*/_jsx(\"option\",{value:option,children:option},option))]}),commonTransitions.length<queueStatusOptions.length&&/*#__PURE__*/_jsxs(\"div\",{style:{fontSize:'11px',color:'#ff9800',marginLeft:'8px',display:'flex',alignItems:'center',gap:'4px'},children:[/*#__PURE__*/_jsx(AlertCircle,{size:12}),\"Some transitions may not be valid for all selected projects\"]})]});})(),/*#__PURE__*/_jsxs(\"button\",{className:\"btn-primary\",onClick:handlePublish,disabled:!canPublish()||publishing,style:{display:'flex',alignItems:'center',gap:'8px',whiteSpace:'nowrap'},title:!canPublish()?'Please select at least one project and choose a Queue Status':'Publish selected projects to Salesforce',children:[/*#__PURE__*/_jsx(Send,{size:16}),publishing?'Publishing...':selectedProjects.length>0?\"Publish \".concat(selectedProjects.length,\" Selected\"):'Publish Selected']})]})]}),filteredContributorProjects.length===0?/*#__PURE__*/_jsx(\"div\",{className:\"no-projects\",children:/*#__PURE__*/_jsx(\"p\",{children:\"No contributor projects found that require queue status update\"})}):/*#__PURE__*/_jsxs(\"div\",{className:\"projects-table\",ref:tableContainerRef,children:[/*#__PURE__*/_jsxs(\"table\",{children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{style:{width:'40px'},children:/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:selectedProjects.length===filteredContributorProjects.length&&filteredContributorProjects.length>0,onChange:e=>handleSelectAll(e.target.checked)})}),/*#__PURE__*/_jsx(\"th\",{children:\"Contributor Project Name\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Project\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Status\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Current Queue Status\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Update Queue Status\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:filteredContributorProjects.map(project=>{const currentStatus=project.currentQueueStatus||null;// Use bulk status if set and project is selected, otherwise use individual update\nlet updateStatus;if(bulkQueueStatus&&bulkQueueStatus!==''&&selectedProjects.includes(project.id)){updateStatus=bulkQueueStatus==='--None--'?null:bulkQueueStatus;}else{updateStatus=queueStatusUpdates[project.id]!==undefined?queueStatusUpdates[project.id]:currentStatus;}const hasChange=currentStatus!==updateStatus;return/*#__PURE__*/_jsxs(\"tr\",{style:{background:selectedProjects.includes(project.id)&&hasChange?'var(--bg-secondary)':'transparent'},children:[/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:selectedProjects.includes(project.id),onChange:()=>toggleSelection(project.id)})}),/*#__PURE__*/_jsx(\"td\",{children:project.contributorProjectName||'N/A'}),/*#__PURE__*/_jsx(\"td\",{children:project.project||'N/A'}),/*#__PURE__*/_jsx(\"td\",{children:project.status||'N/A'}),/*#__PURE__*/_jsx(\"td\",{children:currentStatus||'--None--'}),/*#__PURE__*/_jsxs(\"td\",{children:[/*#__PURE__*/_jsx(\"select\",{value:updateStatus||'--None--',onChange:e=>handleQueueStatusChange(project.id,e.target.value),style:{fontSize:'13px',padding:'6px 8px',border:'1px solid var(--border-color)',borderRadius:'var(--radius-md)',background:'var(--surface)',color:'var(--text-primary)',width:'100%',minWidth:'150px'},title:getTransitionDescription(currentStatus),children:getAllowedTransitions(currentStatus).map(option=>/*#__PURE__*/_jsx(\"option\",{value:option,children:option},option))}),!isValidTransition(currentStatus,updateStatus||'--None--')&&/*#__PURE__*/_jsxs(\"div\",{style:{fontSize:'11px',color:'#d32f2f',marginTop:'4px',display:'flex',alignItems:'center',gap:'4px'},children:[/*#__PURE__*/_jsx(AlertCircle,{size:12}),\"Invalid transition\"]})]})]},project.id);})})]}),hasMoreProjects&&/*#__PURE__*/_jsxs(_Fragment,{children:[!loadingMore&&/*#__PURE__*/_jsx(\"div\",{ref:infiniteScrollRef,style:{height:'50px',width:'100%',marginTop:'20px',display:'flex',justifyContent:'center',alignItems:'center'},children:/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'12px',color:'var(--text-secondary)',padding:'10px'},children:\"Scroll for more...\"})}),loadingMore&&/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'center',alignItems:'center',padding:'20px',gap:'12px'},children:[/*#__PURE__*/_jsx(Loader,{className:\"spinner\",size:20,style:{color:'#0176d3'}}),/*#__PURE__*/_jsx(\"span\",{style:{color:'var(--text-primary)',fontSize:'14px'},children:\"Loading more contributor projects...\"})]})]})]})]})]})})]});};export default QueueStatusManagement;","map":{"version":3,"names":["React","useState","useEffect","useRef","useCallback","useAuth","Sidebar","useSidebarWidth","QueueStatusDashboard","QueueStatusScheduleManager","Menu","LogOut","Search","RefreshCw","Send","Loader","Download","AlertCircle","BarChart3","Clock","apiClient","toast","XLSX","BookmarkButton","getAllowedTransitions","isValidTransition","getTransitionDescription","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","QueueStatusManagement","user","logout","sidebarOpen","setSidebarOpen","sidebarWidth","loading","setLoading","contributorProjects","setContributorProjects","filteredContributorProjects","setFilteredContributorProjects","searchTerm","setSearchTerm","statusFilter","setStatusFilter","queueStatusFilter","setQueueStatusFilter","hasMoreProjects","setHasMoreProjects","loadingMore","setLoadingMore","selectedProjects","setSelectedProjects","queueStatusUpdates","setQueueStatusUpdates","bulkQueueStatus","setBulkQueueStatus","publishing","setPublishing","activeTab","setActiveTab","infiniteScrollRef","tableContainerRef","contributorProjectsRef","hasMoreProjectsRef","loadingMoreRef","searchTermRef","statusFilterRef","queueStatusFilterRef","queueStatusOptions","fetchContributorProjects","append","arguments","length","undefined","offset","params","URLSearchParams","limit","toString","trim","response","get","concat","data","success","prev","projects","hasMore","error","_error$response","_error$response$data","_error$response2","_error$response2$data","errorMessage","message","handleRefresh","e","preventDefault","stopPropagation","current","loadMoreProjects","currentHasMore","currentLoading","currentOffset","currentSearchTerm","currentStatusFilter","currentQueueStatusFilter","then","newProjects","catch","_error$response3","_error$response3$data","_error$response4","_error$response4$data","finally","element","tableContainer","loadTriggered","handleIntersection","entries","entry","isIntersecting","setTimeout","handleScroll","containerRect","getBoundingClientRect","elementRect","isVisible","top","bottom","observer","IntersectionObserver","root","rootMargin","threshold","observe","addEventListener","passive","checkVisibility","visibilityTimeout","disconnect","removeEventListener","clearTimeout","toggleSelection","projectId","includes","newSelected","filter","id","handleSelectAll","checked","allSelected","map","p","handleQueueStatusChange","value","project","find","currentStatus","currentQueueStatus","_objectSpread","handleBulkQueueStatusChange","invalidProjects","forEach","push","contributorProjectName","updates","canPublish","bulkStatus","some","updateStatus","handleExportToExcel","exportData","status","ws","utils","json_to_sheet","wb","book_new","book_append_sheet","filename","Date","toISOString","split","writeFile","console","handlePublish","queueStatus","update","post","updatedCount","_error$response5","_error$response5$data","className","children","isOpen","toggleSidebar","style","marginLeft","width","transition","height","display","alignItems","justifyContent","size","onClick","pageName","pageType","email","charAt","toUpperCase","title","gap","marginBottom","borderBottom","padding","background","border","color","fontWeight","cursor","fontSize","flexWrap","margin","position","minWidth","maxWidth","left","transform","zIndex","pointerEvents","type","placeholder","onChange","target","paddingLeft","borderRadius","boxSizing","Array","from","Set","Boolean","sort","disabled","whiteSpace","getCommonAllowedTransitions","transitionsPerProject","reduce","common","transitions","t","commonTransitions","flexShrink","htmlFor","option","ref","hasChange","marginTop"],"sources":["/Users/mmoola/Documents/GitHub/project-tools/client/src/pages/QueueStatusManagement.js"],"sourcesContent":["import React, { useState, useEffect, useRef, useCallback } from 'react';\nimport { useAuth } from '../context/AuthContext';\nimport Sidebar from '../components/Sidebar';\nimport useSidebarWidth from '../hooks/useSidebarWidth';\nimport QueueStatusDashboard from '../components/QueueStatusDashboard';\nimport QueueStatusScheduleManager from '../components/QueueStatusScheduleManager';\nimport { Menu, LogOut, Search, RefreshCw, Send, Loader, Download, AlertCircle, BarChart3, Clock } from 'lucide-react';\nimport apiClient from '../config/api';\nimport toast from 'react-hot-toast';\nimport * as XLSX from 'xlsx';\nimport BookmarkButton from '../components/BookmarkButton';\nimport { getAllowedTransitions, isValidTransition, getTransitionDescription } from './QueueStatusManagement/transitionRules';\nimport '../styles/QueueStatusManagement.css';\nimport '../styles/Sidebar.css';\nimport '../styles/GlobalHeader.css';\n\nconst QueueStatusManagement = () => {\n  const { user, logout } = useAuth();\n  const [sidebarOpen, setSidebarOpen] = useState(true);\n  const sidebarWidth = useSidebarWidth(sidebarOpen);\n  const [loading, setLoading] = useState(true);\n  const [contributorProjects, setContributorProjects] = useState([]);\n  const [filteredContributorProjects, setFilteredContributorProjects] = useState([]);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [statusFilter, setStatusFilter] = useState('');\n  const [queueStatusFilter, setQueueStatusFilter] = useState('');\n  const [hasMoreProjects, setHasMoreProjects] = useState(false);\n  const [loadingMore, setLoadingMore] = useState(false);\n  const [selectedProjects, setSelectedProjects] = useState([]);\n  const [queueStatusUpdates, setQueueStatusUpdates] = useState({}); // { projectId: queueStatus }\n  const [bulkQueueStatus, setBulkQueueStatus] = useState(''); // Bulk update queue status for selected projects\n  const [publishing, setPublishing] = useState(false);\n  const [activeTab, setActiveTab] = useState('management'); // 'management', 'dashboard', 'schedule'\n  \n  // Refs for infinite scroll\n  const infiniteScrollRef = useRef(null);\n  const tableContainerRef = useRef(null);\n  const contributorProjectsRef = useRef([]);\n  const hasMoreProjectsRef = useRef(false);\n  const loadingMoreRef = useRef(false);\n  const searchTermRef = useRef('');\n  const statusFilterRef = useRef('');\n  const queueStatusFilterRef = useRef('');\n\n  // Queue Status picklist values\n  const queueStatusOptions = [\n    '--None--',\n    'Calibration Queue',\n    'Production Queue',\n    'Test Queue'\n  ];\n\n  const fetchContributorProjects = async (append = false) => {\n    if (append) {\n      setLoadingMore(true);\n    } else {\n      setLoading(true);\n      setHasMoreProjects(false);\n    }\n    try {\n      const offset = append ? contributorProjects.length : 0;\n      \n      // Build query parameters with filters\n      const params = new URLSearchParams({\n        limit: '1000',\n        offset: offset.toString()\n      });\n      \n      // Add search term if provided\n      if (searchTerm && searchTerm.trim() !== '') {\n        params.append('searchTerm', searchTerm.trim());\n      }\n      \n      // Add status filter if provided\n      if (statusFilter && statusFilter !== '') {\n        params.append('statusFilter', statusFilter);\n      }\n      \n      // Add queue status filter if provided\n      if (queueStatusFilter && queueStatusFilter !== '') {\n        params.append('queueStatusFilter', queueStatusFilter);\n      }\n      \n      const response = await apiClient.get(`/queue-status-management/contributor-projects?${params.toString()}`);\n      if (response.data.success) {\n        if (append) {\n          setContributorProjects(prev => [...prev, ...(response.data.projects || [])]);\n        } else {\n          setContributorProjects(response.data.projects || []);\n          setQueueStatusUpdates({});\n          setSelectedProjects([]);\n          setBulkQueueStatus('');\n        }\n        setHasMoreProjects(response.data.hasMore || false);\n      }\n    } catch (error) {\n      const errorMessage = error.response?.data?.error || error.response?.data?.message || error.message || 'Failed to fetch contributor projects';\n      toast.error(errorMessage);\n    } finally {\n      if (append) {\n        setLoadingMore(false);\n      } else {\n        setLoading(false);\n      }\n    }\n  };\n\n  // Refresh handler that ensures proper reset\n  const handleRefresh = useCallback((e) => {\n    if (e) {\n      e.preventDefault();\n      e.stopPropagation();\n    }\n    // Clear existing projects\n    setContributorProjects([]);\n    // Reset refs\n    contributorProjectsRef.current = [];\n    hasMoreProjectsRef.current = false;\n    setHasMoreProjects(false);\n    // Fetch fresh data\n    fetchContributorProjects(false);\n  }, []);\n\n  useEffect(() => {\n    fetchContributorProjects();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  // Filter is now done server-side, so we just use the projects as-is\n  // But we still need to update when filters change to trigger a new fetch\n  useEffect(() => {\n    // When filters change, reset and fetch with new filters (don't append)\n    if (!loading) {\n      setContributorProjects([]); // Clear existing projects\n      fetchContributorProjects(false); // Fetch from beginning\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [searchTerm, statusFilter, queueStatusFilter]);\n\n  // Update filtered list when projects change (no client-side filtering needed)\n  useEffect(() => {\n    setFilteredContributorProjects(contributorProjects);\n  }, [contributorProjects]);\n\n  // Synchronize refs with state\n  useEffect(() => {\n    contributorProjectsRef.current = contributorProjects;\n  }, [contributorProjects]);\n\n  useEffect(() => {\n    hasMoreProjectsRef.current = hasMoreProjects;\n  }, [hasMoreProjects]);\n\n  useEffect(() => {\n    loadingMoreRef.current = loadingMore;\n  }, [loadingMore]);\n\n  useEffect(() => {\n    searchTermRef.current = searchTerm;\n  }, [searchTerm]);\n\n  useEffect(() => {\n    statusFilterRef.current = statusFilter;\n  }, [statusFilter]);\n\n  useEffect(() => {\n    queueStatusFilterRef.current = queueStatusFilter;\n  }, [queueStatusFilter]);\n\n  // Function to load more projects (for infinite scroll)\n  const loadMoreProjects = useCallback(() => {\n    const currentHasMore = hasMoreProjectsRef.current;\n    const currentLoading = loadingMoreRef.current;\n    \n    if (currentLoading || !currentHasMore) {\n      return;\n    }\n    \n    const currentOffset = contributorProjectsRef.current.length;\n    \n    // Prevent multiple simultaneous loads\n    if (loadingMoreRef.current) {\n      return;\n    }\n    \n    loadingMoreRef.current = true;\n    setLoadingMore(true);\n    \n    const params = new URLSearchParams({\n      limit: '1000',\n      offset: currentOffset.toString()\n    });\n    \n    // Get current filter values from refs\n    const currentSearchTerm = searchTermRef.current;\n    const currentStatusFilter = statusFilterRef.current;\n    const currentQueueStatusFilter = queueStatusFilterRef.current;\n    \n    if (currentSearchTerm && currentSearchTerm.trim() !== '') {\n      params.append('searchTerm', currentSearchTerm.trim());\n    }\n    \n    if (currentStatusFilter && currentStatusFilter !== '') {\n      params.append('statusFilter', currentStatusFilter);\n    }\n    \n    if (currentQueueStatusFilter && currentQueueStatusFilter !== '') {\n      params.append('queueStatusFilter', currentQueueStatusFilter);\n    }\n    \n    apiClient.get(`/queue-status-management/contributor-projects?${params.toString()}`)\n      .then(response => {\n        if (response.data.success) {\n          setContributorProjects(prev => {\n            const newProjects = [...prev, ...(response.data.projects || [])];\n            return newProjects;\n          });\n          setHasMoreProjects(response.data.hasMore || false);\n          hasMoreProjectsRef.current = response.data.hasMore || false;\n        }\n      })\n      .catch(error => {\n        const errorMessage = error.response?.data?.error || error.response?.data?.message || error.message || 'Failed to fetch more contributor projects';\n        toast.error(errorMessage);\n      })\n      .finally(() => {\n        loadingMoreRef.current = false;\n        setLoadingMore(false);\n      });\n  }, []);\n\n  // Set up IntersectionObserver for infinite scroll\n  useEffect(() => {\n    if (!hasMoreProjects) {\n      return;\n    }\n\n    const element = infiniteScrollRef.current;\n    const tableContainer = tableContainerRef.current;\n    \n    if (!element || !tableContainer || loadingMore) {\n      return;\n    }\n\n    let loadTriggered = false;\n\n    const handleIntersection = (entries) => {\n      const entry = entries[0];\n      \n      if (entry.isIntersecting && !loadTriggered && hasMoreProjectsRef.current && !loadingMoreRef.current) {\n        loadTriggered = true;\n        loadMoreProjects();\n        \n        setTimeout(() => {\n          loadTriggered = false;\n        }, 2000);\n      }\n    };\n\n    const handleScroll = () => {\n      if (loadTriggered || loadingMoreRef.current || !hasMoreProjectsRef.current) {\n        return;\n      }\n      \n      if (!element || !tableContainer) return;\n      \n      const containerRect = tableContainer.getBoundingClientRect();\n      const elementRect = element.getBoundingClientRect();\n      const isVisible = elementRect.top <= containerRect.bottom + 200;\n      \n      if (isVisible) {\n        loadTriggered = true;\n        loadMoreProjects();\n        \n        setTimeout(() => {\n          loadTriggered = false;\n        }, 2000);\n      }\n    };\n\n    try {\n      const observer = new IntersectionObserver(handleIntersection, {\n        root: tableContainer,\n        rootMargin: '200px',\n        threshold: [0, 0.1, 0.5, 1.0]\n      });\n\n      observer.observe(element);\n\n      tableContainer.addEventListener('scroll', handleScroll, { passive: true });\n\n      const checkVisibility = () => {\n        if (!element || !tableContainer) return;\n        const containerRect = tableContainer.getBoundingClientRect();\n        const elementRect = element.getBoundingClientRect();\n        const isVisible = elementRect.top < containerRect.bottom + 200;\n        \n        if (isVisible && hasMoreProjectsRef.current && !loadingMoreRef.current && !loadTriggered) {\n          loadTriggered = true;\n          loadMoreProjects();\n          \n          setTimeout(() => {\n            loadTriggered = false;\n          }, 2000);\n        }\n      };\n\n      const visibilityTimeout = setTimeout(checkVisibility, 300);\n\n      return () => {\n        try {\n          observer.disconnect();\n        } catch (e) {\n          // Ignore disconnect errors\n        }\n        tableContainer.removeEventListener('scroll', handleScroll);\n        clearTimeout(visibilityTimeout);\n      };\n    } catch (error) {\n      // If IntersectionObserver is not supported, just return\n      return;\n    }\n  }, [hasMoreProjects, loadingMore, loadMoreProjects]);\n\n  const toggleSelection = (projectId) => {\n    setSelectedProjects(prev => {\n      if (prev.includes(projectId)) {\n        const newSelected = prev.filter(id => id !== projectId);\n        // Clear bulk status if less than 2 projects are selected\n        if (newSelected.length < 2) {\n          setBulkQueueStatus('');\n        }\n        return newSelected;\n      } else {\n        const newSelected = [...prev, projectId];\n        return newSelected;\n      }\n    });\n  };\n\n  const handleSelectAll = (checked) => {\n    if (checked) {\n      const allSelected = filteredContributorProjects.map(p => p.id);\n      setSelectedProjects(allSelected);\n      // Clear bulk status if less than 2 projects are selected\n      if (allSelected.length < 2) {\n        setBulkQueueStatus('');\n      }\n    } else {\n      setSelectedProjects([]);\n      setBulkQueueStatus(''); // Clear bulk status when deselecting all\n    }\n  };\n\n  const handleQueueStatusChange = (projectId, value) => {\n    // Find the project to get current status\n    const project = contributorProjects.find(p => p.id === projectId);\n    const currentStatus = project?.currentQueueStatus || null;\n    \n    // Validate transition\n    if (!isValidTransition(currentStatus, value)) {\n      toast.error(`Invalid transition: Cannot change from \"${currentStatus || '--None--'}\" to \"${value}\". ${getTransitionDescription(currentStatus)}`);\n      return;\n    }\n    \n    setQueueStatusUpdates(prev => ({\n      ...prev,\n      [projectId]: value === '--None--' ? null : value\n    }));\n    // Clear bulk status when individual change is made\n    setBulkQueueStatus('');\n  };\n\n  const handleBulkQueueStatusChange = (value) => {\n    // Validate transitions for all selected projects\n    const invalidProjects = [];\n    selectedProjects.forEach(projectId => {\n      const project = contributorProjects.find(p => p.id === projectId);\n      const currentStatus = project?.currentQueueStatus || null;\n      if (!isValidTransition(currentStatus, value)) {\n        invalidProjects.push(project?.contributorProjectName || projectId);\n      }\n    });\n    \n    if (invalidProjects.length > 0) {\n      toast.error(`Invalid transitions for ${invalidProjects.length} project(s). Please check individual transitions.`);\n      return;\n    }\n    \n    setBulkQueueStatus(value);\n    // Apply bulk status to all selected projects\n    const updates = {};\n    selectedProjects.forEach(projectId => {\n      updates[projectId] = value === '--None--' ? null : value;\n    });\n    setQueueStatusUpdates(prev => ({\n      ...prev,\n      ...updates\n    }));\n  };\n\n  // Check if publish button should be enabled\n  const canPublish = () => {\n    if (selectedProjects.length === 0) return false;\n    \n    // If bulk status is set, check if it's different from current status for at least one project\n    if (bulkQueueStatus && bulkQueueStatus !== '') {\n      const bulkStatus = bulkQueueStatus === '--None--' ? null : bulkQueueStatus;\n      return selectedProjects.some(projectId => {\n        const project = contributorProjects.find(p => p.id === projectId);\n        if (!project) return false;\n        \n        const currentStatus = project.currentQueueStatus || null;\n        return currentStatus !== bulkStatus;\n      });\n    }\n    \n    // If no bulk status is set, check individual updates\n    return selectedProjects.some(projectId => {\n      const project = contributorProjects.find(p => p.id === projectId);\n      if (!project) return false;\n      \n      const currentStatus = project.currentQueueStatus || null;\n      const updateStatus = queueStatusUpdates[projectId] !== undefined \n        ? queueStatusUpdates[projectId] \n        : currentStatus;\n      \n      return currentStatus !== updateStatus;\n    });\n  };\n\n  const handleExportToExcel = () => {\n    if (filteredContributorProjects.length === 0) {\n      toast.error('No data to export');\n      return;\n    }\n\n    try {\n      // Prepare data for export - only table columns\n      const exportData = filteredContributorProjects.map(project => ({\n        'Contributor Project Name': project.contributorProjectName || 'N/A',\n        'Project': project.project || 'N/A',\n        'Status': project.status || 'N/A',\n        'Current Queue Status': project.currentQueueStatus || 'N/A'\n      }));\n\n      // Create workbook and worksheet\n      const ws = XLSX.utils.json_to_sheet(exportData);\n      const wb = XLSX.utils.book_new();\n      XLSX.utils.book_append_sheet(wb, ws, 'Queue Status');\n\n      // Generate filename with timestamp\n      const filename = `Queue_Status_Management_${new Date().toISOString().split('T')[0]}.xlsx`;\n\n      // Write and download\n      XLSX.writeFile(wb, filename);\n      toast.success(`Exported ${exportData.length} records to Excel`);\n    } catch (error) {\n      console.error('Error exporting to Excel:', error);\n      toast.error('Failed to export to Excel');\n    }\n  };\n\n  const handlePublish = async () => {\n    if (!canPublish()) {\n      toast.error('Please select at least one project and choose a Queue Status to update');\n      return;\n    }\n\n    // Prepare updates for selected projects\n    const updates = selectedProjects\n      .map(projectId => {\n        const project = contributorProjects.find(p => p.id === projectId);\n        if (!project) return null;\n        \n        const currentStatus = project.currentQueueStatus || null;\n        let updateStatus;\n        \n        // Use bulk status if set, otherwise use individual update\n        if (bulkQueueStatus && bulkQueueStatus !== '') {\n          updateStatus = bulkQueueStatus === '--None--' ? null : bulkQueueStatus;\n        } else {\n          updateStatus = queueStatusUpdates[projectId] !== undefined \n            ? queueStatusUpdates[projectId] \n            : currentStatus;\n        }\n        \n        // Only include if status has changed\n        if (currentStatus !== updateStatus) {\n          return {\n            projectId: projectId,\n            queueStatus: updateStatus,\n            currentStatus: currentStatus // Include for server-side validation\n          };\n        }\n        return null;\n      })\n      .filter(update => update !== null);\n\n    if (updates.length === 0) {\n      toast.error('No changes to publish');\n      return;\n    }\n\n    setPublishing(true);\n    try {\n      const response = await apiClient.post('/queue-status-management/update-queue-status', { updates });\n      if (response.data.success) {\n        toast.success(`Successfully published ${response.data.updatedCount} project(s) to Salesforce`);\n        setSelectedProjects([]);\n        setQueueStatusUpdates({});\n        setBulkQueueStatus('');\n        fetchContributorProjects();\n      }\n    } catch (error) {\n      const errorMessage = error.response?.data?.error || 'Failed to publish queue status updates';\n      toast.error(errorMessage);\n    } finally {\n      setPublishing(false);\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"dashboard-layout\">\n        <Sidebar isOpen={sidebarOpen} toggleSidebar={() => setSidebarOpen(!sidebarOpen)} />\n        <div className=\"queue-status-management\" style={{ marginLeft: `${sidebarWidth}px`, width: `calc(100% - ${sidebarWidth}px)`, transition: 'margin-left 0.2s ease, width 0.2s ease', height: '100vh', display: 'flex', alignItems: 'center', justifyContent: 'center' }}>\n          <div className=\"loading-container\">\n            <Loader className=\"spinning\" size={24} />\n            <p>Loading queue status management data...</p>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"dashboard-layout\">\n      <Sidebar isOpen={sidebarOpen} toggleSidebar={() => setSidebarOpen(!sidebarOpen)} />\n      \n      <div className=\"queue-status-management\" style={{ marginLeft: `${sidebarWidth}px`, width: `calc(100% - ${sidebarWidth}px)`, transition: 'margin-left 0.2s ease, width 0.2s ease' }}>\n        <div className=\"queue-status-management-container\">\n          <div className=\"queue-status-management-header\">\n            <div className=\"header-content\">\n              <div className=\"header-left\">\n                <button \n                  className=\"header-menu-toggle\"\n                  onClick={() => setSidebarOpen(!sidebarOpen)}\n                  aria-label=\"Toggle sidebar\"\n                >\n                  <Menu size={20} />\n                </button>\n                <div>\n                  <h1 className=\"page-title\">Queue Status Management</h1>\n                  <p className=\"page-subtitle\">Manage Queue Status for Contributor Projects</p>\n                </div>\n              </div>\n              <div className=\"header-user-profile\">\n                <BookmarkButton pageName=\"Queue Status Management\" pageType=\"page\" />\n                <div className=\"user-profile\">\n                  <div className=\"user-avatar\">\n                    {(user?.email || 'U').charAt(0).toUpperCase()}\n                  </div>\n                  <span className=\"user-name\">{user?.email || 'User'}</span>\n                  <button className=\"logout-btn\" onClick={logout} title=\"Logout\">\n                    <LogOut size={18} />\n                  </button>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          {/* Tab Navigation */}\n          <div style={{ display: 'flex', gap: '8px', marginBottom: '24px', borderBottom: '2px solid var(--border-color)' }}>\n            <button\n              onClick={() => setActiveTab('management')}\n              style={{\n                padding: '12px 20px',\n                background: 'none',\n                border: 'none',\n                borderBottom: activeTab === 'management' ? '2px solid #0176d3' : '2px solid transparent',\n                color: activeTab === 'management' ? '#0176d3' : '#666',\n                fontWeight: activeTab === 'management' ? '600' : '400',\n                cursor: 'pointer',\n                fontSize: '14px',\n                marginBottom: '-2px'\n              }}\n            >\n              Management\n            </button>\n            <button\n              onClick={() => setActiveTab('dashboard')}\n              style={{\n                padding: '12px 20px',\n                background: 'none',\n                border: 'none',\n                borderBottom: activeTab === 'dashboard' ? '2px solid #0176d3' : '2px solid transparent',\n                color: activeTab === 'dashboard' ? '#0176d3' : '#666',\n                fontWeight: activeTab === 'dashboard' ? '600' : '400',\n                cursor: 'pointer',\n                fontSize: '14px',\n                marginBottom: '-2px',\n                display: 'flex',\n                alignItems: 'center',\n                gap: '6px'\n              }}\n            >\n              <BarChart3 size={16} />\n              Analytics\n            </button>\n            <button\n              onClick={() => setActiveTab('schedule')}\n              style={{\n                padding: '12px 20px',\n                background: 'none',\n                border: 'none',\n                borderBottom: activeTab === 'schedule' ? '2px solid #0176d3' : '2px solid transparent',\n                color: activeTab === 'schedule' ? '#0176d3' : '#666',\n                fontWeight: activeTab === 'schedule' ? '600' : '400',\n                cursor: 'pointer',\n                fontSize: '14px',\n                marginBottom: '-2px',\n                display: 'flex',\n                alignItems: 'center',\n                gap: '6px'\n              }}\n            >\n              <Clock size={16} />\n              Schedule & Automation\n            </button>\n          </div>\n\n          {/* Dashboard Tab */}\n          {activeTab === 'dashboard' && (\n            <QueueStatusDashboard />\n          )}\n\n          {/* Schedule Tab */}\n          {activeTab === 'schedule' && (\n            <QueueStatusScheduleManager />\n          )}\n\n          {/* Management Tab */}\n          {activeTab === 'management' && (\n          <div className=\"contributor-projects-list\">\n            <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '16px', flexWrap: 'wrap', gap: '16px' }}>\n              <h2 style={{ fontSize: '18px', fontWeight: '600', margin: 0 }}>\n                Contributor Projects ({filteredContributorProjects.length})\n              </h2>\n              <div style={{ display: 'flex', gap: '12px', alignItems: 'center', flexWrap: 'wrap' }}>\n                <div style={{ position: 'relative', minWidth: '250px', maxWidth: '400px' }}>\n                  <Search size={16} style={{ position: 'absolute', left: '12px', top: '50%', transform: 'translateY(-50%)', color: '#666', zIndex: 1, pointerEvents: 'none' }} />\n                  <input\n                    type=\"text\"\n                    placeholder=\"Search contributor projects...\"\n                    value={searchTerm}\n                    onChange={(e) => setSearchTerm(e.target.value)}\n                    style={{\n                      paddingLeft: '36px',\n                      fontSize: '14px',\n                      padding: '10px 16px 10px 36px',\n                      width: '100%',\n                      border: '1px solid var(--border-color)',\n                      borderRadius: 'var(--radius-md)',\n                      background: 'var(--surface)',\n                      color: 'var(--text-primary)',\n                      boxSizing: 'border-box'\n                    }}\n                  />\n                </div>\n                <select\n                  value={statusFilter}\n                  onChange={(e) => setStatusFilter(e.target.value)}\n                  style={{\n                    fontSize: '14px',\n                    padding: '10px 16px',\n                    border: '1px solid var(--border-color)',\n                    borderRadius: 'var(--radius-md)',\n                    background: 'var(--surface)',\n                    color: 'var(--text-primary)',\n                    minWidth: '150px',\n                    cursor: 'pointer'\n                  }}\n                >\n                  <option value=\"\">All Status</option>\n                  {Array.from(new Set(contributorProjects.map(p => p.status).filter(Boolean))).sort().map(status => (\n                    <option key={status} value={status}>{status}</option>\n                  ))}\n                </select>\n                <select\n                  value={queueStatusFilter}\n                  onChange={(e) => setQueueStatusFilter(e.target.value)}\n                  style={{\n                    fontSize: '14px',\n                    padding: '10px 16px',\n                    border: '1px solid var(--border-color)',\n                    borderRadius: 'var(--radius-md)',\n                    background: 'var(--surface)',\n                    color: 'var(--text-primary)',\n                    minWidth: '180px',\n                    cursor: 'pointer'\n                  }}\n                >\n                  <option value=\"\">All Queue Status</option>\n                  <option value=\"--None--\">--None--</option>\n                  {Array.from(new Set(contributorProjects.map(p => p.currentQueueStatus).filter(Boolean))).sort().map(queueStatus => (\n                    <option key={queueStatus} value={queueStatus}>{queueStatus}</option>\n                  ))}\n                </select>\n                <button\n                  className=\"btn-secondary\"\n                  onClick={handleRefresh}\n                  disabled={loading}\n                  style={{ display: 'flex', alignItems: 'center', gap: '8px', whiteSpace: 'nowrap' }}\n                  title=\"Refresh table\"\n                >\n                  <RefreshCw size={16} className={loading ? 'spinning' : ''} />\n                  Refresh\n                </button>\n                <button\n                  className=\"btn-secondary\"\n                  onClick={handleExportToExcel}\n                  disabled={filteredContributorProjects.length === 0}\n                  style={{ display: 'flex', alignItems: 'center', gap: '8px', whiteSpace: 'nowrap' }}\n                  title=\"Export table data to Excel\"\n                >\n                  <Download size={16} />\n                  Export to Excel\n                </button>\n                {selectedProjects.length >= 2 && (() => {\n                  // Get common allowed transitions for all selected projects\n                  const getCommonAllowedTransitions = () => {\n                    if (selectedProjects.length === 0) return queueStatusOptions;\n                    \n                    const transitionsPerProject = selectedProjects.map(projectId => {\n                      const project = contributorProjects.find(p => p.id === projectId);\n                      const currentStatus = project?.currentQueueStatus || null;\n                      return getAllowedTransitions(currentStatus);\n                    });\n                    \n                    // Find intersection of all allowed transitions\n                    if (transitionsPerProject.length === 0) return queueStatusOptions;\n                    return transitionsPerProject.reduce((common, transitions) => \n                      common.filter(t => transitions.includes(t))\n                    );\n                  };\n                  \n                  const commonTransitions = getCommonAllowedTransitions();\n                  \n                  return (\n                  <div style={{ \n                    display: 'flex', \n                    alignItems: 'center', \n                    gap: '8px', \n                    padding: '0 8px',\n                    margin: '0 4px',\n                    flexShrink: 0,\n                    whiteSpace: 'nowrap'\n                  }}>\n                    <label htmlFor=\"bulk-queue-status-select\" style={{ \n                      fontSize: '13px', \n                      fontWeight: '500', \n                      whiteSpace: 'nowrap', \n                      color: 'var(--text-primary)',\n                      margin: 0\n                    }}>\n                      Update Queue Status:\n                    </label>\n                    <select\n                      id=\"bulk-queue-status-select\"\n                      value={bulkQueueStatus}\n                      onChange={(e) => handleBulkQueueStatusChange(e.target.value)}\n                      style={{\n                        fontSize: '14px',\n                        padding: '8px 12px',\n                        border: '1px solid var(--border-color)',\n                        borderRadius: 'var(--radius-md)',\n                        background: 'var(--surface)',\n                        color: 'var(--text-primary)',\n                        minWidth: '180px',\n                        cursor: 'pointer'\n                      }}\n                    >\n                      <option value=\"\">--Select--</option>\n                      {commonTransitions.map((option) => (\n                        <option key={option} value={option}>{option}</option>\n                      ))}\n                    </select>\n                    {commonTransitions.length < queueStatusOptions.length && (\n                      <div style={{ fontSize: '11px', color: '#ff9800', marginLeft: '8px', display: 'flex', alignItems: 'center', gap: '4px' }}>\n                        <AlertCircle size={12} />\n                        Some transitions may not be valid for all selected projects\n                      </div>\n                    )}\n                  </div>\n                  );\n                })()}\n                <button\n                  className=\"btn-primary\"\n                  onClick={handlePublish}\n                  disabled={!canPublish() || publishing}\n                  style={{ display: 'flex', alignItems: 'center', gap: '8px', whiteSpace: 'nowrap' }}\n                  title={!canPublish() ? 'Please select at least one project and choose a Queue Status' : 'Publish selected projects to Salesforce'}\n                >\n                  <Send size={16} />\n                  {publishing ? 'Publishing...' : selectedProjects.length > 0 ? `Publish ${selectedProjects.length} Selected` : 'Publish Selected'}\n                </button>\n              </div>\n            </div>\n            \n            {filteredContributorProjects.length === 0 ? (\n              <div className=\"no-projects\">\n                <p>No contributor projects found that require queue status update</p>\n              </div>\n            ) : (\n              <div className=\"projects-table\" ref={tableContainerRef}>\n                <table>\n                  <thead>\n                    <tr>\n                      <th style={{ width: '40px' }}>\n                        <input\n                          type=\"checkbox\"\n                          checked={selectedProjects.length === filteredContributorProjects.length && filteredContributorProjects.length > 0}\n                          onChange={(e) => handleSelectAll(e.target.checked)}\n                        />\n                      </th>\n                      <th>Contributor Project Name</th>\n                      <th>Project</th>\n                      <th>Status</th>\n                      <th>Current Queue Status</th>\n                      <th>Update Queue Status</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    {filteredContributorProjects.map((project) => {\n                      const currentStatus = project.currentQueueStatus || null;\n                      // Use bulk status if set and project is selected, otherwise use individual update\n                      let updateStatus;\n                      if (bulkQueueStatus && bulkQueueStatus !== '' && selectedProjects.includes(project.id)) {\n                        updateStatus = bulkQueueStatus === '--None--' ? null : bulkQueueStatus;\n                      } else {\n                        updateStatus = queueStatusUpdates[project.id] !== undefined \n                          ? queueStatusUpdates[project.id] \n                          : currentStatus;\n                      }\n                      const hasChange = currentStatus !== updateStatus;\n                      \n                      return (\n                        <tr key={project.id} style={{ background: selectedProjects.includes(project.id) && hasChange ? 'var(--bg-secondary)' : 'transparent' }}>\n                          <td>\n                            <input\n                              type=\"checkbox\"\n                              checked={selectedProjects.includes(project.id)}\n                              onChange={() => toggleSelection(project.id)}\n                            />\n                          </td>\n                          <td>{project.contributorProjectName || 'N/A'}</td>\n                          <td>{project.project || 'N/A'}</td>\n                          <td>{project.status || 'N/A'}</td>\n                          <td>{currentStatus || '--None--'}</td>\n                          <td>\n                            <select\n                              value={updateStatus || '--None--'}\n                              onChange={(e) => handleQueueStatusChange(project.id, e.target.value)}\n                              style={{\n                                fontSize: '13px',\n                                padding: '6px 8px',\n                                border: '1px solid var(--border-color)',\n                                borderRadius: 'var(--radius-md)',\n                                background: 'var(--surface)',\n                                color: 'var(--text-primary)',\n                                width: '100%',\n                                minWidth: '150px'\n                              }}\n                              title={getTransitionDescription(currentStatus)}\n                            >\n                              {getAllowedTransitions(currentStatus).map((option) => (\n                                <option key={option} value={option}>\n                                  {option}\n                                </option>\n                              ))}\n                            </select>\n                            {!isValidTransition(currentStatus, updateStatus || '--None--') && (\n                              <div style={{ fontSize: '11px', color: '#d32f2f', marginTop: '4px', display: 'flex', alignItems: 'center', gap: '4px' }}>\n                                <AlertCircle size={12} />\n                                Invalid transition\n                              </div>\n                            )}\n                          </td>\n                        </tr>\n                      );\n                    })}\n                  </tbody>\n                </table>\n                {/* Infinite scroll trigger and loading indicator */}\n                {hasMoreProjects && (\n                  <>\n                    {!loadingMore && (\n                      <div\n                        ref={infiniteScrollRef}\n                        style={{ \n                          height: '50px', \n                          width: '100%', \n                          marginTop: '20px',\n                          display: 'flex',\n                          justifyContent: 'center',\n                          alignItems: 'center'\n                        }}\n                      >\n                        <div style={{ \n                          fontSize: '12px', \n                          color: 'var(--text-secondary)',\n                          padding: '10px'\n                        }}>\n                          Scroll for more...\n                        </div>\n                      </div>\n                    )}\n                    {loadingMore && (\n                      <div style={{ \n                        display: 'flex', \n                        justifyContent: 'center', \n                        alignItems: 'center', \n                        padding: '20px',\n                        gap: '12px'\n                      }}>\n                        <Loader className=\"spinner\" size={20} style={{ color: '#0176d3' }} />\n                        <span style={{ color: 'var(--text-primary)', fontSize: '14px' }}>Loading more contributor projects...</span>\n                      </div>\n                    )}\n                  </>\n                )}\n              </div>\n            )}\n          </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default QueueStatusManagement;\n\n"],"mappings":"wIAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,CAAEC,MAAM,CAAEC,WAAW,KAAQ,OAAO,CACvE,OAASC,OAAO,KAAQ,wBAAwB,CAChD,MAAO,CAAAC,OAAO,KAAM,uBAAuB,CAC3C,MAAO,CAAAC,eAAe,KAAM,0BAA0B,CACtD,MAAO,CAAAC,oBAAoB,KAAM,oCAAoC,CACrE,MAAO,CAAAC,0BAA0B,KAAM,0CAA0C,CACjF,OAASC,IAAI,CAAEC,MAAM,CAAEC,MAAM,CAAEC,SAAS,CAAEC,IAAI,CAAEC,MAAM,CAAEC,QAAQ,CAAEC,WAAW,CAAEC,SAAS,CAAEC,KAAK,KAAQ,cAAc,CACrH,MAAO,CAAAC,SAAS,KAAM,eAAe,CACrC,MAAO,CAAAC,KAAK,KAAM,iBAAiB,CACnC,MAAO,GAAK,CAAAC,IAAI,KAAM,MAAM,CAC5B,MAAO,CAAAC,cAAc,KAAM,8BAA8B,CACzD,OAASC,qBAAqB,CAAEC,iBAAiB,CAAEC,wBAAwB,KAAQ,yCAAyC,CAC5H,MAAO,qCAAqC,CAC5C,MAAO,uBAAuB,CAC9B,MAAO,4BAA4B,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,CAAAC,QAAA,IAAAC,SAAA,yBAEpC,KAAM,CAAAC,qBAAqB,CAAGA,CAAA,GAAM,CAClC,KAAM,CAAEC,IAAI,CAAEC,MAAO,CAAC,CAAG9B,OAAO,CAAC,CAAC,CAClC,KAAM,CAAC+B,WAAW,CAAEC,cAAc,CAAC,CAAGpC,QAAQ,CAAC,IAAI,CAAC,CACpD,KAAM,CAAAqC,YAAY,CAAG/B,eAAe,CAAC6B,WAAW,CAAC,CACjD,KAAM,CAACG,OAAO,CAAEC,UAAU,CAAC,CAAGvC,QAAQ,CAAC,IAAI,CAAC,CAC5C,KAAM,CAACwC,mBAAmB,CAAEC,sBAAsB,CAAC,CAAGzC,QAAQ,CAAC,EAAE,CAAC,CAClE,KAAM,CAAC0C,2BAA2B,CAAEC,8BAA8B,CAAC,CAAG3C,QAAQ,CAAC,EAAE,CAAC,CAClF,KAAM,CAAC4C,UAAU,CAAEC,aAAa,CAAC,CAAG7C,QAAQ,CAAC,EAAE,CAAC,CAChD,KAAM,CAAC8C,YAAY,CAAEC,eAAe,CAAC,CAAG/C,QAAQ,CAAC,EAAE,CAAC,CACpD,KAAM,CAACgD,iBAAiB,CAAEC,oBAAoB,CAAC,CAAGjD,QAAQ,CAAC,EAAE,CAAC,CAC9D,KAAM,CAACkD,eAAe,CAAEC,kBAAkB,CAAC,CAAGnD,QAAQ,CAAC,KAAK,CAAC,CAC7D,KAAM,CAACoD,WAAW,CAAEC,cAAc,CAAC,CAAGrD,QAAQ,CAAC,KAAK,CAAC,CACrD,KAAM,CAACsD,gBAAgB,CAAEC,mBAAmB,CAAC,CAAGvD,QAAQ,CAAC,EAAE,CAAC,CAC5D,KAAM,CAACwD,kBAAkB,CAAEC,qBAAqB,CAAC,CAAGzD,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAE;AAClE,KAAM,CAAC0D,eAAe,CAAEC,kBAAkB,CAAC,CAAG3D,QAAQ,CAAC,EAAE,CAAC,CAAE;AAC5D,KAAM,CAAC4D,UAAU,CAAEC,aAAa,CAAC,CAAG7D,QAAQ,CAAC,KAAK,CAAC,CACnD,KAAM,CAAC8D,SAAS,CAAEC,YAAY,CAAC,CAAG/D,QAAQ,CAAC,YAAY,CAAC,CAAE;AAE1D;AACA,KAAM,CAAAgE,iBAAiB,CAAG9D,MAAM,CAAC,IAAI,CAAC,CACtC,KAAM,CAAA+D,iBAAiB,CAAG/D,MAAM,CAAC,IAAI,CAAC,CACtC,KAAM,CAAAgE,sBAAsB,CAAGhE,MAAM,CAAC,EAAE,CAAC,CACzC,KAAM,CAAAiE,kBAAkB,CAAGjE,MAAM,CAAC,KAAK,CAAC,CACxC,KAAM,CAAAkE,cAAc,CAAGlE,MAAM,CAAC,KAAK,CAAC,CACpC,KAAM,CAAAmE,aAAa,CAAGnE,MAAM,CAAC,EAAE,CAAC,CAChC,KAAM,CAAAoE,eAAe,CAAGpE,MAAM,CAAC,EAAE,CAAC,CAClC,KAAM,CAAAqE,oBAAoB,CAAGrE,MAAM,CAAC,EAAE,CAAC,CAEvC;AACA,KAAM,CAAAsE,kBAAkB,CAAG,CACzB,UAAU,CACV,mBAAmB,CACnB,kBAAkB,CAClB,YAAY,CACb,CAED,KAAM,CAAAC,wBAAwB,CAAG,cAAAA,CAAA,CAA0B,IAAnB,CAAAC,MAAM,CAAAC,SAAA,CAAAC,MAAA,IAAAD,SAAA,MAAAE,SAAA,CAAAF,SAAA,IAAG,KAAK,CACpD,GAAID,MAAM,CAAE,CACVrB,cAAc,CAAC,IAAI,CAAC,CACtB,CAAC,IAAM,CACLd,UAAU,CAAC,IAAI,CAAC,CAChBY,kBAAkB,CAAC,KAAK,CAAC,CAC3B,CACA,GAAI,CACF,KAAM,CAAA2B,MAAM,CAAGJ,MAAM,CAAGlC,mBAAmB,CAACoC,MAAM,CAAG,CAAC,CAEtD;AACA,KAAM,CAAAG,MAAM,CAAG,GAAI,CAAAC,eAAe,CAAC,CACjCC,KAAK,CAAE,MAAM,CACbH,MAAM,CAAEA,MAAM,CAACI,QAAQ,CAAC,CAC1B,CAAC,CAAC,CAEF;AACA,GAAItC,UAAU,EAAIA,UAAU,CAACuC,IAAI,CAAC,CAAC,GAAK,EAAE,CAAE,CAC1CJ,MAAM,CAACL,MAAM,CAAC,YAAY,CAAE9B,UAAU,CAACuC,IAAI,CAAC,CAAC,CAAC,CAChD,CAEA;AACA,GAAIrC,YAAY,EAAIA,YAAY,GAAK,EAAE,CAAE,CACvCiC,MAAM,CAACL,MAAM,CAAC,cAAc,CAAE5B,YAAY,CAAC,CAC7C,CAEA;AACA,GAAIE,iBAAiB,EAAIA,iBAAiB,GAAK,EAAE,CAAE,CACjD+B,MAAM,CAACL,MAAM,CAAC,mBAAmB,CAAE1B,iBAAiB,CAAC,CACvD,CAEA,KAAM,CAAAoC,QAAQ,CAAG,KAAM,CAAAjE,SAAS,CAACkE,GAAG,kDAAAC,MAAA,CAAkDP,MAAM,CAACG,QAAQ,CAAC,CAAC,CAAE,CAAC,CAC1G,GAAIE,QAAQ,CAACG,IAAI,CAACC,OAAO,CAAE,CACzB,GAAId,MAAM,CAAE,CACVjC,sBAAsB,CAACgD,IAAI,EAAI,CAAC,GAAGA,IAAI,CAAE,IAAIL,QAAQ,CAACG,IAAI,CAACG,QAAQ,EAAI,EAAE,CAAC,CAAC,CAAC,CAC9E,CAAC,IAAM,CACLjD,sBAAsB,CAAC2C,QAAQ,CAACG,IAAI,CAACG,QAAQ,EAAI,EAAE,CAAC,CACpDjC,qBAAqB,CAAC,CAAC,CAAC,CAAC,CACzBF,mBAAmB,CAAC,EAAE,CAAC,CACvBI,kBAAkB,CAAC,EAAE,CAAC,CACxB,CACAR,kBAAkB,CAACiC,QAAQ,CAACG,IAAI,CAACI,OAAO,EAAI,KAAK,CAAC,CACpD,CACF,CAAE,MAAOC,KAAK,CAAE,KAAAC,eAAA,CAAAC,oBAAA,CAAAC,gBAAA,CAAAC,qBAAA,CACd,KAAM,CAAAC,YAAY,CAAG,EAAAJ,eAAA,CAAAD,KAAK,CAACR,QAAQ,UAAAS,eAAA,kBAAAC,oBAAA,CAAdD,eAAA,CAAgBN,IAAI,UAAAO,oBAAA,iBAApBA,oBAAA,CAAsBF,KAAK,KAAAG,gBAAA,CAAIH,KAAK,CAACR,QAAQ,UAAAW,gBAAA,kBAAAC,qBAAA,CAAdD,gBAAA,CAAgBR,IAAI,UAAAS,qBAAA,iBAApBA,qBAAA,CAAsBE,OAAO,GAAIN,KAAK,CAACM,OAAO,EAAI,sCAAsC,CAC5I9E,KAAK,CAACwE,KAAK,CAACK,YAAY,CAAC,CAC3B,CAAC,OAAS,CACR,GAAIvB,MAAM,CAAE,CACVrB,cAAc,CAAC,KAAK,CAAC,CACvB,CAAC,IAAM,CACLd,UAAU,CAAC,KAAK,CAAC,CACnB,CACF,CACF,CAAC,CAED;AACA,KAAM,CAAA4D,aAAa,CAAGhG,WAAW,CAAEiG,CAAC,EAAK,CACvC,GAAIA,CAAC,CAAE,CACLA,CAAC,CAACC,cAAc,CAAC,CAAC,CAClBD,CAAC,CAACE,eAAe,CAAC,CAAC,CACrB,CACA;AACA7D,sBAAsB,CAAC,EAAE,CAAC,CAC1B;AACAyB,sBAAsB,CAACqC,OAAO,CAAG,EAAE,CACnCpC,kBAAkB,CAACoC,OAAO,CAAG,KAAK,CAClCpD,kBAAkB,CAAC,KAAK,CAAC,CACzB;AACAsB,wBAAwB,CAAC,KAAK,CAAC,CACjC,CAAC,CAAE,EAAE,CAAC,CAENxE,SAAS,CAAC,IAAM,CACdwE,wBAAwB,CAAC,CAAC,CAC1B;AACF,CAAC,CAAE,EAAE,CAAC,CAEN;AACA;AACAxE,SAAS,CAAC,IAAM,CACd;AACA,GAAI,CAACqC,OAAO,CAAE,CACZG,sBAAsB,CAAC,EAAE,CAAC,CAAE;AAC5BgC,wBAAwB,CAAC,KAAK,CAAC,CAAE;AACnC,CACA;AACF,CAAC,CAAE,CAAC7B,UAAU,CAAEE,YAAY,CAAEE,iBAAiB,CAAC,CAAC,CAEjD;AACA/C,SAAS,CAAC,IAAM,CACd0C,8BAA8B,CAACH,mBAAmB,CAAC,CACrD,CAAC,CAAE,CAACA,mBAAmB,CAAC,CAAC,CAEzB;AACAvC,SAAS,CAAC,IAAM,CACdiE,sBAAsB,CAACqC,OAAO,CAAG/D,mBAAmB,CACtD,CAAC,CAAE,CAACA,mBAAmB,CAAC,CAAC,CAEzBvC,SAAS,CAAC,IAAM,CACdkE,kBAAkB,CAACoC,OAAO,CAAGrD,eAAe,CAC9C,CAAC,CAAE,CAACA,eAAe,CAAC,CAAC,CAErBjD,SAAS,CAAC,IAAM,CACdmE,cAAc,CAACmC,OAAO,CAAGnD,WAAW,CACtC,CAAC,CAAE,CAACA,WAAW,CAAC,CAAC,CAEjBnD,SAAS,CAAC,IAAM,CACdoE,aAAa,CAACkC,OAAO,CAAG3D,UAAU,CACpC,CAAC,CAAE,CAACA,UAAU,CAAC,CAAC,CAEhB3C,SAAS,CAAC,IAAM,CACdqE,eAAe,CAACiC,OAAO,CAAGzD,YAAY,CACxC,CAAC,CAAE,CAACA,YAAY,CAAC,CAAC,CAElB7C,SAAS,CAAC,IAAM,CACdsE,oBAAoB,CAACgC,OAAO,CAAGvD,iBAAiB,CAClD,CAAC,CAAE,CAACA,iBAAiB,CAAC,CAAC,CAEvB;AACA,KAAM,CAAAwD,gBAAgB,CAAGrG,WAAW,CAAC,IAAM,CACzC,KAAM,CAAAsG,cAAc,CAAGtC,kBAAkB,CAACoC,OAAO,CACjD,KAAM,CAAAG,cAAc,CAAGtC,cAAc,CAACmC,OAAO,CAE7C,GAAIG,cAAc,EAAI,CAACD,cAAc,CAAE,CACrC,OACF,CAEA,KAAM,CAAAE,aAAa,CAAGzC,sBAAsB,CAACqC,OAAO,CAAC3B,MAAM,CAE3D;AACA,GAAIR,cAAc,CAACmC,OAAO,CAAE,CAC1B,OACF,CAEAnC,cAAc,CAACmC,OAAO,CAAG,IAAI,CAC7BlD,cAAc,CAAC,IAAI,CAAC,CAEpB,KAAM,CAAA0B,MAAM,CAAG,GAAI,CAAAC,eAAe,CAAC,CACjCC,KAAK,CAAE,MAAM,CACbH,MAAM,CAAE6B,aAAa,CAACzB,QAAQ,CAAC,CACjC,CAAC,CAAC,CAEF;AACA,KAAM,CAAA0B,iBAAiB,CAAGvC,aAAa,CAACkC,OAAO,CAC/C,KAAM,CAAAM,mBAAmB,CAAGvC,eAAe,CAACiC,OAAO,CACnD,KAAM,CAAAO,wBAAwB,CAAGvC,oBAAoB,CAACgC,OAAO,CAE7D,GAAIK,iBAAiB,EAAIA,iBAAiB,CAACzB,IAAI,CAAC,CAAC,GAAK,EAAE,CAAE,CACxDJ,MAAM,CAACL,MAAM,CAAC,YAAY,CAAEkC,iBAAiB,CAACzB,IAAI,CAAC,CAAC,CAAC,CACvD,CAEA,GAAI0B,mBAAmB,EAAIA,mBAAmB,GAAK,EAAE,CAAE,CACrD9B,MAAM,CAACL,MAAM,CAAC,cAAc,CAAEmC,mBAAmB,CAAC,CACpD,CAEA,GAAIC,wBAAwB,EAAIA,wBAAwB,GAAK,EAAE,CAAE,CAC/D/B,MAAM,CAACL,MAAM,CAAC,mBAAmB,CAAEoC,wBAAwB,CAAC,CAC9D,CAEA3F,SAAS,CAACkE,GAAG,kDAAAC,MAAA,CAAkDP,MAAM,CAACG,QAAQ,CAAC,CAAC,CAAE,CAAC,CAChF6B,IAAI,CAAC3B,QAAQ,EAAI,CAChB,GAAIA,QAAQ,CAACG,IAAI,CAACC,OAAO,CAAE,CACzB/C,sBAAsB,CAACgD,IAAI,EAAI,CAC7B,KAAM,CAAAuB,WAAW,CAAG,CAAC,GAAGvB,IAAI,CAAE,IAAIL,QAAQ,CAACG,IAAI,CAACG,QAAQ,EAAI,EAAE,CAAC,CAAC,CAChE,MAAO,CAAAsB,WAAW,CACpB,CAAC,CAAC,CACF7D,kBAAkB,CAACiC,QAAQ,CAACG,IAAI,CAACI,OAAO,EAAI,KAAK,CAAC,CAClDxB,kBAAkB,CAACoC,OAAO,CAAGnB,QAAQ,CAACG,IAAI,CAACI,OAAO,EAAI,KAAK,CAC7D,CACF,CAAC,CAAC,CACDsB,KAAK,CAACrB,KAAK,EAAI,KAAAsB,gBAAA,CAAAC,qBAAA,CAAAC,gBAAA,CAAAC,qBAAA,CACd,KAAM,CAAApB,YAAY,CAAG,EAAAiB,gBAAA,CAAAtB,KAAK,CAACR,QAAQ,UAAA8B,gBAAA,kBAAAC,qBAAA,CAAdD,gBAAA,CAAgB3B,IAAI,UAAA4B,qBAAA,iBAApBA,qBAAA,CAAsBvB,KAAK,KAAAwB,gBAAA,CAAIxB,KAAK,CAACR,QAAQ,UAAAgC,gBAAA,kBAAAC,qBAAA,CAAdD,gBAAA,CAAgB7B,IAAI,UAAA8B,qBAAA,iBAApBA,qBAAA,CAAsBnB,OAAO,GAAIN,KAAK,CAACM,OAAO,EAAI,2CAA2C,CACjJ9E,KAAK,CAACwE,KAAK,CAACK,YAAY,CAAC,CAC3B,CAAC,CAAC,CACDqB,OAAO,CAAC,IAAM,CACblD,cAAc,CAACmC,OAAO,CAAG,KAAK,CAC9BlD,cAAc,CAAC,KAAK,CAAC,CACvB,CAAC,CAAC,CACN,CAAC,CAAE,EAAE,CAAC,CAEN;AACApD,SAAS,CAAC,IAAM,CACd,GAAI,CAACiD,eAAe,CAAE,CACpB,OACF,CAEA,KAAM,CAAAqE,OAAO,CAAGvD,iBAAiB,CAACuC,OAAO,CACzC,KAAM,CAAAiB,cAAc,CAAGvD,iBAAiB,CAACsC,OAAO,CAEhD,GAAI,CAACgB,OAAO,EAAI,CAACC,cAAc,EAAIpE,WAAW,CAAE,CAC9C,OACF,CAEA,GAAI,CAAAqE,aAAa,CAAG,KAAK,CAEzB,KAAM,CAAAC,kBAAkB,CAAIC,OAAO,EAAK,CACtC,KAAM,CAAAC,KAAK,CAAGD,OAAO,CAAC,CAAC,CAAC,CAExB,GAAIC,KAAK,CAACC,cAAc,EAAI,CAACJ,aAAa,EAAItD,kBAAkB,CAACoC,OAAO,EAAI,CAACnC,cAAc,CAACmC,OAAO,CAAE,CACnGkB,aAAa,CAAG,IAAI,CACpBjB,gBAAgB,CAAC,CAAC,CAElBsB,UAAU,CAAC,IAAM,CACfL,aAAa,CAAG,KAAK,CACvB,CAAC,CAAE,IAAI,CAAC,CACV,CACF,CAAC,CAED,KAAM,CAAAM,YAAY,CAAGA,CAAA,GAAM,CACzB,GAAIN,aAAa,EAAIrD,cAAc,CAACmC,OAAO,EAAI,CAACpC,kBAAkB,CAACoC,OAAO,CAAE,CAC1E,OACF,CAEA,GAAI,CAACgB,OAAO,EAAI,CAACC,cAAc,CAAE,OAEjC,KAAM,CAAAQ,aAAa,CAAGR,cAAc,CAACS,qBAAqB,CAAC,CAAC,CAC5D,KAAM,CAAAC,WAAW,CAAGX,OAAO,CAACU,qBAAqB,CAAC,CAAC,CACnD,KAAM,CAAAE,SAAS,CAAGD,WAAW,CAACE,GAAG,EAAIJ,aAAa,CAACK,MAAM,CAAG,GAAG,CAE/D,GAAIF,SAAS,CAAE,CACbV,aAAa,CAAG,IAAI,CACpBjB,gBAAgB,CAAC,CAAC,CAElBsB,UAAU,CAAC,IAAM,CACfL,aAAa,CAAG,KAAK,CACvB,CAAC,CAAE,IAAI,CAAC,CACV,CACF,CAAC,CAED,GAAI,CACF,KAAM,CAAAa,QAAQ,CAAG,GAAI,CAAAC,oBAAoB,CAACb,kBAAkB,CAAE,CAC5Dc,IAAI,CAAEhB,cAAc,CACpBiB,UAAU,CAAE,OAAO,CACnBC,SAAS,CAAE,CAAC,CAAC,CAAE,GAAG,CAAE,GAAG,CAAE,GAAG,CAC9B,CAAC,CAAC,CAEFJ,QAAQ,CAACK,OAAO,CAACpB,OAAO,CAAC,CAEzBC,cAAc,CAACoB,gBAAgB,CAAC,QAAQ,CAAEb,YAAY,CAAE,CAAEc,OAAO,CAAE,IAAK,CAAC,CAAC,CAE1E,KAAM,CAAAC,eAAe,CAAGA,CAAA,GAAM,CAC5B,GAAI,CAACvB,OAAO,EAAI,CAACC,cAAc,CAAE,OACjC,KAAM,CAAAQ,aAAa,CAAGR,cAAc,CAACS,qBAAqB,CAAC,CAAC,CAC5D,KAAM,CAAAC,WAAW,CAAGX,OAAO,CAACU,qBAAqB,CAAC,CAAC,CACnD,KAAM,CAAAE,SAAS,CAAGD,WAAW,CAACE,GAAG,CAAGJ,aAAa,CAACK,MAAM,CAAG,GAAG,CAE9D,GAAIF,SAAS,EAAIhE,kBAAkB,CAACoC,OAAO,EAAI,CAACnC,cAAc,CAACmC,OAAO,EAAI,CAACkB,aAAa,CAAE,CACxFA,aAAa,CAAG,IAAI,CACpBjB,gBAAgB,CAAC,CAAC,CAElBsB,UAAU,CAAC,IAAM,CACfL,aAAa,CAAG,KAAK,CACvB,CAAC,CAAE,IAAI,CAAC,CACV,CACF,CAAC,CAED,KAAM,CAAAsB,iBAAiB,CAAGjB,UAAU,CAACgB,eAAe,CAAE,GAAG,CAAC,CAE1D,MAAO,IAAM,CACX,GAAI,CACFR,QAAQ,CAACU,UAAU,CAAC,CAAC,CACvB,CAAE,MAAO5C,CAAC,CAAE,CACV;AAAA,CAEFoB,cAAc,CAACyB,mBAAmB,CAAC,QAAQ,CAAElB,YAAY,CAAC,CAC1DmB,YAAY,CAACH,iBAAiB,CAAC,CACjC,CAAC,CACH,CAAE,MAAOnD,KAAK,CAAE,CACd;AACA,OACF,CACF,CAAC,CAAE,CAAC1C,eAAe,CAAEE,WAAW,CAAEoD,gBAAgB,CAAC,CAAC,CAEpD,KAAM,CAAA2C,eAAe,CAAIC,SAAS,EAAK,CACrC7F,mBAAmB,CAACkC,IAAI,EAAI,CAC1B,GAAIA,IAAI,CAAC4D,QAAQ,CAACD,SAAS,CAAC,CAAE,CAC5B,KAAM,CAAAE,WAAW,CAAG7D,IAAI,CAAC8D,MAAM,CAACC,EAAE,EAAIA,EAAE,GAAKJ,SAAS,CAAC,CACvD;AACA,GAAIE,WAAW,CAAC1E,MAAM,CAAG,CAAC,CAAE,CAC1BjB,kBAAkB,CAAC,EAAE,CAAC,CACxB,CACA,MAAO,CAAA2F,WAAW,CACpB,CAAC,IAAM,CACL,KAAM,CAAAA,WAAW,CAAG,CAAC,GAAG7D,IAAI,CAAE2D,SAAS,CAAC,CACxC,MAAO,CAAAE,WAAW,CACpB,CACF,CAAC,CAAC,CACJ,CAAC,CAED,KAAM,CAAAG,eAAe,CAAIC,OAAO,EAAK,CACnC,GAAIA,OAAO,CAAE,CACX,KAAM,CAAAC,WAAW,CAAGjH,2BAA2B,CAACkH,GAAG,CAACC,CAAC,EAAIA,CAAC,CAACL,EAAE,CAAC,CAC9DjG,mBAAmB,CAACoG,WAAW,CAAC,CAChC;AACA,GAAIA,WAAW,CAAC/E,MAAM,CAAG,CAAC,CAAE,CAC1BjB,kBAAkB,CAAC,EAAE,CAAC,CACxB,CACF,CAAC,IAAM,CACLJ,mBAAmB,CAAC,EAAE,CAAC,CACvBI,kBAAkB,CAAC,EAAE,CAAC,CAAE;AAC1B,CACF,CAAC,CAED,KAAM,CAAAmG,uBAAuB,CAAGA,CAACV,SAAS,CAAEW,KAAK,GAAK,CACpD;AACA,KAAM,CAAAC,OAAO,CAAGxH,mBAAmB,CAACyH,IAAI,CAACJ,CAAC,EAAIA,CAAC,CAACL,EAAE,GAAKJ,SAAS,CAAC,CACjE,KAAM,CAAAc,aAAa,CAAG,CAAAF,OAAO,SAAPA,OAAO,iBAAPA,OAAO,CAAEG,kBAAkB,GAAI,IAAI,CAEzD;AACA,GAAI,CAAC3I,iBAAiB,CAAC0I,aAAa,CAAEH,KAAK,CAAC,CAAE,CAC5C3I,KAAK,CAACwE,KAAK,6CAAAN,MAAA,CAA4C4E,aAAa,EAAI,UAAU,aAAA5E,MAAA,CAASyE,KAAK,SAAAzE,MAAA,CAAM7D,wBAAwB,CAACyI,aAAa,CAAC,CAAE,CAAC,CAChJ,OACF,CAEAzG,qBAAqB,CAACgC,IAAI,EAAA2E,aAAA,CAAAA,aAAA,IACrB3E,IAAI,MACP,CAAC2D,SAAS,EAAGW,KAAK,GAAK,UAAU,CAAG,IAAI,CAAGA,KAAK,EAChD,CAAC,CACH;AACApG,kBAAkB,CAAC,EAAE,CAAC,CACxB,CAAC,CAED,KAAM,CAAA0G,2BAA2B,CAAIN,KAAK,EAAK,CAC7C;AACA,KAAM,CAAAO,eAAe,CAAG,EAAE,CAC1BhH,gBAAgB,CAACiH,OAAO,CAACnB,SAAS,EAAI,CACpC,KAAM,CAAAY,OAAO,CAAGxH,mBAAmB,CAACyH,IAAI,CAACJ,CAAC,EAAIA,CAAC,CAACL,EAAE,GAAKJ,SAAS,CAAC,CACjE,KAAM,CAAAc,aAAa,CAAG,CAAAF,OAAO,SAAPA,OAAO,iBAAPA,OAAO,CAAEG,kBAAkB,GAAI,IAAI,CACzD,GAAI,CAAC3I,iBAAiB,CAAC0I,aAAa,CAAEH,KAAK,CAAC,CAAE,CAC5CO,eAAe,CAACE,IAAI,CAAC,CAAAR,OAAO,SAAPA,OAAO,iBAAPA,OAAO,CAAES,sBAAsB,GAAIrB,SAAS,CAAC,CACpE,CACF,CAAC,CAAC,CAEF,GAAIkB,eAAe,CAAC1F,MAAM,CAAG,CAAC,CAAE,CAC9BxD,KAAK,CAACwE,KAAK,4BAAAN,MAAA,CAA4BgF,eAAe,CAAC1F,MAAM,qDAAmD,CAAC,CACjH,OACF,CAEAjB,kBAAkB,CAACoG,KAAK,CAAC,CACzB;AACA,KAAM,CAAAW,OAAO,CAAG,CAAC,CAAC,CAClBpH,gBAAgB,CAACiH,OAAO,CAACnB,SAAS,EAAI,CACpCsB,OAAO,CAACtB,SAAS,CAAC,CAAGW,KAAK,GAAK,UAAU,CAAG,IAAI,CAAGA,KAAK,CAC1D,CAAC,CAAC,CACFtG,qBAAqB,CAACgC,IAAI,EAAA2E,aAAA,CAAAA,aAAA,IACrB3E,IAAI,EACJiF,OAAO,CACV,CAAC,CACL,CAAC,CAED;AACA,KAAM,CAAAC,UAAU,CAAGA,CAAA,GAAM,CACvB,GAAIrH,gBAAgB,CAACsB,MAAM,GAAK,CAAC,CAAE,MAAO,MAAK,CAE/C;AACA,GAAIlB,eAAe,EAAIA,eAAe,GAAK,EAAE,CAAE,CAC7C,KAAM,CAAAkH,UAAU,CAAGlH,eAAe,GAAK,UAAU,CAAG,IAAI,CAAGA,eAAe,CAC1E,MAAO,CAAAJ,gBAAgB,CAACuH,IAAI,CAACzB,SAAS,EAAI,CACxC,KAAM,CAAAY,OAAO,CAAGxH,mBAAmB,CAACyH,IAAI,CAACJ,CAAC,EAAIA,CAAC,CAACL,EAAE,GAAKJ,SAAS,CAAC,CACjE,GAAI,CAACY,OAAO,CAAE,MAAO,MAAK,CAE1B,KAAM,CAAAE,aAAa,CAAGF,OAAO,CAACG,kBAAkB,EAAI,IAAI,CACxD,MAAO,CAAAD,aAAa,GAAKU,UAAU,CACrC,CAAC,CAAC,CACJ,CAEA;AACA,MAAO,CAAAtH,gBAAgB,CAACuH,IAAI,CAACzB,SAAS,EAAI,CACxC,KAAM,CAAAY,OAAO,CAAGxH,mBAAmB,CAACyH,IAAI,CAACJ,CAAC,EAAIA,CAAC,CAACL,EAAE,GAAKJ,SAAS,CAAC,CACjE,GAAI,CAACY,OAAO,CAAE,MAAO,MAAK,CAE1B,KAAM,CAAAE,aAAa,CAAGF,OAAO,CAACG,kBAAkB,EAAI,IAAI,CACxD,KAAM,CAAAW,YAAY,CAAGtH,kBAAkB,CAAC4F,SAAS,CAAC,GAAKvE,SAAS,CAC5DrB,kBAAkB,CAAC4F,SAAS,CAAC,CAC7Bc,aAAa,CAEjB,MAAO,CAAAA,aAAa,GAAKY,YAAY,CACvC,CAAC,CAAC,CACJ,CAAC,CAED,KAAM,CAAAC,mBAAmB,CAAGA,CAAA,GAAM,CAChC,GAAIrI,2BAA2B,CAACkC,MAAM,GAAK,CAAC,CAAE,CAC5CxD,KAAK,CAACwE,KAAK,CAAC,mBAAmB,CAAC,CAChC,OACF,CAEA,GAAI,CACF;AACA,KAAM,CAAAoF,UAAU,CAAGtI,2BAA2B,CAACkH,GAAG,CAACI,OAAO,GAAK,CAC7D,0BAA0B,CAAEA,OAAO,CAACS,sBAAsB,EAAI,KAAK,CACnE,SAAS,CAAET,OAAO,CAACA,OAAO,EAAI,KAAK,CACnC,QAAQ,CAAEA,OAAO,CAACiB,MAAM,EAAI,KAAK,CACjC,sBAAsB,CAAEjB,OAAO,CAACG,kBAAkB,EAAI,KACxD,CAAC,CAAC,CAAC,CAEH;AACA,KAAM,CAAAe,EAAE,CAAG7J,IAAI,CAAC8J,KAAK,CAACC,aAAa,CAACJ,UAAU,CAAC,CAC/C,KAAM,CAAAK,EAAE,CAAGhK,IAAI,CAAC8J,KAAK,CAACG,QAAQ,CAAC,CAAC,CAChCjK,IAAI,CAAC8J,KAAK,CAACI,iBAAiB,CAACF,EAAE,CAAEH,EAAE,CAAE,cAAc,CAAC,CAEpD;AACA,KAAM,CAAAM,QAAQ,4BAAAlG,MAAA,CAA8B,GAAI,CAAAmG,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC,CAACC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,SAAO,CAEzF;AACAtK,IAAI,CAACuK,SAAS,CAACP,EAAE,CAAEG,QAAQ,CAAC,CAC5BpK,KAAK,CAACoE,OAAO,aAAAF,MAAA,CAAa0F,UAAU,CAACpG,MAAM,qBAAmB,CAAC,CACjE,CAAE,MAAOgB,KAAK,CAAE,CACdiG,OAAO,CAACjG,KAAK,CAAC,2BAA2B,CAAEA,KAAK,CAAC,CACjDxE,KAAK,CAACwE,KAAK,CAAC,2BAA2B,CAAC,CAC1C,CACF,CAAC,CAED,KAAM,CAAAkG,aAAa,CAAG,KAAAA,CAAA,GAAY,CAChC,GAAI,CAACnB,UAAU,CAAC,CAAC,CAAE,CACjBvJ,KAAK,CAACwE,KAAK,CAAC,wEAAwE,CAAC,CACrF,OACF,CAEA;AACA,KAAM,CAAA8E,OAAO,CAAGpH,gBAAgB,CAC7BsG,GAAG,CAACR,SAAS,EAAI,CAChB,KAAM,CAAAY,OAAO,CAAGxH,mBAAmB,CAACyH,IAAI,CAACJ,CAAC,EAAIA,CAAC,CAACL,EAAE,GAAKJ,SAAS,CAAC,CACjE,GAAI,CAACY,OAAO,CAAE,MAAO,KAAI,CAEzB,KAAM,CAAAE,aAAa,CAAGF,OAAO,CAACG,kBAAkB,EAAI,IAAI,CACxD,GAAI,CAAAW,YAAY,CAEhB;AACA,GAAIpH,eAAe,EAAIA,eAAe,GAAK,EAAE,CAAE,CAC7CoH,YAAY,CAAGpH,eAAe,GAAK,UAAU,CAAG,IAAI,CAAGA,eAAe,CACxE,CAAC,IAAM,CACLoH,YAAY,CAAGtH,kBAAkB,CAAC4F,SAAS,CAAC,GAAKvE,SAAS,CACtDrB,kBAAkB,CAAC4F,SAAS,CAAC,CAC7Bc,aAAa,CACnB,CAEA;AACA,GAAIA,aAAa,GAAKY,YAAY,CAAE,CAClC,MAAO,CACL1B,SAAS,CAAEA,SAAS,CACpB2C,WAAW,CAAEjB,YAAY,CACzBZ,aAAa,CAAEA,aAAc;AAC/B,CAAC,CACH,CACA,MAAO,KAAI,CACb,CAAC,CAAC,CACDX,MAAM,CAACyC,MAAM,EAAIA,MAAM,GAAK,IAAI,CAAC,CAEpC,GAAItB,OAAO,CAAC9F,MAAM,GAAK,CAAC,CAAE,CACxBxD,KAAK,CAACwE,KAAK,CAAC,uBAAuB,CAAC,CACpC,OACF,CAEA/B,aAAa,CAAC,IAAI,CAAC,CACnB,GAAI,CACF,KAAM,CAAAuB,QAAQ,CAAG,KAAM,CAAAjE,SAAS,CAAC8K,IAAI,CAAC,8CAA8C,CAAE,CAAEvB,OAAQ,CAAC,CAAC,CAClG,GAAItF,QAAQ,CAACG,IAAI,CAACC,OAAO,CAAE,CACzBpE,KAAK,CAACoE,OAAO,2BAAAF,MAAA,CAA2BF,QAAQ,CAACG,IAAI,CAAC2G,YAAY,6BAA2B,CAAC,CAC9F3I,mBAAmB,CAAC,EAAE,CAAC,CACvBE,qBAAqB,CAAC,CAAC,CAAC,CAAC,CACzBE,kBAAkB,CAAC,EAAE,CAAC,CACtBc,wBAAwB,CAAC,CAAC,CAC5B,CACF,CAAE,MAAOmB,KAAK,CAAE,KAAAuG,gBAAA,CAAAC,qBAAA,CACd,KAAM,CAAAnG,YAAY,CAAG,EAAAkG,gBAAA,CAAAvG,KAAK,CAACR,QAAQ,UAAA+G,gBAAA,kBAAAC,qBAAA,CAAdD,gBAAA,CAAgB5G,IAAI,UAAA6G,qBAAA,iBAApBA,qBAAA,CAAsBxG,KAAK,GAAI,wCAAwC,CAC5FxE,KAAK,CAACwE,KAAK,CAACK,YAAY,CAAC,CAC3B,CAAC,OAAS,CACRpC,aAAa,CAAC,KAAK,CAAC,CACtB,CACF,CAAC,CAED,GAAIvB,OAAO,CAAE,CACX,mBACET,KAAA,QAAKwK,SAAS,CAAC,kBAAkB,CAAAC,QAAA,eAC/B3K,IAAA,CAACtB,OAAO,EAACkM,MAAM,CAAEpK,WAAY,CAACqK,aAAa,CAAEA,CAAA,GAAMpK,cAAc,CAAC,CAACD,WAAW,CAAE,CAAE,CAAC,cACnFR,IAAA,QAAK0K,SAAS,CAAC,yBAAyB,CAACI,KAAK,CAAE,CAAEC,UAAU,IAAApH,MAAA,CAAKjD,YAAY,MAAI,CAAEsK,KAAK,gBAAArH,MAAA,CAAiBjD,YAAY,OAAK,CAAEuK,UAAU,CAAE,wCAAwC,CAAEC,MAAM,CAAE,OAAO,CAAEC,OAAO,CAAE,MAAM,CAAEC,UAAU,CAAE,QAAQ,CAAEC,cAAc,CAAE,QAAS,CAAE,CAAAV,QAAA,cACnQzK,KAAA,QAAKwK,SAAS,CAAC,mBAAmB,CAAAC,QAAA,eAChC3K,IAAA,CAACb,MAAM,EAACuL,SAAS,CAAC,UAAU,CAACY,IAAI,CAAE,EAAG,CAAE,CAAC,cACzCtL,IAAA,MAAA2K,QAAA,CAAG,yCAAuC,CAAG,CAAC,EAC3C,CAAC,CACH,CAAC,EACH,CAAC,CAEV,CAEA,mBACEzK,KAAA,QAAKwK,SAAS,CAAC,kBAAkB,CAAAC,QAAA,eAC/B3K,IAAA,CAACtB,OAAO,EAACkM,MAAM,CAAEpK,WAAY,CAACqK,aAAa,CAAEA,CAAA,GAAMpK,cAAc,CAAC,CAACD,WAAW,CAAE,CAAE,CAAC,cAEnFR,IAAA,QAAK0K,SAAS,CAAC,yBAAyB,CAACI,KAAK,CAAE,CAAEC,UAAU,IAAApH,MAAA,CAAKjD,YAAY,MAAI,CAAEsK,KAAK,gBAAArH,MAAA,CAAiBjD,YAAY,OAAK,CAAEuK,UAAU,CAAE,wCAAyC,CAAE,CAAAN,QAAA,cACjLzK,KAAA,QAAKwK,SAAS,CAAC,mCAAmC,CAAAC,QAAA,eAChD3K,IAAA,QAAK0K,SAAS,CAAC,gCAAgC,CAAAC,QAAA,cAC7CzK,KAAA,QAAKwK,SAAS,CAAC,gBAAgB,CAAAC,QAAA,eAC7BzK,KAAA,QAAKwK,SAAS,CAAC,aAAa,CAAAC,QAAA,eAC1B3K,IAAA,WACE0K,SAAS,CAAC,oBAAoB,CAC9Ba,OAAO,CAAEA,CAAA,GAAM9K,cAAc,CAAC,CAACD,WAAW,CAAE,CAC5C,aAAW,gBAAgB,CAAAmK,QAAA,cAE3B3K,IAAA,CAAClB,IAAI,EAACwM,IAAI,CAAE,EAAG,CAAE,CAAC,CACZ,CAAC,cACTpL,KAAA,QAAAyK,QAAA,eACE3K,IAAA,OAAI0K,SAAS,CAAC,YAAY,CAAAC,QAAA,CAAC,yBAAuB,CAAI,CAAC,cACvD3K,IAAA,MAAG0K,SAAS,CAAC,eAAe,CAAAC,QAAA,CAAC,8CAA4C,CAAG,CAAC,EAC1E,CAAC,EACH,CAAC,cACNzK,KAAA,QAAKwK,SAAS,CAAC,qBAAqB,CAAAC,QAAA,eAClC3K,IAAA,CAACL,cAAc,EAAC6L,QAAQ,CAAC,yBAAyB,CAACC,QAAQ,CAAC,MAAM,CAAE,CAAC,cACrEvL,KAAA,QAAKwK,SAAS,CAAC,cAAc,CAAAC,QAAA,eAC3B3K,IAAA,QAAK0K,SAAS,CAAC,aAAa,CAAAC,QAAA,CACzB,CAAC,CAAArK,IAAI,SAAJA,IAAI,iBAAJA,IAAI,CAAEoL,KAAK,GAAI,GAAG,EAAEC,MAAM,CAAC,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC,CAC1C,CAAC,cACN5L,IAAA,SAAM0K,SAAS,CAAC,WAAW,CAAAC,QAAA,CAAE,CAAArK,IAAI,SAAJA,IAAI,iBAAJA,IAAI,CAAEoL,KAAK,GAAI,MAAM,CAAO,CAAC,cAC1D1L,IAAA,WAAQ0K,SAAS,CAAC,YAAY,CAACa,OAAO,CAAEhL,MAAO,CAACsL,KAAK,CAAC,QAAQ,CAAAlB,QAAA,cAC5D3K,IAAA,CAACjB,MAAM,EAACuM,IAAI,CAAE,EAAG,CAAE,CAAC,CACd,CAAC,EACN,CAAC,EACH,CAAC,EACH,CAAC,CACH,CAAC,cAGNpL,KAAA,QAAK4K,KAAK,CAAE,CAAEK,OAAO,CAAE,MAAM,CAAEW,GAAG,CAAE,KAAK,CAAEC,YAAY,CAAE,MAAM,CAAEC,YAAY,CAAE,+BAAgC,CAAE,CAAArB,QAAA,eAC/G3K,IAAA,WACEuL,OAAO,CAAEA,CAAA,GAAMnJ,YAAY,CAAC,YAAY,CAAE,CAC1C0I,KAAK,CAAE,CACLmB,OAAO,CAAE,WAAW,CACpBC,UAAU,CAAE,MAAM,CAClBC,MAAM,CAAE,MAAM,CACdH,YAAY,CAAE7J,SAAS,GAAK,YAAY,CAAG,mBAAmB,CAAG,uBAAuB,CACxFiK,KAAK,CAAEjK,SAAS,GAAK,YAAY,CAAG,SAAS,CAAG,MAAM,CACtDkK,UAAU,CAAElK,SAAS,GAAK,YAAY,CAAG,KAAK,CAAG,KAAK,CACtDmK,MAAM,CAAE,SAAS,CACjBC,QAAQ,CAAE,MAAM,CAChBR,YAAY,CAAE,MAChB,CAAE,CAAApB,QAAA,CACH,YAED,CAAQ,CAAC,cACTzK,KAAA,WACEqL,OAAO,CAAEA,CAAA,GAAMnJ,YAAY,CAAC,WAAW,CAAE,CACzC0I,KAAK,CAAE,CACLmB,OAAO,CAAE,WAAW,CACpBC,UAAU,CAAE,MAAM,CAClBC,MAAM,CAAE,MAAM,CACdH,YAAY,CAAE7J,SAAS,GAAK,WAAW,CAAG,mBAAmB,CAAG,uBAAuB,CACvFiK,KAAK,CAAEjK,SAAS,GAAK,WAAW,CAAG,SAAS,CAAG,MAAM,CACrDkK,UAAU,CAAElK,SAAS,GAAK,WAAW,CAAG,KAAK,CAAG,KAAK,CACrDmK,MAAM,CAAE,SAAS,CACjBC,QAAQ,CAAE,MAAM,CAChBR,YAAY,CAAE,MAAM,CACpBZ,OAAO,CAAE,MAAM,CACfC,UAAU,CAAE,QAAQ,CACpBU,GAAG,CAAE,KACP,CAAE,CAAAnB,QAAA,eAEF3K,IAAA,CAACV,SAAS,EAACgM,IAAI,CAAE,EAAG,CAAE,CAAC,YAEzB,EAAQ,CAAC,cACTpL,KAAA,WACEqL,OAAO,CAAEA,CAAA,GAAMnJ,YAAY,CAAC,UAAU,CAAE,CACxC0I,KAAK,CAAE,CACLmB,OAAO,CAAE,WAAW,CACpBC,UAAU,CAAE,MAAM,CAClBC,MAAM,CAAE,MAAM,CACdH,YAAY,CAAE7J,SAAS,GAAK,UAAU,CAAG,mBAAmB,CAAG,uBAAuB,CACtFiK,KAAK,CAAEjK,SAAS,GAAK,UAAU,CAAG,SAAS,CAAG,MAAM,CACpDkK,UAAU,CAAElK,SAAS,GAAK,UAAU,CAAG,KAAK,CAAG,KAAK,CACpDmK,MAAM,CAAE,SAAS,CACjBC,QAAQ,CAAE,MAAM,CAChBR,YAAY,CAAE,MAAM,CACpBZ,OAAO,CAAE,MAAM,CACfC,UAAU,CAAE,QAAQ,CACpBU,GAAG,CAAE,KACP,CAAE,CAAAnB,QAAA,eAEF3K,IAAA,CAACT,KAAK,EAAC+L,IAAI,CAAE,EAAG,CAAE,CAAC,wBAErB,EAAQ,CAAC,EACN,CAAC,CAGLnJ,SAAS,GAAK,WAAW,eACxBnC,IAAA,CAACpB,oBAAoB,GAAE,CACxB,CAGAuD,SAAS,GAAK,UAAU,eACvBnC,IAAA,CAACnB,0BAA0B,GAAE,CAC9B,CAGAsD,SAAS,GAAK,YAAY,eAC3BjC,KAAA,QAAKwK,SAAS,CAAC,2BAA2B,CAAAC,QAAA,eACxCzK,KAAA,QAAK4K,KAAK,CAAE,CAAEK,OAAO,CAAE,MAAM,CAAEE,cAAc,CAAE,eAAe,CAAED,UAAU,CAAE,QAAQ,CAAEW,YAAY,CAAE,MAAM,CAAES,QAAQ,CAAE,MAAM,CAAEV,GAAG,CAAE,MAAO,CAAE,CAAAnB,QAAA,eAC1IzK,KAAA,OAAI4K,KAAK,CAAE,CAAEyB,QAAQ,CAAE,MAAM,CAAEF,UAAU,CAAE,KAAK,CAAEI,MAAM,CAAE,CAAE,CAAE,CAAA9B,QAAA,EAAC,wBACvC,CAAC5J,2BAA2B,CAACkC,MAAM,CAAC,GAC5D,EAAI,CAAC,cACL/C,KAAA,QAAK4K,KAAK,CAAE,CAAEK,OAAO,CAAE,MAAM,CAAEW,GAAG,CAAE,MAAM,CAAEV,UAAU,CAAE,QAAQ,CAAEoB,QAAQ,CAAE,MAAO,CAAE,CAAA7B,QAAA,eACnFzK,KAAA,QAAK4K,KAAK,CAAE,CAAE4B,QAAQ,CAAE,UAAU,CAAEC,QAAQ,CAAE,OAAO,CAAEC,QAAQ,CAAE,OAAQ,CAAE,CAAAjC,QAAA,eACzE3K,IAAA,CAAChB,MAAM,EAACsM,IAAI,CAAE,EAAG,CAACR,KAAK,CAAE,CAAE4B,QAAQ,CAAE,UAAU,CAAEG,IAAI,CAAE,MAAM,CAAEpG,GAAG,CAAE,KAAK,CAAEqG,SAAS,CAAE,kBAAkB,CAAEV,KAAK,CAAE,MAAM,CAAEW,MAAM,CAAE,CAAC,CAAEC,aAAa,CAAE,MAAO,CAAE,CAAE,CAAC,cAC/JhN,IAAA,UACEiN,IAAI,CAAC,MAAM,CACXC,WAAW,CAAC,gCAAgC,CAC5C9E,KAAK,CAAEnH,UAAW,CAClBkM,QAAQ,CAAG1I,CAAC,EAAKvD,aAAa,CAACuD,CAAC,CAAC2I,MAAM,CAAChF,KAAK,CAAE,CAC/C0C,KAAK,CAAE,CACLuC,WAAW,CAAE,MAAM,CACnBd,QAAQ,CAAE,MAAM,CAChBN,OAAO,CAAE,qBAAqB,CAC9BjB,KAAK,CAAE,MAAM,CACbmB,MAAM,CAAE,+BAA+B,CACvCmB,YAAY,CAAE,kBAAkB,CAChCpB,UAAU,CAAE,gBAAgB,CAC5BE,KAAK,CAAE,qBAAqB,CAC5BmB,SAAS,CAAE,YACb,CAAE,CACH,CAAC,EACC,CAAC,cACNrN,KAAA,WACEkI,KAAK,CAAEjH,YAAa,CACpBgM,QAAQ,CAAG1I,CAAC,EAAKrD,eAAe,CAACqD,CAAC,CAAC2I,MAAM,CAAChF,KAAK,CAAE,CACjD0C,KAAK,CAAE,CACLyB,QAAQ,CAAE,MAAM,CAChBN,OAAO,CAAE,WAAW,CACpBE,MAAM,CAAE,+BAA+B,CACvCmB,YAAY,CAAE,kBAAkB,CAChCpB,UAAU,CAAE,gBAAgB,CAC5BE,KAAK,CAAE,qBAAqB,CAC5BO,QAAQ,CAAE,OAAO,CACjBL,MAAM,CAAE,SACV,CAAE,CAAA3B,QAAA,eAEF3K,IAAA,WAAQoI,KAAK,CAAC,EAAE,CAAAuC,QAAA,CAAC,YAAU,CAAQ,CAAC,CACnC6C,KAAK,CAACC,IAAI,CAAC,GAAI,CAAAC,GAAG,CAAC7M,mBAAmB,CAACoH,GAAG,CAACC,CAAC,EAAIA,CAAC,CAACoB,MAAM,CAAC,CAAC1B,MAAM,CAAC+F,OAAO,CAAC,CAAC,CAAC,CAACC,IAAI,CAAC,CAAC,CAAC3F,GAAG,CAACqB,MAAM,eAC5FtJ,IAAA,WAAqBoI,KAAK,CAAEkB,MAAO,CAAAqB,QAAA,CAAErB,MAAM,EAA9BA,MAAuC,CACrD,CAAC,EACI,CAAC,cACTpJ,KAAA,WACEkI,KAAK,CAAE/G,iBAAkB,CACzB8L,QAAQ,CAAG1I,CAAC,EAAKnD,oBAAoB,CAACmD,CAAC,CAAC2I,MAAM,CAAChF,KAAK,CAAE,CACtD0C,KAAK,CAAE,CACLyB,QAAQ,CAAE,MAAM,CAChBN,OAAO,CAAE,WAAW,CACpBE,MAAM,CAAE,+BAA+B,CACvCmB,YAAY,CAAE,kBAAkB,CAChCpB,UAAU,CAAE,gBAAgB,CAC5BE,KAAK,CAAE,qBAAqB,CAC5BO,QAAQ,CAAE,OAAO,CACjBL,MAAM,CAAE,SACV,CAAE,CAAA3B,QAAA,eAEF3K,IAAA,WAAQoI,KAAK,CAAC,EAAE,CAAAuC,QAAA,CAAC,kBAAgB,CAAQ,CAAC,cAC1C3K,IAAA,WAAQoI,KAAK,CAAC,UAAU,CAAAuC,QAAA,CAAC,UAAQ,CAAQ,CAAC,CACzC6C,KAAK,CAACC,IAAI,CAAC,GAAI,CAAAC,GAAG,CAAC7M,mBAAmB,CAACoH,GAAG,CAACC,CAAC,EAAIA,CAAC,CAACM,kBAAkB,CAAC,CAACZ,MAAM,CAAC+F,OAAO,CAAC,CAAC,CAAC,CAACC,IAAI,CAAC,CAAC,CAAC3F,GAAG,CAACmC,WAAW,eAC7GpK,IAAA,WAA0BoI,KAAK,CAAEgC,WAAY,CAAAO,QAAA,CAAEP,WAAW,EAA7CA,WAAsD,CACpE,CAAC,EACI,CAAC,cACTlK,KAAA,WACEwK,SAAS,CAAC,eAAe,CACzBa,OAAO,CAAE/G,aAAc,CACvBqJ,QAAQ,CAAElN,OAAQ,CAClBmK,KAAK,CAAE,CAAEK,OAAO,CAAE,MAAM,CAAEC,UAAU,CAAE,QAAQ,CAAEU,GAAG,CAAE,KAAK,CAAEgC,UAAU,CAAE,QAAS,CAAE,CACnFjC,KAAK,CAAC,eAAe,CAAAlB,QAAA,eAErB3K,IAAA,CAACf,SAAS,EAACqM,IAAI,CAAE,EAAG,CAACZ,SAAS,CAAE/J,OAAO,CAAG,UAAU,CAAG,EAAG,CAAE,CAAC,UAE/D,EAAQ,CAAC,cACTT,KAAA,WACEwK,SAAS,CAAC,eAAe,CACzBa,OAAO,CAAEnC,mBAAoB,CAC7ByE,QAAQ,CAAE9M,2BAA2B,CAACkC,MAAM,GAAK,CAAE,CACnD6H,KAAK,CAAE,CAAEK,OAAO,CAAE,MAAM,CAAEC,UAAU,CAAE,QAAQ,CAAEU,GAAG,CAAE,KAAK,CAAEgC,UAAU,CAAE,QAAS,CAAE,CACnFjC,KAAK,CAAC,4BAA4B,CAAAlB,QAAA,eAElC3K,IAAA,CAACZ,QAAQ,EAACkM,IAAI,CAAE,EAAG,CAAE,CAAC,kBAExB,EAAQ,CAAC,CACR3J,gBAAgB,CAACsB,MAAM,EAAI,CAAC,EAAI,CAAC,IAAM,CACtC;AACA,KAAM,CAAA8K,2BAA2B,CAAGA,CAAA,GAAM,CACxC,GAAIpM,gBAAgB,CAACsB,MAAM,GAAK,CAAC,CAAE,MAAO,CAAAJ,kBAAkB,CAE5D,KAAM,CAAAmL,qBAAqB,CAAGrM,gBAAgB,CAACsG,GAAG,CAACR,SAAS,EAAI,CAC9D,KAAM,CAAAY,OAAO,CAAGxH,mBAAmB,CAACyH,IAAI,CAACJ,CAAC,EAAIA,CAAC,CAACL,EAAE,GAAKJ,SAAS,CAAC,CACjE,KAAM,CAAAc,aAAa,CAAG,CAAAF,OAAO,SAAPA,OAAO,iBAAPA,OAAO,CAAEG,kBAAkB,GAAI,IAAI,CACzD,MAAO,CAAA5I,qBAAqB,CAAC2I,aAAa,CAAC,CAC7C,CAAC,CAAC,CAEF;AACA,GAAIyF,qBAAqB,CAAC/K,MAAM,GAAK,CAAC,CAAE,MAAO,CAAAJ,kBAAkB,CACjE,MAAO,CAAAmL,qBAAqB,CAACC,MAAM,CAAC,CAACC,MAAM,CAAEC,WAAW,GACtDD,MAAM,CAACtG,MAAM,CAACwG,CAAC,EAAID,WAAW,CAACzG,QAAQ,CAAC0G,CAAC,CAAC,CAC5C,CAAC,CACH,CAAC,CAED,KAAM,CAAAC,iBAAiB,CAAGN,2BAA2B,CAAC,CAAC,CAEvD,mBACA7N,KAAA,QAAK4K,KAAK,CAAE,CACVK,OAAO,CAAE,MAAM,CACfC,UAAU,CAAE,QAAQ,CACpBU,GAAG,CAAE,KAAK,CACVG,OAAO,CAAE,OAAO,CAChBQ,MAAM,CAAE,OAAO,CACf6B,UAAU,CAAE,CAAC,CACbR,UAAU,CAAE,QACd,CAAE,CAAAnD,QAAA,eACA3K,IAAA,UAAOuO,OAAO,CAAC,0BAA0B,CAACzD,KAAK,CAAE,CAC/CyB,QAAQ,CAAE,MAAM,CAChBF,UAAU,CAAE,KAAK,CACjByB,UAAU,CAAE,QAAQ,CACpB1B,KAAK,CAAE,qBAAqB,CAC5BK,MAAM,CAAE,CACV,CAAE,CAAA9B,QAAA,CAAC,sBAEH,CAAO,CAAC,cACRzK,KAAA,WACE2H,EAAE,CAAC,0BAA0B,CAC7BO,KAAK,CAAErG,eAAgB,CACvBoL,QAAQ,CAAG1I,CAAC,EAAKiE,2BAA2B,CAACjE,CAAC,CAAC2I,MAAM,CAAChF,KAAK,CAAE,CAC7D0C,KAAK,CAAE,CACLyB,QAAQ,CAAE,MAAM,CAChBN,OAAO,CAAE,UAAU,CACnBE,MAAM,CAAE,+BAA+B,CACvCmB,YAAY,CAAE,kBAAkB,CAChCpB,UAAU,CAAE,gBAAgB,CAC5BE,KAAK,CAAE,qBAAqB,CAC5BO,QAAQ,CAAE,OAAO,CACjBL,MAAM,CAAE,SACV,CAAE,CAAA3B,QAAA,eAEF3K,IAAA,WAAQoI,KAAK,CAAC,EAAE,CAAAuC,QAAA,CAAC,YAAU,CAAQ,CAAC,CACnC0D,iBAAiB,CAACpG,GAAG,CAAEuG,MAAM,eAC5BxO,IAAA,WAAqBoI,KAAK,CAAEoG,MAAO,CAAA7D,QAAA,CAAE6D,MAAM,EAA9BA,MAAuC,CACrD,CAAC,EACI,CAAC,CACRH,iBAAiB,CAACpL,MAAM,CAAGJ,kBAAkB,CAACI,MAAM,eACnD/C,KAAA,QAAK4K,KAAK,CAAE,CAAEyB,QAAQ,CAAE,MAAM,CAAEH,KAAK,CAAE,SAAS,CAAErB,UAAU,CAAE,KAAK,CAAEI,OAAO,CAAE,MAAM,CAAEC,UAAU,CAAE,QAAQ,CAAEU,GAAG,CAAE,KAAM,CAAE,CAAAnB,QAAA,eACvH3K,IAAA,CAACX,WAAW,EAACiM,IAAI,CAAE,EAAG,CAAE,CAAC,8DAE3B,EAAK,CACN,EACE,CAAC,CAER,CAAC,EAAE,CAAC,cACJpL,KAAA,WACEwK,SAAS,CAAC,aAAa,CACvBa,OAAO,CAAEpB,aAAc,CACvB0D,QAAQ,CAAE,CAAC7E,UAAU,CAAC,CAAC,EAAI/G,UAAW,CACtC6I,KAAK,CAAE,CAAEK,OAAO,CAAE,MAAM,CAAEC,UAAU,CAAE,QAAQ,CAAEU,GAAG,CAAE,KAAK,CAAEgC,UAAU,CAAE,QAAS,CAAE,CACnFjC,KAAK,CAAE,CAAC7C,UAAU,CAAC,CAAC,CAAG,8DAA8D,CAAG,yCAA0C,CAAA2B,QAAA,eAElI3K,IAAA,CAACd,IAAI,EAACoM,IAAI,CAAE,EAAG,CAAE,CAAC,CACjBrJ,UAAU,CAAG,eAAe,CAAGN,gBAAgB,CAACsB,MAAM,CAAG,CAAC,YAAAU,MAAA,CAAchC,gBAAgB,CAACsB,MAAM,cAAc,kBAAkB,EAC1H,CAAC,EACN,CAAC,EACH,CAAC,CAELlC,2BAA2B,CAACkC,MAAM,GAAK,CAAC,cACvCjD,IAAA,QAAK0K,SAAS,CAAC,aAAa,CAAAC,QAAA,cAC1B3K,IAAA,MAAA2K,QAAA,CAAG,gEAA8D,CAAG,CAAC,CAClE,CAAC,cAENzK,KAAA,QAAKwK,SAAS,CAAC,gBAAgB,CAAC+D,GAAG,CAAEnM,iBAAkB,CAAAqI,QAAA,eACrDzK,KAAA,UAAAyK,QAAA,eACE3K,IAAA,UAAA2K,QAAA,cACEzK,KAAA,OAAAyK,QAAA,eACE3K,IAAA,OAAI8K,KAAK,CAAE,CAAEE,KAAK,CAAE,MAAO,CAAE,CAAAL,QAAA,cAC3B3K,IAAA,UACEiN,IAAI,CAAC,UAAU,CACflF,OAAO,CAAEpG,gBAAgB,CAACsB,MAAM,GAAKlC,2BAA2B,CAACkC,MAAM,EAAIlC,2BAA2B,CAACkC,MAAM,CAAG,CAAE,CAClHkK,QAAQ,CAAG1I,CAAC,EAAKqD,eAAe,CAACrD,CAAC,CAAC2I,MAAM,CAACrF,OAAO,CAAE,CACpD,CAAC,CACA,CAAC,cACL/H,IAAA,OAAA2K,QAAA,CAAI,0BAAwB,CAAI,CAAC,cACjC3K,IAAA,OAAA2K,QAAA,CAAI,SAAO,CAAI,CAAC,cAChB3K,IAAA,OAAA2K,QAAA,CAAI,QAAM,CAAI,CAAC,cACf3K,IAAA,OAAA2K,QAAA,CAAI,sBAAoB,CAAI,CAAC,cAC7B3K,IAAA,OAAA2K,QAAA,CAAI,qBAAmB,CAAI,CAAC,EAC1B,CAAC,CACA,CAAC,cACR3K,IAAA,UAAA2K,QAAA,CACG5J,2BAA2B,CAACkH,GAAG,CAAEI,OAAO,EAAK,CAC5C,KAAM,CAAAE,aAAa,CAAGF,OAAO,CAACG,kBAAkB,EAAI,IAAI,CACxD;AACA,GAAI,CAAAW,YAAY,CAChB,GAAIpH,eAAe,EAAIA,eAAe,GAAK,EAAE,EAAIJ,gBAAgB,CAAC+F,QAAQ,CAACW,OAAO,CAACR,EAAE,CAAC,CAAE,CACtFsB,YAAY,CAAGpH,eAAe,GAAK,UAAU,CAAG,IAAI,CAAGA,eAAe,CACxE,CAAC,IAAM,CACLoH,YAAY,CAAGtH,kBAAkB,CAACwG,OAAO,CAACR,EAAE,CAAC,GAAK3E,SAAS,CACvDrB,kBAAkB,CAACwG,OAAO,CAACR,EAAE,CAAC,CAC9BU,aAAa,CACnB,CACA,KAAM,CAAAmG,SAAS,CAAGnG,aAAa,GAAKY,YAAY,CAEhD,mBACEjJ,KAAA,OAAqB4K,KAAK,CAAE,CAAEoB,UAAU,CAAEvK,gBAAgB,CAAC+F,QAAQ,CAACW,OAAO,CAACR,EAAE,CAAC,EAAI6G,SAAS,CAAG,qBAAqB,CAAG,aAAc,CAAE,CAAA/D,QAAA,eACrI3K,IAAA,OAAA2K,QAAA,cACE3K,IAAA,UACEiN,IAAI,CAAC,UAAU,CACflF,OAAO,CAAEpG,gBAAgB,CAAC+F,QAAQ,CAACW,OAAO,CAACR,EAAE,CAAE,CAC/CsF,QAAQ,CAAEA,CAAA,GAAM3F,eAAe,CAACa,OAAO,CAACR,EAAE,CAAE,CAC7C,CAAC,CACA,CAAC,cACL7H,IAAA,OAAA2K,QAAA,CAAKtC,OAAO,CAACS,sBAAsB,EAAI,KAAK,CAAK,CAAC,cAClD9I,IAAA,OAAA2K,QAAA,CAAKtC,OAAO,CAACA,OAAO,EAAI,KAAK,CAAK,CAAC,cACnCrI,IAAA,OAAA2K,QAAA,CAAKtC,OAAO,CAACiB,MAAM,EAAI,KAAK,CAAK,CAAC,cAClCtJ,IAAA,OAAA2K,QAAA,CAAKpC,aAAa,EAAI,UAAU,CAAK,CAAC,cACtCrI,KAAA,OAAAyK,QAAA,eACE3K,IAAA,WACEoI,KAAK,CAAEe,YAAY,EAAI,UAAW,CAClCgE,QAAQ,CAAG1I,CAAC,EAAK0D,uBAAuB,CAACE,OAAO,CAACR,EAAE,CAAEpD,CAAC,CAAC2I,MAAM,CAAChF,KAAK,CAAE,CACrE0C,KAAK,CAAE,CACLyB,QAAQ,CAAE,MAAM,CAChBN,OAAO,CAAE,SAAS,CAClBE,MAAM,CAAE,+BAA+B,CACvCmB,YAAY,CAAE,kBAAkB,CAChCpB,UAAU,CAAE,gBAAgB,CAC5BE,KAAK,CAAE,qBAAqB,CAC5BpB,KAAK,CAAE,MAAM,CACb2B,QAAQ,CAAE,OACZ,CAAE,CACFd,KAAK,CAAE/L,wBAAwB,CAACyI,aAAa,CAAE,CAAAoC,QAAA,CAE9C/K,qBAAqB,CAAC2I,aAAa,CAAC,CAACN,GAAG,CAAEuG,MAAM,eAC/CxO,IAAA,WAAqBoI,KAAK,CAAEoG,MAAO,CAAA7D,QAAA,CAChC6D,MAAM,EADIA,MAEL,CACT,CAAC,CACI,CAAC,CACR,CAAC3O,iBAAiB,CAAC0I,aAAa,CAAEY,YAAY,EAAI,UAAU,CAAC,eAC5DjJ,KAAA,QAAK4K,KAAK,CAAE,CAAEyB,QAAQ,CAAE,MAAM,CAAEH,KAAK,CAAE,SAAS,CAAEuC,SAAS,CAAE,KAAK,CAAExD,OAAO,CAAE,MAAM,CAAEC,UAAU,CAAE,QAAQ,CAAEU,GAAG,CAAE,KAAM,CAAE,CAAAnB,QAAA,eACtH3K,IAAA,CAACX,WAAW,EAACiM,IAAI,CAAE,EAAG,CAAE,CAAC,qBAE3B,EAAK,CACN,EACC,CAAC,GAxCEjD,OAAO,CAACR,EAyCb,CAAC,CAET,CAAC,CAAC,CACG,CAAC,EACH,CAAC,CAEPtG,eAAe,eACdrB,KAAA,CAAAE,SAAA,EAAAuK,QAAA,EACG,CAAClJ,WAAW,eACXzB,IAAA,QACEyO,GAAG,CAAEpM,iBAAkB,CACvByI,KAAK,CAAE,CACLI,MAAM,CAAE,MAAM,CACdF,KAAK,CAAE,MAAM,CACb2D,SAAS,CAAE,MAAM,CACjBxD,OAAO,CAAE,MAAM,CACfE,cAAc,CAAE,QAAQ,CACxBD,UAAU,CAAE,QACd,CAAE,CAAAT,QAAA,cAEF3K,IAAA,QAAK8K,KAAK,CAAE,CACVyB,QAAQ,CAAE,MAAM,CAChBH,KAAK,CAAE,uBAAuB,CAC9BH,OAAO,CAAE,MACX,CAAE,CAAAtB,QAAA,CAAC,oBAEH,CAAK,CAAC,CACH,CACN,CACAlJ,WAAW,eACVvB,KAAA,QAAK4K,KAAK,CAAE,CACVK,OAAO,CAAE,MAAM,CACfE,cAAc,CAAE,QAAQ,CACxBD,UAAU,CAAE,QAAQ,CACpBa,OAAO,CAAE,MAAM,CACfH,GAAG,CAAE,MACP,CAAE,CAAAnB,QAAA,eACA3K,IAAA,CAACb,MAAM,EAACuL,SAAS,CAAC,SAAS,CAACY,IAAI,CAAE,EAAG,CAACR,KAAK,CAAE,CAAEsB,KAAK,CAAE,SAAU,CAAE,CAAE,CAAC,cACrEpM,IAAA,SAAM8K,KAAK,CAAE,CAAEsB,KAAK,CAAE,qBAAqB,CAAEG,QAAQ,CAAE,MAAO,CAAE,CAAA5B,QAAA,CAAC,sCAAoC,CAAM,CAAC,EACzG,CACN,EACD,CACH,EACE,CACN,EACE,CACJ,EACE,CAAC,CACH,CAAC,EACH,CAAC,CAEV,CAAC,CAED,cAAe,CAAAtK,qBAAqB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}