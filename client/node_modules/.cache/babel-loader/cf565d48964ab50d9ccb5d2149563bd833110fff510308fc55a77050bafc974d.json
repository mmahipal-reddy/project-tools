{"ast":null,"code":"import React,{useState,useEffect,useImperativeHandle,forwardRef}from'react';import ObjectPanel from'./ObjectPanel/ObjectPanel';import QueryCanvas from'./QueryCanvas/QueryCanvas';import PreviewPanel from'./PreviewPanel/PreviewPanel';import{useQueryBuilder}from'./hooks/useQueryBuilder';import{usePreview}from'./hooks/usePreview';import'../../../styles/AdvancedBuilderCanvas.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const AdvancedBuilderCanvas=/*#__PURE__*/forwardRef((props,ref)=>{const{reportConfig,updateConfig,addField,removeField,addRelationship,removeRelationship,addSubquery,removeSubquery,addFilter,removeFilter,updateSort,updateGroupBy}=useQueryBuilder();const{previewData,loading,error,generatePreview}=usePreview();const[previewExpanded,setPreviewExpanded]=useState(true);// Expose reportConfig via ref\nuseImperativeHandle(ref,()=>({getReportConfig:()=>reportConfig}));// Auto-preview when config changes (debounced)\nuseEffect(()=>{if(reportConfig.objectType&&reportConfig.fields.length>0){const timer=setTimeout(()=>{generatePreview(reportConfig);},500);return()=>clearTimeout(timer);}},[reportConfig,generatePreview]);return/*#__PURE__*/_jsxs(\"div\",{className:\"advanced-builder-canvas\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"canvas-layout\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"canvas-left-panel\",children:/*#__PURE__*/_jsx(ObjectPanel,{selectedObject:reportConfig.objectType,onObjectSelect:objectType=>updateConfig({objectType}),onFieldDrag:field=>addField(field),onRelationshipDrag:relationship=>addRelationship(relationship),onSubqueryDrag:subquery=>addSubquery(subquery)})}),/*#__PURE__*/_jsx(\"div\",{className:\"canvas-center-panel\",children:/*#__PURE__*/_jsx(QueryCanvas,{reportConfig:reportConfig,onFieldAdd:addField,onFieldRemove:removeField,onRelationshipAdd:addRelationship,onRelationshipRemove:removeRelationship,onSubqueryAdd:addSubquery,onSubqueryRemove:removeSubquery,onFilterAdd:addFilter,onFilterRemove:removeFilter,onSortUpdate:updateSort,onGroupByUpdate:updateGroupBy,onConfigUpdate:updateConfig})})]}),/*#__PURE__*/_jsx(PreviewPanel,{data:previewData,loading:loading,error:error,expanded:previewExpanded,onToggle:()=>setPreviewExpanded(!previewExpanded),reportName:reportConfig.name})]});});AdvancedBuilderCanvas.displayName='AdvancedBuilderCanvas';export default AdvancedBuilderCanvas;","map":{"version":3,"names":["React","useState","useEffect","useImperativeHandle","forwardRef","ObjectPanel","QueryCanvas","PreviewPanel","useQueryBuilder","usePreview","jsx","_jsx","jsxs","_jsxs","AdvancedBuilderCanvas","props","ref","reportConfig","updateConfig","addField","removeField","addRelationship","removeRelationship","addSubquery","removeSubquery","addFilter","removeFilter","updateSort","updateGroupBy","previewData","loading","error","generatePreview","previewExpanded","setPreviewExpanded","getReportConfig","objectType","fields","length","timer","setTimeout","clearTimeout","className","children","selectedObject","onObjectSelect","onFieldDrag","field","onRelationshipDrag","relationship","onSubqueryDrag","subquery","onFieldAdd","onFieldRemove","onRelationshipAdd","onRelationshipRemove","onSubqueryAdd","onSubqueryRemove","onFilterAdd","onFilterRemove","onSortUpdate","onGroupByUpdate","onConfigUpdate","data","expanded","onToggle","reportName","name","displayName"],"sources":["/Users/mmoola/Cursor/ProjectSetup/client/src/components/AdvancedReportBuilder/AdvancedBuilderCanvas.js"],"sourcesContent":["import React, { useState, useEffect, useImperativeHandle, forwardRef } from 'react';\nimport ObjectPanel from './ObjectPanel/ObjectPanel';\nimport QueryCanvas from './QueryCanvas/QueryCanvas';\nimport PreviewPanel from './PreviewPanel/PreviewPanel';\nimport { useQueryBuilder } from './hooks/useQueryBuilder';\nimport { usePreview } from './hooks/usePreview';\nimport '../../../styles/AdvancedBuilderCanvas.css';\n\nconst AdvancedBuilderCanvas = forwardRef((props, ref) => {\n  const {\n    reportConfig,\n    updateConfig,\n    addField,\n    removeField,\n    addRelationship,\n    removeRelationship,\n    addSubquery,\n    removeSubquery,\n    addFilter,\n    removeFilter,\n    updateSort,\n    updateGroupBy\n  } = useQueryBuilder();\n\n  const {\n    previewData,\n    loading,\n    error,\n    generatePreview\n  } = usePreview();\n\n  const [previewExpanded, setPreviewExpanded] = useState(true);\n\n  // Expose reportConfig via ref\n  useImperativeHandle(ref, () => ({\n    getReportConfig: () => reportConfig\n  }));\n\n  // Auto-preview when config changes (debounced)\n  useEffect(() => {\n    if (reportConfig.objectType && reportConfig.fields.length > 0) {\n      const timer = setTimeout(() => {\n        generatePreview(reportConfig);\n      }, 500);\n      return () => clearTimeout(timer);\n    }\n  }, [reportConfig, generatePreview]);\n\n  return (\n    <div className=\"advanced-builder-canvas\">\n      <div className=\"canvas-layout\">\n        {/* Left Panel - Object Browser */}\n        <div className=\"canvas-left-panel\">\n          <ObjectPanel\n            selectedObject={reportConfig.objectType}\n            onObjectSelect={(objectType) => updateConfig({ objectType })}\n            onFieldDrag={(field) => addField(field)}\n            onRelationshipDrag={(relationship) => addRelationship(relationship)}\n            onSubqueryDrag={(subquery) => addSubquery(subquery)}\n          />\n        </div>\n\n        {/* Center Panel - Visual Query Builder */}\n        <div className=\"canvas-center-panel\">\n          <QueryCanvas\n            reportConfig={reportConfig}\n            onFieldAdd={addField}\n            onFieldRemove={removeField}\n            onRelationshipAdd={addRelationship}\n            onRelationshipRemove={removeRelationship}\n            onSubqueryAdd={addSubquery}\n            onSubqueryRemove={removeSubquery}\n            onFilterAdd={addFilter}\n            onFilterRemove={removeFilter}\n            onSortUpdate={updateSort}\n            onGroupByUpdate={updateGroupBy}\n            onConfigUpdate={updateConfig}\n          />\n        </div>\n      </div>\n\n      {/* Bottom Panel - Preview */}\n      <PreviewPanel\n        data={previewData}\n        loading={loading}\n        error={error}\n        expanded={previewExpanded}\n        onToggle={() => setPreviewExpanded(!previewExpanded)}\n        reportName={reportConfig.name}\n      />\n    </div>\n  );\n});\n\nAdvancedBuilderCanvas.displayName = 'AdvancedBuilderCanvas';\n\nexport default AdvancedBuilderCanvas;\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}