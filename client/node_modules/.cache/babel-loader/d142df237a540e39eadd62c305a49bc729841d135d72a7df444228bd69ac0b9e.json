{"ast":null,"code":"import _objectSpread from\"/Users/mmoola/Cursor/ProjectSetup/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect,useRef,useCallback}from'react';import{useAuth}from'../context/AuthContext';import Sidebar from'../components/Sidebar';import{Menu,LogOut,Search,X,Info,Plus,ChevronDown,ChevronUp,Trash2,Loader,Save,Copy,FolderOpen}from'lucide-react';import apiClient from'../config/api';import toast from'react-hot-toast';import'../styles/CreateWorkStream.css';import'../styles/Sidebar.css';import'../styles/GlobalHeader.css';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const CreateWorkStream=_ref=>{let{hideHeader=false}=_ref;const{user,logout}=useAuth();const[sidebarOpen,setSidebarOpen]=useState(true);const[submitting,setSubmitting]=useState(false);const[showForm,setShowForm]=useState(false);// New state to control form visibility\n// Project Objectives without workstreams\nconst[projectObjectives,setProjectObjectives]=useState([]);const[allProjectObjectives,setAllProjectObjectives]=useState([]);// Store all fetched data for filtering\nconst[loadingPOs,setLoadingPOs]=useState(true);const[poOffset,setPoOffset]=useState(0);const[poHasMore,setPoHasMore]=useState(true);const[loadingMorePOs,setLoadingMorePOs]=useState(false);const infiniteScrollRef=useRef(null);const[statusFilter,setStatusFilter]=useState('');// Filter by status\n// Workstreams array - each workstream has its own form data\nconst[workstreams,setWorkstreams]=useState([{id:Date.now(),projectWorkstreamName:'',projectObjective:'',projectObjectiveId:'',refresh:false,deliveryToolName:'',clientWorkstreamIdentifier:'',functionality:''}]);// Track expanded/collapsed state for each workstream\nconst[expandedWorkstreams,setExpandedWorkstreams]=useState({[Date.now()]:true});// Templates state\nconst[savedTemplates,setSavedTemplates]=useState([]);const[showTemplateModal,setShowTemplateModal]=useState(false);const[templateName,setTemplateName]=useState('');const[showLoadTemplateModal,setShowLoadTemplateModal]=useState(false);// Project Objective search - per workstream\nconst[projectObjectiveSearchTerms,setProjectObjectiveSearchTerms]=useState({});const[projectObjectiveSearchResults,setProjectObjectiveSearchResults]=useState({});const[loadingProjectObjectiveSearch,setLoadingProjectObjectiveSearch]=useState({});const[showProjectObjectiveDropdowns,setShowProjectObjectiveDropdowns]=useState({});const projectObjectiveSearchTimeoutRefs=useRef({});const recentSelectionsRef=useRef({});// Track recent selections to prevent search loop\n// Fetch project objectives without workstreams\nconst fetchProjectObjectives=useCallback(async function(){let offset=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;let append=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;try{if(offset===0){setLoadingPOs(true);}else{setLoadingMorePOs(true);}const response=await apiClient.get('/workstream/project-objectives-without-workstreams',{params:{limit:1000,offset},timeout:120000// 2 minutes to match backend timeout\n});if(response.data.success){const newPOs=response.data.projectObjectives;if(append){setAllProjectObjectives(prev=>[...prev,...newPOs]);}else{setAllProjectObjectives(newPOs);setPoOffset(0);// Reset offset when starting fresh\n}// Update offset and hasMore\nconst newOffset=append?poOffset+newPOs.length:newPOs.length;setPoOffset(newOffset);// If we got exactly 1000 records, assume there might be more\n// Also check the hasMore flag from backend\nconst hasMoreRecords=response.data.hasMore||newPOs.length===1000;setPoHasMore(hasMoreRecords);}}catch(error){var _error$response,_error$response$data;toast.error(((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.error)||'Failed to fetch project objectives');}finally{setLoadingPOs(false);setLoadingMorePOs(false);}},[]);// Load saved templates from localStorage\nuseEffect(()=>{try{const saved=localStorage.getItem('workstreamTemplates');if(saved){setSavedTemplates(JSON.parse(saved));}}catch(error){console.error('Error loading templates:',error);}},[]);// Initial load\nuseEffect(()=>{if(!showForm){fetchProjectObjectives(0,false);}},[showForm,fetchProjectObjectives]);// Infinite scroll for project objectives\nuseEffect(()=>{const observer=new IntersectionObserver(entries=>{if(entries[0].isIntersecting&&poHasMore&&!loadingMorePOs&&!showForm){fetchProjectObjectives(poOffset,true);}},{threshold:0.1});if(infiniteScrollRef.current){observer.observe(infiniteScrollRef.current);}return()=>{if(infiniteScrollRef.current){observer.unobserve(infiniteScrollRef.current);}};},[poHasMore,loadingMorePOs,poOffset,showForm,fetchProjectObjectives]);// Filter project objectives by status\nuseEffect(()=>{if(statusFilter===''){setProjectObjectives(allProjectObjectives);}else{setProjectObjectives(allProjectObjectives.filter(po=>po.status===statusFilter));}},[statusFilter,allProjectObjectives]);// Get unique status values for filter dropdown (exclude '--' and empty values)\nconst uniqueStatuses=Array.from(new Set(allProjectObjectives.map(po=>po.status).filter(s=>s&&s!=='--'))).sort();// Delivery Tool Name picklist (excluding QF as per original requirement)\nconst deliveryToolNameOptions=['--None--','A9','ADAP','Ampersand','Appen Collect','AppenLex','Baseline','EWOQ','Exotel','Other','Polyglot','SRT','TryRating','UHRS','Test','Test Tool'];// Functionality picklist values\nconst functionalityOptions=['--None--','System Access','System Access & Productivity','Productivity'];// Close search results when clicking outside\nuseEffect(()=>{const handleClickOutside=event=>{Object.keys(showProjectObjectiveDropdowns).forEach(workstreamId=>{if(showProjectObjectiveDropdowns[workstreamId]&&!event.target.closest(\".project-objective-search-container-\".concat(workstreamId))){setShowProjectObjectiveDropdowns(prev=>_objectSpread(_objectSpread({},prev),{},{[workstreamId]:false}));}});};document.addEventListener('mousedown',handleClickOutside);return()=>{document.removeEventListener('mousedown',handleClickOutside);};},[showProjectObjectiveDropdowns]);// Search Project Objectives when search term changes (per workstream)\nuseEffect(()=>{Object.keys(projectObjectiveSearchTerms).forEach(workstreamId=>{const searchTerm=projectObjectiveSearchTerms[workstreamId];const workstream=workstreams.find(w=>w.id===workstreamId);// Clear any existing timeout\nif(projectObjectiveSearchTimeoutRefs.current[workstreamId]){clearTimeout(projectObjectiveSearchTimeoutRefs.current[workstreamId]);delete projectObjectiveSearchTimeoutRefs.current[workstreamId];}// IMPORTANT: Don't search if an objective is already selected\n// This prevents the search loop when user selects an objective\nif(workstream&&workstream.projectObjectiveId){setProjectObjectiveSearchResults(prev=>_objectSpread(_objectSpread({},prev),{},{[workstreamId]:[]}));setShowProjectObjectiveDropdowns(prev=>_objectSpread(_objectSpread({},prev),{},{[workstreamId]:false}));setLoadingProjectObjectiveSearch(prev=>_objectSpread(_objectSpread({},prev),{},{[workstreamId]:false}));return;}// Don't search if search term is empty\nif(!searchTerm||searchTerm.trim()===''){setProjectObjectiveSearchResults(prev=>_objectSpread(_objectSpread({},prev),{},{[workstreamId]:[]}));setShowProjectObjectiveDropdowns(prev=>_objectSpread(_objectSpread({},prev),{},{[workstreamId]:false}));setLoadingProjectObjectiveSearch(prev=>_objectSpread(_objectSpread({},prev),{},{[workstreamId]:false}));return;}// Check if this is a recent selection (within last 2 seconds)\nconst recentSelection=recentSelectionsRef.current[workstreamId];if(recentSelection){const timeSinceSelection=Date.now()-recentSelection.timestamp;if(timeSinceSelection<2000){// This is a recent selection, don't search\nsetProjectObjectiveSearchResults(prev=>_objectSpread(_objectSpread({},prev),{},{[workstreamId]:[]}));setShowProjectObjectiveDropdowns(prev=>_objectSpread(_objectSpread({},prev),{},{[workstreamId]:false}));setLoadingProjectObjectiveSearch(prev=>_objectSpread(_objectSpread({},prev),{},{[workstreamId]:false}));return;}}// Only search if user is actively typing (not just matching selected value)\nprojectObjectiveSearchTimeoutRefs.current[workstreamId]=setTimeout(async()=>{// Get fresh search term and workstream\nconst currentSearchTerm=projectObjectiveSearchTerms[workstreamId];if(!currentSearchTerm||currentSearchTerm.trim()===''){return;}// CRITICAL: Re-check if objective was selected during timeout - if so, abort search\nconst currentWorkstream=workstreams.find(w=>w.id===workstreamId);if(currentWorkstream&&currentWorkstream.projectObjectiveId){// An objective was selected, don't search\nsetProjectObjectiveSearchResults(prev=>_objectSpread(_objectSpread({},prev),{},{[workstreamId]:[]}));setShowProjectObjectiveDropdowns(prev=>_objectSpread(_objectSpread({},prev),{},{[workstreamId]:false}));setLoadingProjectObjectiveSearch(prev=>_objectSpread(_objectSpread({},prev),{},{[workstreamId]:false}));return;}// Check again if this is a recent selection\nconst currentRecentSelection=recentSelectionsRef.current[workstreamId];if(currentRecentSelection){const timeSinceSelection=Date.now()-currentRecentSelection.timestamp;if(timeSinceSelection<2000){// This is a recent selection, don't search\nsetProjectObjectiveSearchResults(prev=>_objectSpread(_objectSpread({},prev),{},{[workstreamId]:[]}));setShowProjectObjectiveDropdowns(prev=>_objectSpread(_objectSpread({},prev),{},{[workstreamId]:false}));setLoadingProjectObjectiveSearch(prev=>_objectSpread(_objectSpread({},prev),{},{[workstreamId]:false}));return;}}setLoadingProjectObjectiveSearch(prev=>_objectSpread(_objectSpread({},prev),{},{[workstreamId]:true}));try{const response=await apiClient.get(\"/workstream/search-project-objectives?search=\".concat(encodeURIComponent(currentSearchTerm)));if(response.data.success){// CRITICAL: Final check before showing results - make sure objective wasn't selected during API call\nconst finalWorkstream=workstreams.find(w=>w.id===workstreamId);if(finalWorkstream&&finalWorkstream.projectObjectiveId){// An objective was selected during the API call, don't show results\nsetProjectObjectiveSearchResults(prev=>_objectSpread(_objectSpread({},prev),{},{[workstreamId]:[]}));setShowProjectObjectiveDropdowns(prev=>_objectSpread(_objectSpread({},prev),{},{[workstreamId]:false}));setLoadingProjectObjectiveSearch(prev=>_objectSpread(_objectSpread({},prev),{},{[workstreamId]:false}));return;}// Check for recent selection\nconst finalRecentSelection=recentSelectionsRef.current[workstreamId];if(finalRecentSelection){const timeSinceSelection=Date.now()-finalRecentSelection.timestamp;if(timeSinceSelection<2000){// Objective was just selected, don't show results\nsetProjectObjectiveSearchResults(prev=>_objectSpread(_objectSpread({},prev),{},{[workstreamId]:[]}));setShowProjectObjectiveDropdowns(prev=>_objectSpread(_objectSpread({},prev),{},{[workstreamId]:false}));setLoadingProjectObjectiveSearch(prev=>_objectSpread(_objectSpread({},prev),{},{[workstreamId]:false}));return;}}// All checks passed, show results\nsetProjectObjectiveSearchResults(prev=>_objectSpread(_objectSpread({},prev),{},{[workstreamId]:response.data.projectObjectives||[]}));setShowProjectObjectiveDropdowns(prev=>_objectSpread(_objectSpread({},prev),{},{[workstreamId]:true}));}}catch(error){setProjectObjectiveSearchResults(prev=>_objectSpread(_objectSpread({},prev),{},{[workstreamId]:[]}));}finally{setLoadingProjectObjectiveSearch(prev=>_objectSpread(_objectSpread({},prev),{},{[workstreamId]:false}));}},300);});return()=>{Object.keys(projectObjectiveSearchTimeoutRefs.current).forEach(workstreamId=>{if(projectObjectiveSearchTimeoutRefs.current[workstreamId]){clearTimeout(projectObjectiveSearchTimeoutRefs.current[workstreamId]);delete projectObjectiveSearchTimeoutRefs.current[workstreamId];}});};},[projectObjectiveSearchTerms,workstreams]);const handleProjectObjectiveSelect=(workstreamId,objective)=>{const selectedName=objective.contributorFacingProjectName||objective.name;// Clear any pending search timeout immediately\nif(projectObjectiveSearchTimeoutRefs.current[workstreamId]){clearTimeout(projectObjectiveSearchTimeoutRefs.current[workstreamId]);delete projectObjectiveSearchTimeoutRefs.current[workstreamId];}// Mark this as a recent selection to prevent search loop\nrecentSelectionsRef.current[workstreamId]={name:selectedName,timestamp:Date.now()};// Update workstream with selected objective\nsetWorkstreams(prev=>prev.map(ws=>ws.id===workstreamId?_objectSpread(_objectSpread({},ws),{},{projectObjective:selectedName,projectObjectiveId:objective.id}):ws));// Clear search term instead of setting it to selected name - this prevents re-triggering search\nsetProjectObjectiveSearchTerms(prev=>_objectSpread(_objectSpread({},prev),{},{[workstreamId]:''}));// Immediately close dropdown and clear results\nsetShowProjectObjectiveDropdowns(prev=>_objectSpread(_objectSpread({},prev),{},{[workstreamId]:false}));setProjectObjectiveSearchResults(prev=>_objectSpread(_objectSpread({},prev),{},{[workstreamId]:[]}));setLoadingProjectObjectiveSearch(prev=>_objectSpread(_objectSpread({},prev),{},{[workstreamId]:false}));// Clear the recent selection flag after a delay\nsetTimeout(()=>{if(recentSelectionsRef.current[workstreamId]){delete recentSelectionsRef.current[workstreamId];}},2000);};const handleClearProjectObjective=workstreamId=>{setWorkstreams(prev=>prev.map(ws=>ws.id===workstreamId?_objectSpread(_objectSpread({},ws),{},{projectObjective:'',projectObjectiveId:''}):ws));setProjectObjectiveSearchTerms(prev=>_objectSpread(_objectSpread({},prev),{},{[workstreamId]:''}));setProjectObjectiveSearchResults(prev=>_objectSpread(_objectSpread({},prev),{},{[workstreamId]:[]}));setShowProjectObjectiveDropdowns(prev=>_objectSpread(_objectSpread({},prev),{},{[workstreamId]:false}));};const handleInputChange=(workstreamId,field,value)=>{setWorkstreams(prev=>prev.map(ws=>ws.id===workstreamId?_objectSpread(_objectSpread({},ws),{},{[field]:value}):ws));};const handleSearchTermChange=(workstreamId,value)=>{setProjectObjectiveSearchTerms(prev=>_objectSpread(_objectSpread({},prev),{},{[workstreamId]:value}));if(value===''){handleClearProjectObjective(workstreamId);}};const toggleWorkstreamExpanded=workstreamId=>{setExpandedWorkstreams(prev=>_objectSpread(_objectSpread({},prev),{},{[workstreamId]:!prev[workstreamId]}));};const addWorkstream=()=>{const newId=Date.now();setWorkstreams(prev=>[...prev,{id:newId,projectWorkstreamName:'',projectObjective:'',projectObjectiveId:'',refresh:false,deliveryToolName:'',clientWorkstreamIdentifier:'',functionality:''}]);setExpandedWorkstreams(prev=>_objectSpread(_objectSpread({},prev),{},{[newId]:true}));setProjectObjectiveSearchTerms(prev=>_objectSpread(_objectSpread({},prev),{},{[newId]:''}));};const removeWorkstream=workstreamId=>{if(workstreams.length===1){toast.error('At least one workstream is required');return;}setWorkstreams(prev=>prev.filter(ws=>ws.id!==workstreamId));setExpandedWorkstreams(prev=>{const newState=_objectSpread({},prev);delete newState[workstreamId];return newState;});setProjectObjectiveSearchTerms(prev=>{const newState=_objectSpread({},prev);delete newState[workstreamId];return newState;});setProjectObjectiveSearchResults(prev=>{const newState=_objectSpread({},prev);delete newState[workstreamId];return newState;});setShowProjectObjectiveDropdowns(prev=>{const newState=_objectSpread({},prev);delete newState[workstreamId];return newState;});if(projectObjectiveSearchTimeoutRefs.current[workstreamId]){clearTimeout(projectObjectiveSearchTimeoutRefs.current[workstreamId]);delete projectObjectiveSearchTimeoutRefs.current[workstreamId];}};const validateWorkstream=workstream=>{if(!workstream.projectObjectiveId){return'Project Objective is required';}if(!workstream.deliveryToolName||workstream.deliveryToolName==='--None--'){return'Delivery Tool Name is required';}if(!workstream.clientWorkstreamIdentifier||workstream.clientWorkstreamIdentifier.trim()===''){return'Client Workstream Identifier is required';}if(!workstream.functionality||workstream.functionality==='--None--'){return'Functionality is required';}return null;};const handleSubmit=async e=>{e.preventDefault();// Validate all workstreams\nconst validationErrors=[];workstreams.forEach((workstream,index)=>{const error=validateWorkstream(workstream);if(error){validationErrors.push(\"Workstream \".concat(index+1,\": \").concat(error));}});if(validationErrors.length>0){toast.error(validationErrors[0]);return;}setSubmitting(true);try{// Create all workstreams - each under its respective project objective\nconst createPromises=workstreams.map(workstream=>apiClient.post('/workstream/create',{projectWorkstreamName:workstream.projectWorkstreamName,projectObjective:workstream.projectObjective,projectObjectiveId:workstream.projectObjectiveId,refresh:workstream.refresh,deliveryToolName:workstream.deliveryToolName,clientWorkstreamIdentifier:workstream.clientWorkstreamIdentifier,functionality:workstream.functionality}));const results=await Promise.all(createPromises);const successCount=results.filter(r=>r.data.success).length;if(successCount===workstreams.length){toast.success(\"Successfully created \".concat(successCount,\" workstream(s)\"));// Reset all workstreams and hide form\nconst newId=Date.now();setWorkstreams([{id:newId,projectWorkstreamName:'',projectObjective:'',projectObjectiveId:'',refresh:false,deliveryToolName:'',clientWorkstreamIdentifier:'',functionality:''}]);setExpandedWorkstreams({[newId]:true});setProjectObjectiveSearchTerms({[newId]:''});setProjectObjectiveSearchResults({});setShowProjectObjectiveDropdowns({});setShowForm(false);// Reload project objectives list\nfetchProjectObjectives(0,false);}else{toast.error(\"Created \".concat(successCount,\" of \").concat(workstreams.length,\" workstream(s)\"));}}catch(error){var _error$response2,_error$response2$data;const errorMessage=((_error$response2=error.response)===null||_error$response2===void 0?void 0:(_error$response2$data=_error$response2.data)===null||_error$response2$data===void 0?void 0:_error$response2$data.error)||error.message||'Failed to create workstream(s)';toast.error(errorMessage);}finally{setSubmitting(false);}};const handleCancel=()=>{// Reset all workstreams and hide form\nconst newId=Date.now();setWorkstreams([{id:newId,projectWorkstreamName:'',projectObjective:'',projectObjectiveId:'',refresh:false,deliveryToolName:'',clientWorkstreamIdentifier:'',functionality:''}]);setExpandedWorkstreams({[newId]:true});setProjectObjectiveSearchTerms({[newId]:''});setProjectObjectiveSearchResults({});setShowProjectObjectiveDropdowns({});setShowForm(false);// Reload project objectives list\nfetchProjectObjectives(0,false);};const handleAddWorkstream=()=>{setShowForm(true);};// Save current workstreams as template\nconst handleSaveTemplate=()=>{if(workstreams.length===0){toast.error('No workstreams to save as template');return;}setShowTemplateModal(true);};const confirmSaveTemplate=()=>{if(!templateName.trim()){toast.error('Please enter a template name');return;}try{const template={id:Date.now(),name:templateName.trim(),createdAt:new Date().toISOString(),workstreams:workstreams.map(ws=>({projectWorkstreamName:ws.projectWorkstreamName,projectObjective:ws.projectObjective,projectObjectiveId:ws.projectObjectiveId,refresh:ws.refresh,deliveryToolName:ws.deliveryToolName,clientWorkstreamIdentifier:ws.clientWorkstreamIdentifier,functionality:ws.functionality}))};const updatedTemplates=[...savedTemplates,template];setSavedTemplates(updatedTemplates);localStorage.setItem('workstreamTemplates',JSON.stringify(updatedTemplates));toast.success('Template saved successfully');setShowTemplateModal(false);setTemplateName('');}catch(error){console.error('Error saving template:',error);toast.error('Failed to save template');}};// Load template\nconst handleLoadTemplate=template=>{try{const newWorkstreams=template.workstreams.map((ws,index)=>_objectSpread({id:Date.now()+index},ws));setWorkstreams(newWorkstreams);setExpandedWorkstreams(newWorkstreams.reduce((acc,ws)=>{acc[ws.id]=true;return acc;},{}));setShowLoadTemplateModal(false);toast.success(\"Template \\\"\".concat(template.name,\"\\\" loaded successfully\"));}catch(error){console.error('Error loading template:',error);toast.error('Failed to load template');}};// Delete template\nconst handleDeleteTemplate=templateId=>{try{const updatedTemplates=savedTemplates.filter(t=>t.id!==templateId);setSavedTemplates(updatedTemplates);localStorage.setItem('workstreamTemplates',JSON.stringify(updatedTemplates));toast.success('Template deleted successfully');}catch(error){console.error('Error deleting template:',error);toast.error('Failed to delete template');}};// Clone workstream\nconst handleCloneWorkstream=workstreamId=>{const workstreamToClone=workstreams.find(ws=>ws.id===workstreamId);if(!workstreamToClone)return;const clonedWorkstream=_objectSpread(_objectSpread({},workstreamToClone),{},{id:Date.now(),projectWorkstreamName:\"\".concat(workstreamToClone.projectWorkstreamName,\" (Copy)\"),projectObjective:'',projectObjectiveId:''});setWorkstreams(prev=>[...prev,clonedWorkstream]);setExpandedWorkstreams(prev=>_objectSpread(_objectSpread({},prev),{},{[clonedWorkstream.id]:true}));toast.success('Workstream cloned successfully');};const renderWorkstreamForm=(workstream,index)=>{const isExpanded=expandedWorkstreams[workstream.id]!==false;const searchTerm=projectObjectiveSearchTerms[workstream.id]||'';const searchResults=projectObjectiveSearchResults[workstream.id]||[];const loadingSearch=loadingProjectObjectiveSearch[workstream.id]||false;const showDropdown=showProjectObjectiveDropdowns[workstream.id]||false;return/*#__PURE__*/_jsxs(\"div\",{className:\"workstream-form-card\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"create-workstream-header-section\",onClick:()=>toggleWorkstreamExpanded(workstream.id),children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"create-workstream-toggle\",onClick:e=>{e.stopPropagation();toggleWorkstreamExpanded(workstream.id);},children:isExpanded?/*#__PURE__*/_jsx(ChevronUp,{size:18}):/*#__PURE__*/_jsx(ChevronDown,{size:18})}),/*#__PURE__*/_jsxs(\"span\",{className:\"create-workstream-title-text\",children:[\"WorkStream \",index+1,workstream.projectObjective?\" - \".concat(workstream.projectObjective):'']}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'8px',alignItems:'center'},children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"create-workstream-remove\",onClick:e=>{e.stopPropagation();handleCloneWorkstream(workstream.id);},title:\"Clone workstream\",style:{background:'transparent',border:'none',cursor:'pointer',padding:'4px',display:'flex',alignItems:'center'},children:/*#__PURE__*/_jsx(Copy,{size:16,style:{color:'#0176d3'}})}),workstreams.length>1&&/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"create-workstream-remove\",onClick:e=>{e.stopPropagation();removeWorkstream(workstream.id);},title:\"Remove workstream\",children:/*#__PURE__*/_jsx(Trash2,{size:16})})]})]}),isExpanded&&/*#__PURE__*/_jsx(\"div\",{className:\"workstream-form-content\",children:/*#__PURE__*/_jsx(\"div\",{className:\"form-section-card\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"form-grid-two-column\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-column\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Project Workstream Name\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:workstream.projectWorkstreamName,onChange:e=>handleInputChange(workstream.id,'projectWorkstreamName',e.target.value),className:\"form-input-compact\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsxs(\"label\",{children:[\"Project Objective \",/*#__PURE__*/_jsx(\"span\",{className:\"required\",children:\"*\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"project-objective-search-container project-objective-search-container-\".concat(workstream.id),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"search-input-wrapper\",children:[/*#__PURE__*/_jsx(Search,{size:14,className:\"search-icon\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Search for project objective...\",value:workstream.projectObjectiveId?workstream.projectObjective:searchTerm,readOnly:!!workstream.projectObjectiveId,onChange:e=>{// Only allow changes if no objective is selected\nif(!workstream.projectObjectiveId){handleSearchTermChange(workstream.id,e.target.value);}},onFocus:()=>{// If there's a selection, allow clearing it\nif(workstream.projectObjectiveId){// User can click X button to clear\n}else if(searchResults.length>0){setShowProjectObjectiveDropdowns(prev=>_objectSpread(_objectSpread({},prev),{},{[workstream.id]:true}));}},onClick:()=>{// If there's a selection and user clicks, don't clear automatically\n// They need to use the X button\nif(!workstream.projectObjectiveId&&searchResults.length>0){setShowProjectObjectiveDropdowns(prev=>_objectSpread(_objectSpread({},prev),{},{[workstream.id]:true}));}},className:\"form-input-compact search-input\",style:workstream.projectObjectiveId?{cursor:'default'}:{}}),workstream.projectObjectiveId&&/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>handleClearProjectObjective(workstream.id),className:\"clear-button\",title:\"Clear selection\",children:/*#__PURE__*/_jsx(X,{size:14})})]}),loadingSearch&&/*#__PURE__*/_jsx(\"div\",{className:\"searching-indicator\",children:\"Searching...\"}),showDropdown&&searchResults.length>0&&!workstream.projectObjectiveId&&/*#__PURE__*/_jsx(\"div\",{className:\"search-results-dropdown\",children:searchResults.map(objective=>/*#__PURE__*/_jsxs(\"div\",{onClick:()=>handleProjectObjectiveSelect(workstream.id,objective),className:\"search-result-item \".concat(workstream.projectObjectiveId===objective.id?'selected':''),children:[/*#__PURE__*/_jsx(\"div\",{className:\"search-result-name\",children:objective.contributorFacingProjectName||objective.name}),objective.projectName&&/*#__PURE__*/_jsxs(\"div\",{className:\"search-result-subtitle\",children:[\"Project: \",objective.projectName]})]},objective.id))})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"form-group\",style:{marginTop:'6px'},children:/*#__PURE__*/_jsxs(\"label\",{className:\"checkbox-label\",style:{marginBottom:0},children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:workstream.refresh,onChange:e=>handleInputChange(workstream.id,'refresh',e.target.checked),className:\"checkbox-input\",style:{marginRight:'8px',marginTop:'0',verticalAlign:'middle'}}),/*#__PURE__*/_jsx(\"span\",{className:\"checkbox-text\",style:{verticalAlign:'middle'},children:\"Refresh\"}),/*#__PURE__*/_jsx(Info,{size:12,className:\"info-icon\",style:{marginLeft:'6px',verticalAlign:'middle'}})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-column\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsxs(\"label\",{children:[\"Delivery Tool Name \",/*#__PURE__*/_jsx(\"span\",{className:\"required\",children:\"*\"})]}),/*#__PURE__*/_jsxs(\"select\",{value:workstream.deliveryToolName,onChange:e=>handleInputChange(workstream.id,'deliveryToolName',e.target.value),className:\"form-input-compact\",required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"--None--\"}),deliveryToolNameOptions.filter(opt=>opt!=='--None--').map(option=>/*#__PURE__*/_jsx(\"option\",{value:option,children:option},option))]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsxs(\"label\",{children:[\"Client Workstream Identifier \",/*#__PURE__*/_jsx(\"span\",{className:\"required\",children:\"*\"}),/*#__PURE__*/_jsx(Info,{size:12,className:\"info-icon\"})]}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:workstream.clientWorkstreamIdentifier,onChange:e=>handleInputChange(workstream.id,'clientWorkstreamIdentifier',e.target.value),className:\"form-input-compact\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsxs(\"label\",{children:[\"Functionality \",/*#__PURE__*/_jsx(\"span\",{className:\"required\",children:\"*\"}),/*#__PURE__*/_jsx(Info,{size:12,className:\"info-icon\"})]}),/*#__PURE__*/_jsxs(\"select\",{value:workstream.functionality,onChange:e=>handleInputChange(workstream.id,'functionality',e.target.value),className:\"form-input-compact\",required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"--None--\"}),functionalityOptions.filter(opt=>opt!=='--None--').map(option=>/*#__PURE__*/_jsx(\"option\",{value:option,children:option},option))]})]})]})]})})})]},workstream.id);};const content=/*#__PURE__*/_jsxs(\"div\",{className:\"create-workstream-content\",children:[!showForm?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:'20px'},children:[/*#__PURE__*/_jsx(\"h2\",{style:{margin:0,fontSize:'18px',fontWeight:600,color:'#002329'},children:\"Project Objectives Without Workstreams\"}),/*#__PURE__*/_jsxs(\"button\",{type:\"button\",className:\"btn-primary\",onClick:handleAddWorkstream,style:{display:'flex',alignItems:'center',gap:'8px'},children:[/*#__PURE__*/_jsx(Plus,{size:16}),\"Add Workstream\"]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'12px',alignItems:'center',marginBottom:'16px'},children:[/*#__PURE__*/_jsx(\"label\",{style:{fontSize:'14px',fontWeight:500,color:'#002329'},children:\"Filter by Status:\"}),/*#__PURE__*/_jsxs(\"select\",{value:statusFilter,onChange:e=>setStatusFilter(e.target.value),style:{fontSize:'14px',padding:'8px 12px',border:'1px solid var(--border-color)',borderRadius:'var(--radius-md)',background:'var(--surface)',color:'var(--text-primary)',minWidth:'180px',cursor:'pointer',fontFamily:'Poppins'},children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"All Status\"}),uniqueStatuses.map(status=>/*#__PURE__*/_jsx(\"option\",{value:status,children:status},status))]}),statusFilter&&/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>setStatusFilter(''),style:{fontSize:'13px',padding:'6px 12px',background:'transparent',border:'1px solid var(--border-color)',borderRadius:'var(--radius-md)',color:'var(--text-secondary)',cursor:'pointer',fontFamily:'Poppins'},children:\"Clear Filter\"})]}),loadingPOs&&allProjectObjectives.length===0?/*#__PURE__*/_jsxs(\"div\",{style:{textAlign:'center',padding:'40px'},children:[/*#__PURE__*/_jsx(Loader,{className:\"spinning\",size:24}),/*#__PURE__*/_jsx(\"p\",{children:\"Loading project objectives...\"})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"project-objectives-table-container\",style:{maxHeight:'70vh',overflowY:'auto'},children:[/*#__PURE__*/_jsxs(\"table\",{className:\"project-objectives-table\",style:{width:'100%'},children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Project Objective\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Associated Project\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Project Objective Status\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:projectObjectives.length===0?/*#__PURE__*/_jsx(\"tr\",{children:/*#__PURE__*/_jsx(\"td\",{colSpan:\"3\",className:\"no-data\",style:{textAlign:'center',padding:'40px'},children:\"No project objectives without workstreams found\"})}):projectObjectives.map((po,index)=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:po.name||'--'}),/*#__PURE__*/_jsx(\"td\",{children:po.projectName||'--'}),/*#__PURE__*/_jsx(\"td\",{children:po.status||'--'})]},po.id||index))})]}),(poHasMore||allProjectObjectives.length>=1000)&&!loadingMorePOs&&allProjectObjectives.length>0&&!loadingPOs&&/*#__PURE__*/_jsxs(\"div\",{style:{textAlign:'center',padding:'20px',borderTop:'1px solid var(--border-color)'},children:[/*#__PURE__*/_jsxs(\"button\",{type:\"button\",className:\"btn-secondary\",onClick:()=>fetchProjectObjectives(poOffset,true),style:{display:'inline-flex',alignItems:'center',gap:'8px',padding:'10px 24px',fontSize:'14px',fontWeight:600},children:[/*#__PURE__*/_jsx(Plus,{size:16}),\"Show More (\",allProjectObjectives.length,\" loaded\",poHasMore?', more available':'',\")\"]}),/*#__PURE__*/_jsx(\"div\",{style:{marginTop:'8px',fontSize:'12px',color:'#666'},children:\"Click to load next 1000 project objectives\"})]}),loadingMorePOs&&/*#__PURE__*/_jsxs(\"div\",{style:{textAlign:'center',padding:'20px',borderTop:'1px solid var(--border-color)'},children:[/*#__PURE__*/_jsx(Loader,{className:\"spinning\",size:16}),/*#__PURE__*/_jsx(\"span\",{style:{marginLeft:'8px'},children:\"Loading more project objectives...\"})]}),poHasMore&&!loadingMorePOs&&/*#__PURE__*/_jsx(\"div\",{ref:infiniteScrollRef,style:{height:'20px',width:'100%'}}),allProjectObjectives.length>0&&!poHasMore&&/*#__PURE__*/_jsx(\"div\",{style:{textAlign:'center',padding:'16px',borderTop:'1px solid var(--border-color)',color:'#666',fontSize:'13px'},children:statusFilter?/*#__PURE__*/_jsxs(_Fragment,{children:[\"Showing \",projectObjectives.length,\" of \",allProjectObjectives.length,\" project objectives (filtered by status: \",statusFilter,\")\"]}):/*#__PURE__*/_jsxs(_Fragment,{children:[\"All \",allProjectObjectives.length,\" project objectives loaded\"]})})]})]}):/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"create-workstream-form\",children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:'16px'},children:[/*#__PURE__*/_jsx(\"h2\",{style:{margin:0,fontSize:'18px',fontWeight:600,color:'#002329'},children:\"Create Workstream\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn-secondary\",onClick:()=>setShowForm(false),children:\"Back to List\"})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'16px',display:'flex',gap:'12px',alignItems:'center',flexWrap:'wrap'},children:[/*#__PURE__*/_jsxs(\"button\",{type:\"button\",className:\"btn-primary\",onClick:addWorkstream,style:{display:'flex',alignItems:'center',gap:'8px'},children:[/*#__PURE__*/_jsx(Plus,{size:16}),\"Add WorkStream\"]}),/*#__PURE__*/_jsxs(\"button\",{type:\"button\",className:\"btn-secondary\",onClick:handleSaveTemplate,disabled:workstreams.length===0,style:{display:'flex',alignItems:'center',gap:'8px'},title:\"Save current workstreams as template\",children:[/*#__PURE__*/_jsx(Save,{size:16}),\"Save Template\"]}),/*#__PURE__*/_jsxs(\"button\",{type:\"button\",className:\"btn-secondary\",onClick:()=>setShowLoadTemplateModal(true),disabled:savedTemplates.length===0,style:{display:'flex',alignItems:'center',gap:'8px'},title:\"Load a saved template\",children:[/*#__PURE__*/_jsx(FolderOpen,{size:16}),\"Load Template\"]})]}),workstreams.map((workstream,index)=>renderWorkstreamForm(workstream,index)),/*#__PURE__*/_jsxs(\"div\",{className:\"form-actions\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn-secondary\",onClick:handleCancel,children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn-primary\",disabled:submitting,children:submitting?'Creating...':\"Create \".concat(workstreams.length,\" WorkStream\").concat(workstreams.length>1?'s':'')})]})]}),showTemplateModal&&/*#__PURE__*/_jsx(\"div\",{style:{position:'fixed',top:0,left:0,right:0,bottom:0,background:'rgba(0, 0, 0, 0.5)',display:'flex',alignItems:'center',justifyContent:'center',zIndex:1000},children:/*#__PURE__*/_jsxs(\"div\",{style:{background:'white',padding:'24px',borderRadius:'8px',minWidth:'400px',maxWidth:'500px'},children:[/*#__PURE__*/_jsx(\"h3\",{style:{margin:'0 0 16px 0',fontSize:'18px',fontWeight:600},children:\"Save Template\"}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'16px'},children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:'8px',fontSize:'14px',fontWeight:500},children:\"Template Name:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:templateName,onChange:e=>setTemplateName(e.target.value),placeholder:\"Enter template name\",style:{width:'100%',padding:'8px 12px',border:'1px solid var(--border-color)',borderRadius:'4px',fontSize:'14px'},autoFocus:true,onKeyPress:e=>{if(e.key==='Enter'){confirmSaveTemplate();}}})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'12px',justifyContent:'flex-end'},children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn-secondary\",onClick:()=>{setShowTemplateModal(false);setTemplateName('');},children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn-primary\",onClick:confirmSaveTemplate,disabled:!templateName.trim(),children:\"Save\"})]})]})}),showLoadTemplateModal&&/*#__PURE__*/_jsx(\"div\",{style:{position:'fixed',top:0,left:0,right:0,bottom:0,background:'rgba(0, 0, 0, 0.5)',display:'flex',alignItems:'center',justifyContent:'center',zIndex:1000},children:/*#__PURE__*/_jsxs(\"div\",{style:{background:'white',padding:'24px',borderRadius:'8px',minWidth:'500px',maxWidth:'600px',maxHeight:'80vh',overflow:'auto'},children:[/*#__PURE__*/_jsx(\"h3\",{style:{margin:'0 0 16px 0',fontSize:'18px',fontWeight:600},children:\"Load Template\"}),savedTemplates.length===0?/*#__PURE__*/_jsx(\"p\",{style:{color:'#666',fontSize:'14px'},children:\"No saved templates found.\"}):/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',flexDirection:'column',gap:'12px'},children:savedTemplates.map(template=>/*#__PURE__*/_jsxs(\"div\",{style:{padding:'12px',border:'1px solid var(--border-color)',borderRadius:'4px',display:'flex',justifyContent:'space-between',alignItems:'center'},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:500,fontSize:'14px',marginBottom:'4px'},children:template.name}),/*#__PURE__*/_jsxs(\"div\",{style:{fontSize:'12px',color:'#666'},children:[template.workstreams.length,\" workstream(s) \\u2022 Created \",new Date(template.createdAt).toLocaleDateString()]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'8px'},children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn-primary\",onClick:()=>handleLoadTemplate(template),style:{fontSize:'12px',padding:'6px 12px'},children:\"Load\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn-secondary\",onClick:()=>handleDeleteTemplate(template.id),style:{fontSize:'12px',padding:'6px 12px',color:'#d32f2f'},title:\"Delete template\",children:/*#__PURE__*/_jsx(Trash2,{size:14})})]})]},template.id))}),/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',justifyContent:'flex-end',marginTop:'16px'},children:/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn-secondary\",onClick:()=>setShowLoadTemplateModal(false),children:\"Close\"})})]})})]});if(hideHeader){return/*#__PURE__*/_jsx(\"div\",{className:\"create-workstream-content-wrapper\",children:content});}return/*#__PURE__*/_jsxs(\"div\",{className:\"dashboard-layout\",children:[/*#__PURE__*/_jsx(Sidebar,{isOpen:sidebarOpen,toggleSidebar:()=>setSidebarOpen(!sidebarOpen)}),/*#__PURE__*/_jsx(\"div\",{className:\"create-workstream\",style:{marginLeft:sidebarOpen?'320px':'80px'},children:/*#__PURE__*/_jsxs(\"div\",{className:\"create-workstream-container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"create-workstream-header\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"header-content\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"header-left\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"header-menu-toggle\",onClick:()=>setSidebarOpen(!sidebarOpen),\"aria-label\":\"Toggle sidebar\",children:/*#__PURE__*/_jsx(Menu,{size:20})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"page-title\",children:\"New Project Workstream\"}),/*#__PURE__*/_jsx(\"p\",{className:\"page-subtitle\",children:\"Create a new project workstream\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"header-user-profile\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"user-profile\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"user-avatar\",children:((user===null||user===void 0?void 0:user.email)||'U').charAt(0).toUpperCase()}),/*#__PURE__*/_jsx(\"span\",{className:\"user-name\",children:(user===null||user===void 0?void 0:user.email)||'User'}),/*#__PURE__*/_jsx(\"button\",{className:\"logout-btn\",onClick:logout,title:\"Logout\",children:/*#__PURE__*/_jsx(LogOut,{size:18})})]})})]})}),content]})})]});};export default CreateWorkStream;","map":{"version":3,"names":["React","useState","useEffect","useRef","useCallback","useAuth","Sidebar","Menu","LogOut","Search","X","Info","Plus","ChevronDown","ChevronUp","Trash2","Loader","Save","Copy","FolderOpen","apiClient","toast","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","CreateWorkStream","_ref","hideHeader","user","logout","sidebarOpen","setSidebarOpen","submitting","setSubmitting","showForm","setShowForm","projectObjectives","setProjectObjectives","allProjectObjectives","setAllProjectObjectives","loadingPOs","setLoadingPOs","poOffset","setPoOffset","poHasMore","setPoHasMore","loadingMorePOs","setLoadingMorePOs","infiniteScrollRef","statusFilter","setStatusFilter","workstreams","setWorkstreams","id","Date","now","projectWorkstreamName","projectObjective","projectObjectiveId","refresh","deliveryToolName","clientWorkstreamIdentifier","functionality","expandedWorkstreams","setExpandedWorkstreams","savedTemplates","setSavedTemplates","showTemplateModal","setShowTemplateModal","templateName","setTemplateName","showLoadTemplateModal","setShowLoadTemplateModal","projectObjectiveSearchTerms","setProjectObjectiveSearchTerms","projectObjectiveSearchResults","setProjectObjectiveSearchResults","loadingProjectObjectiveSearch","setLoadingProjectObjectiveSearch","showProjectObjectiveDropdowns","setShowProjectObjectiveDropdowns","projectObjectiveSearchTimeoutRefs","recentSelectionsRef","fetchProjectObjectives","offset","arguments","length","undefined","append","response","get","params","limit","timeout","data","success","newPOs","prev","newOffset","hasMoreRecords","hasMore","error","_error$response","_error$response$data","saved","localStorage","getItem","JSON","parse","console","observer","IntersectionObserver","entries","isIntersecting","threshold","current","observe","unobserve","filter","po","status","uniqueStatuses","Array","from","Set","map","s","sort","deliveryToolNameOptions","functionalityOptions","handleClickOutside","event","Object","keys","forEach","workstreamId","target","closest","concat","_objectSpread","document","addEventListener","removeEventListener","searchTerm","workstream","find","w","clearTimeout","trim","recentSelection","timeSinceSelection","timestamp","setTimeout","currentSearchTerm","currentWorkstream","currentRecentSelection","encodeURIComponent","finalWorkstream","finalRecentSelection","handleProjectObjectiveSelect","objective","selectedName","contributorFacingProjectName","name","ws","handleClearProjectObjective","handleInputChange","field","value","handleSearchTermChange","toggleWorkstreamExpanded","addWorkstream","newId","removeWorkstream","newState","validateWorkstream","handleSubmit","e","preventDefault","validationErrors","index","push","createPromises","post","results","Promise","all","successCount","r","_error$response2","_error$response2$data","errorMessage","message","handleCancel","handleAddWorkstream","handleSaveTemplate","confirmSaveTemplate","template","createdAt","toISOString","updatedTemplates","setItem","stringify","handleLoadTemplate","newWorkstreams","reduce","acc","handleDeleteTemplate","templateId","t","handleCloneWorkstream","workstreamToClone","clonedWorkstream","renderWorkstreamForm","isExpanded","searchResults","loadingSearch","showDropdown","className","children","onClick","type","stopPropagation","size","style","display","gap","alignItems","title","background","border","cursor","padding","color","onChange","placeholder","readOnly","onFocus","projectName","marginTop","marginBottom","checked","marginRight","verticalAlign","marginLeft","required","opt","option","content","justifyContent","margin","fontSize","fontWeight","borderRadius","minWidth","fontFamily","textAlign","maxHeight","overflowY","width","colSpan","borderTop","ref","height","onSubmit","flexWrap","disabled","position","top","left","right","bottom","zIndex","maxWidth","autoFocus","onKeyPress","key","overflow","flexDirection","toLocaleDateString","isOpen","toggleSidebar","email","charAt","toUpperCase"],"sources":["/Users/mmoola/Cursor/ProjectSetup/client/src/pages/CreateWorkStream.js"],"sourcesContent":["import React, { useState, useEffect, useRef, useCallback } from 'react';\nimport { useAuth } from '../context/AuthContext';\nimport Sidebar from '../components/Sidebar';\nimport { Menu, LogOut, Search, X, Info, Plus, ChevronDown, ChevronUp, Trash2, Loader, Save, Copy, FolderOpen } from 'lucide-react';\nimport apiClient from '../config/api';\nimport toast from 'react-hot-toast';\nimport '../styles/CreateWorkStream.css';\nimport '../styles/Sidebar.css';\nimport '../styles/GlobalHeader.css';\n\nconst CreateWorkStream = ({ hideHeader = false }) => {\n  const { user, logout } = useAuth();\n  const [sidebarOpen, setSidebarOpen] = useState(true);\n  const [submitting, setSubmitting] = useState(false);\n  const [showForm, setShowForm] = useState(false); // New state to control form visibility\n  \n  // Project Objectives without workstreams\n  const [projectObjectives, setProjectObjectives] = useState([]);\n  const [allProjectObjectives, setAllProjectObjectives] = useState([]); // Store all fetched data for filtering\n  const [loadingPOs, setLoadingPOs] = useState(true);\n  const [poOffset, setPoOffset] = useState(0);\n  const [poHasMore, setPoHasMore] = useState(true);\n  const [loadingMorePOs, setLoadingMorePOs] = useState(false);\n  const infiniteScrollRef = useRef(null);\n  const [statusFilter, setStatusFilter] = useState(''); // Filter by status\n  \n  // Workstreams array - each workstream has its own form data\n  const [workstreams, setWorkstreams] = useState([\n    {\n      id: Date.now(),\n      projectWorkstreamName: '',\n      projectObjective: '',\n      projectObjectiveId: '',\n      refresh: false,\n      deliveryToolName: '',\n      clientWorkstreamIdentifier: '',\n      functionality: ''\n    }\n  ]);\n  \n  // Track expanded/collapsed state for each workstream\n  const [expandedWorkstreams, setExpandedWorkstreams] = useState({ [Date.now()]: true });\n  \n  // Templates state\n  const [savedTemplates, setSavedTemplates] = useState([]);\n  const [showTemplateModal, setShowTemplateModal] = useState(false);\n  const [templateName, setTemplateName] = useState('');\n  const [showLoadTemplateModal, setShowLoadTemplateModal] = useState(false);\n\n  // Project Objective search - per workstream\n  const [projectObjectiveSearchTerms, setProjectObjectiveSearchTerms] = useState({});\n  const [projectObjectiveSearchResults, setProjectObjectiveSearchResults] = useState({});\n  const [loadingProjectObjectiveSearch, setLoadingProjectObjectiveSearch] = useState({});\n  const [showProjectObjectiveDropdowns, setShowProjectObjectiveDropdowns] = useState({});\n  const projectObjectiveSearchTimeoutRefs = useRef({});\n  const recentSelectionsRef = useRef({}); // Track recent selections to prevent search loop\n\n  // Fetch project objectives without workstreams\n  const fetchProjectObjectives = useCallback(async (offset = 0, append = false) => {\n    try {\n      if (offset === 0) {\n        setLoadingPOs(true);\n      } else {\n        setLoadingMorePOs(true);\n      }\n      \n      const response = await apiClient.get('/workstream/project-objectives-without-workstreams', {\n        params: { limit: 1000, offset },\n        timeout: 120000 // 2 minutes to match backend timeout\n      });\n      \n      if (response.data.success) {\n        const newPOs = response.data.projectObjectives;\n        if (append) {\n          setAllProjectObjectives(prev => [...prev, ...newPOs]);\n        } else {\n          setAllProjectObjectives(newPOs);\n          setPoOffset(0); // Reset offset when starting fresh\n        }\n        \n        // Update offset and hasMore\n        const newOffset = append ? poOffset + newPOs.length : newPOs.length;\n        setPoOffset(newOffset);\n        \n        // If we got exactly 1000 records, assume there might be more\n        // Also check the hasMore flag from backend\n        const hasMoreRecords = response.data.hasMore || newPOs.length === 1000;\n        setPoHasMore(hasMoreRecords);\n      }\n    } catch (error) {\n      toast.error(error.response?.data?.error || 'Failed to fetch project objectives');\n    } finally {\n      setLoadingPOs(false);\n      setLoadingMorePOs(false);\n    }\n  }, []);\n\n  // Load saved templates from localStorage\n  useEffect(() => {\n    try {\n      const saved = localStorage.getItem('workstreamTemplates');\n      if (saved) {\n        setSavedTemplates(JSON.parse(saved));\n      }\n    } catch (error) {\n      console.error('Error loading templates:', error);\n    }\n  }, []);\n\n  // Initial load\n  useEffect(() => {\n    if (!showForm) {\n      fetchProjectObjectives(0, false);\n    }\n  }, [showForm, fetchProjectObjectives]);\n\n  // Infinite scroll for project objectives\n  useEffect(() => {\n    const observer = new IntersectionObserver(\n      (entries) => {\n        if (entries[0].isIntersecting && poHasMore && !loadingMorePOs && !showForm) {\n          fetchProjectObjectives(poOffset, true);\n        }\n      },\n      { threshold: 0.1 }\n    );\n\n    if (infiniteScrollRef.current) {\n      observer.observe(infiniteScrollRef.current);\n    }\n\n    return () => {\n      if (infiniteScrollRef.current) {\n        observer.unobserve(infiniteScrollRef.current);\n      }\n    };\n  }, [poHasMore, loadingMorePOs, poOffset, showForm, fetchProjectObjectives]);\n\n  // Filter project objectives by status\n  useEffect(() => {\n    if (statusFilter === '') {\n      setProjectObjectives(allProjectObjectives);\n    } else {\n      setProjectObjectives(allProjectObjectives.filter(po => po.status === statusFilter));\n    }\n  }, [statusFilter, allProjectObjectives]);\n\n  // Get unique status values for filter dropdown (exclude '--' and empty values)\n  const uniqueStatuses = Array.from(new Set(allProjectObjectives.map(po => po.status).filter(s => s && s !== '--'))).sort();\n\n  // Delivery Tool Name picklist (excluding QF as per original requirement)\n  const deliveryToolNameOptions = [\n    '--None--',\n    'A9',\n    'ADAP',\n    'Ampersand',\n    'Appen Collect',\n    'AppenLex',\n    'Baseline',\n    'EWOQ',\n    'Exotel',\n    'Other',\n    'Polyglot',\n    'SRT',\n    'TryRating',\n    'UHRS',\n    'Test',\n    'Test Tool'\n  ];\n\n  // Functionality picklist values\n  const functionalityOptions = [\n    '--None--',\n    'System Access',\n    'System Access & Productivity',\n    'Productivity'\n  ];\n\n  // Close search results when clicking outside\n  useEffect(() => {\n    const handleClickOutside = (event) => {\n      Object.keys(showProjectObjectiveDropdowns).forEach(workstreamId => {\n        if (showProjectObjectiveDropdowns[workstreamId] && !event.target.closest(`.project-objective-search-container-${workstreamId}`)) {\n          setShowProjectObjectiveDropdowns(prev => ({\n            ...prev,\n            [workstreamId]: false\n          }));\n        }\n      });\n    };\n\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => {\n      document.removeEventListener('mousedown', handleClickOutside);\n    };\n  }, [showProjectObjectiveDropdowns]);\n\n  // Search Project Objectives when search term changes (per workstream)\n  useEffect(() => {\n    Object.keys(projectObjectiveSearchTerms).forEach(workstreamId => {\n      const searchTerm = projectObjectiveSearchTerms[workstreamId];\n      const workstream = workstreams.find(w => w.id === workstreamId);\n      \n      // Clear any existing timeout\n      if (projectObjectiveSearchTimeoutRefs.current[workstreamId]) {\n        clearTimeout(projectObjectiveSearchTimeoutRefs.current[workstreamId]);\n        delete projectObjectiveSearchTimeoutRefs.current[workstreamId];\n      }\n\n      // IMPORTANT: Don't search if an objective is already selected\n      // This prevents the search loop when user selects an objective\n      if (workstream && workstream.projectObjectiveId) {\n        setProjectObjectiveSearchResults(prev => ({ ...prev, [workstreamId]: [] }));\n        setShowProjectObjectiveDropdowns(prev => ({ ...prev, [workstreamId]: false }));\n        setLoadingProjectObjectiveSearch(prev => ({ ...prev, [workstreamId]: false }));\n        return;\n      }\n\n      // Don't search if search term is empty\n      if (!searchTerm || searchTerm.trim() === '') {\n        setProjectObjectiveSearchResults(prev => ({ ...prev, [workstreamId]: [] }));\n        setShowProjectObjectiveDropdowns(prev => ({ ...prev, [workstreamId]: false }));\n        setLoadingProjectObjectiveSearch(prev => ({ ...prev, [workstreamId]: false }));\n        return;\n      }\n\n      // Check if this is a recent selection (within last 2 seconds)\n      const recentSelection = recentSelectionsRef.current[workstreamId];\n      if (recentSelection) {\n        const timeSinceSelection = Date.now() - recentSelection.timestamp;\n        if (timeSinceSelection < 2000) {\n          // This is a recent selection, don't search\n          setProjectObjectiveSearchResults(prev => ({ ...prev, [workstreamId]: [] }));\n          setShowProjectObjectiveDropdowns(prev => ({ ...prev, [workstreamId]: false }));\n          setLoadingProjectObjectiveSearch(prev => ({ ...prev, [workstreamId]: false }));\n          return;\n        }\n      }\n\n      // Only search if user is actively typing (not just matching selected value)\n      projectObjectiveSearchTimeoutRefs.current[workstreamId] = setTimeout(async () => {\n        // Get fresh search term and workstream\n        const currentSearchTerm = projectObjectiveSearchTerms[workstreamId];\n        if (!currentSearchTerm || currentSearchTerm.trim() === '') {\n          return;\n        }\n        \n        // CRITICAL: Re-check if objective was selected during timeout - if so, abort search\n        const currentWorkstream = workstreams.find(w => w.id === workstreamId);\n        if (currentWorkstream && currentWorkstream.projectObjectiveId) {\n          // An objective was selected, don't search\n          setProjectObjectiveSearchResults(prev => ({ ...prev, [workstreamId]: [] }));\n          setShowProjectObjectiveDropdowns(prev => ({ ...prev, [workstreamId]: false }));\n          setLoadingProjectObjectiveSearch(prev => ({ ...prev, [workstreamId]: false }));\n          return;\n        }\n        \n        // Check again if this is a recent selection\n        const currentRecentSelection = recentSelectionsRef.current[workstreamId];\n        if (currentRecentSelection) {\n          const timeSinceSelection = Date.now() - currentRecentSelection.timestamp;\n          if (timeSinceSelection < 2000) {\n            // This is a recent selection, don't search\n            setProjectObjectiveSearchResults(prev => ({ ...prev, [workstreamId]: [] }));\n            setShowProjectObjectiveDropdowns(prev => ({ ...prev, [workstreamId]: false }));\n            setLoadingProjectObjectiveSearch(prev => ({ ...prev, [workstreamId]: false }));\n            return;\n          }\n        }\n        \n        setLoadingProjectObjectiveSearch(prev => ({ ...prev, [workstreamId]: true }));\n        try {\n          const response = await apiClient.get(`/workstream/search-project-objectives?search=${encodeURIComponent(currentSearchTerm)}`);\n          if (response.data.success) {\n            // CRITICAL: Final check before showing results - make sure objective wasn't selected during API call\n            const finalWorkstream = workstreams.find(w => w.id === workstreamId);\n            if (finalWorkstream && finalWorkstream.projectObjectiveId) {\n              // An objective was selected during the API call, don't show results\n              setProjectObjectiveSearchResults(prev => ({ ...prev, [workstreamId]: [] }));\n              setShowProjectObjectiveDropdowns(prev => ({ ...prev, [workstreamId]: false }));\n              setLoadingProjectObjectiveSearch(prev => ({ ...prev, [workstreamId]: false }));\n              return;\n            }\n            \n            // Check for recent selection\n            const finalRecentSelection = recentSelectionsRef.current[workstreamId];\n            if (finalRecentSelection) {\n              const timeSinceSelection = Date.now() - finalRecentSelection.timestamp;\n              if (timeSinceSelection < 2000) {\n                // Objective was just selected, don't show results\n                setProjectObjectiveSearchResults(prev => ({ ...prev, [workstreamId]: [] }));\n                setShowProjectObjectiveDropdowns(prev => ({ ...prev, [workstreamId]: false }));\n                setLoadingProjectObjectiveSearch(prev => ({ ...prev, [workstreamId]: false }));\n                return;\n              }\n            }\n            \n            // All checks passed, show results\n            setProjectObjectiveSearchResults(prev => ({ ...prev, [workstreamId]: response.data.projectObjectives || [] }));\n            setShowProjectObjectiveDropdowns(prev => ({ ...prev, [workstreamId]: true }));\n          }\n        } catch (error) {\n          setProjectObjectiveSearchResults(prev => ({ ...prev, [workstreamId]: [] }));\n        } finally {\n          setLoadingProjectObjectiveSearch(prev => ({ ...prev, [workstreamId]: false }));\n        }\n      }, 300);\n    });\n\n    return () => {\n      Object.keys(projectObjectiveSearchTimeoutRefs.current).forEach(workstreamId => {\n        if (projectObjectiveSearchTimeoutRefs.current[workstreamId]) {\n          clearTimeout(projectObjectiveSearchTimeoutRefs.current[workstreamId]);\n          delete projectObjectiveSearchTimeoutRefs.current[workstreamId];\n        }\n      });\n    };\n  }, [projectObjectiveSearchTerms, workstreams]);\n\n  const handleProjectObjectiveSelect = (workstreamId, objective) => {\n    const selectedName = objective.contributorFacingProjectName || objective.name;\n    \n    // Clear any pending search timeout immediately\n    if (projectObjectiveSearchTimeoutRefs.current[workstreamId]) {\n      clearTimeout(projectObjectiveSearchTimeoutRefs.current[workstreamId]);\n      delete projectObjectiveSearchTimeoutRefs.current[workstreamId];\n    }\n    \n    // Mark this as a recent selection to prevent search loop\n    recentSelectionsRef.current[workstreamId] = {\n      name: selectedName,\n      timestamp: Date.now()\n    };\n    \n    // Update workstream with selected objective\n    setWorkstreams(prev => prev.map(ws => \n      ws.id === workstreamId \n        ? {\n            ...ws,\n            projectObjective: selectedName,\n            projectObjectiveId: objective.id\n          }\n        : ws\n    ));\n    \n    // Clear search term instead of setting it to selected name - this prevents re-triggering search\n    setProjectObjectiveSearchTerms(prev => ({\n      ...prev,\n      [workstreamId]: ''\n    }));\n    \n    // Immediately close dropdown and clear results\n    setShowProjectObjectiveDropdowns(prev => ({ ...prev, [workstreamId]: false }));\n    setProjectObjectiveSearchResults(prev => ({ ...prev, [workstreamId]: [] }));\n    setLoadingProjectObjectiveSearch(prev => ({ ...prev, [workstreamId]: false }));\n    \n    // Clear the recent selection flag after a delay\n    setTimeout(() => {\n      if (recentSelectionsRef.current[workstreamId]) {\n        delete recentSelectionsRef.current[workstreamId];\n      }\n    }, 2000);\n  };\n\n  const handleClearProjectObjective = (workstreamId) => {\n    setWorkstreams(prev => prev.map(ws => \n      ws.id === workstreamId \n        ? {\n            ...ws,\n            projectObjective: '',\n            projectObjectiveId: ''\n          }\n        : ws\n    ));\n    setProjectObjectiveSearchTerms(prev => ({ ...prev, [workstreamId]: '' }));\n    setProjectObjectiveSearchResults(prev => ({ ...prev, [workstreamId]: [] }));\n    setShowProjectObjectiveDropdowns(prev => ({ ...prev, [workstreamId]: false }));\n  };\n\n  const handleInputChange = (workstreamId, field, value) => {\n    setWorkstreams(prev => prev.map(ws => \n      ws.id === workstreamId ? { ...ws, [field]: value } : ws\n    ));\n  };\n\n  const handleSearchTermChange = (workstreamId, value) => {\n    setProjectObjectiveSearchTerms(prev => ({\n      ...prev,\n      [workstreamId]: value\n    }));\n    if (value === '') {\n      handleClearProjectObjective(workstreamId);\n    }\n  };\n\n  const toggleWorkstreamExpanded = (workstreamId) => {\n    setExpandedWorkstreams(prev => ({\n      ...prev,\n      [workstreamId]: !prev[workstreamId]\n    }));\n  };\n\n  const addWorkstream = () => {\n    const newId = Date.now();\n    setWorkstreams(prev => [...prev, {\n      id: newId,\n      projectWorkstreamName: '',\n      projectObjective: '',\n      projectObjectiveId: '',\n      refresh: false,\n      deliveryToolName: '',\n      clientWorkstreamIdentifier: '',\n      functionality: ''\n    }]);\n    setExpandedWorkstreams(prev => ({ ...prev, [newId]: true }));\n    setProjectObjectiveSearchTerms(prev => ({ ...prev, [newId]: '' }));\n  };\n\n  const removeWorkstream = (workstreamId) => {\n    if (workstreams.length === 1) {\n      toast.error('At least one workstream is required');\n      return;\n    }\n    setWorkstreams(prev => prev.filter(ws => ws.id !== workstreamId));\n    setExpandedWorkstreams(prev => {\n      const newState = { ...prev };\n      delete newState[workstreamId];\n      return newState;\n    });\n    setProjectObjectiveSearchTerms(prev => {\n      const newState = { ...prev };\n      delete newState[workstreamId];\n      return newState;\n    });\n    setProjectObjectiveSearchResults(prev => {\n      const newState = { ...prev };\n      delete newState[workstreamId];\n      return newState;\n    });\n    setShowProjectObjectiveDropdowns(prev => {\n      const newState = { ...prev };\n      delete newState[workstreamId];\n      return newState;\n    });\n    if (projectObjectiveSearchTimeoutRefs.current[workstreamId]) {\n      clearTimeout(projectObjectiveSearchTimeoutRefs.current[workstreamId]);\n      delete projectObjectiveSearchTimeoutRefs.current[workstreamId];\n    }\n  };\n\n  const validateWorkstream = (workstream) => {\n    if (!workstream.projectObjectiveId) {\n      return 'Project Objective is required';\n    }\n    if (!workstream.deliveryToolName || workstream.deliveryToolName === '--None--') {\n      return 'Delivery Tool Name is required';\n    }\n    if (!workstream.clientWorkstreamIdentifier || workstream.clientWorkstreamIdentifier.trim() === '') {\n      return 'Client Workstream Identifier is required';\n    }\n    if (!workstream.functionality || workstream.functionality === '--None--') {\n      return 'Functionality is required';\n    }\n    return null;\n  };\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n\n    // Validate all workstreams\n    const validationErrors = [];\n    workstreams.forEach((workstream, index) => {\n      const error = validateWorkstream(workstream);\n      if (error) {\n        validationErrors.push(`Workstream ${index + 1}: ${error}`);\n      }\n    });\n\n    if (validationErrors.length > 0) {\n      toast.error(validationErrors[0]);\n      return;\n    }\n\n    setSubmitting(true);\n    try {\n      // Create all workstreams - each under its respective project objective\n      const createPromises = workstreams.map(workstream => \n        apiClient.post('/workstream/create', {\n          projectWorkstreamName: workstream.projectWorkstreamName,\n          projectObjective: workstream.projectObjective,\n          projectObjectiveId: workstream.projectObjectiveId,\n          refresh: workstream.refresh,\n          deliveryToolName: workstream.deliveryToolName,\n          clientWorkstreamIdentifier: workstream.clientWorkstreamIdentifier,\n          functionality: workstream.functionality\n        })\n      );\n\n      const results = await Promise.all(createPromises);\n      const successCount = results.filter(r => r.data.success).length;\n      \n      if (successCount === workstreams.length) {\n        toast.success(`Successfully created ${successCount} workstream(s)`);\n        // Reset all workstreams and hide form\n        const newId = Date.now();\n        setWorkstreams([{\n          id: newId,\n          projectWorkstreamName: '',\n          projectObjective: '',\n          projectObjectiveId: '',\n          refresh: false,\n          deliveryToolName: '',\n          clientWorkstreamIdentifier: '',\n          functionality: ''\n        }]);\n        setExpandedWorkstreams({ [newId]: true });\n        setProjectObjectiveSearchTerms({ [newId]: '' });\n        setProjectObjectiveSearchResults({});\n        setShowProjectObjectiveDropdowns({});\n        setShowForm(false);\n        // Reload project objectives list\n        fetchProjectObjectives(0, false);\n      } else {\n        toast.error(`Created ${successCount} of ${workstreams.length} workstream(s)`);\n      }\n    } catch (error) {\n      const errorMessage = error.response?.data?.error || error.message || 'Failed to create workstream(s)';\n      toast.error(errorMessage);\n    } finally {\n      setSubmitting(false);\n    }\n  };\n\n  const handleCancel = () => {\n    // Reset all workstreams and hide form\n    const newId = Date.now();\n    setWorkstreams([{\n      id: newId,\n      projectWorkstreamName: '',\n      projectObjective: '',\n      projectObjectiveId: '',\n      refresh: false,\n      deliveryToolName: '',\n      clientWorkstreamIdentifier: '',\n      functionality: ''\n    }]);\n    setExpandedWorkstreams({ [newId]: true });\n    setProjectObjectiveSearchTerms({ [newId]: '' });\n    setProjectObjectiveSearchResults({});\n    setShowProjectObjectiveDropdowns({});\n    setShowForm(false);\n    // Reload project objectives list\n    fetchProjectObjectives(0, false);\n  };\n\n  const handleAddWorkstream = () => {\n    setShowForm(true);\n  };\n\n  // Save current workstreams as template\n  const handleSaveTemplate = () => {\n    if (workstreams.length === 0) {\n      toast.error('No workstreams to save as template');\n      return;\n    }\n    setShowTemplateModal(true);\n  };\n\n  const confirmSaveTemplate = () => {\n    if (!templateName.trim()) {\n      toast.error('Please enter a template name');\n      return;\n    }\n\n    try {\n      const template = {\n        id: Date.now(),\n        name: templateName.trim(),\n        createdAt: new Date().toISOString(),\n        workstreams: workstreams.map(ws => ({\n          projectWorkstreamName: ws.projectWorkstreamName,\n          projectObjective: ws.projectObjective,\n          projectObjectiveId: ws.projectObjectiveId,\n          refresh: ws.refresh,\n          deliveryToolName: ws.deliveryToolName,\n          clientWorkstreamIdentifier: ws.clientWorkstreamIdentifier,\n          functionality: ws.functionality\n        }))\n      };\n\n      const updatedTemplates = [...savedTemplates, template];\n      setSavedTemplates(updatedTemplates);\n      localStorage.setItem('workstreamTemplates', JSON.stringify(updatedTemplates));\n      toast.success('Template saved successfully');\n      setShowTemplateModal(false);\n      setTemplateName('');\n    } catch (error) {\n      console.error('Error saving template:', error);\n      toast.error('Failed to save template');\n    }\n  };\n\n  // Load template\n  const handleLoadTemplate = (template) => {\n    try {\n      const newWorkstreams = template.workstreams.map((ws, index) => ({\n        id: Date.now() + index,\n        ...ws\n      }));\n      setWorkstreams(newWorkstreams);\n      setExpandedWorkstreams(newWorkstreams.reduce((acc, ws) => {\n        acc[ws.id] = true;\n        return acc;\n      }, {}));\n      setShowLoadTemplateModal(false);\n      toast.success(`Template \"${template.name}\" loaded successfully`);\n    } catch (error) {\n      console.error('Error loading template:', error);\n      toast.error('Failed to load template');\n    }\n  };\n\n  // Delete template\n  const handleDeleteTemplate = (templateId) => {\n    try {\n      const updatedTemplates = savedTemplates.filter(t => t.id !== templateId);\n      setSavedTemplates(updatedTemplates);\n      localStorage.setItem('workstreamTemplates', JSON.stringify(updatedTemplates));\n      toast.success('Template deleted successfully');\n    } catch (error) {\n      console.error('Error deleting template:', error);\n      toast.error('Failed to delete template');\n    }\n  };\n\n  // Clone workstream\n  const handleCloneWorkstream = (workstreamId) => {\n    const workstreamToClone = workstreams.find(ws => ws.id === workstreamId);\n    if (!workstreamToClone) return;\n\n    const clonedWorkstream = {\n      ...workstreamToClone,\n      id: Date.now(),\n      projectWorkstreamName: `${workstreamToClone.projectWorkstreamName} (Copy)`,\n      projectObjective: '',\n      projectObjectiveId: ''\n    };\n\n    setWorkstreams(prev => [...prev, clonedWorkstream]);\n    setExpandedWorkstreams(prev => ({ ...prev, [clonedWorkstream.id]: true }));\n    toast.success('Workstream cloned successfully');\n  };\n\n  const renderWorkstreamForm = (workstream, index) => {\n    const isExpanded = expandedWorkstreams[workstream.id] !== false;\n    const searchTerm = projectObjectiveSearchTerms[workstream.id] || '';\n    const searchResults = projectObjectiveSearchResults[workstream.id] || [];\n    const loadingSearch = loadingProjectObjectiveSearch[workstream.id] || false;\n    const showDropdown = showProjectObjectiveDropdowns[workstream.id] || false;\n\n    return (\n      <div key={workstream.id} className=\"workstream-form-card\">\n        <div \n          className=\"create-workstream-header-section\"\n          onClick={() => toggleWorkstreamExpanded(workstream.id)}\n        >\n          <button\n            type=\"button\"\n            className=\"create-workstream-toggle\"\n            onClick={(e) => {\n              e.stopPropagation();\n              toggleWorkstreamExpanded(workstream.id);\n            }}\n          >\n            {isExpanded ? <ChevronUp size={18} /> : <ChevronDown size={18} />}\n          </button>\n          <span className=\"create-workstream-title-text\">\n            WorkStream {index + 1}{workstream.projectObjective ? ` - ${workstream.projectObjective}` : ''}\n          </span>\n          <div style={{ display: 'flex', gap: '8px', alignItems: 'center' }}>\n            <button\n              type=\"button\"\n              className=\"create-workstream-remove\"\n              onClick={(e) => {\n                e.stopPropagation();\n                handleCloneWorkstream(workstream.id);\n              }}\n              title=\"Clone workstream\"\n              style={{ background: 'transparent', border: 'none', cursor: 'pointer', padding: '4px', display: 'flex', alignItems: 'center' }}\n            >\n              <Copy size={16} style={{ color: '#0176d3' }} />\n            </button>\n            {workstreams.length > 1 && (\n              <button\n                type=\"button\"\n                className=\"create-workstream-remove\"\n                onClick={(e) => {\n                  e.stopPropagation();\n                  removeWorkstream(workstream.id);\n                }}\n                title=\"Remove workstream\"\n              >\n                <Trash2 size={16} />\n              </button>\n            )}\n          </div>\n        </div>\n\n        {isExpanded && (\n          <div className=\"workstream-form-content\">\n            <div className=\"form-section-card\">\n              <div className=\"form-grid-two-column\">\n                <div className=\"form-column\">\n                  <div className=\"form-group\">\n                    <label>Project Workstream Name</label>\n                    <input\n                      type=\"text\"\n                      value={workstream.projectWorkstreamName}\n                      onChange={(e) => handleInputChange(workstream.id, 'projectWorkstreamName', e.target.value)}\n                      className=\"form-input-compact\"\n                    />\n                  </div>\n\n                  <div className=\"form-group\">\n                    <label>\n                      Project Objective <span className=\"required\">*</span>\n                    </label>\n                    <div className={`project-objective-search-container project-objective-search-container-${workstream.id}`}>\n                      <div className=\"search-input-wrapper\">\n                        <Search size={14} className=\"search-icon\" />\n                        <input\n                          type=\"text\"\n                          placeholder=\"Search for project objective...\"\n                          value={workstream.projectObjectiveId ? workstream.projectObjective : searchTerm}\n                          readOnly={!!workstream.projectObjectiveId}\n                          onChange={(e) => {\n                            // Only allow changes if no objective is selected\n                            if (!workstream.projectObjectiveId) {\n                              handleSearchTermChange(workstream.id, e.target.value);\n                            }\n                          }}\n                          onFocus={() => {\n                            // If there's a selection, allow clearing it\n                            if (workstream.projectObjectiveId) {\n                              // User can click X button to clear\n                            } else if (searchResults.length > 0) {\n                              setShowProjectObjectiveDropdowns(prev => ({ ...prev, [workstream.id]: true }));\n                            }\n                          }}\n                          onClick={() => {\n                            // If there's a selection and user clicks, don't clear automatically\n                            // They need to use the X button\n                            if (!workstream.projectObjectiveId && searchResults.length > 0) {\n                              setShowProjectObjectiveDropdowns(prev => ({ ...prev, [workstream.id]: true }));\n                            }\n                          }}\n                          className=\"form-input-compact search-input\"\n                          style={workstream.projectObjectiveId ? { cursor: 'default' } : {}}\n                        />\n                        {workstream.projectObjectiveId && (\n                          <button\n                            type=\"button\"\n                            onClick={() => handleClearProjectObjective(workstream.id)}\n                            className=\"clear-button\"\n                            title=\"Clear selection\"\n                          >\n                            <X size={14} />\n                          </button>\n                        )}\n                      </div>\n                      {loadingSearch && (\n                        <div className=\"searching-indicator\">Searching...</div>\n                      )}\n                      {showDropdown && searchResults.length > 0 && !workstream.projectObjectiveId && (\n                        <div className=\"search-results-dropdown\">\n                          {searchResults.map((objective) => (\n                            <div\n                              key={objective.id}\n                              onClick={() => handleProjectObjectiveSelect(workstream.id, objective)}\n                              className={`search-result-item ${workstream.projectObjectiveId === objective.id ? 'selected' : ''}`}\n                            >\n                              <div className=\"search-result-name\">\n                                {objective.contributorFacingProjectName || objective.name}\n                              </div>\n                              {objective.projectName && (\n                                <div className=\"search-result-subtitle\">\n                                  Project: {objective.projectName}\n                                </div>\n                              )}\n                            </div>\n                          ))}\n                        </div>\n                      )}\n                    </div>\n                  </div>\n\n                  <div className=\"form-group\" style={{ marginTop: '6px' }}>\n                    <label className=\"checkbox-label\" style={{ marginBottom: 0 }}>\n                      <input\n                        type=\"checkbox\"\n                        checked={workstream.refresh}\n                        onChange={(e) => handleInputChange(workstream.id, 'refresh', e.target.checked)}\n                        className=\"checkbox-input\"\n                        style={{ marginRight: '8px', marginTop: '0', verticalAlign: 'middle' }}\n                      />\n                      <span className=\"checkbox-text\" style={{ verticalAlign: 'middle' }}>Refresh</span>\n                      <Info size={12} className=\"info-icon\" style={{ marginLeft: '6px', verticalAlign: 'middle' }} />\n                    </label>\n                  </div>\n                </div>\n\n                <div className=\"form-column\">\n                  <div className=\"form-group\">\n                    <label>\n                      Delivery Tool Name <span className=\"required\">*</span>\n                    </label>\n                    <select\n                      value={workstream.deliveryToolName}\n                      onChange={(e) => handleInputChange(workstream.id, 'deliveryToolName', e.target.value)}\n                      className=\"form-input-compact\"\n                      required\n                    >\n                      <option value=\"\">--None--</option>\n                      {deliveryToolNameOptions.filter(opt => opt !== '--None--').map((option) => (\n                        <option key={option} value={option}>{option}</option>\n                      ))}\n                    </select>\n                  </div>\n\n                  <div className=\"form-group\">\n                    <label>\n                      Client Workstream Identifier <span className=\"required\">*</span>\n                      <Info size={12} className=\"info-icon\" />\n                    </label>\n                    <input\n                      type=\"text\"\n                      value={workstream.clientWorkstreamIdentifier}\n                      onChange={(e) => handleInputChange(workstream.id, 'clientWorkstreamIdentifier', e.target.value)}\n                      className=\"form-input-compact\"\n                      required\n                    />\n                  </div>\n\n                  <div className=\"form-group\">\n                    <label>\n                      Functionality <span className=\"required\">*</span>\n                      <Info size={12} className=\"info-icon\" />\n                    </label>\n                    <select\n                      value={workstream.functionality}\n                      onChange={(e) => handleInputChange(workstream.id, 'functionality', e.target.value)}\n                      className=\"form-input-compact\"\n                      required\n                    >\n                      <option value=\"\">--None--</option>\n                      {functionalityOptions.filter(opt => opt !== '--None--').map((option) => (\n                        <option key={option} value={option}>{option}</option>\n                      ))}\n                    </select>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        )}\n      </div>\n    );\n  };\n\n  const content = (\n    <div className=\"create-workstream-content\">\n      {!showForm ? (\n        <>\n          {/* Header with Add Workstream button */}\n          <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '20px' }}>\n            <h2 style={{ margin: 0, fontSize: '18px', fontWeight: 600, color: '#002329' }}>\n              Project Objectives Without Workstreams\n            </h2>\n            <button\n              type=\"button\"\n              className=\"btn-primary\"\n              onClick={handleAddWorkstream}\n              style={{ display: 'flex', alignItems: 'center', gap: '8px' }}\n            >\n              <Plus size={16} />\n              Add Workstream\n            </button>\n          </div>\n\n          {/* Filter Section */}\n          <div style={{ display: 'flex', gap: '12px', alignItems: 'center', marginBottom: '16px' }}>\n            <label style={{ fontSize: '14px', fontWeight: 500, color: '#002329' }}>\n              Filter by Status:\n            </label>\n            <select\n              value={statusFilter}\n              onChange={(e) => setStatusFilter(e.target.value)}\n              style={{\n                fontSize: '14px',\n                padding: '8px 12px',\n                border: '1px solid var(--border-color)',\n                borderRadius: 'var(--radius-md)',\n                background: 'var(--surface)',\n                color: 'var(--text-primary)',\n                minWidth: '180px',\n                cursor: 'pointer',\n                fontFamily: 'Poppins'\n              }}\n            >\n              <option value=\"\">All Status</option>\n              {uniqueStatuses.map(status => (\n                <option key={status} value={status}>{status}</option>\n              ))}\n            </select>\n            {statusFilter && (\n              <button\n                type=\"button\"\n                onClick={() => setStatusFilter('')}\n                style={{\n                  fontSize: '13px',\n                  padding: '6px 12px',\n                  background: 'transparent',\n                  border: '1px solid var(--border-color)',\n                  borderRadius: 'var(--radius-md)',\n                  color: 'var(--text-secondary)',\n                  cursor: 'pointer',\n                  fontFamily: 'Poppins'\n                }}\n              >\n                Clear Filter\n              </button>\n            )}\n          </div>\n\n          {/* Project Objectives Table */}\n          {loadingPOs && allProjectObjectives.length === 0 ? (\n            <div style={{ textAlign: 'center', padding: '40px' }}>\n              <Loader className=\"spinning\" size={24} />\n              <p>Loading project objectives...</p>\n            </div>\n          ) : (\n            <div className=\"project-objectives-table-container\" style={{ maxHeight: '70vh', overflowY: 'auto' }}>\n              <table className=\"project-objectives-table\" style={{ width: '100%' }}>\n                <thead>\n                  <tr>\n                    <th>Project Objective</th>\n                    <th>Associated Project</th>\n                    <th>Project Objective Status</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  {projectObjectives.length === 0 ? (\n                    <tr>\n                      <td colSpan=\"3\" className=\"no-data\" style={{ textAlign: 'center', padding: '40px' }}>\n                        No project objectives without workstreams found\n                      </td>\n                    </tr>\n                  ) : (\n                    projectObjectives.map((po, index) => (\n                      <tr key={po.id || index}>\n                        <td>{po.name || '--'}</td>\n                        <td>{po.projectName || '--'}</td>\n                        <td>{po.status || '--'}</td>\n                      </tr>\n                    ))\n                  )}\n                </tbody>\n              </table>\n              \n              {/* Show More Button and Loading States */}\n              {((poHasMore || allProjectObjectives.length >= 1000) && !loadingMorePOs && allProjectObjectives.length > 0 && !loadingPOs) && (\n                <div style={{ textAlign: 'center', padding: '20px', borderTop: '1px solid var(--border-color)' }}>\n                  <button\n                    type=\"button\"\n                    className=\"btn-secondary\"\n                    onClick={() => fetchProjectObjectives(poOffset, true)}\n                    style={{\n                      display: 'inline-flex',\n                      alignItems: 'center',\n                      gap: '8px',\n                      padding: '10px 24px',\n                      fontSize: '14px',\n                      fontWeight: 600\n                    }}\n                  >\n                    <Plus size={16} />\n                    Show More ({allProjectObjectives.length} loaded{poHasMore ? ', more available' : ''})\n                  </button>\n                  <div style={{ marginTop: '8px', fontSize: '12px', color: '#666' }}>\n                    Click to load next 1000 project objectives\n                  </div>\n                </div>\n              )}\n              \n              {loadingMorePOs && (\n                <div style={{ textAlign: 'center', padding: '20px', borderTop: '1px solid var(--border-color)' }}>\n                  <Loader className=\"spinning\" size={16} />\n                  <span style={{ marginLeft: '8px' }}>Loading more project objectives...</span>\n                </div>\n              )}\n              \n              {/* Infinite scroll trigger (backup - hidden but still functional) */}\n              {poHasMore && !loadingMorePOs && (\n                <div\n                  ref={infiniteScrollRef}\n                  style={{ height: '20px', width: '100%' }}\n                />\n              )}\n              \n              {allProjectObjectives.length > 0 && !poHasMore && (\n                <div style={{ textAlign: 'center', padding: '16px', borderTop: '1px solid var(--border-color)', color: '#666', fontSize: '13px' }}>\n                  {statusFilter ? (\n                    <>Showing {projectObjectives.length} of {allProjectObjectives.length} project objectives (filtered by status: {statusFilter})</>\n                  ) : (\n                    <>All {allProjectObjectives.length} project objectives loaded</>\n                  )}\n                </div>\n              )}\n            </div>\n          )}\n        </>\n      ) : (\n        <form onSubmit={handleSubmit} className=\"create-workstream-form\">\n          <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '16px' }}>\n            <h2 style={{ margin: 0, fontSize: '18px', fontWeight: 600, color: '#002329' }}>\n              Create Workstream\n            </h2>\n            <button\n              type=\"button\"\n              className=\"btn-secondary\"\n              onClick={() => setShowForm(false)}\n            >\n              Back to List\n            </button>\n          </div>\n\n          <div style={{ marginBottom: '16px', display: 'flex', gap: '12px', alignItems: 'center', flexWrap: 'wrap' }}>\n            <button\n              type=\"button\"\n              className=\"btn-primary\"\n              onClick={addWorkstream}\n              style={{ display: 'flex', alignItems: 'center', gap: '8px' }}\n            >\n              <Plus size={16} />\n              Add WorkStream\n            </button>\n            <button\n              type=\"button\"\n              className=\"btn-secondary\"\n              onClick={handleSaveTemplate}\n              disabled={workstreams.length === 0}\n              style={{ display: 'flex', alignItems: 'center', gap: '8px' }}\n              title=\"Save current workstreams as template\"\n            >\n              <Save size={16} />\n              Save Template\n            </button>\n            <button\n              type=\"button\"\n              className=\"btn-secondary\"\n              onClick={() => setShowLoadTemplateModal(true)}\n              disabled={savedTemplates.length === 0}\n              style={{ display: 'flex', alignItems: 'center', gap: '8px' }}\n              title=\"Load a saved template\"\n            >\n              <FolderOpen size={16} />\n              Load Template\n            </button>\n          </div>\n\n          {workstreams.map((workstream, index) => renderWorkstreamForm(workstream, index))}\n\n          <div className=\"form-actions\">\n            <button\n              type=\"button\"\n              className=\"btn-secondary\"\n              onClick={handleCancel}\n            >\n              Cancel\n            </button>\n            <button\n              type=\"submit\"\n              className=\"btn-primary\"\n              disabled={submitting}\n            >\n              {submitting ? 'Creating...' : `Create ${workstreams.length} WorkStream${workstreams.length > 1 ? 's' : ''}`}\n            </button>\n          </div>\n        </form>\n      )}\n\n      {/* Save Template Modal */}\n      {showTemplateModal && (\n        <div style={{\n          position: 'fixed',\n          top: 0,\n          left: 0,\n          right: 0,\n          bottom: 0,\n          background: 'rgba(0, 0, 0, 0.5)',\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n          zIndex: 1000\n        }}>\n          <div style={{\n            background: 'white',\n            padding: '24px',\n            borderRadius: '8px',\n            minWidth: '400px',\n            maxWidth: '500px'\n          }}>\n            <h3 style={{ margin: '0 0 16px 0', fontSize: '18px', fontWeight: 600 }}>Save Template</h3>\n            <div style={{ marginBottom: '16px' }}>\n              <label style={{ display: 'block', marginBottom: '8px', fontSize: '14px', fontWeight: 500 }}>\n                Template Name:\n              </label>\n              <input\n                type=\"text\"\n                value={templateName}\n                onChange={(e) => setTemplateName(e.target.value)}\n                placeholder=\"Enter template name\"\n                style={{\n                  width: '100%',\n                  padding: '8px 12px',\n                  border: '1px solid var(--border-color)',\n                  borderRadius: '4px',\n                  fontSize: '14px'\n                }}\n                autoFocus\n                onKeyPress={(e) => {\n                  if (e.key === 'Enter') {\n                    confirmSaveTemplate();\n                  }\n                }}\n              />\n            </div>\n            <div style={{ display: 'flex', gap: '12px', justifyContent: 'flex-end' }}>\n              <button\n                type=\"button\"\n                className=\"btn-secondary\"\n                onClick={() => {\n                  setShowTemplateModal(false);\n                  setTemplateName('');\n                }}\n              >\n                Cancel\n              </button>\n              <button\n                type=\"button\"\n                className=\"btn-primary\"\n                onClick={confirmSaveTemplate}\n                disabled={!templateName.trim()}\n              >\n                Save\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Load Template Modal */}\n      {showLoadTemplateModal && (\n        <div style={{\n          position: 'fixed',\n          top: 0,\n          left: 0,\n          right: 0,\n          bottom: 0,\n          background: 'rgba(0, 0, 0, 0.5)',\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n          zIndex: 1000\n        }}>\n          <div style={{\n            background: 'white',\n            padding: '24px',\n            borderRadius: '8px',\n            minWidth: '500px',\n            maxWidth: '600px',\n            maxHeight: '80vh',\n            overflow: 'auto'\n          }}>\n            <h3 style={{ margin: '0 0 16px 0', fontSize: '18px', fontWeight: 600 }}>Load Template</h3>\n            {savedTemplates.length === 0 ? (\n              <p style={{ color: '#666', fontSize: '14px' }}>No saved templates found.</p>\n            ) : (\n              <div style={{ display: 'flex', flexDirection: 'column', gap: '12px' }}>\n                {savedTemplates.map((template) => (\n                  <div\n                    key={template.id}\n                    style={{\n                      padding: '12px',\n                      border: '1px solid var(--border-color)',\n                      borderRadius: '4px',\n                      display: 'flex',\n                      justifyContent: 'space-between',\n                      alignItems: 'center'\n                    }}\n                  >\n                    <div>\n                      <div style={{ fontWeight: 500, fontSize: '14px', marginBottom: '4px' }}>\n                        {template.name}\n                      </div>\n                      <div style={{ fontSize: '12px', color: '#666' }}>\n                        {template.workstreams.length} workstream(s)  Created {new Date(template.createdAt).toLocaleDateString()}\n                      </div>\n                    </div>\n                    <div style={{ display: 'flex', gap: '8px' }}>\n                      <button\n                        type=\"button\"\n                        className=\"btn-primary\"\n                        onClick={() => handleLoadTemplate(template)}\n                        style={{ fontSize: '12px', padding: '6px 12px' }}\n                      >\n                        Load\n                      </button>\n                      <button\n                        type=\"button\"\n                        className=\"btn-secondary\"\n                        onClick={() => handleDeleteTemplate(template.id)}\n                        style={{ fontSize: '12px', padding: '6px 12px', color: '#d32f2f' }}\n                        title=\"Delete template\"\n                      >\n                        <Trash2 size={14} />\n                      </button>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            )}\n            <div style={{ display: 'flex', justifyContent: 'flex-end', marginTop: '16px' }}>\n              <button\n                type=\"button\"\n                className=\"btn-secondary\"\n                onClick={() => setShowLoadTemplateModal(false)}\n              >\n                Close\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n\n  if (hideHeader) {\n    return <div className=\"create-workstream-content-wrapper\">{content}</div>;\n  }\n\n  return (\n    <div className=\"dashboard-layout\">\n      <Sidebar isOpen={sidebarOpen} toggleSidebar={() => setSidebarOpen(!sidebarOpen)} />\n      \n      <div className=\"create-workstream\" style={{ marginLeft: sidebarOpen ? '320px' : '80px' }}>\n        <div className=\"create-workstream-container\">\n          <div className=\"create-workstream-header\">\n            <div className=\"header-content\">\n              <div className=\"header-left\">\n                <button \n                  className=\"header-menu-toggle\"\n                  onClick={() => setSidebarOpen(!sidebarOpen)}\n                  aria-label=\"Toggle sidebar\"\n                >\n                  <Menu size={20} />\n                </button>\n                <div>\n                  <h1 className=\"page-title\">New Project Workstream</h1>\n                  <p className=\"page-subtitle\">Create a new project workstream</p>\n                </div>\n              </div>\n              <div className=\"header-user-profile\">\n                <div className=\"user-profile\">\n                  <div className=\"user-avatar\">\n                    {(user?.email || 'U').charAt(0).toUpperCase()}\n                  </div>\n                  <span className=\"user-name\">{user?.email || 'User'}</span>\n                  <button className=\"logout-btn\" onClick={logout} title=\"Logout\">\n                    <LogOut size={18} />\n                  </button>\n                </div>\n              </div>\n            </div>\n          </div>\n          {content}\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default CreateWorkStream;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}