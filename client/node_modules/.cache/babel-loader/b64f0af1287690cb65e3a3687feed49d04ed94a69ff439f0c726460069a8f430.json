{"ast":null,"code":"import _objectSpread from\"/Users/mmoola/Cursor/ProjectSetup/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect,useRef}from'react';import{X,Edit2,Download,BarChart3,RefreshCw,FileSpreadsheet,FileText,File}from'lucide-react';import{exportData}from'../../utils/crossFeature/exportService';import toast from'react-hot-toast';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ReportViewPanel=_ref=>{let{previewData,fieldLabelMap,reportName,onEdit,onClose,onLoadMore,hasMore,totalCount,canEdit=true}=_ref;const[showExportMenu,setShowExportMenu]=useState(false);const exportMenuRef=useRef(null);const[displayedData,setDisplayedData]=useState([]);const[loadingMore,setLoadingMore]=useState(false);const scrollContainerRef=useRef(null);const initialLoadSize=100;useEffect(()=>{if(previewData&&previewData.length>0){// Filter out attributes column and show all data\nconst filteredData=previewData.map(record=>{const cleaned=_objectSpread({},record);delete cleaned.attributes;return cleaned;});setDisplayedData(filteredData);// Show all records, not just first 100\n}else{setDisplayedData([]);}},[previewData]);// Listen for Quick Actions export event\nuseEffect(()=>{const handleQuickActionExport=event=>{if(displayedData&&displayedData.length>0){var _event$detail;const format=((_event$detail=event.detail)===null||_event$detail===void 0?void 0:_event$detail.format)||'excel';handleExport(format);}};window.addEventListener('quickActionExport',handleQuickActionExport);return()=>{window.removeEventListener('quickActionExport',handleQuickActionExport);};},[displayedData]);useEffect(()=>{const handleClickOutside=event=>{if(exportMenuRef.current&&!exportMenuRef.current.contains(event.target)){setShowExportMenu(false);}};if(showExportMenu){document.addEventListener('mousedown',handleClickOutside);}return()=>{document.removeEventListener('mousedown',handleClickOutside);};},[showExportMenu]);const handleExport=format=>{if(!displayedData||displayedData.length===0){toast.error('No data to export');return;}// Prepare data with field labels (same format as displayed in view)\nconst exportDataWithLabels=displayedData.filter(row=>!row._isGroupHeader)// Exclude group headers from export\n.map(row=>{const mappedRow={};Object.keys(row).forEach(key=>{if(key!=='attributes'&&!key.startsWith('_')){const label=fieldLabelMap[key]||key;// Handle relationship fields\nconst value=row[key];if(value&&typeof value==='object'&&value.Name){mappedRow[label]=value.Name;}else if(key.endsWith('__c')&&!key.includes('__r')){// Check for relationship field - try different patterns\nconst baseField=key.replace('__c','');const possibleRelationshipFields=[\"\".concat(baseField,\"__r.Name\"),\"\".concat(baseField,\".Name\"),\"\".concat(baseField,\"__r.name\"),\"\".concat(baseField,\".name\")];// Find the first matching relationship field\nlet foundRelField=null;for(const relField of possibleRelationshipFields){if(row[relField]!==undefined&&row[relField]!==null&&row[relField]!==''){foundRelField=row[relField];break;}}// Also check all keys for any relationship field that might match\nif(!foundRelField){const matchingRelField=Object.keys(row).find(k=>{if(k===key||k.startsWith('_'))return false;const lowerK=k.toLowerCase();const lowerBase=baseField.toLowerCase();return(lowerK.includes(lowerBase)||lowerK.includes(lowerBase.replace('_','')))&&(k.endsWith('.Name')||k.endsWith('.name')||k.endsWith('__r.Name')||k.endsWith('__r.name'));});if(matchingRelField&&row[matchingRelField]!==undefined&&row[matchingRelField]!==null&&row[matchingRelField]!==''){foundRelField=row[matchingRelField];}}mappedRow[label]=foundRelField||(value!==null&&value!==undefined?value:'');}else{mappedRow[label]=value!==null&&value!==undefined?value:'';}}});return mappedRow;});const result=exportData(exportDataWithLabels,reportName||'report',format);if(result.success){toast.success(\"Exported to \".concat(result.filename));}else{toast.error(result.error||'Export failed');}setShowExportMenu(false);};const handleScroll=()=>{if(!scrollContainerRef.current||loadingMore||!hasMore)return;const container=scrollContainerRef.current;const scrollTop=container.scrollTop;const scrollHeight=container.scrollHeight;const clientHeight=container.clientHeight;// Load more when user scrolls to within 200px of bottom\n// Only needed if we have more data from server (hasMore) and onLoadMore callback\nif(scrollTop+clientHeight>=scrollHeight-200){if(onLoadMore&&hasMore&&displayedData.length>=previewData.length){// Fetch more data from server\nsetLoadingMore(true);onLoadMore(displayedData.length).finally(()=>{setLoadingMore(false);});}}};useEffect(()=>{const container=scrollContainerRef.current;if(container){container.addEventListener('scroll',handleScroll);return()=>container.removeEventListener('scroll',handleScroll);}},[displayedData.length,hasMore,loadingMore]);const getFieldLabel=fieldName=>{// Special handling for common fields\nif(fieldName==='Id')return'Record ID';if(fieldName==='Name')return'Name';// Try exact match first\nif(fieldLabelMap&&fieldLabelMap[fieldName]){return fieldLabelMap[fieldName];}// Try alternative naming convention (__c vs _c__c)\n// Check if field ends with _c__c first (more specific)\nlet altName=null;if(fieldName.endsWith('_c__c')){// Convert _c__c to __c (e.g., Active_Contributors_c__c -> Active_Contributors__c)\naltName=fieldName.replace(/_c__c$/,'__c');}else if(fieldName.endsWith('__c')){// Convert __c to _c__c (e.g., Active_Contributors__c -> Active_Contributors_c__c)\naltName=fieldName.replace(/__c$/,'_c__c');}if(altName&&fieldLabelMap&&fieldLabelMap[altName]){return fieldLabelMap[altName];}// Fallback: try to create a readable label from the field name\nif(fieldName.includes('Active_Contributors'))return'Active Contributors';if(fieldName.includes('Applied_Contributors'))return'Applied Contributors';if(fieldName.includes('Qualified_Contributors'))return'Qualified Contributors';if(fieldName.includes('Removed'))return'Removed';// Default: return the field name\nreturn fieldName;};// Filter out attributes and internal metadata from column headers\nconst getColumns=()=>{if(displayedData.length===0)return[];// Get columns from first non-header row\nconst firstDataRow=displayedData.find(row=>!row._isGroupHeader);if(!firstDataRow)return[];const allKeys=Object.keys(firstDataRow);return allKeys.filter(key=>{// Exclude internal metadata fields\nif(key==='attributes'||key.startsWith('_'))return false;// Exclude nested relationship objects (e.g., Account__r) - always exclude these as they are objects\n// Relationship objects end with __r and don't contain a dot\nif(key.endsWith('__r')&&!key.includes('.')){const value=firstDataRow[key];// Always exclude relationship objects (they are nested objects, not displayable values)\nif(value&&typeof value==='object'&&!Array.isArray(value)){return false;}// Also exclude if it's null/undefined or any other type - we want the base field instead\nreturn false;}// Exclude relationship fields (e.g., Account__r.Name) if the base lookup field (e.g., Account__c) exists\n// This prevents showing both \"Account\" (from Account__c) and \"Account__r.Name\" columns\nif(key.includes('__r.')||key.includes('__r.Name')||key.includes('__r.name')){// Extract the base field name (e.g., Account__r.Name -> Account__c)\nconst baseFieldMatch=key.match(/^(.+?)__r\\./);if(baseFieldMatch){const baseField=\"\".concat(baseFieldMatch[1],\"__c\");// If the base lookup field exists, exclude the relationship field\nif(allKeys.includes(baseField)){return false;}}}return true;});};const columns=getColumns();return/*#__PURE__*/_jsxs(\"div\",{style:{background:'#fff',borderRadius:'8px',padding:'24px',boxShadow:'0 2px 4px rgba(0,0,0,0.1)',width:'100%',height:'calc(100vh - 200px)',display:'flex',flexDirection:'column'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:'16px'},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{style:{fontSize:'16px',fontWeight:'600',margin:0,marginBottom:'4px'},children:\"Report View\"}),/*#__PURE__*/_jsxs(\"div\",{style:{fontSize:'12px',color:'#666'},children:[\"Showing \",displayedData.length,\" of \",totalCount||previewData.length,\" \",totalCount||previewData.length===1?'entry':'entries']})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'8px',alignItems:'center',position:'relative'},children:[canEdit&&onEdit&&/*#__PURE__*/_jsxs(\"button\",{onClick:onEdit,style:{padding:'6px 12px',background:'#08979C',color:'#fff',border:'none',borderRadius:'4px',cursor:'pointer',fontSize:'12px',display:'flex',alignItems:'center',gap:'4px'},children:[/*#__PURE__*/_jsx(Edit2,{size:14}),\"Edit\"]}),/*#__PURE__*/_jsxs(\"div\",{ref:exportMenuRef,style:{position:'relative'},children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setShowExportMenu(!showExportMenu),style:{padding:'6px 12px',background:'#059669',color:'#fff',border:'none',borderRadius:'4px',cursor:'pointer',fontSize:'12px',display:'flex',alignItems:'center',gap:'4px'},children:[/*#__PURE__*/_jsx(Download,{size:14}),\"Export\"]}),showExportMenu&&/*#__PURE__*/_jsxs(\"div\",{style:{position:'absolute',top:'100%',right:0,marginTop:'4px',background:'#fff',border:'1px solid #d9d9d9',borderRadius:'6px',boxShadow:'0 4px 12px rgba(0,0,0,0.15)',zIndex:1000,minWidth:'150px',overflow:'hidden'},children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>handleExport('excel'),style:{width:'100%',padding:'8px 12px',background:'transparent',border:'none',cursor:'pointer',fontSize:'12px',textAlign:'left',display:'flex',alignItems:'center',gap:'8px',color:'#002329'},onMouseEnter:e=>e.target.style.background='#f5f5f5',onMouseLeave:e=>e.target.style.background='transparent',children:[/*#__PURE__*/_jsx(FileSpreadsheet,{size:14,color:\"#08979C\"}),\"Export as Excel (XLSX)\"]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>handleExport('csv'),style:{width:'100%',padding:'8px 12px',background:'transparent',border:'none',cursor:'pointer',fontSize:'12px',textAlign:'left',display:'flex',alignItems:'center',gap:'8px',color:'#002329',borderTop:'1px solid #f0f0f0'},onMouseEnter:e=>e.target.style.background='#f5f5f5',onMouseLeave:e=>e.target.style.background='transparent',children:[/*#__PURE__*/_jsx(FileText,{size:14,color:\"#08979C\"}),\"Export as CSV\"]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>handleExport('pdf'),style:{width:'100%',padding:'8px 12px',background:'transparent',border:'none',cursor:'pointer',fontSize:'12px',textAlign:'left',display:'flex',alignItems:'center',gap:'8px',color:'#002329',borderTop:'1px solid #f0f0f0'},onMouseEnter:e=>e.target.style.background='#f5f5f5',onMouseLeave:e=>e.target.style.background='transparent',children:[/*#__PURE__*/_jsx(File,{size:14,color:\"#08979C\"}),\"Export as PDF\"]})]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:onClose,style:{background:'none',border:'none',cursor:'pointer',padding:'4px'},children:/*#__PURE__*/_jsx(X,{size:18})})]})]}),displayedData.length>0?/*#__PURE__*/_jsxs(\"div\",{ref:scrollContainerRef,style:{border:'1px solid #e5e7eb',borderRadius:'6px',overflow:'auto',flex:1,minHeight:0},children:[/*#__PURE__*/_jsxs(\"table\",{style:{width:'100%',borderCollapse:'collapse',fontSize:'12px'},children:[/*#__PURE__*/_jsx(\"thead\",{style:{background:'#f9fafb',position:'sticky',top:0},children:/*#__PURE__*/_jsx(\"tr\",{children:columns.map(key=>/*#__PURE__*/_jsx(\"th\",{style:{padding:'8px 12px',textAlign:'left',borderBottom:'1px solid #e5e7eb',fontWeight:'600'},children:getFieldLabel(key)},key))})}),/*#__PURE__*/_jsx(\"tbody\",{children:displayedData.map((row,idx)=>{// Check if this is a group header row\nif(row._isGroupHeader){const groupLabel=fieldLabelMap[row._groupByField]||row._groupByField||'Group';// Prioritize _groupKey which should have the display value (name), not the ID\nlet groupValue=row._groupKey||'(No Value)';// If _groupKey is an ID (18 characters), try to find the relationship field\nif(typeof groupValue==='string'&&groupValue.length===18&&row._groupByField&&row._groupByField.endsWith('__c')){const baseField=row._groupByField.replace('__c','');const possibleRelFields=[\"\".concat(baseField,\"__r.Name\"),\"\".concat(baseField,\".Name\"),\"\".concat(baseField,\"__r.name\"),\"\".concat(baseField,\".name\")];for(const relField of possibleRelFields){if(row[relField]){groupValue=row[relField];break;}}// Also check for nested relationship object\nif(groupValue.length===18&&row[\"\".concat(baseField,\"__r\")]&&row[\"\".concat(baseField,\"__r\")].Name){groupValue=row[\"\".concat(baseField,\"__r\")].Name;}}return/*#__PURE__*/_jsx(\"tr\",{style:{background:'#f0f9ff',borderTop:'2px solid #08979C',borderBottom:'2px solid #08979C'},children:/*#__PURE__*/_jsxs(\"td\",{colSpan:columns.length,style:{padding:'12px 16px',fontWeight:'600',fontSize:'13px',color:'#08979C'},children:[groupLabel,\": \",groupValue]})},\"group-\".concat(idx));}// Regular data row\nreturn/*#__PURE__*/_jsx(\"tr\",{style:{borderBottom:'1px solid #f3f4f6'},children:columns.map((key,vIdx)=>{const value=row[key];// Handle relationship fields (e.g., Account__r.Name)\nif(value&&typeof value==='object'&&value.Name){return/*#__PURE__*/_jsx(\"td\",{style:{padding:'8px 12px'},children:value.Name},vIdx);}// Handle lookup fields - check for relationship Name fields\n// The relationship field could be Account__r.Name or Account.Name depending on metadata\nif(key.endsWith('__c')&&!key.includes('__r')){// First check if value is an ID (18 character Salesforce ID)\nconst isId=typeof value==='string'&&value.length===18;// Try different relationship field patterns\nconst baseField=key.replace('__c','');const possibleRelationshipFields=[\"\".concat(baseField,\"__r.Name\"),// Standard pattern: Account__c -> Account__r.Name\n\"\".concat(baseField,\".Name\"),// Alternative: Account__c -> Account.Name\n\"\".concat(baseField,\"__r.name\"),// Lowercase variant\n\"\".concat(baseField,\".name\")// Lowercase variant\n];// Find the first matching relationship field\nfor(const relField of possibleRelationshipFields){if(row[relField]!==undefined&&row[relField]!==null&&row[relField]!==''){return/*#__PURE__*/_jsx(\"td\",{style:{padding:'8px 12px'},children:row[relField]},vIdx);}}// Check if there's a nested relationship object (e.g., Account__r: { Name: \"Meta\" })\nconst relObjKey=\"\".concat(baseField,\"__r\");if(row[relObjKey]&&typeof row[relObjKey]==='object'&&row[relObjKey].Name){return/*#__PURE__*/_jsx(\"td\",{style:{padding:'8px 12px'},children:row[relObjKey].Name},vIdx);}// Also try without __r suffix\nconst relObjKey2=baseField;if(row[relObjKey2]&&typeof row[relObjKey2]==='object'&&row[relObjKey2].Name){return/*#__PURE__*/_jsx(\"td\",{style:{padding:'8px 12px'},children:row[relObjKey2].Name},vIdx);}// Also check all keys for any relationship field that might match\n// Look for fields that contain the base field name and end with .Name or __r.Name\nconst matchingRelField=Object.keys(row).find(k=>{if(k===key||k.startsWith('_'))return false;const lowerK=k.toLowerCase();const lowerBase=baseField.toLowerCase();return(lowerK.includes(lowerBase)||lowerK.includes(lowerBase.replace('_','')))&&(k.endsWith('.Name')||k.endsWith('.name')||k.endsWith('__r.Name')||k.endsWith('__r.name'));});if(matchingRelField&&row[matchingRelField]!==undefined&&row[matchingRelField]!==null&&row[matchingRelField]!==''){return/*#__PURE__*/_jsx(\"td\",{style:{padding:'8px 12px'},children:row[matchingRelField]},vIdx);}// If it's an ID and we couldn't find the relationship field, show the ID\n// (This means the relationship field wasn't queried or doesn't exist)\nif(isId){// Try to find any field that contains the base field name and has Name\nconst anyRelField=Object.keys(row).find(k=>{if(k===key||k.startsWith('_'))return false;const lowerK=k.toLowerCase();const lowerBase=baseField.toLowerCase();return(lowerK.includes(lowerBase)||lowerK.includes(lowerBase.replace('_','')))&&(k.includes('Name')||k.includes('name'));});if(anyRelField&&row[anyRelField]!==undefined&&row[anyRelField]!==null&&row[anyRelField]!==''){return/*#__PURE__*/_jsx(\"td\",{style:{padding:'8px 12px'},children:row[anyRelField]},vIdx);}}}// Handle count fields - ensure they display as numbers\nif(key.includes('Contributors')&&(typeof value==='number'||value===0)){return/*#__PURE__*/_jsx(\"td\",{style:{padding:'8px 12px',fontWeight:'500'},children:value},vIdx);}return/*#__PURE__*/_jsx(\"td\",{style:{padding:'8px 12px'},children:value!==null&&value!==undefined?String(value):'--'},vIdx);})},idx);})})]}),loadingMore&&/*#__PURE__*/_jsxs(\"div\",{style:{padding:'12px',textAlign:'center',fontSize:'12px',color:'#666'},children:[/*#__PURE__*/_jsx(RefreshCw,{size:16,className:\"spinning\",style:{display:'inline-block',marginRight:'8px'}}),\"Loading more records...\"]}),!hasMore&&displayedData.length>=(totalCount||previewData.length)&&/*#__PURE__*/_jsxs(\"div\",{style:{padding:'12px',textAlign:'center',fontSize:'12px',color:'#666'},children:[\"All \",totalCount||previewData.length,\" records loaded\"]})]}):/*#__PURE__*/_jsxs(\"div\",{style:{padding:'40px',textAlign:'center',color:'#666'},children:[/*#__PURE__*/_jsx(BarChart3,{size:32,style:{marginBottom:'12px',opacity:0.5}}),/*#__PURE__*/_jsx(\"p\",{children:\"No data to preview\"})]})]});};export default ReportViewPanel;","map":{"version":3,"names":["React","useState","useEffect","useRef","X","Edit2","Download","BarChart3","RefreshCw","FileSpreadsheet","FileText","File","exportData","toast","jsx","_jsx","jsxs","_jsxs","ReportViewPanel","_ref","previewData","fieldLabelMap","reportName","onEdit","onClose","onLoadMore","hasMore","totalCount","canEdit","showExportMenu","setShowExportMenu","exportMenuRef","displayedData","setDisplayedData","loadingMore","setLoadingMore","scrollContainerRef","initialLoadSize","length","filteredData","map","record","cleaned","_objectSpread","attributes","handleQuickActionExport","event","_event$detail","format","detail","handleExport","window","addEventListener","removeEventListener","handleClickOutside","current","contains","target","document","error","exportDataWithLabels","filter","row","_isGroupHeader","mappedRow","Object","keys","forEach","key","startsWith","label","value","Name","endsWith","includes","baseField","replace","possibleRelationshipFields","concat","foundRelField","relField","undefined","matchingRelField","find","k","lowerK","toLowerCase","lowerBase","result","success","filename","handleScroll","container","scrollTop","scrollHeight","clientHeight","finally","getFieldLabel","fieldName","altName","getColumns","firstDataRow","allKeys","Array","isArray","baseFieldMatch","match","columns","style","background","borderRadius","padding","boxShadow","width","height","display","flexDirection","children","justifyContent","alignItems","marginBottom","fontSize","fontWeight","margin","color","gap","position","onClick","border","cursor","size","ref","top","right","marginTop","zIndex","minWidth","overflow","textAlign","onMouseEnter","e","onMouseLeave","borderTop","flex","minHeight","borderCollapse","borderBottom","idx","groupLabel","_groupByField","groupValue","_groupKey","possibleRelFields","colSpan","vIdx","isId","relObjKey","relObjKey2","anyRelField","String","className","marginRight","opacity"],"sources":["/Users/mmoola/Cursor/ProjectSetup/client/src/components/ReportBuilder/ReportViewPanel.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport { X, Edit2, Download, BarChart3, RefreshCw, FileSpreadsheet, FileText, File } from 'lucide-react';\nimport { exportData } from '../../utils/crossFeature/exportService';\nimport toast from 'react-hot-toast';\n\nconst ReportViewPanel = ({\n  previewData,\n  fieldLabelMap,\n  reportName,\n  onEdit,\n  onClose,\n  onLoadMore,\n  hasMore,\n  totalCount,\n  canEdit = true\n}) => {\n  const [showExportMenu, setShowExportMenu] = useState(false);\n  const exportMenuRef = useRef(null);\n  const [displayedData, setDisplayedData] = useState([]);\n  const [loadingMore, setLoadingMore] = useState(false);\n  const scrollContainerRef = useRef(null);\n  const initialLoadSize = 100;\n\n  useEffect(() => {\n    if (previewData && previewData.length > 0) {\n      // Filter out attributes column and show all data\n      const filteredData = previewData.map(record => {\n        const cleaned = { ...record };\n        delete cleaned.attributes;\n        return cleaned;\n      });\n      setDisplayedData(filteredData); // Show all records, not just first 100\n    } else {\n      setDisplayedData([]);\n    }\n  }, [previewData]);\n\n  // Listen for Quick Actions export event\n  useEffect(() => {\n    const handleQuickActionExport = (event) => {\n      if (displayedData && displayedData.length > 0) {\n        const format = event.detail?.format || 'excel';\n        handleExport(format);\n      }\n    };\n\n    window.addEventListener('quickActionExport', handleQuickActionExport);\n    return () => {\n      window.removeEventListener('quickActionExport', handleQuickActionExport);\n    };\n  }, [displayedData]);\n\n  useEffect(() => {\n    const handleClickOutside = (event) => {\n      if (exportMenuRef.current && !exportMenuRef.current.contains(event.target)) {\n        setShowExportMenu(false);\n      }\n    };\n\n    if (showExportMenu) {\n      document.addEventListener('mousedown', handleClickOutside);\n    }\n\n    return () => {\n      document.removeEventListener('mousedown', handleClickOutside);\n    };\n  }, [showExportMenu]);\n\n  const handleExport = (format) => {\n    if (!displayedData || displayedData.length === 0) {\n      toast.error('No data to export');\n      return;\n    }\n\n    // Prepare data with field labels (same format as displayed in view)\n    const exportDataWithLabels = displayedData\n      .filter(row => !row._isGroupHeader) // Exclude group headers from export\n      .map(row => {\n        const mappedRow = {};\n        Object.keys(row).forEach(key => {\n          if (key !== 'attributes' && !key.startsWith('_')) {\n            const label = fieldLabelMap[key] || key;\n            // Handle relationship fields\n            const value = row[key];\n            if (value && typeof value === 'object' && value.Name) {\n              mappedRow[label] = value.Name;\n            } else if (key.endsWith('__c') && !key.includes('__r')) {\n              // Check for relationship field - try different patterns\n              const baseField = key.replace('__c', '');\n              const possibleRelationshipFields = [\n                `${baseField}__r.Name`,\n                `${baseField}.Name`,\n                `${baseField}__r.name`,\n                `${baseField}.name`\n              ];\n              \n              // Find the first matching relationship field\n              let foundRelField = null;\n              for (const relField of possibleRelationshipFields) {\n                if (row[relField] !== undefined && row[relField] !== null && row[relField] !== '') {\n                  foundRelField = row[relField];\n                  break;\n                }\n              }\n              \n              // Also check all keys for any relationship field that might match\n              if (!foundRelField) {\n                const matchingRelField = Object.keys(row).find(k => {\n                  if (k === key || k.startsWith('_')) return false;\n                  const lowerK = k.toLowerCase();\n                  const lowerBase = baseField.toLowerCase();\n                  return (lowerK.includes(lowerBase) || lowerK.includes(lowerBase.replace('_', ''))) && \n                         (k.endsWith('.Name') || k.endsWith('.name') || k.endsWith('__r.Name') || k.endsWith('__r.name'));\n                });\n                if (matchingRelField && row[matchingRelField] !== undefined && row[matchingRelField] !== null && row[matchingRelField] !== '') {\n                  foundRelField = row[matchingRelField];\n                }\n              }\n              \n              mappedRow[label] = foundRelField || (value !== null && value !== undefined ? value : '');\n            } else {\n              mappedRow[label] = value !== null && value !== undefined ? value : '';\n            }\n          }\n        });\n        return mappedRow;\n      });\n\n    const result = exportData(exportDataWithLabels, reportName || 'report', format);\n    if (result.success) {\n      toast.success(`Exported to ${result.filename}`);\n    } else {\n      toast.error(result.error || 'Export failed');\n    }\n    setShowExportMenu(false);\n  };\n\n  const handleScroll = () => {\n    if (!scrollContainerRef.current || loadingMore || !hasMore) return;\n\n    const container = scrollContainerRef.current;\n    const scrollTop = container.scrollTop;\n    const scrollHeight = container.scrollHeight;\n    const clientHeight = container.clientHeight;\n\n    // Load more when user scrolls to within 200px of bottom\n    // Only needed if we have more data from server (hasMore) and onLoadMore callback\n    if (scrollTop + clientHeight >= scrollHeight - 200) {\n      if (onLoadMore && hasMore && displayedData.length >= previewData.length) {\n        // Fetch more data from server\n        setLoadingMore(true);\n        onLoadMore(displayedData.length).finally(() => {\n          setLoadingMore(false);\n        });\n      }\n    }\n  };\n\n  useEffect(() => {\n    const container = scrollContainerRef.current;\n    if (container) {\n      container.addEventListener('scroll', handleScroll);\n      return () => container.removeEventListener('scroll', handleScroll);\n    }\n  }, [displayedData.length, hasMore, loadingMore]);\n\n  const getFieldLabel = (fieldName) => {\n    // Special handling for common fields\n    if (fieldName === 'Id') return 'Record ID';\n    if (fieldName === 'Name') return 'Name';\n    \n    // Try exact match first\n    if (fieldLabelMap && fieldLabelMap[fieldName]) {\n      return fieldLabelMap[fieldName];\n    }\n    // Try alternative naming convention (__c vs _c__c)\n    // Check if field ends with _c__c first (more specific)\n    let altName = null;\n    if (fieldName.endsWith('_c__c')) {\n      // Convert _c__c to __c (e.g., Active_Contributors_c__c -> Active_Contributors__c)\n      altName = fieldName.replace(/_c__c$/, '__c');\n    } else if (fieldName.endsWith('__c')) {\n      // Convert __c to _c__c (e.g., Active_Contributors__c -> Active_Contributors_c__c)\n      altName = fieldName.replace(/__c$/, '_c__c');\n    }\n    if (altName && fieldLabelMap && fieldLabelMap[altName]) {\n      return fieldLabelMap[altName];\n    }\n    // Fallback: try to create a readable label from the field name\n    if (fieldName.includes('Active_Contributors')) return 'Active Contributors';\n    if (fieldName.includes('Applied_Contributors')) return 'Applied Contributors';\n    if (fieldName.includes('Qualified_Contributors')) return 'Qualified Contributors';\n    if (fieldName.includes('Removed')) return 'Removed';\n    // Default: return the field name\n    return fieldName;\n  };\n\n  // Filter out attributes and internal metadata from column headers\n  const getColumns = () => {\n    if (displayedData.length === 0) return [];\n    // Get columns from first non-header row\n    const firstDataRow = displayedData.find(row => !row._isGroupHeader);\n    if (!firstDataRow) return [];\n    const allKeys = Object.keys(firstDataRow);\n    return allKeys.filter(key => {\n      // Exclude internal metadata fields\n      if (key === 'attributes' || key.startsWith('_')) return false;\n      \n      // Exclude nested relationship objects (e.g., Account__r) - always exclude these as they are objects\n      // Relationship objects end with __r and don't contain a dot\n      if (key.endsWith('__r') && !key.includes('.')) {\n        const value = firstDataRow[key];\n        // Always exclude relationship objects (they are nested objects, not displayable values)\n        if (value && typeof value === 'object' && !Array.isArray(value)) {\n          return false;\n        }\n        // Also exclude if it's null/undefined or any other type - we want the base field instead\n        return false;\n      }\n      \n      // Exclude relationship fields (e.g., Account__r.Name) if the base lookup field (e.g., Account__c) exists\n      // This prevents showing both \"Account\" (from Account__c) and \"Account__r.Name\" columns\n      if (key.includes('__r.') || key.includes('__r.Name') || key.includes('__r.name')) {\n        // Extract the base field name (e.g., Account__r.Name -> Account__c)\n        const baseFieldMatch = key.match(/^(.+?)__r\\./);\n        if (baseFieldMatch) {\n          const baseField = `${baseFieldMatch[1]}__c`;\n          // If the base lookup field exists, exclude the relationship field\n          if (allKeys.includes(baseField)) {\n            return false;\n          }\n        }\n      }\n      \n      return true;\n    });\n  };\n\n  const columns = getColumns();\n\n  return (\n    <div style={{ background: '#fff', borderRadius: '8px', padding: '24px', boxShadow: '0 2px 4px rgba(0,0,0,0.1)', width: '100%', height: 'calc(100vh - 200px)', display: 'flex', flexDirection: 'column' }}>\n      <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '16px' }}>\n        <div>\n          <h3 style={{ fontSize: '16px', fontWeight: '600', margin: 0, marginBottom: '4px' }}>\n            Report View\n          </h3>\n          <div style={{ fontSize: '12px', color: '#666' }}>\n            Showing {displayedData.length} of {totalCount || previewData.length} {totalCount || previewData.length === 1 ? 'entry' : 'entries'}\n          </div>\n        </div>\n        <div style={{ display: 'flex', gap: '8px', alignItems: 'center', position: 'relative' }}>\n          {canEdit && onEdit && (\n            <button\n              onClick={onEdit}\n              style={{\n                padding: '6px 12px',\n                background: '#08979C',\n                color: '#fff',\n                border: 'none',\n                borderRadius: '4px',\n                cursor: 'pointer',\n                fontSize: '12px',\n                display: 'flex',\n                alignItems: 'center',\n                gap: '4px'\n              }}\n            >\n              <Edit2 size={14} />\n              Edit\n            </button>\n          )}\n          <div ref={exportMenuRef} style={{ position: 'relative' }}>\n            <button\n              onClick={() => setShowExportMenu(!showExportMenu)}\n              style={{\n                padding: '6px 12px',\n                background: '#059669',\n                color: '#fff',\n                border: 'none',\n                borderRadius: '4px',\n                cursor: 'pointer',\n                fontSize: '12px',\n                display: 'flex',\n                alignItems: 'center',\n                gap: '4px'\n              }}\n            >\n              <Download size={14} />\n              Export\n            </button>\n            {showExportMenu && (\n              <div style={{\n                position: 'absolute',\n                top: '100%',\n                right: 0,\n                marginTop: '4px',\n                background: '#fff',\n                border: '1px solid #d9d9d9',\n                borderRadius: '6px',\n                boxShadow: '0 4px 12px rgba(0,0,0,0.15)',\n                zIndex: 1000,\n                minWidth: '150px',\n                overflow: 'hidden'\n              }}>\n                <button\n                  onClick={() => handleExport('excel')}\n                  style={{\n                    width: '100%',\n                    padding: '8px 12px',\n                    background: 'transparent',\n                    border: 'none',\n                    cursor: 'pointer',\n                    fontSize: '12px',\n                    textAlign: 'left',\n                    display: 'flex',\n                    alignItems: 'center',\n                    gap: '8px',\n                    color: '#002329'\n                  }}\n                  onMouseEnter={(e) => e.target.style.background = '#f5f5f5'}\n                  onMouseLeave={(e) => e.target.style.background = 'transparent'}\n                >\n                  <FileSpreadsheet size={14} color=\"#08979C\" />\n                  Export as Excel (XLSX)\n                </button>\n                <button\n                  onClick={() => handleExport('csv')}\n                  style={{\n                    width: '100%',\n                    padding: '8px 12px',\n                    background: 'transparent',\n                    border: 'none',\n                    cursor: 'pointer',\n                    fontSize: '12px',\n                    textAlign: 'left',\n                    display: 'flex',\n                    alignItems: 'center',\n                    gap: '8px',\n                    color: '#002329',\n                    borderTop: '1px solid #f0f0f0'\n                  }}\n                  onMouseEnter={(e) => e.target.style.background = '#f5f5f5'}\n                  onMouseLeave={(e) => e.target.style.background = 'transparent'}\n                >\n                  <FileText size={14} color=\"#08979C\" />\n                  Export as CSV\n                </button>\n                <button\n                  onClick={() => handleExport('pdf')}\n                  style={{\n                    width: '100%',\n                    padding: '8px 12px',\n                    background: 'transparent',\n                    border: 'none',\n                    cursor: 'pointer',\n                    fontSize: '12px',\n                    textAlign: 'left',\n                    display: 'flex',\n                    alignItems: 'center',\n                    gap: '8px',\n                    color: '#002329',\n                    borderTop: '1px solid #f0f0f0'\n                  }}\n                  onMouseEnter={(e) => e.target.style.background = '#f5f5f5'}\n                  onMouseLeave={(e) => e.target.style.background = 'transparent'}\n                >\n                  <File size={14} color=\"#08979C\" />\n                  Export as PDF\n                </button>\n              </div>\n            )}\n          </div>\n          <button\n            onClick={onClose}\n            style={{\n              background: 'none',\n              border: 'none',\n              cursor: 'pointer',\n              padding: '4px'\n            }}\n          >\n            <X size={18} />\n          </button>\n        </div>\n      </div>\n      {displayedData.length > 0 ? (\n        <div \n          ref={scrollContainerRef}\n          style={{ \n            border: '1px solid #e5e7eb', \n            borderRadius: '6px', \n            overflow: 'auto', \n            flex: 1,\n            minHeight: 0\n          }}\n        >\n          <table style={{ width: '100%', borderCollapse: 'collapse', fontSize: '12px' }}>\n            <thead style={{ background: '#f9fafb', position: 'sticky', top: 0 }}>\n              <tr>\n                {columns.map(key => (\n                  <th key={key} style={{ padding: '8px 12px', textAlign: 'left', borderBottom: '1px solid #e5e7eb', fontWeight: '600' }}>\n                    {getFieldLabel(key)}\n                  </th>\n                ))}\n              </tr>\n            </thead>\n            <tbody>\n              {displayedData.map((row, idx) => {\n                // Check if this is a group header row\n                if (row._isGroupHeader) {\n                  const groupLabel = fieldLabelMap[row._groupByField] || row._groupByField || 'Group';\n                  // Prioritize _groupKey which should have the display value (name), not the ID\n                  let groupValue = row._groupKey || '(No Value)';\n                  \n                  // If _groupKey is an ID (18 characters), try to find the relationship field\n                  if (typeof groupValue === 'string' && groupValue.length === 18 && row._groupByField && row._groupByField.endsWith('__c')) {\n                    const baseField = row._groupByField.replace('__c', '');\n                    const possibleRelFields = [\n                      `${baseField}__r.Name`,\n                      `${baseField}.Name`,\n                      `${baseField}__r.name`,\n                      `${baseField}.name`\n                    ];\n                    for (const relField of possibleRelFields) {\n                      if (row[relField]) {\n                        groupValue = row[relField];\n                        break;\n                      }\n                    }\n                    // Also check for nested relationship object\n                    if (groupValue.length === 18 && row[`${baseField}__r`] && row[`${baseField}__r`].Name) {\n                      groupValue = row[`${baseField}__r`].Name;\n                    }\n                  }\n                  \n                  return (\n                    <tr key={`group-${idx}`} style={{ background: '#f0f9ff', borderTop: '2px solid #08979C', borderBottom: '2px solid #08979C' }}>\n                      <td colSpan={columns.length} style={{ padding: '12px 16px', fontWeight: '600', fontSize: '13px', color: '#08979C' }}>\n                        {groupLabel}: {groupValue}\n                      </td>\n                    </tr>\n                  );\n                }\n                \n                // Regular data row\n                return (\n                  <tr key={idx} style={{ borderBottom: '1px solid #f3f4f6' }}>\n                    {columns.map((key, vIdx) => {\n                      const value = row[key];\n                      \n                      \n                      // Handle relationship fields (e.g., Account__r.Name)\n                      if (value && typeof value === 'object' && value.Name) {\n                        return (\n                          <td key={vIdx} style={{ padding: '8px 12px' }}>\n                            {value.Name}\n                          </td>\n                        );\n                      }\n                      // Handle lookup fields - check for relationship Name fields\n                      // The relationship field could be Account__r.Name or Account.Name depending on metadata\n                      if (key.endsWith('__c') && !key.includes('__r')) {\n                        // First check if value is an ID (18 character Salesforce ID)\n                        const isId = typeof value === 'string' && value.length === 18;\n                        \n                        // Try different relationship field patterns\n                        const baseField = key.replace('__c', '');\n                        const possibleRelationshipFields = [\n                          `${baseField}__r.Name`,  // Standard pattern: Account__c -> Account__r.Name\n                          `${baseField}.Name`,     // Alternative: Account__c -> Account.Name\n                          `${baseField}__r.name`,  // Lowercase variant\n                          `${baseField}.name`      // Lowercase variant\n                        ];\n                        \n                        // Find the first matching relationship field\n                        for (const relField of possibleRelationshipFields) {\n                          if (row[relField] !== undefined && row[relField] !== null && row[relField] !== '') {\n                            return (\n                              <td key={vIdx} style={{ padding: '8px 12px' }}>\n                                {row[relField]}\n                              </td>\n                            );\n                          }\n                        }\n                        \n                        // Check if there's a nested relationship object (e.g., Account__r: { Name: \"Meta\" })\n                        const relObjKey = `${baseField}__r`;\n                        if (row[relObjKey] && typeof row[relObjKey] === 'object' && row[relObjKey].Name) {\n                          return (\n                            <td key={vIdx} style={{ padding: '8px 12px' }}>\n                              {row[relObjKey].Name}\n                            </td>\n                          );\n                        }\n                        \n                        // Also try without __r suffix\n                        const relObjKey2 = baseField;\n                        if (row[relObjKey2] && typeof row[relObjKey2] === 'object' && row[relObjKey2].Name) {\n                          return (\n                            <td key={vIdx} style={{ padding: '8px 12px' }}>\n                              {row[relObjKey2].Name}\n                            </td>\n                          );\n                        }\n                        \n                        // Also check all keys for any relationship field that might match\n                        // Look for fields that contain the base field name and end with .Name or __r.Name\n                        const matchingRelField = Object.keys(row).find(k => {\n                          if (k === key || k.startsWith('_')) return false;\n                          const lowerK = k.toLowerCase();\n                          const lowerBase = baseField.toLowerCase();\n                          return (lowerK.includes(lowerBase) || lowerK.includes(lowerBase.replace('_', ''))) && \n                                 (k.endsWith('.Name') || k.endsWith('.name') || k.endsWith('__r.Name') || k.endsWith('__r.name'));\n                        });\n                        if (matchingRelField && row[matchingRelField] !== undefined && row[matchingRelField] !== null && row[matchingRelField] !== '') {\n                          return (\n                            <td key={vIdx} style={{ padding: '8px 12px' }}>\n                              {row[matchingRelField]}\n                            </td>\n                          );\n                        }\n                        \n                        // If it's an ID and we couldn't find the relationship field, show the ID\n                        // (This means the relationship field wasn't queried or doesn't exist)\n                        if (isId) {\n                          // Try to find any field that contains the base field name and has Name\n                          const anyRelField = Object.keys(row).find(k => {\n                            if (k === key || k.startsWith('_')) return false;\n                            const lowerK = k.toLowerCase();\n                            const lowerBase = baseField.toLowerCase();\n                            return (lowerK.includes(lowerBase) || lowerK.includes(lowerBase.replace('_', ''))) && \n                                   (k.includes('Name') || k.includes('name'));\n                          });\n                          if (anyRelField && row[anyRelField] !== undefined && row[anyRelField] !== null && row[anyRelField] !== '') {\n                            return (\n                              <td key={vIdx} style={{ padding: '8px 12px' }}>\n                                {row[anyRelField]}\n                              </td>\n                            );\n                          }\n                        }\n                      }\n                      // Handle count fields - ensure they display as numbers\n                      if (key.includes('Contributors') && (typeof value === 'number' || value === 0)) {\n                        return (\n                          <td key={vIdx} style={{ padding: '8px 12px', fontWeight: '500' }}>\n                            {value}\n                          </td>\n                        );\n                      }\n                      return (\n                        <td key={vIdx} style={{ padding: '8px 12px' }}>\n                          {value !== null && value !== undefined ? String(value) : '--'}\n                        </td>\n                      );\n                    })}\n                  </tr>\n                );\n              })}\n            </tbody>\n          </table>\n          {loadingMore && (\n            <div style={{ padding: '12px', textAlign: 'center', fontSize: '12px', color: '#666' }}>\n              <RefreshCw size={16} className=\"spinning\" style={{ display: 'inline-block', marginRight: '8px' }} />\n              Loading more records...\n            </div>\n          )}\n          {!hasMore && displayedData.length >= (totalCount || previewData.length) && (\n            <div style={{ padding: '12px', textAlign: 'center', fontSize: '12px', color: '#666' }}>\n              All {totalCount || previewData.length} records loaded\n            </div>\n          )}\n        </div>\n      ) : (\n        <div style={{ padding: '40px', textAlign: 'center', color: '#666' }}>\n          <BarChart3 size={32} style={{ marginBottom: '12px', opacity: 0.5 }} />\n          <p>No data to preview</p>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default ReportViewPanel;\n"],"mappings":"6HAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,CAAEC,MAAM,KAAQ,OAAO,CAC1D,OAASC,CAAC,CAAEC,KAAK,CAAEC,QAAQ,CAAEC,SAAS,CAAEC,SAAS,CAAEC,eAAe,CAAEC,QAAQ,CAAEC,IAAI,KAAQ,cAAc,CACxG,OAASC,UAAU,KAAQ,wCAAwC,CACnE,MAAO,CAAAC,KAAK,KAAM,iBAAiB,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAEpC,KAAM,CAAAC,eAAe,CAAGC,IAAA,EAUlB,IAVmB,CACvBC,WAAW,CACXC,aAAa,CACbC,UAAU,CACVC,MAAM,CACNC,OAAO,CACPC,UAAU,CACVC,OAAO,CACPC,UAAU,CACVC,OAAO,CAAG,IACZ,CAAC,CAAAT,IAAA,CACC,KAAM,CAACU,cAAc,CAAEC,iBAAiB,CAAC,CAAG7B,QAAQ,CAAC,KAAK,CAAC,CAC3D,KAAM,CAAA8B,aAAa,CAAG5B,MAAM,CAAC,IAAI,CAAC,CAClC,KAAM,CAAC6B,aAAa,CAAEC,gBAAgB,CAAC,CAAGhC,QAAQ,CAAC,EAAE,CAAC,CACtD,KAAM,CAACiC,WAAW,CAAEC,cAAc,CAAC,CAAGlC,QAAQ,CAAC,KAAK,CAAC,CACrD,KAAM,CAAAmC,kBAAkB,CAAGjC,MAAM,CAAC,IAAI,CAAC,CACvC,KAAM,CAAAkC,eAAe,CAAG,GAAG,CAE3BnC,SAAS,CAAC,IAAM,CACd,GAAIkB,WAAW,EAAIA,WAAW,CAACkB,MAAM,CAAG,CAAC,CAAE,CACzC;AACA,KAAM,CAAAC,YAAY,CAAGnB,WAAW,CAACoB,GAAG,CAACC,MAAM,EAAI,CAC7C,KAAM,CAAAC,OAAO,CAAAC,aAAA,IAAQF,MAAM,CAAE,CAC7B,MAAO,CAAAC,OAAO,CAACE,UAAU,CACzB,MAAO,CAAAF,OAAO,CAChB,CAAC,CAAC,CACFT,gBAAgB,CAACM,YAAY,CAAC,CAAE;AAClC,CAAC,IAAM,CACLN,gBAAgB,CAAC,EAAE,CAAC,CACtB,CACF,CAAC,CAAE,CAACb,WAAW,CAAC,CAAC,CAEjB;AACAlB,SAAS,CAAC,IAAM,CACd,KAAM,CAAA2C,uBAAuB,CAAIC,KAAK,EAAK,CACzC,GAAId,aAAa,EAAIA,aAAa,CAACM,MAAM,CAAG,CAAC,CAAE,KAAAS,aAAA,CAC7C,KAAM,CAAAC,MAAM,CAAG,EAAAD,aAAA,CAAAD,KAAK,CAACG,MAAM,UAAAF,aAAA,iBAAZA,aAAA,CAAcC,MAAM,GAAI,OAAO,CAC9CE,YAAY,CAACF,MAAM,CAAC,CACtB,CACF,CAAC,CAEDG,MAAM,CAACC,gBAAgB,CAAC,mBAAmB,CAAEP,uBAAuB,CAAC,CACrE,MAAO,IAAM,CACXM,MAAM,CAACE,mBAAmB,CAAC,mBAAmB,CAAER,uBAAuB,CAAC,CAC1E,CAAC,CACH,CAAC,CAAE,CAACb,aAAa,CAAC,CAAC,CAEnB9B,SAAS,CAAC,IAAM,CACd,KAAM,CAAAoD,kBAAkB,CAAIR,KAAK,EAAK,CACpC,GAAIf,aAAa,CAACwB,OAAO,EAAI,CAACxB,aAAa,CAACwB,OAAO,CAACC,QAAQ,CAACV,KAAK,CAACW,MAAM,CAAC,CAAE,CAC1E3B,iBAAiB,CAAC,KAAK,CAAC,CAC1B,CACF,CAAC,CAED,GAAID,cAAc,CAAE,CAClB6B,QAAQ,CAACN,gBAAgB,CAAC,WAAW,CAAEE,kBAAkB,CAAC,CAC5D,CAEA,MAAO,IAAM,CACXI,QAAQ,CAACL,mBAAmB,CAAC,WAAW,CAAEC,kBAAkB,CAAC,CAC/D,CAAC,CACH,CAAC,CAAE,CAACzB,cAAc,CAAC,CAAC,CAEpB,KAAM,CAAAqB,YAAY,CAAIF,MAAM,EAAK,CAC/B,GAAI,CAAChB,aAAa,EAAIA,aAAa,CAACM,MAAM,GAAK,CAAC,CAAE,CAChDzB,KAAK,CAAC8C,KAAK,CAAC,mBAAmB,CAAC,CAChC,OACF,CAEA;AACA,KAAM,CAAAC,oBAAoB,CAAG5B,aAAa,CACvC6B,MAAM,CAACC,GAAG,EAAI,CAACA,GAAG,CAACC,cAAc,CAAE;AAAA,CACnCvB,GAAG,CAACsB,GAAG,EAAI,CACV,KAAM,CAAAE,SAAS,CAAG,CAAC,CAAC,CACpBC,MAAM,CAACC,IAAI,CAACJ,GAAG,CAAC,CAACK,OAAO,CAACC,GAAG,EAAI,CAC9B,GAAIA,GAAG,GAAK,YAAY,EAAI,CAACA,GAAG,CAACC,UAAU,CAAC,GAAG,CAAC,CAAE,CAChD,KAAM,CAAAC,KAAK,CAAGjD,aAAa,CAAC+C,GAAG,CAAC,EAAIA,GAAG,CACvC;AACA,KAAM,CAAAG,KAAK,CAAGT,GAAG,CAACM,GAAG,CAAC,CACtB,GAAIG,KAAK,EAAI,MAAO,CAAAA,KAAK,GAAK,QAAQ,EAAIA,KAAK,CAACC,IAAI,CAAE,CACpDR,SAAS,CAACM,KAAK,CAAC,CAAGC,KAAK,CAACC,IAAI,CAC/B,CAAC,IAAM,IAAIJ,GAAG,CAACK,QAAQ,CAAC,KAAK,CAAC,EAAI,CAACL,GAAG,CAACM,QAAQ,CAAC,KAAK,CAAC,CAAE,CACtD;AACA,KAAM,CAAAC,SAAS,CAAGP,GAAG,CAACQ,OAAO,CAAC,KAAK,CAAE,EAAE,CAAC,CACxC,KAAM,CAAAC,0BAA0B,CAAG,IAAAC,MAAA,CAC9BH,SAAS,gBAAAG,MAAA,CACTH,SAAS,aAAAG,MAAA,CACTH,SAAS,gBAAAG,MAAA,CACTH,SAAS,UACb,CAED;AACA,GAAI,CAAAI,aAAa,CAAG,IAAI,CACxB,IAAK,KAAM,CAAAC,QAAQ,GAAI,CAAAH,0BAA0B,CAAE,CACjD,GAAIf,GAAG,CAACkB,QAAQ,CAAC,GAAKC,SAAS,EAAInB,GAAG,CAACkB,QAAQ,CAAC,GAAK,IAAI,EAAIlB,GAAG,CAACkB,QAAQ,CAAC,GAAK,EAAE,CAAE,CACjFD,aAAa,CAAGjB,GAAG,CAACkB,QAAQ,CAAC,CAC7B,MACF,CACF,CAEA;AACA,GAAI,CAACD,aAAa,CAAE,CAClB,KAAM,CAAAG,gBAAgB,CAAGjB,MAAM,CAACC,IAAI,CAACJ,GAAG,CAAC,CAACqB,IAAI,CAACC,CAAC,EAAI,CAClD,GAAIA,CAAC,GAAKhB,GAAG,EAAIgB,CAAC,CAACf,UAAU,CAAC,GAAG,CAAC,CAAE,MAAO,MAAK,CAChD,KAAM,CAAAgB,MAAM,CAAGD,CAAC,CAACE,WAAW,CAAC,CAAC,CAC9B,KAAM,CAAAC,SAAS,CAAGZ,SAAS,CAACW,WAAW,CAAC,CAAC,CACzC,MAAO,CAACD,MAAM,CAACX,QAAQ,CAACa,SAAS,CAAC,EAAIF,MAAM,CAACX,QAAQ,CAACa,SAAS,CAACX,OAAO,CAAC,GAAG,CAAE,EAAE,CAAC,CAAC,IACzEQ,CAAC,CAACX,QAAQ,CAAC,OAAO,CAAC,EAAIW,CAAC,CAACX,QAAQ,CAAC,OAAO,CAAC,EAAIW,CAAC,CAACX,QAAQ,CAAC,UAAU,CAAC,EAAIW,CAAC,CAACX,QAAQ,CAAC,UAAU,CAAC,CAAC,CACzG,CAAC,CAAC,CACF,GAAIS,gBAAgB,EAAIpB,GAAG,CAACoB,gBAAgB,CAAC,GAAKD,SAAS,EAAInB,GAAG,CAACoB,gBAAgB,CAAC,GAAK,IAAI,EAAIpB,GAAG,CAACoB,gBAAgB,CAAC,GAAK,EAAE,CAAE,CAC7HH,aAAa,CAAGjB,GAAG,CAACoB,gBAAgB,CAAC,CACvC,CACF,CAEAlB,SAAS,CAACM,KAAK,CAAC,CAAGS,aAAa,GAAKR,KAAK,GAAK,IAAI,EAAIA,KAAK,GAAKU,SAAS,CAAGV,KAAK,CAAG,EAAE,CAAC,CAC1F,CAAC,IAAM,CACLP,SAAS,CAACM,KAAK,CAAC,CAAGC,KAAK,GAAK,IAAI,EAAIA,KAAK,GAAKU,SAAS,CAAGV,KAAK,CAAG,EAAE,CACvE,CACF,CACF,CAAC,CAAC,CACF,MAAO,CAAAP,SAAS,CAClB,CAAC,CAAC,CAEJ,KAAM,CAAAwB,MAAM,CAAG5E,UAAU,CAACgD,oBAAoB,CAAEtC,UAAU,EAAI,QAAQ,CAAE0B,MAAM,CAAC,CAC/E,GAAIwC,MAAM,CAACC,OAAO,CAAE,CAClB5E,KAAK,CAAC4E,OAAO,gBAAAX,MAAA,CAAgBU,MAAM,CAACE,QAAQ,CAAE,CAAC,CACjD,CAAC,IAAM,CACL7E,KAAK,CAAC8C,KAAK,CAAC6B,MAAM,CAAC7B,KAAK,EAAI,eAAe,CAAC,CAC9C,CACA7B,iBAAiB,CAAC,KAAK,CAAC,CAC1B,CAAC,CAED,KAAM,CAAA6D,YAAY,CAAGA,CAAA,GAAM,CACzB,GAAI,CAACvD,kBAAkB,CAACmB,OAAO,EAAIrB,WAAW,EAAI,CAACR,OAAO,CAAE,OAE5D,KAAM,CAAAkE,SAAS,CAAGxD,kBAAkB,CAACmB,OAAO,CAC5C,KAAM,CAAAsC,SAAS,CAAGD,SAAS,CAACC,SAAS,CACrC,KAAM,CAAAC,YAAY,CAAGF,SAAS,CAACE,YAAY,CAC3C,KAAM,CAAAC,YAAY,CAAGH,SAAS,CAACG,YAAY,CAE3C;AACA;AACA,GAAIF,SAAS,CAAGE,YAAY,EAAID,YAAY,CAAG,GAAG,CAAE,CAClD,GAAIrE,UAAU,EAAIC,OAAO,EAAIM,aAAa,CAACM,MAAM,EAAIlB,WAAW,CAACkB,MAAM,CAAE,CACvE;AACAH,cAAc,CAAC,IAAI,CAAC,CACpBV,UAAU,CAACO,aAAa,CAACM,MAAM,CAAC,CAAC0D,OAAO,CAAC,IAAM,CAC7C7D,cAAc,CAAC,KAAK,CAAC,CACvB,CAAC,CAAC,CACJ,CACF,CACF,CAAC,CAEDjC,SAAS,CAAC,IAAM,CACd,KAAM,CAAA0F,SAAS,CAAGxD,kBAAkB,CAACmB,OAAO,CAC5C,GAAIqC,SAAS,CAAE,CACbA,SAAS,CAACxC,gBAAgB,CAAC,QAAQ,CAAEuC,YAAY,CAAC,CAClD,MAAO,IAAMC,SAAS,CAACvC,mBAAmB,CAAC,QAAQ,CAAEsC,YAAY,CAAC,CACpE,CACF,CAAC,CAAE,CAAC3D,aAAa,CAACM,MAAM,CAAEZ,OAAO,CAAEQ,WAAW,CAAC,CAAC,CAEhD,KAAM,CAAA+D,aAAa,CAAIC,SAAS,EAAK,CACnC;AACA,GAAIA,SAAS,GAAK,IAAI,CAAE,MAAO,WAAW,CAC1C,GAAIA,SAAS,GAAK,MAAM,CAAE,MAAO,MAAM,CAEvC;AACA,GAAI7E,aAAa,EAAIA,aAAa,CAAC6E,SAAS,CAAC,CAAE,CAC7C,MAAO,CAAA7E,aAAa,CAAC6E,SAAS,CAAC,CACjC,CACA;AACA;AACA,GAAI,CAAAC,OAAO,CAAG,IAAI,CAClB,GAAID,SAAS,CAACzB,QAAQ,CAAC,OAAO,CAAC,CAAE,CAC/B;AACA0B,OAAO,CAAGD,SAAS,CAACtB,OAAO,CAAC,QAAQ,CAAE,KAAK,CAAC,CAC9C,CAAC,IAAM,IAAIsB,SAAS,CAACzB,QAAQ,CAAC,KAAK,CAAC,CAAE,CACpC;AACA0B,OAAO,CAAGD,SAAS,CAACtB,OAAO,CAAC,MAAM,CAAE,OAAO,CAAC,CAC9C,CACA,GAAIuB,OAAO,EAAI9E,aAAa,EAAIA,aAAa,CAAC8E,OAAO,CAAC,CAAE,CACtD,MAAO,CAAA9E,aAAa,CAAC8E,OAAO,CAAC,CAC/B,CACA;AACA,GAAID,SAAS,CAACxB,QAAQ,CAAC,qBAAqB,CAAC,CAAE,MAAO,qBAAqB,CAC3E,GAAIwB,SAAS,CAACxB,QAAQ,CAAC,sBAAsB,CAAC,CAAE,MAAO,sBAAsB,CAC7E,GAAIwB,SAAS,CAACxB,QAAQ,CAAC,wBAAwB,CAAC,CAAE,MAAO,wBAAwB,CACjF,GAAIwB,SAAS,CAACxB,QAAQ,CAAC,SAAS,CAAC,CAAE,MAAO,SAAS,CACnD;AACA,MAAO,CAAAwB,SAAS,CAClB,CAAC,CAED;AACA,KAAM,CAAAE,UAAU,CAAGA,CAAA,GAAM,CACvB,GAAIpE,aAAa,CAACM,MAAM,GAAK,CAAC,CAAE,MAAO,EAAE,CACzC;AACA,KAAM,CAAA+D,YAAY,CAAGrE,aAAa,CAACmD,IAAI,CAACrB,GAAG,EAAI,CAACA,GAAG,CAACC,cAAc,CAAC,CACnE,GAAI,CAACsC,YAAY,CAAE,MAAO,EAAE,CAC5B,KAAM,CAAAC,OAAO,CAAGrC,MAAM,CAACC,IAAI,CAACmC,YAAY,CAAC,CACzC,MAAO,CAAAC,OAAO,CAACzC,MAAM,CAACO,GAAG,EAAI,CAC3B;AACA,GAAIA,GAAG,GAAK,YAAY,EAAIA,GAAG,CAACC,UAAU,CAAC,GAAG,CAAC,CAAE,MAAO,MAAK,CAE7D;AACA;AACA,GAAID,GAAG,CAACK,QAAQ,CAAC,KAAK,CAAC,EAAI,CAACL,GAAG,CAACM,QAAQ,CAAC,GAAG,CAAC,CAAE,CAC7C,KAAM,CAAAH,KAAK,CAAG8B,YAAY,CAACjC,GAAG,CAAC,CAC/B;AACA,GAAIG,KAAK,EAAI,MAAO,CAAAA,KAAK,GAAK,QAAQ,EAAI,CAACgC,KAAK,CAACC,OAAO,CAACjC,KAAK,CAAC,CAAE,CAC/D,MAAO,MAAK,CACd,CACA;AACA,MAAO,MAAK,CACd,CAEA;AACA;AACA,GAAIH,GAAG,CAACM,QAAQ,CAAC,MAAM,CAAC,EAAIN,GAAG,CAACM,QAAQ,CAAC,UAAU,CAAC,EAAIN,GAAG,CAACM,QAAQ,CAAC,UAAU,CAAC,CAAE,CAChF;AACA,KAAM,CAAA+B,cAAc,CAAGrC,GAAG,CAACsC,KAAK,CAAC,aAAa,CAAC,CAC/C,GAAID,cAAc,CAAE,CAClB,KAAM,CAAA9B,SAAS,IAAAG,MAAA,CAAM2B,cAAc,CAAC,CAAC,CAAC,OAAK,CAC3C;AACA,GAAIH,OAAO,CAAC5B,QAAQ,CAACC,SAAS,CAAC,CAAE,CAC/B,MAAO,MAAK,CACd,CACF,CACF,CAEA,MAAO,KAAI,CACb,CAAC,CAAC,CACJ,CAAC,CAED,KAAM,CAAAgC,OAAO,CAAGP,UAAU,CAAC,CAAC,CAE5B,mBACEnF,KAAA,QAAK2F,KAAK,CAAE,CAAEC,UAAU,CAAE,MAAM,CAAEC,YAAY,CAAE,KAAK,CAAEC,OAAO,CAAE,MAAM,CAAEC,SAAS,CAAE,2BAA2B,CAAEC,KAAK,CAAE,MAAM,CAAEC,MAAM,CAAE,qBAAqB,CAAEC,OAAO,CAAE,MAAM,CAAEC,aAAa,CAAE,QAAS,CAAE,CAAAC,QAAA,eACvMpG,KAAA,QAAK2F,KAAK,CAAE,CAAEO,OAAO,CAAE,MAAM,CAAEG,cAAc,CAAE,eAAe,CAAEC,UAAU,CAAE,QAAQ,CAAEC,YAAY,CAAE,MAAO,CAAE,CAAAH,QAAA,eAC3GpG,KAAA,QAAAoG,QAAA,eACEtG,IAAA,OAAI6F,KAAK,CAAE,CAAEa,QAAQ,CAAE,MAAM,CAAEC,UAAU,CAAE,KAAK,CAAEC,MAAM,CAAE,CAAC,CAAEH,YAAY,CAAE,KAAM,CAAE,CAAAH,QAAA,CAAC,aAEpF,CAAI,CAAC,cACLpG,KAAA,QAAK2F,KAAK,CAAE,CAAEa,QAAQ,CAAE,MAAM,CAAEG,KAAK,CAAE,MAAO,CAAE,CAAAP,QAAA,EAAC,UACvC,CAACrF,aAAa,CAACM,MAAM,CAAC,MAAI,CAACX,UAAU,EAAIP,WAAW,CAACkB,MAAM,CAAC,GAAC,CAACX,UAAU,EAAIP,WAAW,CAACkB,MAAM,GAAK,CAAC,CAAG,OAAO,CAAG,SAAS,EAC/H,CAAC,EACH,CAAC,cACNrB,KAAA,QAAK2F,KAAK,CAAE,CAAEO,OAAO,CAAE,MAAM,CAAEU,GAAG,CAAE,KAAK,CAAEN,UAAU,CAAE,QAAQ,CAAEO,QAAQ,CAAE,UAAW,CAAE,CAAAT,QAAA,EACrFzF,OAAO,EAAIL,MAAM,eAChBN,KAAA,WACE8G,OAAO,CAAExG,MAAO,CAChBqF,KAAK,CAAE,CACLG,OAAO,CAAE,UAAU,CACnBF,UAAU,CAAE,SAAS,CACrBe,KAAK,CAAE,MAAM,CACbI,MAAM,CAAE,MAAM,CACdlB,YAAY,CAAE,KAAK,CACnBmB,MAAM,CAAE,SAAS,CACjBR,QAAQ,CAAE,MAAM,CAChBN,OAAO,CAAE,MAAM,CACfI,UAAU,CAAE,QAAQ,CACpBM,GAAG,CAAE,KACP,CAAE,CAAAR,QAAA,eAEFtG,IAAA,CAACV,KAAK,EAAC6H,IAAI,CAAE,EAAG,CAAE,CAAC,OAErB,EAAQ,CACT,cACDjH,KAAA,QAAKkH,GAAG,CAAEpG,aAAc,CAAC6E,KAAK,CAAE,CAAEkB,QAAQ,CAAE,UAAW,CAAE,CAAAT,QAAA,eACvDpG,KAAA,WACE8G,OAAO,CAAEA,CAAA,GAAMjG,iBAAiB,CAAC,CAACD,cAAc,CAAE,CAClD+E,KAAK,CAAE,CACLG,OAAO,CAAE,UAAU,CACnBF,UAAU,CAAE,SAAS,CACrBe,KAAK,CAAE,MAAM,CACbI,MAAM,CAAE,MAAM,CACdlB,YAAY,CAAE,KAAK,CACnBmB,MAAM,CAAE,SAAS,CACjBR,QAAQ,CAAE,MAAM,CAChBN,OAAO,CAAE,MAAM,CACfI,UAAU,CAAE,QAAQ,CACpBM,GAAG,CAAE,KACP,CAAE,CAAAR,QAAA,eAEFtG,IAAA,CAACT,QAAQ,EAAC4H,IAAI,CAAE,EAAG,CAAE,CAAC,SAExB,EAAQ,CAAC,CACRrG,cAAc,eACbZ,KAAA,QAAK2F,KAAK,CAAE,CACVkB,QAAQ,CAAE,UAAU,CACpBM,GAAG,CAAE,MAAM,CACXC,KAAK,CAAE,CAAC,CACRC,SAAS,CAAE,KAAK,CAChBzB,UAAU,CAAE,MAAM,CAClBmB,MAAM,CAAE,mBAAmB,CAC3BlB,YAAY,CAAE,KAAK,CACnBE,SAAS,CAAE,6BAA6B,CACxCuB,MAAM,CAAE,IAAI,CACZC,QAAQ,CAAE,OAAO,CACjBC,QAAQ,CAAE,QACZ,CAAE,CAAApB,QAAA,eACApG,KAAA,WACE8G,OAAO,CAAEA,CAAA,GAAM7E,YAAY,CAAC,OAAO,CAAE,CACrC0D,KAAK,CAAE,CACLK,KAAK,CAAE,MAAM,CACbF,OAAO,CAAE,UAAU,CACnBF,UAAU,CAAE,aAAa,CACzBmB,MAAM,CAAE,MAAM,CACdC,MAAM,CAAE,SAAS,CACjBR,QAAQ,CAAE,MAAM,CAChBiB,SAAS,CAAE,MAAM,CACjBvB,OAAO,CAAE,MAAM,CACfI,UAAU,CAAE,QAAQ,CACpBM,GAAG,CAAE,KAAK,CACVD,KAAK,CAAE,SACT,CAAE,CACFe,YAAY,CAAGC,CAAC,EAAKA,CAAC,CAACnF,MAAM,CAACmD,KAAK,CAACC,UAAU,CAAG,SAAU,CAC3DgC,YAAY,CAAGD,CAAC,EAAKA,CAAC,CAACnF,MAAM,CAACmD,KAAK,CAACC,UAAU,CAAG,aAAc,CAAAQ,QAAA,eAE/DtG,IAAA,CAACN,eAAe,EAACyH,IAAI,CAAE,EAAG,CAACN,KAAK,CAAC,SAAS,CAAE,CAAC,yBAE/C,EAAQ,CAAC,cACT3G,KAAA,WACE8G,OAAO,CAAEA,CAAA,GAAM7E,YAAY,CAAC,KAAK,CAAE,CACnC0D,KAAK,CAAE,CACLK,KAAK,CAAE,MAAM,CACbF,OAAO,CAAE,UAAU,CACnBF,UAAU,CAAE,aAAa,CACzBmB,MAAM,CAAE,MAAM,CACdC,MAAM,CAAE,SAAS,CACjBR,QAAQ,CAAE,MAAM,CAChBiB,SAAS,CAAE,MAAM,CACjBvB,OAAO,CAAE,MAAM,CACfI,UAAU,CAAE,QAAQ,CACpBM,GAAG,CAAE,KAAK,CACVD,KAAK,CAAE,SAAS,CAChBkB,SAAS,CAAE,mBACb,CAAE,CACFH,YAAY,CAAGC,CAAC,EAAKA,CAAC,CAACnF,MAAM,CAACmD,KAAK,CAACC,UAAU,CAAG,SAAU,CAC3DgC,YAAY,CAAGD,CAAC,EAAKA,CAAC,CAACnF,MAAM,CAACmD,KAAK,CAACC,UAAU,CAAG,aAAc,CAAAQ,QAAA,eAE/DtG,IAAA,CAACL,QAAQ,EAACwH,IAAI,CAAE,EAAG,CAACN,KAAK,CAAC,SAAS,CAAE,CAAC,gBAExC,EAAQ,CAAC,cACT3G,KAAA,WACE8G,OAAO,CAAEA,CAAA,GAAM7E,YAAY,CAAC,KAAK,CAAE,CACnC0D,KAAK,CAAE,CACLK,KAAK,CAAE,MAAM,CACbF,OAAO,CAAE,UAAU,CACnBF,UAAU,CAAE,aAAa,CACzBmB,MAAM,CAAE,MAAM,CACdC,MAAM,CAAE,SAAS,CACjBR,QAAQ,CAAE,MAAM,CAChBiB,SAAS,CAAE,MAAM,CACjBvB,OAAO,CAAE,MAAM,CACfI,UAAU,CAAE,QAAQ,CACpBM,GAAG,CAAE,KAAK,CACVD,KAAK,CAAE,SAAS,CAChBkB,SAAS,CAAE,mBACb,CAAE,CACFH,YAAY,CAAGC,CAAC,EAAKA,CAAC,CAACnF,MAAM,CAACmD,KAAK,CAACC,UAAU,CAAG,SAAU,CAC3DgC,YAAY,CAAGD,CAAC,EAAKA,CAAC,CAACnF,MAAM,CAACmD,KAAK,CAACC,UAAU,CAAG,aAAc,CAAAQ,QAAA,eAE/DtG,IAAA,CAACJ,IAAI,EAACuH,IAAI,CAAE,EAAG,CAACN,KAAK,CAAC,SAAS,CAAE,CAAC,gBAEpC,EAAQ,CAAC,EACN,CACN,EACE,CAAC,cACN7G,IAAA,WACEgH,OAAO,CAAEvG,OAAQ,CACjBoF,KAAK,CAAE,CACLC,UAAU,CAAE,MAAM,CAClBmB,MAAM,CAAE,MAAM,CACdC,MAAM,CAAE,SAAS,CACjBlB,OAAO,CAAE,KACX,CAAE,CAAAM,QAAA,cAEFtG,IAAA,CAACX,CAAC,EAAC8H,IAAI,CAAE,EAAG,CAAE,CAAC,CACT,CAAC,EACN,CAAC,EACH,CAAC,CACLlG,aAAa,CAACM,MAAM,CAAG,CAAC,cACvBrB,KAAA,QACEkH,GAAG,CAAE/F,kBAAmB,CACxBwE,KAAK,CAAE,CACLoB,MAAM,CAAE,mBAAmB,CAC3BlB,YAAY,CAAE,KAAK,CACnB2B,QAAQ,CAAE,MAAM,CAChBM,IAAI,CAAE,CAAC,CACPC,SAAS,CAAE,CACb,CAAE,CAAA3B,QAAA,eAEFpG,KAAA,UAAO2F,KAAK,CAAE,CAAEK,KAAK,CAAE,MAAM,CAAEgC,cAAc,CAAE,UAAU,CAAExB,QAAQ,CAAE,MAAO,CAAE,CAAAJ,QAAA,eAC5EtG,IAAA,UAAO6F,KAAK,CAAE,CAAEC,UAAU,CAAE,SAAS,CAAEiB,QAAQ,CAAE,QAAQ,CAAEM,GAAG,CAAE,CAAE,CAAE,CAAAf,QAAA,cAClEtG,IAAA,OAAAsG,QAAA,CACGV,OAAO,CAACnE,GAAG,CAAC4B,GAAG,eACdrD,IAAA,OAAc6F,KAAK,CAAE,CAAEG,OAAO,CAAE,UAAU,CAAE2B,SAAS,CAAE,MAAM,CAAEQ,YAAY,CAAE,mBAAmB,CAAExB,UAAU,CAAE,KAAM,CAAE,CAAAL,QAAA,CACnHpB,aAAa,CAAC7B,GAAG,CAAC,EADZA,GAEL,CACL,CAAC,CACA,CAAC,CACA,CAAC,cACRrD,IAAA,UAAAsG,QAAA,CACGrF,aAAa,CAACQ,GAAG,CAAC,CAACsB,GAAG,CAAEqF,GAAG,GAAK,CAC/B;AACA,GAAIrF,GAAG,CAACC,cAAc,CAAE,CACtB,KAAM,CAAAqF,UAAU,CAAG/H,aAAa,CAACyC,GAAG,CAACuF,aAAa,CAAC,EAAIvF,GAAG,CAACuF,aAAa,EAAI,OAAO,CACnF;AACA,GAAI,CAAAC,UAAU,CAAGxF,GAAG,CAACyF,SAAS,EAAI,YAAY,CAE9C;AACA,GAAI,MAAO,CAAAD,UAAU,GAAK,QAAQ,EAAIA,UAAU,CAAChH,MAAM,GAAK,EAAE,EAAIwB,GAAG,CAACuF,aAAa,EAAIvF,GAAG,CAACuF,aAAa,CAAC5E,QAAQ,CAAC,KAAK,CAAC,CAAE,CACxH,KAAM,CAAAE,SAAS,CAAGb,GAAG,CAACuF,aAAa,CAACzE,OAAO,CAAC,KAAK,CAAE,EAAE,CAAC,CACtD,KAAM,CAAA4E,iBAAiB,CAAG,IAAA1E,MAAA,CACrBH,SAAS,gBAAAG,MAAA,CACTH,SAAS,aAAAG,MAAA,CACTH,SAAS,gBAAAG,MAAA,CACTH,SAAS,UACb,CACD,IAAK,KAAM,CAAAK,QAAQ,GAAI,CAAAwE,iBAAiB,CAAE,CACxC,GAAI1F,GAAG,CAACkB,QAAQ,CAAC,CAAE,CACjBsE,UAAU,CAAGxF,GAAG,CAACkB,QAAQ,CAAC,CAC1B,MACF,CACF,CACA;AACA,GAAIsE,UAAU,CAAChH,MAAM,GAAK,EAAE,EAAIwB,GAAG,IAAAgB,MAAA,CAAIH,SAAS,QAAM,EAAIb,GAAG,IAAAgB,MAAA,CAAIH,SAAS,QAAM,CAACH,IAAI,CAAE,CACrF8E,UAAU,CAAGxF,GAAG,IAAAgB,MAAA,CAAIH,SAAS,QAAM,CAACH,IAAI,CAC1C,CACF,CAEA,mBACEzD,IAAA,OAAyB6F,KAAK,CAAE,CAAEC,UAAU,CAAE,SAAS,CAAEiC,SAAS,CAAE,mBAAmB,CAAEI,YAAY,CAAE,mBAAoB,CAAE,CAAA7B,QAAA,cAC3HpG,KAAA,OAAIwI,OAAO,CAAE9C,OAAO,CAACrE,MAAO,CAACsE,KAAK,CAAE,CAAEG,OAAO,CAAE,WAAW,CAAEW,UAAU,CAAE,KAAK,CAAED,QAAQ,CAAE,MAAM,CAAEG,KAAK,CAAE,SAAU,CAAE,CAAAP,QAAA,EACjH+B,UAAU,CAAC,IAAE,CAACE,UAAU,EACvB,CAAC,WAAAxE,MAAA,CAHWqE,GAAG,CAIjB,CAAC,CAET,CAEA;AACA,mBACEpI,IAAA,OAAc6F,KAAK,CAAE,CAAEsC,YAAY,CAAE,mBAAoB,CAAE,CAAA7B,QAAA,CACxDV,OAAO,CAACnE,GAAG,CAAC,CAAC4B,GAAG,CAAEsF,IAAI,GAAK,CAC1B,KAAM,CAAAnF,KAAK,CAAGT,GAAG,CAACM,GAAG,CAAC,CAGtB;AACA,GAAIG,KAAK,EAAI,MAAO,CAAAA,KAAK,GAAK,QAAQ,EAAIA,KAAK,CAACC,IAAI,CAAE,CACpD,mBACEzD,IAAA,OAAe6F,KAAK,CAAE,CAAEG,OAAO,CAAE,UAAW,CAAE,CAAAM,QAAA,CAC3C9C,KAAK,CAACC,IAAI,EADJkF,IAEL,CAAC,CAET,CACA;AACA;AACA,GAAItF,GAAG,CAACK,QAAQ,CAAC,KAAK,CAAC,EAAI,CAACL,GAAG,CAACM,QAAQ,CAAC,KAAK,CAAC,CAAE,CAC/C;AACA,KAAM,CAAAiF,IAAI,CAAG,MAAO,CAAApF,KAAK,GAAK,QAAQ,EAAIA,KAAK,CAACjC,MAAM,GAAK,EAAE,CAE7D;AACA,KAAM,CAAAqC,SAAS,CAAGP,GAAG,CAACQ,OAAO,CAAC,KAAK,CAAE,EAAE,CAAC,CACxC,KAAM,CAAAC,0BAA0B,CAAG,IAAAC,MAAA,CAC9BH,SAAS,aAAa;AAAA,GAAAG,MAAA,CACtBH,SAAS,UAAa;AAAA,GAAAG,MAAA,CACtBH,SAAS,aAAa;AAAA,GAAAG,MAAA,CACtBH,SAAS,SAAa;AAAA,CAC1B,CAED;AACA,IAAK,KAAM,CAAAK,QAAQ,GAAI,CAAAH,0BAA0B,CAAE,CACjD,GAAIf,GAAG,CAACkB,QAAQ,CAAC,GAAKC,SAAS,EAAInB,GAAG,CAACkB,QAAQ,CAAC,GAAK,IAAI,EAAIlB,GAAG,CAACkB,QAAQ,CAAC,GAAK,EAAE,CAAE,CACjF,mBACEjE,IAAA,OAAe6F,KAAK,CAAE,CAAEG,OAAO,CAAE,UAAW,CAAE,CAAAM,QAAA,CAC3CvD,GAAG,CAACkB,QAAQ,CAAC,EADP0E,IAEL,CAAC,CAET,CACF,CAEA;AACA,KAAM,CAAAE,SAAS,IAAA9E,MAAA,CAAMH,SAAS,OAAK,CACnC,GAAIb,GAAG,CAAC8F,SAAS,CAAC,EAAI,MAAO,CAAA9F,GAAG,CAAC8F,SAAS,CAAC,GAAK,QAAQ,EAAI9F,GAAG,CAAC8F,SAAS,CAAC,CAACpF,IAAI,CAAE,CAC/E,mBACEzD,IAAA,OAAe6F,KAAK,CAAE,CAAEG,OAAO,CAAE,UAAW,CAAE,CAAAM,QAAA,CAC3CvD,GAAG,CAAC8F,SAAS,CAAC,CAACpF,IAAI,EADbkF,IAEL,CAAC,CAET,CAEA;AACA,KAAM,CAAAG,UAAU,CAAGlF,SAAS,CAC5B,GAAIb,GAAG,CAAC+F,UAAU,CAAC,EAAI,MAAO,CAAA/F,GAAG,CAAC+F,UAAU,CAAC,GAAK,QAAQ,EAAI/F,GAAG,CAAC+F,UAAU,CAAC,CAACrF,IAAI,CAAE,CAClF,mBACEzD,IAAA,OAAe6F,KAAK,CAAE,CAAEG,OAAO,CAAE,UAAW,CAAE,CAAAM,QAAA,CAC3CvD,GAAG,CAAC+F,UAAU,CAAC,CAACrF,IAAI,EADdkF,IAEL,CAAC,CAET,CAEA;AACA;AACA,KAAM,CAAAxE,gBAAgB,CAAGjB,MAAM,CAACC,IAAI,CAACJ,GAAG,CAAC,CAACqB,IAAI,CAACC,CAAC,EAAI,CAClD,GAAIA,CAAC,GAAKhB,GAAG,EAAIgB,CAAC,CAACf,UAAU,CAAC,GAAG,CAAC,CAAE,MAAO,MAAK,CAChD,KAAM,CAAAgB,MAAM,CAAGD,CAAC,CAACE,WAAW,CAAC,CAAC,CAC9B,KAAM,CAAAC,SAAS,CAAGZ,SAAS,CAACW,WAAW,CAAC,CAAC,CACzC,MAAO,CAACD,MAAM,CAACX,QAAQ,CAACa,SAAS,CAAC,EAAIF,MAAM,CAACX,QAAQ,CAACa,SAAS,CAACX,OAAO,CAAC,GAAG,CAAE,EAAE,CAAC,CAAC,IACzEQ,CAAC,CAACX,QAAQ,CAAC,OAAO,CAAC,EAAIW,CAAC,CAACX,QAAQ,CAAC,OAAO,CAAC,EAAIW,CAAC,CAACX,QAAQ,CAAC,UAAU,CAAC,EAAIW,CAAC,CAACX,QAAQ,CAAC,UAAU,CAAC,CAAC,CACzG,CAAC,CAAC,CACF,GAAIS,gBAAgB,EAAIpB,GAAG,CAACoB,gBAAgB,CAAC,GAAKD,SAAS,EAAInB,GAAG,CAACoB,gBAAgB,CAAC,GAAK,IAAI,EAAIpB,GAAG,CAACoB,gBAAgB,CAAC,GAAK,EAAE,CAAE,CAC7H,mBACEnE,IAAA,OAAe6F,KAAK,CAAE,CAAEG,OAAO,CAAE,UAAW,CAAE,CAAAM,QAAA,CAC3CvD,GAAG,CAACoB,gBAAgB,CAAC,EADfwE,IAEL,CAAC,CAET,CAEA;AACA;AACA,GAAIC,IAAI,CAAE,CACR;AACA,KAAM,CAAAG,WAAW,CAAG7F,MAAM,CAACC,IAAI,CAACJ,GAAG,CAAC,CAACqB,IAAI,CAACC,CAAC,EAAI,CAC7C,GAAIA,CAAC,GAAKhB,GAAG,EAAIgB,CAAC,CAACf,UAAU,CAAC,GAAG,CAAC,CAAE,MAAO,MAAK,CAChD,KAAM,CAAAgB,MAAM,CAAGD,CAAC,CAACE,WAAW,CAAC,CAAC,CAC9B,KAAM,CAAAC,SAAS,CAAGZ,SAAS,CAACW,WAAW,CAAC,CAAC,CACzC,MAAO,CAACD,MAAM,CAACX,QAAQ,CAACa,SAAS,CAAC,EAAIF,MAAM,CAACX,QAAQ,CAACa,SAAS,CAACX,OAAO,CAAC,GAAG,CAAE,EAAE,CAAC,CAAC,IACzEQ,CAAC,CAACV,QAAQ,CAAC,MAAM,CAAC,EAAIU,CAAC,CAACV,QAAQ,CAAC,MAAM,CAAC,CAAC,CACnD,CAAC,CAAC,CACF,GAAIoF,WAAW,EAAIhG,GAAG,CAACgG,WAAW,CAAC,GAAK7E,SAAS,EAAInB,GAAG,CAACgG,WAAW,CAAC,GAAK,IAAI,EAAIhG,GAAG,CAACgG,WAAW,CAAC,GAAK,EAAE,CAAE,CACzG,mBACE/I,IAAA,OAAe6F,KAAK,CAAE,CAAEG,OAAO,CAAE,UAAW,CAAE,CAAAM,QAAA,CAC3CvD,GAAG,CAACgG,WAAW,CAAC,EADVJ,IAEL,CAAC,CAET,CACF,CACF,CACA;AACA,GAAItF,GAAG,CAACM,QAAQ,CAAC,cAAc,CAAC,GAAK,MAAO,CAAAH,KAAK,GAAK,QAAQ,EAAIA,KAAK,GAAK,CAAC,CAAC,CAAE,CAC9E,mBACExD,IAAA,OAAe6F,KAAK,CAAE,CAAEG,OAAO,CAAE,UAAU,CAAEW,UAAU,CAAE,KAAM,CAAE,CAAAL,QAAA,CAC9D9C,KAAK,EADCmF,IAEL,CAAC,CAET,CACA,mBACE3I,IAAA,OAAe6F,KAAK,CAAE,CAAEG,OAAO,CAAE,UAAW,CAAE,CAAAM,QAAA,CAC3C9C,KAAK,GAAK,IAAI,EAAIA,KAAK,GAAKU,SAAS,CAAG8E,MAAM,CAACxF,KAAK,CAAC,CAAG,IAAI,EADtDmF,IAEL,CAAC,CAET,CAAC,CAAC,EA7GKP,GA8GL,CAAC,CAET,CAAC,CAAC,CACG,CAAC,EACH,CAAC,CACPjH,WAAW,eACVjB,KAAA,QAAK2F,KAAK,CAAE,CAAEG,OAAO,CAAE,MAAM,CAAE2B,SAAS,CAAE,QAAQ,CAAEjB,QAAQ,CAAE,MAAM,CAAEG,KAAK,CAAE,MAAO,CAAE,CAAAP,QAAA,eACpFtG,IAAA,CAACP,SAAS,EAAC0H,IAAI,CAAE,EAAG,CAAC8B,SAAS,CAAC,UAAU,CAACpD,KAAK,CAAE,CAAEO,OAAO,CAAE,cAAc,CAAE8C,WAAW,CAAE,KAAM,CAAE,CAAE,CAAC,0BAEtG,EAAK,CACN,CACA,CAACvI,OAAO,EAAIM,aAAa,CAACM,MAAM,GAAKX,UAAU,EAAIP,WAAW,CAACkB,MAAM,CAAC,eACrErB,KAAA,QAAK2F,KAAK,CAAE,CAAEG,OAAO,CAAE,MAAM,CAAE2B,SAAS,CAAE,QAAQ,CAAEjB,QAAQ,CAAE,MAAM,CAAEG,KAAK,CAAE,MAAO,CAAE,CAAAP,QAAA,EAAC,MACjF,CAAC1F,UAAU,EAAIP,WAAW,CAACkB,MAAM,CAAC,iBACxC,EAAK,CACN,EACE,CAAC,cAENrB,KAAA,QAAK2F,KAAK,CAAE,CAAEG,OAAO,CAAE,MAAM,CAAE2B,SAAS,CAAE,QAAQ,CAAEd,KAAK,CAAE,MAAO,CAAE,CAAAP,QAAA,eAClEtG,IAAA,CAACR,SAAS,EAAC2H,IAAI,CAAE,EAAG,CAACtB,KAAK,CAAE,CAAEY,YAAY,CAAE,MAAM,CAAE0C,OAAO,CAAE,GAAI,CAAE,CAAE,CAAC,cACtEnJ,IAAA,MAAAsG,QAAA,CAAG,oBAAkB,CAAG,CAAC,EACtB,CACN,EACE,CAAC,CAEV,CAAC,CAED,cAAe,CAAAnG,eAAe","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}