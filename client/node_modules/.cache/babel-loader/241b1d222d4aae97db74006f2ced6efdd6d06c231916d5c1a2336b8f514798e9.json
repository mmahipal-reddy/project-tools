{"ast":null,"code":"// Custom hook for transformation history (undo/redo)\nimport{useState,useEffect,useCallback}from'react';import{MAX_HISTORY_STATES}from'../constants';export const useTransformationHistory=fieldMappings=>{const[transformationHistory,setTransformationHistory]=useState([]);const[historyIndex,setHistoryIndex]=useState(-1);// Track history when mappings change\nuseEffect(()=>{if(fieldMappings.length>0){const currentState=JSON.parse(JSON.stringify(fieldMappings));setTransformationHistory(prev=>{const newHistory=prev.slice(0,historyIndex+1);newHistory.push(currentState);if(newHistory.length>MAX_HISTORY_STATES){newHistory.shift();}return newHistory;});setHistoryIndex(prev=>Math.min(prev+1,MAX_HISTORY_STATES-1));}},[fieldMappings.length]);// Only track when mappings are added/removed\nconst undo=useCallback(setFieldMappings=>{if(historyIndex>0){const newIndex=historyIndex-1;setHistoryIndex(newIndex);setFieldMappings(JSON.parse(JSON.stringify(transformationHistory[newIndex])));return true;}return false;},[historyIndex,transformationHistory]);const redo=useCallback(setFieldMappings=>{if(historyIndex<transformationHistory.length-1){const newIndex=historyIndex+1;setHistoryIndex(newIndex);setFieldMappings(JSON.parse(JSON.stringify(transformationHistory[newIndex])));return true;}return false;},[historyIndex,transformationHistory]);const canUndo=historyIndex>0;const canRedo=historyIndex<transformationHistory.length-1;return{undo,redo,canUndo,canRedo};};","map":{"version":3,"names":["useState","useEffect","useCallback","MAX_HISTORY_STATES","useTransformationHistory","fieldMappings","transformationHistory","setTransformationHistory","historyIndex","setHistoryIndex","length","currentState","JSON","parse","stringify","prev","newHistory","slice","push","shift","Math","min","undo","setFieldMappings","newIndex","redo","canUndo","canRedo"],"sources":["/Users/mmoola/Documents/GitHub/project-tools/client/src/pages/UpdateObjectFields/hooks/useTransformationHistory.js"],"sourcesContent":["// Custom hook for transformation history (undo/redo)\n\nimport { useState, useEffect, useCallback } from 'react';\nimport { MAX_HISTORY_STATES } from '../constants';\n\nexport const useTransformationHistory = (fieldMappings) => {\n  const [transformationHistory, setTransformationHistory] = useState([]);\n  const [historyIndex, setHistoryIndex] = useState(-1);\n\n  // Track history when mappings change\n  useEffect(() => {\n    if (fieldMappings.length > 0) {\n      const currentState = JSON.parse(JSON.stringify(fieldMappings));\n      setTransformationHistory(prev => {\n        const newHistory = prev.slice(0, historyIndex + 1);\n        newHistory.push(currentState);\n        if (newHistory.length > MAX_HISTORY_STATES) {\n          newHistory.shift();\n        }\n        return newHistory;\n      });\n      setHistoryIndex(prev => Math.min(prev + 1, MAX_HISTORY_STATES - 1));\n    }\n  }, [fieldMappings.length]); // Only track when mappings are added/removed\n\n  const undo = useCallback((setFieldMappings) => {\n    if (historyIndex > 0) {\n      const newIndex = historyIndex - 1;\n      setHistoryIndex(newIndex);\n      setFieldMappings(JSON.parse(JSON.stringify(transformationHistory[newIndex])));\n      return true;\n    }\n    return false;\n  }, [historyIndex, transformationHistory]);\n\n  const redo = useCallback((setFieldMappings) => {\n    if (historyIndex < transformationHistory.length - 1) {\n      const newIndex = historyIndex + 1;\n      setHistoryIndex(newIndex);\n      setFieldMappings(JSON.parse(JSON.stringify(transformationHistory[newIndex])));\n      return true;\n    }\n    return false;\n  }, [historyIndex, transformationHistory]);\n\n  const canUndo = historyIndex > 0;\n  const canRedo = historyIndex < transformationHistory.length - 1;\n\n  return {\n    undo,\n    redo,\n    canUndo,\n    canRedo\n  };\n};\n\n"],"mappings":"AAAA;AAEA,OAASA,QAAQ,CAAEC,SAAS,CAAEC,WAAW,KAAQ,OAAO,CACxD,OAASC,kBAAkB,KAAQ,cAAc,CAEjD,MAAO,MAAM,CAAAC,wBAAwB,CAAIC,aAAa,EAAK,CACzD,KAAM,CAACC,qBAAqB,CAAEC,wBAAwB,CAAC,CAAGP,QAAQ,CAAC,EAAE,CAAC,CACtE,KAAM,CAACQ,YAAY,CAAEC,eAAe,CAAC,CAAGT,QAAQ,CAAC,CAAC,CAAC,CAAC,CAEpD;AACAC,SAAS,CAAC,IAAM,CACd,GAAII,aAAa,CAACK,MAAM,CAAG,CAAC,CAAE,CAC5B,KAAM,CAAAC,YAAY,CAAGC,IAAI,CAACC,KAAK,CAACD,IAAI,CAACE,SAAS,CAACT,aAAa,CAAC,CAAC,CAC9DE,wBAAwB,CAACQ,IAAI,EAAI,CAC/B,KAAM,CAAAC,UAAU,CAAGD,IAAI,CAACE,KAAK,CAAC,CAAC,CAAET,YAAY,CAAG,CAAC,CAAC,CAClDQ,UAAU,CAACE,IAAI,CAACP,YAAY,CAAC,CAC7B,GAAIK,UAAU,CAACN,MAAM,CAAGP,kBAAkB,CAAE,CAC1Ca,UAAU,CAACG,KAAK,CAAC,CAAC,CACpB,CACA,MAAO,CAAAH,UAAU,CACnB,CAAC,CAAC,CACFP,eAAe,CAACM,IAAI,EAAIK,IAAI,CAACC,GAAG,CAACN,IAAI,CAAG,CAAC,CAAEZ,kBAAkB,CAAG,CAAC,CAAC,CAAC,CACrE,CACF,CAAC,CAAE,CAACE,aAAa,CAACK,MAAM,CAAC,CAAC,CAAE;AAE5B,KAAM,CAAAY,IAAI,CAAGpB,WAAW,CAAEqB,gBAAgB,EAAK,CAC7C,GAAIf,YAAY,CAAG,CAAC,CAAE,CACpB,KAAM,CAAAgB,QAAQ,CAAGhB,YAAY,CAAG,CAAC,CACjCC,eAAe,CAACe,QAAQ,CAAC,CACzBD,gBAAgB,CAACX,IAAI,CAACC,KAAK,CAACD,IAAI,CAACE,SAAS,CAACR,qBAAqB,CAACkB,QAAQ,CAAC,CAAC,CAAC,CAAC,CAC7E,MAAO,KAAI,CACb,CACA,MAAO,MAAK,CACd,CAAC,CAAE,CAAChB,YAAY,CAAEF,qBAAqB,CAAC,CAAC,CAEzC,KAAM,CAAAmB,IAAI,CAAGvB,WAAW,CAAEqB,gBAAgB,EAAK,CAC7C,GAAIf,YAAY,CAAGF,qBAAqB,CAACI,MAAM,CAAG,CAAC,CAAE,CACnD,KAAM,CAAAc,QAAQ,CAAGhB,YAAY,CAAG,CAAC,CACjCC,eAAe,CAACe,QAAQ,CAAC,CACzBD,gBAAgB,CAACX,IAAI,CAACC,KAAK,CAACD,IAAI,CAACE,SAAS,CAACR,qBAAqB,CAACkB,QAAQ,CAAC,CAAC,CAAC,CAAC,CAC7E,MAAO,KAAI,CACb,CACA,MAAO,MAAK,CACd,CAAC,CAAE,CAAChB,YAAY,CAAEF,qBAAqB,CAAC,CAAC,CAEzC,KAAM,CAAAoB,OAAO,CAAGlB,YAAY,CAAG,CAAC,CAChC,KAAM,CAAAmB,OAAO,CAAGnB,YAAY,CAAGF,qBAAqB,CAACI,MAAM,CAAG,CAAC,CAE/D,MAAO,CACLY,IAAI,CACJG,IAAI,CACJC,OAAO,CACPC,OACF,CAAC,CACH,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}