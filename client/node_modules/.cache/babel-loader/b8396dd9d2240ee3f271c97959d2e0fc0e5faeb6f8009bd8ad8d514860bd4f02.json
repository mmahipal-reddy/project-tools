{"ast":null,"code":"import React from'react';import{Navigate,useLocation}from'react-router-dom';import{useAuth}from'../context/AuthContext';import{canAccessRoute,ROLES}from'../utils/rbac';import toast from'react-hot-toast';/**\n * Role-based protected route component\n * Checks if user has permission to access the route based on their role\n */import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const RoleProtectedRoute=_ref=>{let{children,requiredPermission,requiredRole,fallbackPath='/dashboard'}=_ref;const{user,loading}=useAuth();const location=useLocation();// Show loading state while checking authentication\nif(loading){return/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'center',alignItems:'center',height:'100vh',flexDirection:'column',gap:'16px'},children:[/*#__PURE__*/_jsx(\"div\",{className:\"spinner\",style:{width:'40px',height:'40px',border:'4px solid #f3f3f3',borderTop:'4px solid #08979C',borderRadius:'50%',animation:'spin 1s linear infinite'}}),/*#__PURE__*/_jsx(\"p\",{style:{color:'#666',fontSize:'14px'},children:\"Checking permissions...\"})]});}// If not authenticated, redirect to login\nif(!user){return/*#__PURE__*/_jsx(Navigate,{to:\"/login\",state:{from:location},replace:true});}const userRole=user.role;// Admin has access to everything\nif(userRole===ROLES.ADMIN){return/*#__PURE__*/_jsx(_Fragment,{children:children});}// Check role-based access\nif(requiredRole&&userRole!==requiredRole){toast.error('You do not have permission to access this page');return/*#__PURE__*/_jsx(Navigate,{to:fallbackPath,replace:true});}// Check permission-based access using route\nif(requiredPermission){const route=location.pathname;if(!canAccessRoute(userRole,route)){toast.error('You do not have permission to access this page');return/*#__PURE__*/_jsx(Navigate,{to:fallbackPath,replace:true});}}else{// Default: check route access\nconst route=location.pathname;if(!canAccessRoute(userRole,route)){toast.error('You do not have permission to access this page');return/*#__PURE__*/_jsx(Navigate,{to:fallbackPath,replace:true});}}return/*#__PURE__*/_jsx(_Fragment,{children:children});};export default RoleProtectedRoute;","map":{"version":3,"names":["React","Navigate","useLocation","useAuth","canAccessRoute","ROLES","toast","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","RoleProtectedRoute","_ref","children","requiredPermission","requiredRole","fallbackPath","user","loading","location","style","display","justifyContent","alignItems","height","flexDirection","gap","className","width","border","borderTop","borderRadius","animation","color","fontSize","to","state","from","replace","userRole","role","ADMIN","error","route","pathname"],"sources":["/Users/mmoola/Cursor/ProjectSetup/client/src/components/RoleProtectedRoute.js"],"sourcesContent":["import React from 'react';\nimport { Navigate, useLocation } from 'react-router-dom';\nimport { useAuth } from '../context/AuthContext';\nimport { canAccessRoute, ROLES } from '../utils/rbac';\nimport toast from 'react-hot-toast';\n\n/**\n * Role-based protected route component\n * Checks if user has permission to access the route based on their role\n */\nconst RoleProtectedRoute = ({ children, requiredPermission, requiredRole, fallbackPath = '/dashboard' }) => {\n  const { user, loading } = useAuth();\n  const location = useLocation();\n\n  // Show loading state while checking authentication\n  if (loading) {\n    return (\n      <div style={{ \n        display: 'flex', \n        justifyContent: 'center', \n        alignItems: 'center', \n        height: '100vh',\n        flexDirection: 'column',\n        gap: '16px'\n      }}>\n        <div className=\"spinner\" style={{ width: '40px', height: '40px', border: '4px solid #f3f3f3', borderTop: '4px solid #08979C', borderRadius: '50%', animation: 'spin 1s linear infinite' }}></div>\n        <p style={{ color: '#666', fontSize: '14px' }}>Checking permissions...</p>\n      </div>\n    );\n  }\n\n  // If not authenticated, redirect to login\n  if (!user) {\n    return <Navigate to=\"/login\" state={{ from: location }} replace />;\n  }\n\n  const userRole = user.role;\n\n  // Admin has access to everything\n  if (userRole === ROLES.ADMIN) {\n    return <>{children}</>;\n  }\n\n  // Check role-based access\n  if (requiredRole && userRole !== requiredRole) {\n    toast.error('You do not have permission to access this page');\n    return <Navigate to={fallbackPath} replace />;\n  }\n\n  // Check permission-based access using route\n  if (requiredPermission) {\n    const route = location.pathname;\n    if (!canAccessRoute(userRole, route)) {\n      toast.error('You do not have permission to access this page');\n      return <Navigate to={fallbackPath} replace />;\n    }\n  } else {\n    // Default: check route access\n    const route = location.pathname;\n    if (!canAccessRoute(userRole, route)) {\n      toast.error('You do not have permission to access this page');\n      return <Navigate to={fallbackPath} replace />;\n    }\n  }\n\n  return <>{children}</>;\n};\n\nexport default RoleProtectedRoute;\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}