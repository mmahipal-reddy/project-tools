{"ast":null,"code":"import _objectSpread from\"/Users/mmoola/Cursor/ProjectSetup/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";/**\n * Security utilities\n * Provides functions for input sanitization and security checks\n *//**\n * Sanitizes string input to prevent XSS attacks\n * Removes potentially dangerous HTML/JavaScript\n * @param {string} input - Input string to sanitize\n * @returns {string} - Sanitized string\n */export const sanitizeString=input=>{if(!input||typeof input!=='string')return input;// Remove HTML tags\nlet sanitized=input.replace(/<[^>]*>/g,'');// Remove potentially dangerous JavaScript patterns\nsanitized=sanitized.replace(/javascript:/gi,'').replace(/on\\w+\\s*=/gi,'').replace(/<script/gi,'').replace(/<\\/script>/gi,'').replace(/<iframe/gi,'').replace(/<object/gi,'').replace(/<embed/gi,'').replace(/<link/gi,'').replace(/<style/gi,'');// Remove null bytes\nsanitized=sanitized.replace(/\\0/g,'');return sanitized.trim();};/**\n * Sanitizes object recursively\n * @param {object} obj - Object to sanitize\n * @returns {object} - Sanitized object\n */export const sanitizeObject=obj=>{if(!obj||typeof obj!=='object')return obj;if(Array.isArray(obj)){return obj.map(item=>sanitizeObject(item));}const sanitized={};for(const key in obj){if(obj.hasOwnProperty(key)){const value=obj[key];if(typeof value==='string'){sanitized[key]=sanitizeString(value);}else if(typeof value==='object'&&value!==null){sanitized[key]=sanitizeObject(value);}else{sanitized[key]=value;}}}return sanitized;};/**\n * Escapes special characters for use in SQL queries\n * Note: This is a basic escape. Always use parameterized queries when possible.\n * @param {string} input - Input string to escape\n * @returns {string} - Escaped string\n */export const escapeSql=input=>{if(!input||typeof input!=='string')return input;return input.replace(/\\\\/g,'\\\\\\\\').replace(/'/g,\"\\\\'\").replace(/\"/g,'\\\\\"').replace(/\\0/g,'\\\\0').replace(/\\n/g,'\\\\n').replace(/\\r/g,'\\\\r').replace(/\\x1a/g,'\\\\Z');};/**\n * Validates input length\n * @param {string} input - Input to validate\n * @param {number} maxLength - Maximum allowed length\n * @returns {boolean} - True if valid, false otherwise\n */export const isValidLength=(input,maxLength)=>{if(!input)return true;return input.length<=maxLength;};/**\n * Checks for SQL injection patterns\n * @param {string} input - Input to check\n * @returns {boolean} - True if potentially dangerous, false otherwise\n */export const containsSqlInjection=input=>{if(!input||typeof input!=='string')return false;const sqlPatterns=[/(\\b(SELECT|INSERT|UPDATE|DELETE|DROP|CREATE|ALTER|EXEC|EXECUTE|UNION|SCRIPT)\\b)/gi,/('|(\\\\')|(;)|(--)|(\\/\\*)|(\\*\\/)|(\\+)|(\\%))/gi,/((\\%27)|(\\'))((\\%6F)|o|(\\%4F))((\\%72)|r|(\\%52))/gi,// 'or'\n/((\\%27)|(\\'))((\\%55)|u|(\\%75))((\\%4E)|n|(\\%6E))((\\%49)|i|(\\%69))((\\%4F)|o|(\\%6F))((\\%4E)|n|(\\%6E))/gi,// 'union'\n/((\\%27)|(\\'))((\\%4F)|o|(\\%6F))((\\%52)|r|(\\%72))/gi// 'or'\n];return sqlPatterns.some(pattern=>pattern.test(input));};/**\n * Checks for XSS patterns\n * @param {string} input - Input to check\n * @returns {boolean} - True if potentially dangerous, false otherwise\n */export const containsXss=input=>{if(!input||typeof input!=='string')return false;const xssPatterns=[/<script/gi,/<iframe/gi,/<object/gi,/<embed/gi,/javascript:/gi,/on\\w+\\s*=/gi,/<img[^>]+src[^>]*=.*javascript:/gi,/<link[^>]+href[^>]*=.*javascript:/gi];return xssPatterns.some(pattern=>pattern.test(input));};/**\n * Validates input for security threats\n * @param {string} input - Input to validate\n * @returns {object} - { isSafe: boolean, threats: string[] }\n */export const validateSecurity=input=>{if(!input||typeof input!=='string'){return{isSafe:true,threats:[]};}const threats=[];if(containsSqlInjection(input)){threats.push('SQL_INJECTION');}if(containsXss(input)){threats.push('XSS');}return{isSafe:threats.length===0,threats};};/**\n * Sanitizes and validates input for security\n * @param {string} input - Input to sanitize and validate\n * @returns {object} - { sanitized: string, isSafe: boolean, threats: string[] }\n */export const sanitizeAndValidate=input=>{const sanitized=sanitizeString(input);const security=validateSecurity(sanitized);return _objectSpread({sanitized},security);};","map":{"version":3,"names":["sanitizeString","input","sanitized","replace","trim","sanitizeObject","obj","Array","isArray","map","item","key","hasOwnProperty","value","escapeSql","isValidLength","maxLength","length","containsSqlInjection","sqlPatterns","some","pattern","test","containsXss","xssPatterns","validateSecurity","isSafe","threats","push","sanitizeAndValidate","security","_objectSpread"],"sources":["/Users/mmoola/Cursor/ProjectSetup/client/src/utils/security.js"],"sourcesContent":["/**\n * Security utilities\n * Provides functions for input sanitization and security checks\n */\n\n/**\n * Sanitizes string input to prevent XSS attacks\n * Removes potentially dangerous HTML/JavaScript\n * @param {string} input - Input string to sanitize\n * @returns {string} - Sanitized string\n */\nexport const sanitizeString = (input) => {\n  if (!input || typeof input !== 'string') return input;\n  \n  // Remove HTML tags\n  let sanitized = input.replace(/<[^>]*>/g, '');\n  \n  // Remove potentially dangerous JavaScript patterns\n  sanitized = sanitized\n    .replace(/javascript:/gi, '')\n    .replace(/on\\w+\\s*=/gi, '')\n    .replace(/<script/gi, '')\n    .replace(/<\\/script>/gi, '')\n    .replace(/<iframe/gi, '')\n    .replace(/<object/gi, '')\n    .replace(/<embed/gi, '')\n    .replace(/<link/gi, '')\n    .replace(/<style/gi, '');\n  \n  // Remove null bytes\n  sanitized = sanitized.replace(/\\0/g, '');\n  \n  return sanitized.trim();\n};\n\n/**\n * Sanitizes object recursively\n * @param {object} obj - Object to sanitize\n * @returns {object} - Sanitized object\n */\nexport const sanitizeObject = (obj) => {\n  if (!obj || typeof obj !== 'object') return obj;\n  \n  if (Array.isArray(obj)) {\n    return obj.map(item => sanitizeObject(item));\n  }\n  \n  const sanitized = {};\n  for (const key in obj) {\n    if (obj.hasOwnProperty(key)) {\n      const value = obj[key];\n      if (typeof value === 'string') {\n        sanitized[key] = sanitizeString(value);\n      } else if (typeof value === 'object' && value !== null) {\n        sanitized[key] = sanitizeObject(value);\n      } else {\n        sanitized[key] = value;\n      }\n    }\n  }\n  \n  return sanitized;\n};\n\n/**\n * Escapes special characters for use in SQL queries\n * Note: This is a basic escape. Always use parameterized queries when possible.\n * @param {string} input - Input string to escape\n * @returns {string} - Escaped string\n */\nexport const escapeSql = (input) => {\n  if (!input || typeof input !== 'string') return input;\n  \n  return input\n    .replace(/\\\\/g, '\\\\\\\\')\n    .replace(/'/g, \"\\\\'\")\n    .replace(/\"/g, '\\\\\"')\n    .replace(/\\0/g, '\\\\0')\n    .replace(/\\n/g, '\\\\n')\n    .replace(/\\r/g, '\\\\r')\n    .replace(/\\x1a/g, '\\\\Z');\n};\n\n/**\n * Validates input length\n * @param {string} input - Input to validate\n * @param {number} maxLength - Maximum allowed length\n * @returns {boolean} - True if valid, false otherwise\n */\nexport const isValidLength = (input, maxLength) => {\n  if (!input) return true;\n  return input.length <= maxLength;\n};\n\n/**\n * Checks for SQL injection patterns\n * @param {string} input - Input to check\n * @returns {boolean} - True if potentially dangerous, false otherwise\n */\nexport const containsSqlInjection = (input) => {\n  if (!input || typeof input !== 'string') return false;\n  \n  const sqlPatterns = [\n    /(\\b(SELECT|INSERT|UPDATE|DELETE|DROP|CREATE|ALTER|EXEC|EXECUTE|UNION|SCRIPT)\\b)/gi,\n    /('|(\\\\')|(;)|(--)|(\\/\\*)|(\\*\\/)|(\\+)|(\\%))/gi,\n    /((\\%27)|(\\'))((\\%6F)|o|(\\%4F))((\\%72)|r|(\\%52))/gi, // 'or'\n    /((\\%27)|(\\'))((\\%55)|u|(\\%75))((\\%4E)|n|(\\%6E))((\\%49)|i|(\\%69))((\\%4F)|o|(\\%6F))((\\%4E)|n|(\\%6E))/gi, // 'union'\n    /((\\%27)|(\\'))((\\%4F)|o|(\\%6F))((\\%52)|r|(\\%72))/gi, // 'or'\n  ];\n  \n  return sqlPatterns.some(pattern => pattern.test(input));\n};\n\n/**\n * Checks for XSS patterns\n * @param {string} input - Input to check\n * @returns {boolean} - True if potentially dangerous, false otherwise\n */\nexport const containsXss = (input) => {\n  if (!input || typeof input !== 'string') return false;\n  \n  const xssPatterns = [\n    /<script/gi,\n    /<iframe/gi,\n    /<object/gi,\n    /<embed/gi,\n    /javascript:/gi,\n    /on\\w+\\s*=/gi,\n    /<img[^>]+src[^>]*=.*javascript:/gi,\n    /<link[^>]+href[^>]*=.*javascript:/gi,\n  ];\n  \n  return xssPatterns.some(pattern => pattern.test(input));\n};\n\n/**\n * Validates input for security threats\n * @param {string} input - Input to validate\n * @returns {object} - { isSafe: boolean, threats: string[] }\n */\nexport const validateSecurity = (input) => {\n  if (!input || typeof input !== 'string') {\n    return { isSafe: true, threats: [] };\n  }\n  \n  const threats = [];\n  \n  if (containsSqlInjection(input)) {\n    threats.push('SQL_INJECTION');\n  }\n  \n  if (containsXss(input)) {\n    threats.push('XSS');\n  }\n  \n  return {\n    isSafe: threats.length === 0,\n    threats\n  };\n};\n\n/**\n * Sanitizes and validates input for security\n * @param {string} input - Input to sanitize and validate\n * @returns {object} - { sanitized: string, isSafe: boolean, threats: string[] }\n */\nexport const sanitizeAndValidate = (input) => {\n  const sanitized = sanitizeString(input);\n  const security = validateSecurity(sanitized);\n  \n  return {\n    sanitized,\n    ...security\n  };\n};\n\n\n"],"mappings":"6HAAA;AACA;AACA;AACA,GAEA;AACA;AACA;AACA;AACA;AACA,GACA,MAAO,MAAM,CAAAA,cAAc,CAAIC,KAAK,EAAK,CACvC,GAAI,CAACA,KAAK,EAAI,MAAO,CAAAA,KAAK,GAAK,QAAQ,CAAE,MAAO,CAAAA,KAAK,CAErD;AACA,GAAI,CAAAC,SAAS,CAAGD,KAAK,CAACE,OAAO,CAAC,UAAU,CAAE,EAAE,CAAC,CAE7C;AACAD,SAAS,CAAGA,SAAS,CAClBC,OAAO,CAAC,eAAe,CAAE,EAAE,CAAC,CAC5BA,OAAO,CAAC,aAAa,CAAE,EAAE,CAAC,CAC1BA,OAAO,CAAC,WAAW,CAAE,EAAE,CAAC,CACxBA,OAAO,CAAC,cAAc,CAAE,EAAE,CAAC,CAC3BA,OAAO,CAAC,WAAW,CAAE,EAAE,CAAC,CACxBA,OAAO,CAAC,WAAW,CAAE,EAAE,CAAC,CACxBA,OAAO,CAAC,UAAU,CAAE,EAAE,CAAC,CACvBA,OAAO,CAAC,SAAS,CAAE,EAAE,CAAC,CACtBA,OAAO,CAAC,UAAU,CAAE,EAAE,CAAC,CAE1B;AACAD,SAAS,CAAGA,SAAS,CAACC,OAAO,CAAC,KAAK,CAAE,EAAE,CAAC,CAExC,MAAO,CAAAD,SAAS,CAACE,IAAI,CAAC,CAAC,CACzB,CAAC,CAED;AACA;AACA;AACA;AACA,GACA,MAAO,MAAM,CAAAC,cAAc,CAAIC,GAAG,EAAK,CACrC,GAAI,CAACA,GAAG,EAAI,MAAO,CAAAA,GAAG,GAAK,QAAQ,CAAE,MAAO,CAAAA,GAAG,CAE/C,GAAIC,KAAK,CAACC,OAAO,CAACF,GAAG,CAAC,CAAE,CACtB,MAAO,CAAAA,GAAG,CAACG,GAAG,CAACC,IAAI,EAAIL,cAAc,CAACK,IAAI,CAAC,CAAC,CAC9C,CAEA,KAAM,CAAAR,SAAS,CAAG,CAAC,CAAC,CACpB,IAAK,KAAM,CAAAS,GAAG,GAAI,CAAAL,GAAG,CAAE,CACrB,GAAIA,GAAG,CAACM,cAAc,CAACD,GAAG,CAAC,CAAE,CAC3B,KAAM,CAAAE,KAAK,CAAGP,GAAG,CAACK,GAAG,CAAC,CACtB,GAAI,MAAO,CAAAE,KAAK,GAAK,QAAQ,CAAE,CAC7BX,SAAS,CAACS,GAAG,CAAC,CAAGX,cAAc,CAACa,KAAK,CAAC,CACxC,CAAC,IAAM,IAAI,MAAO,CAAAA,KAAK,GAAK,QAAQ,EAAIA,KAAK,GAAK,IAAI,CAAE,CACtDX,SAAS,CAACS,GAAG,CAAC,CAAGN,cAAc,CAACQ,KAAK,CAAC,CACxC,CAAC,IAAM,CACLX,SAAS,CAACS,GAAG,CAAC,CAAGE,KAAK,CACxB,CACF,CACF,CAEA,MAAO,CAAAX,SAAS,CAClB,CAAC,CAED;AACA;AACA;AACA;AACA;AACA,GACA,MAAO,MAAM,CAAAY,SAAS,CAAIb,KAAK,EAAK,CAClC,GAAI,CAACA,KAAK,EAAI,MAAO,CAAAA,KAAK,GAAK,QAAQ,CAAE,MAAO,CAAAA,KAAK,CAErD,MAAO,CAAAA,KAAK,CACTE,OAAO,CAAC,KAAK,CAAE,MAAM,CAAC,CACtBA,OAAO,CAAC,IAAI,CAAE,KAAK,CAAC,CACpBA,OAAO,CAAC,IAAI,CAAE,KAAK,CAAC,CACpBA,OAAO,CAAC,KAAK,CAAE,KAAK,CAAC,CACrBA,OAAO,CAAC,KAAK,CAAE,KAAK,CAAC,CACrBA,OAAO,CAAC,KAAK,CAAE,KAAK,CAAC,CACrBA,OAAO,CAAC,OAAO,CAAE,KAAK,CAAC,CAC5B,CAAC,CAED;AACA;AACA;AACA;AACA;AACA,GACA,MAAO,MAAM,CAAAY,aAAa,CAAGA,CAACd,KAAK,CAAEe,SAAS,GAAK,CACjD,GAAI,CAACf,KAAK,CAAE,MAAO,KAAI,CACvB,MAAO,CAAAA,KAAK,CAACgB,MAAM,EAAID,SAAS,CAClC,CAAC,CAED;AACA;AACA;AACA;AACA,GACA,MAAO,MAAM,CAAAE,oBAAoB,CAAIjB,KAAK,EAAK,CAC7C,GAAI,CAACA,KAAK,EAAI,MAAO,CAAAA,KAAK,GAAK,QAAQ,CAAE,MAAO,MAAK,CAErD,KAAM,CAAAkB,WAAW,CAAG,CAClB,mFAAmF,CACnF,8CAA8C,CAC9C,mDAAmD,CAAE;AACrD,sGAAsG,CAAE;AACxG,mDAAqD;AAAA,CACtD,CAED,MAAO,CAAAA,WAAW,CAACC,IAAI,CAACC,OAAO,EAAIA,OAAO,CAACC,IAAI,CAACrB,KAAK,CAAC,CAAC,CACzD,CAAC,CAED;AACA;AACA;AACA;AACA,GACA,MAAO,MAAM,CAAAsB,WAAW,CAAItB,KAAK,EAAK,CACpC,GAAI,CAACA,KAAK,EAAI,MAAO,CAAAA,KAAK,GAAK,QAAQ,CAAE,MAAO,MAAK,CAErD,KAAM,CAAAuB,WAAW,CAAG,CAClB,WAAW,CACX,WAAW,CACX,WAAW,CACX,UAAU,CACV,eAAe,CACf,aAAa,CACb,mCAAmC,CACnC,qCAAqC,CACtC,CAED,MAAO,CAAAA,WAAW,CAACJ,IAAI,CAACC,OAAO,EAAIA,OAAO,CAACC,IAAI,CAACrB,KAAK,CAAC,CAAC,CACzD,CAAC,CAED;AACA;AACA;AACA;AACA,GACA,MAAO,MAAM,CAAAwB,gBAAgB,CAAIxB,KAAK,EAAK,CACzC,GAAI,CAACA,KAAK,EAAI,MAAO,CAAAA,KAAK,GAAK,QAAQ,CAAE,CACvC,MAAO,CAAEyB,MAAM,CAAE,IAAI,CAAEC,OAAO,CAAE,EAAG,CAAC,CACtC,CAEA,KAAM,CAAAA,OAAO,CAAG,EAAE,CAElB,GAAIT,oBAAoB,CAACjB,KAAK,CAAC,CAAE,CAC/B0B,OAAO,CAACC,IAAI,CAAC,eAAe,CAAC,CAC/B,CAEA,GAAIL,WAAW,CAACtB,KAAK,CAAC,CAAE,CACtB0B,OAAO,CAACC,IAAI,CAAC,KAAK,CAAC,CACrB,CAEA,MAAO,CACLF,MAAM,CAAEC,OAAO,CAACV,MAAM,GAAK,CAAC,CAC5BU,OACF,CAAC,CACH,CAAC,CAED;AACA;AACA;AACA;AACA,GACA,MAAO,MAAM,CAAAE,mBAAmB,CAAI5B,KAAK,EAAK,CAC5C,KAAM,CAAAC,SAAS,CAAGF,cAAc,CAACC,KAAK,CAAC,CACvC,KAAM,CAAA6B,QAAQ,CAAGL,gBAAgB,CAACvB,SAAS,CAAC,CAE5C,OAAA6B,aAAA,EACE7B,SAAS,EACN4B,QAAQ,EAEf,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}