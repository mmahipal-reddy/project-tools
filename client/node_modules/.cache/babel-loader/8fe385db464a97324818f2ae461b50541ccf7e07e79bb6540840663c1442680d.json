{"ast":null,"code":"import _objectSpread from\"/Users/mmoola/Cursor/ProjectSetup/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{X,Loader,Eye,ChevronDown,Info,Edit,Copy}from'lucide-react';import apiClient from'../config/api';import toast from'react-hot-toast';import'../styles/PreviewModal.css';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const PreviewModal=_ref=>{var _displayObjectLabel$c,_tabsData$Details,_tabsData$Details2;let{isOpen,onClose,objectType,formData,objectLabel:propObjectLabel,onClone,onEdit}=_ref;const[previewData,setPreviewData]=useState(null);const[loading,setLoading]=useState(false);const[error,setError]=useState(null);const[expandedSections,setExpandedSections]=useState({});const[activeTab,setActiveTab]=useState('Details');const[showCloneMenu,setShowCloneMenu]=useState(false);useEffect(()=>{if(isOpen&&formData){fetchPreview();// Will expand all sections when preview data is loaded\nsetExpandedSections({});}else{setPreviewData(null);setError(null);setExpandedSections({});setShowCloneMenu(false);}},[isOpen,formData,objectType]);// Expand all sections when preview data is loaded\nuseEffect(()=>{if(previewData&&previewData.fields){const tabsData=groupFieldsByTabs();const allSectionNames=new Set();Object.values(tabsData).forEach(tabSections=>{Object.keys(tabSections).forEach(sectionName=>{allSectionNames.add(sectionName);});});// Set all sections to expanded by default\nconst newExpandedSections={};allSectionNames.forEach(sectionName=>{newExpandedSections[sectionName]=true;});setExpandedSections(newExpandedSections);}},[previewData]);const fetchPreview=async()=>{setLoading(true);setError(null);try{const response=await apiClient.post('/salesforce/preview-object',{objectType:objectType,formData:formData});if(response.data.success){setPreviewData(response.data);}else{setError(response.data.error||'Failed to fetch preview');toast.error(response.data.error||'Failed to fetch preview');}}catch(err){var _err$response,_err$response$data;const errorMessage=((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.error)||err.message||'Failed to fetch preview';setError(errorMessage);toast.error(errorMessage);}finally{setLoading(false);}};const toggleSection=sectionName=>{setExpandedSections(prev=>_objectSpread(_objectSpread({},prev),{},{[sectionName]:!prev[sectionName]}));};const handleClone=()=>{if(onClone&&formData){// Create a copy of form data with cleared ID fields\nconst clonedData=_objectSpread({},formData);// Remove ID fields that shouldn't be cloned\ndelete clonedData.id;delete clonedData.salesforceId;delete clonedData.createdDate;delete clonedData.lastModifiedDate;// Clear name fields to allow new names\nif(clonedData.name)clonedData.name='';if(clonedData.projectName)clonedData.projectName='';if(clonedData.Name)clonedData.Name='';onClone(clonedData);toast.success('Form data cloned. You can now edit and save as a new record.');onClose();}else{// Fallback: copy to clipboard\nnavigator.clipboard.writeText(JSON.stringify(formData,null,2));toast.success('Form data copied to clipboard');}setShowCloneMenu(false);};// Define actual required fields per object type (matching form validation)\nconst getRequiredFieldsForObject=objType=>{const objTypeLower=(objType||'').toLowerCase();if(objTypeLower==='project'){// Required fields from ProjectSetup form validation\nreturn new Set(['Project_Name__c','projectName','Short_Project_Name__c','shortProjectName','Contributor_Project_Name__c','contributorProjectName','Appen_Partner__c','appenPartner','Project_Type__c','projectType','Project_Priority__c','projectPriority','Account__c','account','Hire_Start_Date__c','hireStartDate','Predicted_Close_Date__c','predictedCloseDate','Project_Status__c','projectStatus','Project_Manager__c','projectManager','Project_Payment_Method__c','projectPaymentMethod']);}// Add other object types as needed\nreturn new Set();};const isFieldActuallyRequired=field=>{if(!field.required||field.calculated||field.readOnly){return false;}const requiredFields=getRequiredFieldsForObject(objectType);if(requiredFields.size===0){// If no specific requirements defined, use backend determination\nreturn field.required;}// Check if field name or label matches required fields\nconst fieldNameLower=field.name.toLowerCase();const fieldLabelLower=(field.label||'').toLowerCase();return Array.from(requiredFields).some(reqField=>{const reqFieldLower=reqField.toLowerCase();return fieldNameLower===reqFieldLower||fieldNameLower.includes(reqFieldLower)||fieldLabelLower.includes(reqFieldLower.replace(/_/g,' '));});};const formatFieldValue=(field,value)=>{if(value===null||value===undefined||value===''){return/*#__PURE__*/_jsx(\"span\",{className:\"sf-field-empty\",children:\"--\"});}switch(field.type){case'boolean':return value?'Yes':'No';case'date':return new Date(value).toLocaleDateString('en-US',{month:'numeric',day:'numeric',year:'numeric'});case'datetime':return new Date(value).toLocaleString('en-US',{month:'numeric',day:'numeric',year:'numeric',hour:'numeric',minute:'2-digit'});case'currency':case'double':case'percent':return typeof value==='number'?value.toLocaleString():value;case'picklist':return value;case'multipicklist':return Array.isArray(value)?value.join('; '):value;case'reference':return/*#__PURE__*/_jsx(\"a\",{href:\"#\",className:\"sf-link\",onClick:e=>e.preventDefault(),children:value});case'textarea':case'longtextarea':return/*#__PURE__*/_jsx(\"div\",{className:\"sf-textarea-value\",children:value});case'url':return/*#__PURE__*/_jsx(\"a\",{href:value,className:\"sf-link\",target:\"_blank\",rel:\"noopener noreferrer\",children:value});default:return String(value);}};const getObjectName=()=>{var _previewData$fields;if(!previewData||!formData)return'New Record';// Try to get Name field\nconst nameField=(_previewData$fields=previewData.fields)===null||_previewData$fields===void 0?void 0:_previewData$fields.find(f=>(f.name==='Name'||f.name==='Project_Name__c')&&f.value);if(nameField&&nameField.value){return nameField.value;}// Try common name fields from formData\nconst nameFields=['projectName','name','shortProjectName','contributorProjectName'];for(const fieldName of nameFields){if(formData[fieldName]){return formData[fieldName];}}return previewData.objectLabel||'New Record';};const getStatus=()=>{var _previewData$fields2;if(!previewData)return null;const statusField=(_previewData$fields2=previewData.fields)===null||_previewData$fields2===void 0?void 0:_previewData$fields2.find(f=>(f.name==='Status__c'||f.name==='Project_Status__c'||f.name==='Status')&&f.value);if(statusField)return statusField.value;// Try formData\nif(formData!==null&&formData!==void 0&&formData.projectStatus)return formData.projectStatus;if(formData!==null&&formData!==void 0&&formData.status)return formData.status;return null;};// Group fields by tabs and sections\nconst groupFieldsByTabs=()=>{if(!previewData||!previewData.fields)return{};const tabs={'Details':{'Information':[],'Project Metadata':[]},'Data Collection':{'Requirements':[],'Languages':[],'Data Collection Info':[]},'Lever':{'Lever Requisition Fields':[],'Lever Admin':[]},'Payments':{'Payment Configurations':[]},'Communication':{'Communication':[],'Activation':[]},'Related':{},'Funnel Report':{'Funnel Totals':[],'Funnel Stages':[]}};previewData.fields.forEach(field=>{const fieldName=field.name.toLowerCase();const fieldLabel=field.label.toLowerCase();// Details Tab - Information\nif(fieldName.includes('name')||fieldName.includes('description')||fieldName.includes('short')||fieldName.includes('contributor')||fieldName.includes('partner')||fieldName.includes('category')||fieldName.includes('auditor')||fieldLabel.includes('name')||fieldLabel.includes('description')||fieldLabel.includes('short')){tabs['Details']['Information'].push(field);}// Details Tab - Project Metadata\nelse if(fieldName.includes('id')||fieldName.includes('date')||fieldName.includes('status')||fieldName.includes('account')||fieldName.includes('client')||fieldName.includes('program')||fieldName.includes('delivery')||fieldName.includes('tool')||fieldName.includes('page')||fieldName.includes('url')||fieldName.includes('location')){tabs['Details']['Project Metadata'].push(field);}// Data Collection Tab\nelse if(fieldName.includes('requirement')||fieldName.includes('language')||fieldName.includes('budget')||fieldName.includes('data')||fieldName.includes('hours')||fieldName.includes('milestone')||fieldLabel.includes('requirement')||fieldLabel.includes('language')||fieldLabel.includes('budget')){if(fieldName.includes('requirement')||fieldLabel.includes('requirement')){tabs['Data Collection']['Requirements'].push(field);}else if(fieldName.includes('language')||fieldLabel.includes('language')){tabs['Data Collection']['Languages'].push(field);}else{tabs['Data Collection']['Data Collection Info'].push(field);}}// Lever Tab\nelse if(fieldName.includes('lever')||fieldLabel.includes('lever')){if(fieldName.includes('admin')||fieldName.includes('requisitionid')||fieldName.includes('createdate')){tabs['Lever']['Lever Admin'].push(field);}else{tabs['Lever']['Lever Requisition Fields'].push(field);}}// Payments Tab\nelse if(fieldName.includes('payment')||fieldName.includes('rate')||fieldName.includes('incentive')||fieldName.includes('approval')||fieldLabel.includes('payment')||fieldLabel.includes('rate')){tabs['Payments']['Payment Configurations'].push(field);}// Communication Tab\nelse if(fieldName.includes('communication')||fieldName.includes('comm')||fieldName.includes('activate')||fieldName.includes('email')||fieldName.includes('template')||fieldLabel.includes('communication')||fieldLabel.includes('activate')){if(fieldName.includes('activate')||fieldLabel.includes('activate')){tabs['Communication']['Activation'].push(field);}else{tabs['Communication']['Communication'].push(field);}}// Funnel Report Tab - More comprehensive matching\nelse if(fieldName.includes('funnel')||fieldName.includes('total')||fieldName.includes('stage')||fieldName.includes('contributor')&&(fieldName.includes('count')||fieldName.includes('number')||fieldName.includes('target'))||fieldLabel.includes('funnel')||fieldLabel.includes('total')||fieldLabel.includes('stage')||fieldName.includes('contributor')&&(fieldName.includes('count')||fieldName.includes('number')||fieldName.includes('target'))){if(fieldName.includes('total')||fieldLabel.includes('total')||fieldName.includes('funneltotal')||fieldLabel.includes('funnel total')){tabs['Funnel Report']['Funnel Totals'].push(field);}else if(fieldName.includes('stage')||fieldLabel.includes('stage')||fieldName.includes('funnelstage')||fieldLabel.includes('funnel stage')){tabs['Funnel Report']['Funnel Stages'].push(field);}else{// Default to Funnel Totals if it's funnel-related but unclear\ntabs['Funnel Report']['Funnel Totals'].push(field);}}// Default to Project Metadata if not categorized\nelse{tabs['Details']['Project Metadata'].push(field);}});return tabs;};const renderSection=(sectionName,fields)=>{if(!fields||fields.length===0)return null;// Ensure section is expanded by default (true if not explicitly set to false)\nconst isExpanded=expandedSections[sectionName]!==false;return/*#__PURE__*/_jsxs(\"div\",{className:\"sf-section\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"sf-section-header\",onClick:()=>toggleSection(sectionName),style:{paddingLeft:'16px',paddingRight:'16px',overflow:'visible',position:'relative'},children:/*#__PURE__*/_jsxs(\"div\",{className:\"sf-section-title\",style:{overflow:'visible',width:'100%',display:'flex',alignItems:'center',gap:'8px'},children:[/*#__PURE__*/_jsx(ChevronDown,{size:16,className:\"sf-chevron\",style:{transform:isExpanded?'rotate(0deg)':'rotate(-90deg)',transition:'transform 0.2s',flexShrink:0,minWidth:'16px',display:'block',visibility:'visible'}}),/*#__PURE__*/_jsx(\"span\",{style:{overflow:'visible',whiteSpace:'nowrap',flex:1,minWidth:0},children:sectionName})]})}),isExpanded&&/*#__PURE__*/_jsx(\"div\",{className:\"sf-section-content\",children:/*#__PURE__*/_jsx(\"div\",{className:\"sf-field-list\",children:fields.map((field,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"sf-field-item\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"sf-field-label-cell\",children:/*#__PURE__*/_jsxs(\"label\",{className:\"sf-field-label\",children:[field.label,isFieldActuallyRequired(field)&&/*#__PURE__*/_jsx(\"span\",{className:\"sf-required\",children:\"*\"})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"sf-field-value-cell\",children:formatFieldValue(field,field.value)})]},field.name))})})]});};const renderTabContent=(tabName,tabSections)=>{if(!tabSections||Object.keys(tabSections).length===0){return/*#__PURE__*/_jsx(\"div\",{className:\"sf-tab-content\",children:/*#__PURE__*/_jsxs(\"p\",{className:\"sf-tab-placeholder\",children:[\"No data available for \",tabName,\" tab.\"]})});}return/*#__PURE__*/_jsx(\"div\",{className:\"sf-tab-content\",children:/*#__PURE__*/_jsx(\"div\",{className:\"sf-main-content\",children:Object.entries(tabSections).map(_ref2=>{let[sectionName,fields]=_ref2;return renderSection(sectionName,fields);})})});};if(!isOpen)return null;const tabsData=previewData?groupFieldsByTabs():{};const objectName=getObjectName();const status=getStatus();const displayObjectLabel=(previewData===null||previewData===void 0?void 0:previewData.objectLabel)||propObjectLabel||'Project';return/*#__PURE__*/_jsx(\"div\",{className:\"preview-modal-overlay\",onClick:onClose,children:/*#__PURE__*/_jsxs(\"div\",{className:\"preview-modal-content sf-preview\",onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"sf-header\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"sf-header-left\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"sf-object-icon\",children:/*#__PURE__*/_jsx(\"div\",{className:\"sf-icon-square\",children:(displayObjectLabel===null||displayObjectLabel===void 0?void 0:(_displayObjectLabel$c=displayObjectLabel.charAt(0))===null||_displayObjectLabel$c===void 0?void 0:_displayObjectLabel$c.toUpperCase())||'P'})}),/*#__PURE__*/_jsxs(\"div\",{className:\"sf-object-info\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"sf-object-name-row\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"sf-object-type-label\",children:displayObjectLabel}),/*#__PURE__*/_jsx(\"h1\",{className:\"sf-object-name\",title:objectName,children:objectName||'New Record'})]}),status&&/*#__PURE__*/_jsx(\"div\",{className:\"sf-status-display\",children:/*#__PURE__*/_jsx(\"span\",{className:\"sf-status-badge\",children:status})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"sf-header-right\",children:[(onEdit||formData)&&/*#__PURE__*/_jsx(\"button\",{className:\"sf-action-btn\",onClick:e=>{e.preventDefault();e.stopPropagation();if(onEdit){onEdit();}else if(formData){// Default behavior: close preview to return to form\nonClose();}},children:\"Edit\"}),/*#__PURE__*/_jsx(\"button\",{className:\"sf-action-btn\",onClick:e=>{e.preventDefault();e.stopPropagation();onClose();},children:\"Close\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"sf-tabs\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"sf-tab \".concat(activeTab==='Details'?'active':''),onClick:()=>setActiveTab('Details'),children:\"Details\"}),/*#__PURE__*/_jsx(\"button\",{className:\"sf-tab \".concat(activeTab==='Data Collection'?'active':''),onClick:()=>setActiveTab('Data Collection'),children:\"Data Collection\"}),/*#__PURE__*/_jsx(\"button\",{className:\"sf-tab \".concat(activeTab==='Lever'?'active':''),onClick:()=>setActiveTab('Lever'),children:\"Lever\"}),/*#__PURE__*/_jsx(\"button\",{className:\"sf-tab \".concat(activeTab==='Payments'?'active':''),onClick:()=>setActiveTab('Payments'),children:\"Payments\"}),/*#__PURE__*/_jsx(\"button\",{className:\"sf-tab \".concat(activeTab==='Communication'?'active':''),onClick:()=>setActiveTab('Communication'),children:\"Communication\"}),/*#__PURE__*/_jsx(\"button\",{className:\"sf-tab \".concat(activeTab==='Related'?'active':''),onClick:()=>setActiveTab('Related'),children:\"Related\"}),/*#__PURE__*/_jsx(\"button\",{className:\"sf-tab \".concat(activeTab==='Funnel Report'?'active':''),onClick:()=>setActiveTab('Funnel Report'),children:\"Funnel Report\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"preview-modal-body\",children:[loading&&/*#__PURE__*/_jsxs(\"div\",{className:\"loading-container\",children:[/*#__PURE__*/_jsx(Loader,{className:\"spinning\",size:24,style:{color:'#08979C'}}),/*#__PURE__*/_jsx(\"p\",{children:\"Loading Salesforce preview...\"})]}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"preview-error\",children:/*#__PURE__*/_jsx(\"p\",{children:error})}),previewData&&!loading&&/*#__PURE__*/_jsxs(_Fragment,{children:[activeTab==='Details'&&/*#__PURE__*/_jsxs(\"div\",{className:\"sf-details-content\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"sf-main-content\",children:[renderSection('Information',(_tabsData$Details=tabsData['Details'])===null||_tabsData$Details===void 0?void 0:_tabsData$Details['Information']),renderSection('Project Metadata',(_tabsData$Details2=tabsData['Details'])===null||_tabsData$Details2===void 0?void 0:_tabsData$Details2['Project Metadata'])]}),/*#__PURE__*/_jsxs(\"div\",{className:\"sf-sidebar\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"sf-related-section\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"sf-related-header\",children:[/*#__PURE__*/_jsx(ChevronDown,{size:14}),/*#__PURE__*/_jsx(\"span\",{children:\"Project Teams (0)\"})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"sf-related-section\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"sf-related-header\",children:[/*#__PURE__*/_jsx(ChevronDown,{size:14}),/*#__PURE__*/_jsx(\"span\",{children:\"Project Qualification Steps (0)\"})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"sf-related-section\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"sf-related-header\",children:[/*#__PURE__*/_jsx(ChevronDown,{size:14}),/*#__PURE__*/_jsx(\"span\",{children:\"Project Pages (0)\"})]})})]})]}),activeTab==='Data Collection'&&renderTabContent('Data Collection',tabsData['Data Collection']),activeTab==='Lever'&&renderTabContent('Lever',tabsData['Lever']),activeTab==='Payments'&&renderTabContent('Payments',tabsData['Payments']),activeTab==='Communication'&&renderTabContent('Communication',tabsData['Communication']),activeTab==='Funnel Report'&&renderTabContent('Funnel Report',tabsData['Funnel Report']),activeTab==='Related'&&/*#__PURE__*/_jsx(\"div\",{className:\"sf-tab-content\",children:/*#__PURE__*/_jsx(\"div\",{className:\"sf-main-content\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"sf-section\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"sf-section-header\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"sf-section-title\",children:[/*#__PURE__*/_jsx(ChevronDown,{size:16}),/*#__PURE__*/_jsx(\"span\",{children:\"Related Records\"})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"sf-section-content\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"sf-field-list\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"sf-field-row\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"sf-field-label-cell\",children:/*#__PURE__*/_jsx(\"label\",{className:\"sf-field-label\",children:\"Project Teams\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"sf-field-value-cell\",children:/*#__PURE__*/_jsx(\"span\",{className:\"sf-field-empty\",children:\"No related records\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"sf-field-row\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"sf-field-label-cell\",children:/*#__PURE__*/_jsx(\"label\",{className:\"sf-field-label\",children:\"Project Qualification Steps\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"sf-field-value-cell\",children:/*#__PURE__*/_jsx(\"span\",{className:\"sf-field-empty\",children:\"No related records\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"sf-field-row\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"sf-field-label-cell\",children:/*#__PURE__*/_jsx(\"label\",{className:\"sf-field-label\",children:\"Project Pages\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"sf-field-value-cell\",children:/*#__PURE__*/_jsx(\"span\",{className:\"sf-field-empty\",children:\"No related records\"})})]})]})})]})})})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"preview-modal-footer\",children:/*#__PURE__*/_jsx(\"button\",{className:\"btn-secondary\",onClick:onClose,children:\"Close\"})})]})});};export default PreviewModal;","map":{"version":3,"names":["React","useState","useEffect","X","Loader","Eye","ChevronDown","Info","Edit","Copy","apiClient","toast","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","PreviewModal","_ref","_displayObjectLabel$c","_tabsData$Details","_tabsData$Details2","isOpen","onClose","objectType","formData","objectLabel","propObjectLabel","onClone","onEdit","previewData","setPreviewData","loading","setLoading","error","setError","expandedSections","setExpandedSections","activeTab","setActiveTab","showCloneMenu","setShowCloneMenu","fetchPreview","fields","tabsData","groupFieldsByTabs","allSectionNames","Set","Object","values","forEach","tabSections","keys","sectionName","add","newExpandedSections","response","post","data","success","err","_err$response","_err$response$data","errorMessage","message","toggleSection","prev","_objectSpread","handleClone","clonedData","id","salesforceId","createdDate","lastModifiedDate","name","projectName","Name","navigator","clipboard","writeText","JSON","stringify","getRequiredFieldsForObject","objType","objTypeLower","toLowerCase","isFieldActuallyRequired","field","required","calculated","readOnly","requiredFields","size","fieldNameLower","fieldLabelLower","label","Array","from","some","reqField","reqFieldLower","includes","replace","formatFieldValue","value","undefined","className","children","type","Date","toLocaleDateString","month","day","year","toLocaleString","hour","minute","isArray","join","href","onClick","e","preventDefault","target","rel","String","getObjectName","_previewData$fields","nameField","find","f","nameFields","fieldName","getStatus","_previewData$fields2","statusField","projectStatus","status","tabs","fieldLabel","push","renderSection","length","isExpanded","style","paddingLeft","paddingRight","overflow","position","width","display","alignItems","gap","transform","transition","flexShrink","minWidth","visibility","whiteSpace","flex","map","index","renderTabContent","tabName","entries","_ref2","objectName","displayObjectLabel","stopPropagation","charAt","toUpperCase","title","concat","color"],"sources":["/Users/mmoola/Cursor/ProjectSetup/client/src/components/PreviewModal.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { X, Loader, Eye, ChevronDown, Info, Edit, Copy } from 'lucide-react';\nimport apiClient from '../config/api';\nimport toast from 'react-hot-toast';\nimport '../styles/PreviewModal.css';\n\nconst PreviewModal = ({ isOpen, onClose, objectType, formData, objectLabel: propObjectLabel, onClone, onEdit }) => {\n  const [previewData, setPreviewData] = useState(null);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(null);\n  const [expandedSections, setExpandedSections] = useState({});\n  const [activeTab, setActiveTab] = useState('Details');\n  const [showCloneMenu, setShowCloneMenu] = useState(false);\n\n  useEffect(() => {\n    if (isOpen && formData) {\n      fetchPreview();\n      // Will expand all sections when preview data is loaded\n      setExpandedSections({});\n    } else {\n      setPreviewData(null);\n      setError(null);\n      setExpandedSections({});\n      setShowCloneMenu(false);\n    }\n  }, [isOpen, formData, objectType]);\n\n  // Expand all sections when preview data is loaded\n  useEffect(() => {\n    if (previewData && previewData.fields) {\n      const tabsData = groupFieldsByTabs();\n      const allSectionNames = new Set();\n      Object.values(tabsData).forEach(tabSections => {\n        Object.keys(tabSections).forEach(sectionName => {\n          allSectionNames.add(sectionName);\n        });\n      });\n      \n      // Set all sections to expanded by default\n      const newExpandedSections = {};\n      allSectionNames.forEach(sectionName => {\n        newExpandedSections[sectionName] = true;\n      });\n      setExpandedSections(newExpandedSections);\n    }\n  }, [previewData]);\n\n  const fetchPreview = async () => {\n    setLoading(true);\n    setError(null);\n    try {\n      const response = await apiClient.post('/salesforce/preview-object', {\n        objectType: objectType,\n        formData: formData\n      });\n\n      if (response.data.success) {\n        setPreviewData(response.data);\n      } else {\n        setError(response.data.error || 'Failed to fetch preview');\n        toast.error(response.data.error || 'Failed to fetch preview');\n      }\n    } catch (err) {\n      const errorMessage = err.response?.data?.error || err.message || 'Failed to fetch preview';\n      setError(errorMessage);\n      toast.error(errorMessage);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const toggleSection = (sectionName) => {\n    setExpandedSections(prev => ({\n      ...prev,\n      [sectionName]: !prev[sectionName]\n    }));\n  };\n\n  const handleClone = () => {\n    if (onClone && formData) {\n      // Create a copy of form data with cleared ID fields\n      const clonedData = { ...formData };\n      // Remove ID fields that shouldn't be cloned\n      delete clonedData.id;\n      delete clonedData.salesforceId;\n      delete clonedData.createdDate;\n      delete clonedData.lastModifiedDate;\n      \n      // Clear name fields to allow new names\n      if (clonedData.name) clonedData.name = '';\n      if (clonedData.projectName) clonedData.projectName = '';\n      if (clonedData.Name) clonedData.Name = '';\n      \n      onClone(clonedData);\n      toast.success('Form data cloned. You can now edit and save as a new record.');\n      onClose();\n    } else {\n      // Fallback: copy to clipboard\n      navigator.clipboard.writeText(JSON.stringify(formData, null, 2));\n      toast.success('Form data copied to clipboard');\n    }\n    setShowCloneMenu(false);\n  };\n\n  // Define actual required fields per object type (matching form validation)\n  const getRequiredFieldsForObject = (objType) => {\n    const objTypeLower = (objType || '').toLowerCase();\n    \n    if (objTypeLower === 'project') {\n      // Required fields from ProjectSetup form validation\n      return new Set([\n        'Project_Name__c', 'projectName',\n        'Short_Project_Name__c', 'shortProjectName',\n        'Contributor_Project_Name__c', 'contributorProjectName',\n        'Appen_Partner__c', 'appenPartner',\n        'Project_Type__c', 'projectType',\n        'Project_Priority__c', 'projectPriority',\n        'Account__c', 'account',\n        'Hire_Start_Date__c', 'hireStartDate',\n        'Predicted_Close_Date__c', 'predictedCloseDate',\n        'Project_Status__c', 'projectStatus',\n        'Project_Manager__c', 'projectManager',\n        'Project_Payment_Method__c', 'projectPaymentMethod'\n      ]);\n    }\n    \n    // Add other object types as needed\n    return new Set();\n  };\n\n  const isFieldActuallyRequired = (field) => {\n    if (!field.required || field.calculated || field.readOnly) {\n      return false;\n    }\n    \n    const requiredFields = getRequiredFieldsForObject(objectType);\n    if (requiredFields.size === 0) {\n      // If no specific requirements defined, use backend determination\n      return field.required;\n    }\n    \n    // Check if field name or label matches required fields\n    const fieldNameLower = field.name.toLowerCase();\n    const fieldLabelLower = (field.label || '').toLowerCase();\n    \n    return Array.from(requiredFields).some(reqField => {\n      const reqFieldLower = reqField.toLowerCase();\n      return fieldNameLower === reqFieldLower || \n             fieldNameLower.includes(reqFieldLower) ||\n             fieldLabelLower.includes(reqFieldLower.replace(/_/g, ' '));\n    });\n  };\n\n  const formatFieldValue = (field, value) => {\n    if (value === null || value === undefined || value === '') {\n      return <span className=\"sf-field-empty\">--</span>;\n    }\n\n    switch (field.type) {\n      case 'boolean':\n        return value ? 'Yes' : 'No';\n      case 'date':\n        return new Date(value).toLocaleDateString('en-US', { month: 'numeric', day: 'numeric', year: 'numeric' });\n      case 'datetime':\n        return new Date(value).toLocaleString('en-US', { month: 'numeric', day: 'numeric', year: 'numeric', hour: 'numeric', minute: '2-digit' });\n      case 'currency':\n      case 'double':\n      case 'percent':\n        return typeof value === 'number' ? value.toLocaleString() : value;\n      case 'picklist':\n        return value;\n      case 'multipicklist':\n        return Array.isArray(value) ? value.join('; ') : value;\n      case 'reference':\n        return <a href=\"#\" className=\"sf-link\" onClick={(e) => e.preventDefault()}>{value}</a>;\n      case 'textarea':\n      case 'longtextarea':\n        return <div className=\"sf-textarea-value\">{value}</div>;\n      case 'url':\n        return <a href={value} className=\"sf-link\" target=\"_blank\" rel=\"noopener noreferrer\">{value}</a>;\n      default:\n        return String(value);\n    }\n  };\n\n  const getObjectName = () => {\n    if (!previewData || !formData) return 'New Record';\n    \n    // Try to get Name field\n    const nameField = previewData.fields?.find(f => (f.name === 'Name' || f.name === 'Project_Name__c') && f.value);\n    if (nameField && nameField.value) {\n      return nameField.value;\n    }\n    \n    // Try common name fields from formData\n    const nameFields = ['projectName', 'name', 'shortProjectName', 'contributorProjectName'];\n    for (const fieldName of nameFields) {\n      if (formData[fieldName]) {\n        return formData[fieldName];\n      }\n    }\n    \n    return previewData.objectLabel || 'New Record';\n  };\n\n  const getStatus = () => {\n    if (!previewData) return null;\n    const statusField = previewData.fields?.find(f => \n      (f.name === 'Status__c' || f.name === 'Project_Status__c' || f.name === 'Status') && f.value\n    );\n    if (statusField) return statusField.value;\n    \n    // Try formData\n    if (formData?.projectStatus) return formData.projectStatus;\n    if (formData?.status) return formData.status;\n    \n    return null;\n  };\n\n  // Group fields by tabs and sections\n  const groupFieldsByTabs = () => {\n    if (!previewData || !previewData.fields) return {};\n\n    const tabs = {\n      'Details': {\n        'Information': [],\n        'Project Metadata': []\n      },\n      'Data Collection': {\n        'Requirements': [],\n        'Languages': [],\n        'Data Collection Info': []\n      },\n      'Lever': {\n        'Lever Requisition Fields': [],\n        'Lever Admin': []\n      },\n      'Payments': {\n        'Payment Configurations': []\n      },\n      'Communication': {\n        'Communication': [],\n        'Activation': []\n      },\n      'Related': {},\n      'Funnel Report': {\n        'Funnel Totals': [],\n        'Funnel Stages': []\n      }\n    };\n\n    previewData.fields.forEach(field => {\n      const fieldName = field.name.toLowerCase();\n      const fieldLabel = field.label.toLowerCase();\n\n      // Details Tab - Information\n      if (fieldName.includes('name') || \n          fieldName.includes('description') || \n          fieldName.includes('short') ||\n          fieldName.includes('contributor') ||\n          fieldName.includes('partner') ||\n          fieldName.includes('category') ||\n          fieldName.includes('auditor') ||\n          fieldLabel.includes('name') ||\n          fieldLabel.includes('description') ||\n          fieldLabel.includes('short')) {\n        tabs['Details']['Information'].push(field);\n      }\n      // Details Tab - Project Metadata\n      else if (fieldName.includes('id') || \n               fieldName.includes('date') || \n               fieldName.includes('status') ||\n               fieldName.includes('account') ||\n               fieldName.includes('client') ||\n               fieldName.includes('program') ||\n               fieldName.includes('delivery') ||\n               fieldName.includes('tool') ||\n               fieldName.includes('page') ||\n               fieldName.includes('url') ||\n               fieldName.includes('location')) {\n        tabs['Details']['Project Metadata'].push(field);\n      }\n      // Data Collection Tab\n      else if (fieldName.includes('requirement') ||\n               fieldName.includes('language') ||\n               fieldName.includes('budget') ||\n               fieldName.includes('data') ||\n               fieldName.includes('hours') ||\n               fieldName.includes('milestone') ||\n               fieldLabel.includes('requirement') ||\n               fieldLabel.includes('language') ||\n               fieldLabel.includes('budget')) {\n        if (fieldName.includes('requirement') || fieldLabel.includes('requirement')) {\n          tabs['Data Collection']['Requirements'].push(field);\n        } else if (fieldName.includes('language') || fieldLabel.includes('language')) {\n          tabs['Data Collection']['Languages'].push(field);\n        } else {\n          tabs['Data Collection']['Data Collection Info'].push(field);\n        }\n      }\n      // Lever Tab\n      else if (fieldName.includes('lever') || fieldLabel.includes('lever')) {\n        if (fieldName.includes('admin') || fieldName.includes('requisitionid') || fieldName.includes('createdate')) {\n          tabs['Lever']['Lever Admin'].push(field);\n        } else {\n          tabs['Lever']['Lever Requisition Fields'].push(field);\n        }\n      }\n      // Payments Tab\n      else if (fieldName.includes('payment') ||\n               fieldName.includes('rate') ||\n               fieldName.includes('incentive') ||\n               fieldName.includes('approval') ||\n               fieldLabel.includes('payment') ||\n               fieldLabel.includes('rate')) {\n        tabs['Payments']['Payment Configurations'].push(field);\n      }\n      // Communication Tab\n      else if (fieldName.includes('communication') ||\n               fieldName.includes('comm') ||\n               fieldName.includes('activate') ||\n               fieldName.includes('email') ||\n               fieldName.includes('template') ||\n               fieldLabel.includes('communication') ||\n               fieldLabel.includes('activate')) {\n        if (fieldName.includes('activate') || fieldLabel.includes('activate')) {\n          tabs['Communication']['Activation'].push(field);\n        } else {\n          tabs['Communication']['Communication'].push(field);\n        }\n      }\n      // Funnel Report Tab - More comprehensive matching\n      else if (fieldName.includes('funnel') ||\n               fieldName.includes('total') ||\n               fieldName.includes('stage') ||\n               fieldName.includes('contributor') && (fieldName.includes('count') || fieldName.includes('number') || fieldName.includes('target')) ||\n               fieldLabel.includes('funnel') ||\n               fieldLabel.includes('total') ||\n               fieldLabel.includes('stage') ||\n               (fieldName.includes('contributor') && (fieldName.includes('count') || fieldName.includes('number') || fieldName.includes('target')))) {\n        if (fieldName.includes('total') || fieldLabel.includes('total') || fieldName.includes('funneltotal') || fieldLabel.includes('funnel total')) {\n          tabs['Funnel Report']['Funnel Totals'].push(field);\n        } else if (fieldName.includes('stage') || fieldLabel.includes('stage') || fieldName.includes('funnelstage') || fieldLabel.includes('funnel stage')) {\n          tabs['Funnel Report']['Funnel Stages'].push(field);\n        } else {\n          // Default to Funnel Totals if it's funnel-related but unclear\n          tabs['Funnel Report']['Funnel Totals'].push(field);\n        }\n      }\n      // Default to Project Metadata if not categorized\n      else {\n        tabs['Details']['Project Metadata'].push(field);\n      }\n    });\n\n    return tabs;\n  };\n\n  const renderSection = (sectionName, fields) => {\n    if (!fields || fields.length === 0) return null;\n\n    // Ensure section is expanded by default (true if not explicitly set to false)\n    const isExpanded = expandedSections[sectionName] !== false;\n\n    return (\n      <div className=\"sf-section\">\n        <div \n          className=\"sf-section-header\"\n          onClick={() => toggleSection(sectionName)}\n          style={{ paddingLeft: '16px', paddingRight: '16px', overflow: 'visible', position: 'relative' }}\n        >\n          <div className=\"sf-section-title\" style={{ overflow: 'visible', width: '100%', display: 'flex', alignItems: 'center', gap: '8px' }}>\n            <ChevronDown \n              size={16} \n              className=\"sf-chevron\"\n              style={{ \n                transform: isExpanded ? 'rotate(0deg)' : 'rotate(-90deg)',\n                transition: 'transform 0.2s',\n                flexShrink: 0,\n                minWidth: '16px',\n                display: 'block',\n                visibility: 'visible'\n              }} \n            />\n            <span style={{ overflow: 'visible', whiteSpace: 'nowrap', flex: 1, minWidth: 0 }}>{sectionName}</span>\n          </div>\n        </div>\n        {isExpanded && (\n          <div className=\"sf-section-content\">\n            <div className=\"sf-field-list\">\n              {fields.map((field, index) => (\n                <div key={field.name} className=\"sf-field-item\">\n                  <div className=\"sf-field-label-cell\">\n                    <label className=\"sf-field-label\">\n                      {field.label}\n                      {isFieldActuallyRequired(field) && <span className=\"sf-required\">*</span>}\n                    </label>\n                  </div>\n                  <div className=\"sf-field-value-cell\">\n                    {formatFieldValue(field, field.value)}\n                  </div>\n                </div>\n              ))}\n            </div>\n          </div>\n        )}\n      </div>\n    );\n  };\n\n  const renderTabContent = (tabName, tabSections) => {\n    if (!tabSections || Object.keys(tabSections).length === 0) {\n      return (\n        <div className=\"sf-tab-content\">\n          <p className=\"sf-tab-placeholder\">No data available for {tabName} tab.</p>\n        </div>\n      );\n    }\n\n    return (\n      <div className=\"sf-tab-content\">\n        <div className=\"sf-main-content\">\n          {Object.entries(tabSections).map(([sectionName, fields]) => \n            renderSection(sectionName, fields)\n          )}\n        </div>\n      </div>\n    );\n  };\n\n  if (!isOpen) return null;\n\n  const tabsData = previewData ? groupFieldsByTabs() : {};\n  const objectName = getObjectName();\n  const status = getStatus();\n  const displayObjectLabel = previewData?.objectLabel || propObjectLabel || 'Project';\n\n  return (\n    <div className=\"preview-modal-overlay\" onClick={onClose}>\n      <div className=\"preview-modal-content sf-preview\" onClick={(e) => e.stopPropagation()}>\n        {/* Salesforce Header - Exact Match */}\n        <div className=\"sf-header\">\n          <div className=\"sf-header-left\">\n            <div className=\"sf-object-icon\">\n              <div className=\"sf-icon-square\">{displayObjectLabel?.charAt(0)?.toUpperCase() || 'P'}</div>\n            </div>\n            <div className=\"sf-object-info\">\n              <div className=\"sf-object-name-row\">\n                <span className=\"sf-object-type-label\">{displayObjectLabel}</span>\n                <h1 className=\"sf-object-name\" title={objectName}>{objectName || 'New Record'}</h1>\n              </div>\n              {status && (\n                <div className=\"sf-status-display\">\n                  <span className=\"sf-status-badge\">{status}</span>\n                </div>\n              )}\n            </div>\n          </div>\n          <div className=\"sf-header-right\">\n            {(onEdit || formData) && (\n              <button \n                className=\"sf-action-btn\"\n                onClick={(e) => {\n                  e.preventDefault();\n                  e.stopPropagation();\n                  if (onEdit) {\n                    onEdit();\n                  } else if (formData) {\n                    // Default behavior: close preview to return to form\n                    onClose();\n                  }\n                }}\n              >\n                Edit\n              </button>\n            )}\n            <button \n              className=\"sf-action-btn\"\n              onClick={(e) => {\n                e.preventDefault();\n                e.stopPropagation();\n                onClose();\n              }}\n            >\n              Close\n            </button>\n          </div>\n        </div>\n\n        {/* Tabs - Exact Match */}\n        <div className=\"sf-tabs\">\n          <button \n            className={`sf-tab ${activeTab === 'Details' ? 'active' : ''}`}\n            onClick={() => setActiveTab('Details')}\n          >\n            Details\n          </button>\n          <button \n            className={`sf-tab ${activeTab === 'Data Collection' ? 'active' : ''}`}\n            onClick={() => setActiveTab('Data Collection')}\n          >\n            Data Collection\n          </button>\n          <button \n            className={`sf-tab ${activeTab === 'Lever' ? 'active' : ''}`}\n            onClick={() => setActiveTab('Lever')}\n          >\n            Lever\n          </button>\n          <button \n            className={`sf-tab ${activeTab === 'Payments' ? 'active' : ''}`}\n            onClick={() => setActiveTab('Payments')}\n          >\n            Payments\n          </button>\n          <button \n            className={`sf-tab ${activeTab === 'Communication' ? 'active' : ''}`}\n            onClick={() => setActiveTab('Communication')}\n          >\n            Communication\n          </button>\n          <button \n            className={`sf-tab ${activeTab === 'Related' ? 'active' : ''}`}\n            onClick={() => setActiveTab('Related')}\n          >\n            Related\n          </button>\n          <button \n            className={`sf-tab ${activeTab === 'Funnel Report' ? 'active' : ''}`}\n            onClick={() => setActiveTab('Funnel Report')}\n          >\n            Funnel Report\n          </button>\n        </div>\n\n        <div className=\"preview-modal-body\">\n          {loading && (\n            <div className=\"loading-container\">\n              <Loader className=\"spinning\" size={24} style={{ color: '#08979C' }} />\n              <p>Loading Salesforce preview...</p>\n            </div>\n          )}\n\n          {error && (\n            <div className=\"preview-error\">\n              <p>{error}</p>\n            </div>\n          )}\n\n          {previewData && !loading && (\n            <>\n              {activeTab === 'Details' && (\n                <div className=\"sf-details-content\">\n                  <div className=\"sf-main-content\">\n                    {renderSection('Information', tabsData['Details']?.['Information'])}\n                    {renderSection('Project Metadata', tabsData['Details']?.['Project Metadata'])}\n                  </div>\n                  <div className=\"sf-sidebar\">\n                    <div className=\"sf-related-section\">\n                      <div className=\"sf-related-header\">\n                        <ChevronDown size={14} />\n                        <span>Project Teams (0)</span>\n                      </div>\n                    </div>\n                    <div className=\"sf-related-section\">\n                      <div className=\"sf-related-header\">\n                        <ChevronDown size={14} />\n                        <span>Project Qualification Steps (0)</span>\n                      </div>\n                    </div>\n                    <div className=\"sf-related-section\">\n                      <div className=\"sf-related-header\">\n                        <ChevronDown size={14} />\n                        <span>Project Pages (0)</span>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              )}\n\n              {activeTab === 'Data Collection' && renderTabContent('Data Collection', tabsData['Data Collection'])}\n              {activeTab === 'Lever' && renderTabContent('Lever', tabsData['Lever'])}\n              {activeTab === 'Payments' && renderTabContent('Payments', tabsData['Payments'])}\n              {activeTab === 'Communication' && renderTabContent('Communication', tabsData['Communication'])}\n              {activeTab === 'Funnel Report' && renderTabContent('Funnel Report', tabsData['Funnel Report'])}\n\n              {activeTab === 'Related' && (\n                <div className=\"sf-tab-content\">\n                  <div className=\"sf-main-content\">\n                    <div className=\"sf-section\">\n                      <div className=\"sf-section-header\">\n                        <div className=\"sf-section-title\">\n                          <ChevronDown size={16} />\n                          <span>Related Records</span>\n                        </div>\n                      </div>\n                      <div className=\"sf-section-content\">\n                        <div className=\"sf-field-list\">\n                          <div className=\"sf-field-row\">\n                            <div className=\"sf-field-label-cell\">\n                              <label className=\"sf-field-label\">Project Teams</label>\n                            </div>\n                            <div className=\"sf-field-value-cell\">\n                              <span className=\"sf-field-empty\">No related records</span>\n                            </div>\n                          </div>\n                          <div className=\"sf-field-row\">\n                            <div className=\"sf-field-label-cell\">\n                              <label className=\"sf-field-label\">Project Qualification Steps</label>\n                            </div>\n                            <div className=\"sf-field-value-cell\">\n                              <span className=\"sf-field-empty\">No related records</span>\n                            </div>\n                          </div>\n                          <div className=\"sf-field-row\">\n                            <div className=\"sf-field-label-cell\">\n                              <label className=\"sf-field-label\">Project Pages</label>\n                            </div>\n                            <div className=\"sf-field-value-cell\">\n                              <span className=\"sf-field-empty\">No related records</span>\n                            </div>\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              )}\n            </>\n          )}\n        </div>\n\n        <div className=\"preview-modal-footer\">\n          <button className=\"btn-secondary\" onClick={onClose}>\n            Close\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default PreviewModal;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}