{"ast":null,"code":"import _objectSpread from\"/Users/mmoola/Cursor/ProjectSetup/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React from'react';import{X,FileText}from'lucide-react';import FieldChip from'../FieldChip';import'../../../../styles/SubqueryCard.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const SubqueryCard=_ref=>{let{subquery,fields,onFieldAdd,onFieldRemove,onRemove}=_ref;const handleDrop=e=>{e.preventDefault();e.stopPropagation();try{const data=JSON.parse(e.dataTransfer.getData('application/json'));if(data.type==='subquery-field'&&data.relationshipName===subquery.relationshipName){const fieldWithPath=_objectSpread(_objectSpread({},data.field),{},{name:\"SUBQUERY:\".concat(subquery.relationshipName,\".\").concat(data.field.name),label:\"\".concat(subquery.relationshipName,\" \").concat(data.field.label)});onFieldAdd(fieldWithPath);}}catch(error){console.error('Error handling drop:',error);}};const handleDragOver=e=>{e.preventDefault();e.stopPropagation();e.dataTransfer.dropEffect='move';};return/*#__PURE__*/_jsxs(\"div\",{className:\"query-card subquery-card\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"card-header\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"card-title\",children:[/*#__PURE__*/_jsx(FileText,{size:18}),/*#__PURE__*/_jsxs(\"span\",{children:[\"\\uD83D\\uDCCB \",subquery.fieldLabel||subquery.relationshipName]}),/*#__PURE__*/_jsxs(\"span\",{className:\"card-subtitle\",children:[\"\\u2192 \",subquery.targetObject,\" (Child Records)\"]})]}),/*#__PURE__*/_jsx(\"button\",{className:\"card-remove-btn\",onClick:onRemove,title:\"Remove subquery\",children:/*#__PURE__*/_jsx(X,{size:16})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"card-content\",onDrop:handleDrop,onDragOver:handleDragOver,children:fields.length===0?/*#__PURE__*/_jsx(\"div\",{className:\"card-empty\",children:/*#__PURE__*/_jsx(\"p\",{children:\"Drag child record fields here\"})}):/*#__PURE__*/_jsx(\"div\",{className:\"card-fields\",children:fields.map(field=>{const fieldName=typeof field==='string'?field:field.name;const fieldLabel=typeof field==='string'?field:field.label||field.name;return/*#__PURE__*/_jsx(FieldChip,{label:fieldLabel,name:fieldName,onRemove:()=>onFieldRemove(fieldName)},fieldName);})})})]});};export default SubqueryCard;","map":{"version":3,"names":["React","X","FileText","FieldChip","jsx","_jsx","jsxs","_jsxs","SubqueryCard","_ref","subquery","fields","onFieldAdd","onFieldRemove","onRemove","handleDrop","e","preventDefault","stopPropagation","data","JSON","parse","dataTransfer","getData","type","relationshipName","fieldWithPath","_objectSpread","field","name","concat","label","error","console","handleDragOver","dropEffect","className","children","size","fieldLabel","targetObject","onClick","title","onDrop","onDragOver","length","map","fieldName"],"sources":["/Users/mmoola/Cursor/ProjectSetup/client/src/components/AdvancedReportBuilder/QueryCanvas/cards/SubqueryCard.js"],"sourcesContent":["import React from 'react';\nimport { X, FileText } from 'lucide-react';\nimport FieldChip from '../FieldChip';\nimport '../../../../styles/SubqueryCard.css';\n\nconst SubqueryCard = ({ subquery, fields, onFieldAdd, onFieldRemove, onRemove }) => {\n  const handleDrop = (e) => {\n    e.preventDefault();\n    e.stopPropagation();\n    try {\n      const data = JSON.parse(e.dataTransfer.getData('application/json'));\n      if (data.type === 'subquery-field' && \n          data.relationshipName === subquery.relationshipName) {\n        const fieldWithPath = {\n          ...data.field,\n          name: `SUBQUERY:${subquery.relationshipName}.${data.field.name}`,\n          label: `${subquery.relationshipName} ${data.field.label}`\n        };\n        onFieldAdd(fieldWithPath);\n      }\n    } catch (error) {\n      console.error('Error handling drop:', error);\n    }\n  };\n\n  const handleDragOver = (e) => {\n    e.preventDefault();\n    e.stopPropagation();\n    e.dataTransfer.dropEffect = 'move';\n  };\n\n  return (\n    <div className=\"query-card subquery-card\">\n      <div className=\"card-header\">\n        <div className=\"card-title\">\n          <FileText size={18} />\n          <span>ðŸ“‹ {subquery.fieldLabel || subquery.relationshipName}</span>\n          <span className=\"card-subtitle\">â†’ {subquery.targetObject} (Child Records)</span>\n        </div>\n        <button className=\"card-remove-btn\" onClick={onRemove} title=\"Remove subquery\">\n          <X size={16} />\n        </button>\n      </div>\n      \n      <div\n        className=\"card-content\"\n        onDrop={handleDrop}\n        onDragOver={handleDragOver}\n      >\n        {fields.length === 0 ? (\n          <div className=\"card-empty\">\n            <p>Drag child record fields here</p>\n          </div>\n        ) : (\n          <div className=\"card-fields\">\n            {fields.map(field => {\n              const fieldName = typeof field === 'string' ? field : field.name;\n              const fieldLabel = typeof field === 'string' ? field : (field.label || field.name);\n              return (\n                <FieldChip\n                  key={fieldName}\n                  label={fieldLabel}\n                  name={fieldName}\n                  onRemove={() => onFieldRemove(fieldName)}\n                />\n              );\n            })}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default SubqueryCard;\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}