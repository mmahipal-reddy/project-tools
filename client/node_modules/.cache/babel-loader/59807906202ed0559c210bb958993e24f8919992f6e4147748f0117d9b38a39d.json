{"ast":null,"code":"var _jsxFileName = \"/Users/mmoola/Cursor/ProjectSetup/client/src/pages/CrowdDashboard.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useCallback, useRef, useMemo } from 'react';\nimport { useAuth } from '../context/AuthContext';\nimport Sidebar from '../components/Sidebar';\nimport { Menu, LogOut, RefreshCw, Settings, Loader } from 'lucide-react';\nimport toast from 'react-hot-toast';\nimport BookmarkButton from '../components/BookmarkButton';\nimport '../styles/CrowdDashboard.css';\nimport '../styles/Sidebar.css';\nimport '../styles/GlobalHeader.css';\nimport OverviewTab from './CrowdDashboard/components/OverviewTab';\nimport DemographicSegmentationTab from './CrowdDashboard/components/DemographicSegmentationTab';\nimport ThresholdModal from './CrowdDashboard/components/ThresholdModal';\nimport DrillDownModal from './CrowdDashboard/components/DrillDownModal';\nimport { useCrowdDashboardData } from './CrowdDashboard/hooks';\nimport { loadBaselineData, saveBaselineData, loadThresholds, saveThresholds, formatNumber, formatDate, getMetricColor, exportToExcel, getTrendData, applyFilters } from './CrowdDashboard/utils';\nimport { renderWidgetRefresh, renderWidgetActions, renderWidgetStatus, renderFilterUI } from './CrowdDashboard/components/WidgetHelpers';\nimport { BASELINE_STORAGE_KEY, THRESHOLDS_STORAGE_KEY, HISTORICAL_DATA_KEY } from './CrowdDashboard/constants';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst CrowdDashboard = () => {\n  _s();\n  const {\n    user,\n    logout\n  } = useAuth();\n  const [sidebarOpen, setSidebarOpen] = useState(true);\n  const [loading, setLoading] = useState(false); // Don't block UI - show widgets immediately\n  const [refreshing, setRefreshing] = useState(false);\n  const [activeTab, setActiveTab] = useState('overview');\n\n  // Initialize state with baseline data if available (using lazy initializer)\n  // Load baseline once and reuse for all state initializations\n  const [metrics, setMetrics] = useState(() => {\n    const baseline = loadBaselineData();\n    return (baseline === null || baseline === void 0 ? void 0 : baseline.metrics) || {\n      targetHC: 0,\n      totalApplications: 0,\n      totalQualified: 0,\n      totalActiveOnProjects: 0,\n      totalProductive: 0,\n      onboardingContributors: 0,\n      activeContributors: 0,\n      avgAppReceivedToApplied: 0,\n      avgAppReceivedToActive: 0,\n      lastRefreshed: null\n    };\n  });\n  const [kycStatus, setKycStatus] = useState(() => {\n    const baseline = loadBaselineData();\n    return (baseline === null || baseline === void 0 ? void 0 : baseline.kycStatus) || [];\n  });\n  const [byCountry, setByCountry] = useState(() => {\n    const baseline = loadBaselineData();\n    return (baseline === null || baseline === void 0 ? void 0 : baseline.byCountry) || [];\n  });\n  const [byLanguage, setByLanguage] = useState(() => {\n    const baseline = loadBaselineData();\n    return (baseline === null || baseline === void 0 ? void 0 : baseline.byLanguage) || [];\n  });\n  const [byProject, setByProject] = useState(() => {\n    const baseline = loadBaselineData();\n    return (baseline === null || baseline === void 0 ? void 0 : baseline.byProject) || [];\n  });\n  const [byCountryLanguage, setByCountryLanguage] = useState(() => {\n    const baseline = loadBaselineData();\n    return (baseline === null || baseline === void 0 ? void 0 : baseline.byCountryLanguage) || [];\n  });\n  const [bySource, setBySource] = useState(() => {\n    const baseline = loadBaselineData();\n    return (baseline === null || baseline === void 0 ? void 0 : baseline.bySource) || [];\n  });\n  const [byContributorSource, setByContributorSource] = useState(() => {\n    const baseline = loadBaselineData();\n    return (baseline === null || baseline === void 0 ? void 0 : baseline.byContributorSource) || [];\n  });\n  const [byContributorStatus, setByContributorStatus] = useState(() => {\n    const baseline = loadBaselineData();\n    return (baseline === null || baseline === void 0 ? void 0 : baseline.byContributorStatus) || [];\n  });\n  const [byContributorType, setByContributorType] = useState(() => {\n    const baseline = loadBaselineData();\n    return (baseline === null || baseline === void 0 ? void 0 : baseline.byContributorType) || [];\n  });\n\n  // Track loading and error states per widget\n  const [widgetStates, setWidgetStates] = useState({\n    baseMetrics: {\n      loading: false,\n      error: null\n    },\n    activeContributors: {\n      loading: false,\n      error: null\n    },\n    onboardingContributors: {\n      loading: false,\n      error: null\n    },\n    kycStatus: {\n      loading: false,\n      error: null\n    },\n    bySource: {\n      loading: false,\n      error: null\n    },\n    byContributorSource: {\n      loading: false,\n      error: null\n    },\n    byContributorStatus: {\n      loading: false,\n      error: null\n    },\n    byContributorType: {\n      loading: false,\n      error: null\n    },\n    byCountry: {\n      loading: false,\n      error: null\n    },\n    byLanguage: {\n      loading: false,\n      error: null\n    },\n    byProject: {\n      loading: false,\n      error: null\n    },\n    byCountryLanguage: {\n      loading: false,\n      error: null\n    }\n  });\n  const [thresholds, setThresholds] = useState(loadThresholds);\n  const [showThresholdModal, setShowThresholdModal] = useState(false);\n\n  // Filtering state - separate state for each widget to avoid unnecessary re-renders\n  const [filters, setFilters] = useState({\n    dateRange: {\n      start: null,\n      end: null\n    },\n    status: null,\n    project: null,\n    country: null,\n    language: null\n  });\n  const [showFilters, setShowFilters] = useState({});\n\n  // Debounced filter values to prevent excessive re-renders\n  const [debouncedFilters, setDebouncedFilters] = useState(filters);\n\n  // Debounce filter changes\n  useEffect(() => {\n    const timer = setTimeout(() => {\n      setDebouncedFilters(filters);\n    }, 300);\n    return () => clearTimeout(timer);\n  }, [filters]);\n  const [drillDownData, setDrillDownData] = useState(null);\n\n  // Historical data state\n  const [historicalData, setHistoricalData] = useState(() => {\n    try {\n      const saved = localStorage.getItem(HISTORICAL_DATA_KEY);\n      if (saved) {\n        return JSON.parse(saved);\n      }\n    } catch (error) {\n      // Silently fail historical data loading\n    }\n    return [];\n  });\n  const [showTrendChart, setShowTrendChart] = useState({});\n\n  // Use extracted data fetching hook\n  const {\n    fetchBaseMetrics,\n    fetchActiveContributors,\n    fetchOnboardingContributors,\n    fetchKYCStatus,\n    fetchByCountry,\n    fetchByLanguage,\n    fetchByProject,\n    fetchByCountryLanguage,\n    fetchBySource,\n    fetchAvgAppReceivedToApplied,\n    fetchAvgAppReceivedToActive,\n    fetchByContributorSource,\n    fetchByContributorStatus,\n    fetchByContributorType,\n    fetchAllData\n  } = useCrowdDashboardData(setMetrics, setKycStatus, setByCountry, setByLanguage, setByProject, setByCountryLanguage, setBySource, setByContributorSource, setByContributorStatus, setByContributorType, setWidgetStates);\n\n  // All fetch functions are now provided by useCrowdDashboardData hook\n\n  // Log baseline data on mount and fetch only if baseline doesn't exist\n  // This must be after fetchAllData is defined\n  useEffect(() => {\n    const baseline = loadBaselineData();\n    if (baseline) {\n      var _baseline$kycStatus, _baseline$byProject;\n      // Only fetch if baseline is missing critical overview data\n      const hasOverviewData = baseline.metrics && (baseline.metrics.totalApplications > 0 || ((_baseline$kycStatus = baseline.kycStatus) === null || _baseline$kycStatus === void 0 ? void 0 : _baseline$kycStatus.length) > 0 || ((_baseline$byProject = baseline.byProject) === null || _baseline$byProject === void 0 ? void 0 : _baseline$byProject.length) > 0);\n      if (!hasOverviewData) {\n        fetchAllData(true); // Silent fetch\n      }\n    } else {\n      fetchAllData(true); // Silent fetch on first load\n    }\n  }, [fetchAllData]);\n\n  // Save current dashboard state as baseline\n  const saveCurrentAsBaseline = useCallback(() => {\n    const dashboardState = {\n      metrics,\n      kycStatus,\n      byCountry,\n      byLanguage,\n      byProject,\n      byCountryLanguage,\n      bySource,\n      byContributorSource,\n      byContributorStatus,\n      byContributorType,\n      // Note: Demographic data is saved separately in DemographicSegmentationTab component\n      savedAt: new Date().toISOString()\n    };\n    if (saveBaselineData(dashboardState)) {\n      toast.success('Baseline data saved successfully');\n    } else {\n      toast.error('Failed to save baseline data');\n    }\n  }, [metrics, kycStatus, byCountry, byLanguage, byProject, byCountryLanguage, bySource, byContributorSource, byContributorStatus, byContributorType]);\n\n  // Auto-save baseline whenever data changes (debounced)\n  // This will be called from both main component and demographic tab\n  // We'll merge with existing baseline to preserve all data\n  const autoSaveBaseline = useCallback(() => {\n    const existingBaseline = loadBaselineData() || {};\n    const dashboardState = {\n      ...existingBaseline,\n      // Preserve demographic data if it exists\n      metrics,\n      kycStatus,\n      byCountry,\n      byLanguage,\n      byProject,\n      byCountryLanguage,\n      bySource,\n      byContributorSource,\n      byContributorStatus,\n      byContributorType,\n      savedAt: new Date().toISOString()\n    };\n    saveBaselineData(dashboardState);\n  }, [metrics, kycStatus, byCountry, byLanguage, byProject, byCountryLanguage, bySource, byContributorSource, byContributorStatus, byContributorType]);\n  useEffect(() => {\n    // Only auto-save if we have meaningful data (not all zeros/empty)\n    const hasData = metrics.totalApplications > 0 || metrics.totalQualified > 0 || kycStatus.length > 0 || byProject.length > 0;\n    if (hasData) {\n      const timer = setTimeout(() => {\n        autoSaveBaseline();\n      }, 2000); // Debounce: save 2 seconds after last change\n\n      return () => clearTimeout(timer);\n    }\n  }, [metrics, kycStatus, byCountry, byLanguage, byProject, byCountryLanguage, bySource, byContributorSource, byContributorStatus, byContributorType, autoSaveBaseline]);\n\n  // Overview tab refresh handler\n  const handleOverviewRefresh = useCallback(() => {\n    setRefreshing(true);\n    fetchAllData(false);\n    setTimeout(() => setRefreshing(false), 1000);\n  }, [fetchAllData]);\n\n  // Ref to store demographics refresh function\n  const demographicsRefreshRef = useRef(null);\n\n  // Tab-specific refresh handler\n  const handleRefresh = useCallback(() => {\n    if (activeTab === 'overview') {\n      handleOverviewRefresh();\n    } else if (activeTab === 'demographic-segmentation' && demographicsRefreshRef.current) {\n      setRefreshing(true);\n      demographicsRefreshRef.current(false).finally(() => {\n        setTimeout(() => setRefreshing(false), 1000);\n      });\n    }\n  }, [activeTab, handleOverviewRefresh]);\n\n  // Widget-level refresh handlers\n  const handleWidgetRefresh = widgetKey => {\n    switch (widgetKey) {\n      case 'baseMetrics':\n        fetchBaseMetrics(false, widgetKey);\n        break;\n      case 'activeContributors':\n        fetchActiveContributors(false, widgetKey);\n        break;\n      case 'onboardingContributors':\n        fetchOnboardingContributors(false, widgetKey);\n        break;\n      case 'avgAppReceivedToApplied':\n        fetchAvgAppReceivedToApplied(false, widgetKey);\n        break;\n      case 'avgAppReceivedToActive':\n        fetchAvgAppReceivedToActive(false, widgetKey);\n        break;\n      case 'kycStatus':\n        fetchKYCStatus(false, widgetKey);\n        break;\n      case 'byCountry':\n        fetchByCountry(false, widgetKey);\n        break;\n      case 'byLanguage':\n        fetchByLanguage(false, widgetKey);\n        break;\n      case 'byProject':\n        fetchByProject(false, widgetKey);\n        break;\n      case 'byCountryLanguage':\n        fetchByCountryLanguage(false, widgetKey, true); // Start with top 20 for fast refresh\n        break;\n      case 'bySource':\n        fetchBySource(false, widgetKey);\n        break;\n      case 'byContributorSource':\n        fetchByContributorSource(false, widgetKey);\n        break;\n      case 'byContributorStatus':\n        fetchByContributorStatus(false, widgetKey);\n        break;\n      case 'byContributorType':\n        fetchByContributorType(false, widgetKey);\n        break;\n      default:\n        break;\n    }\n  };\n\n  // formatDate is imported from utils\n\n  // Save historical data snapshot\n  const saveHistoricalSnapshot = useCallback(() => {\n    const snapshot = {\n      timestamp: new Date().toISOString(),\n      metrics: {\n        ...metrics\n      },\n      kycStatus: [...kycStatus],\n      byProject: [...byProject],\n      byCountryLanguage: [...byCountryLanguage]\n    };\n    setHistoricalData(prev => {\n      // Reduce snapshot size - exclude large arrays and keep only essential data\n      const lightweightSnapshot = {\n        timestamp: snapshot.timestamp,\n        metrics: snapshot.metrics,\n        kycStatus: snapshot.kycStatus,\n        byProject: snapshot.byProject\n        // Exclude byCountryLanguage to save space\n      };\n      const updated = [...prev, lightweightSnapshot].slice(-30); // Keep last 30 snapshots (reduced from 100)\n      try {\n        localStorage.setItem(HISTORICAL_DATA_KEY, JSON.stringify(updated));\n      } catch (error) {\n        // If quota exceeded, try to clear old data and keep only last 10\n        try {\n          const reduced = updated.slice(-10);\n          localStorage.setItem(HISTORICAL_DATA_KEY, JSON.stringify(reduced));\n        } catch (retryError) {\n          // Silently fail if even reduced data can't be saved\n        }\n      }\n      return updated;\n    });\n  }, [metrics, kycStatus, byProject, byCountryLanguage]);\n\n  // Auto-save historical snapshot when data changes\n  useEffect(() => {\n    const hasData = metrics.totalApplications > 0 || kycStatus.length > 0 || byProject.length > 0;\n    if (hasData) {\n      const timer = setTimeout(() => {\n        saveHistoricalSnapshot();\n      }, 5000); // Save snapshot 5 seconds after data update\n      return () => clearTimeout(timer);\n    }\n  }, [metrics, kycStatus, byProject, byCountryLanguage, saveHistoricalSnapshot]);\n\n  // exportToExcel, getTrendData, and applyFilters are imported from utils\n  // Create wrapper functions that pass the required parameters\n  const handleExportToExcel = useCallback((widgetKey, data, widgetName) => {\n    exportToExcel(widgetKey, data, widgetName, metrics, kycStatus, byProject, byCountryLanguage, bySource);\n  }, [metrics, kycStatus, byProject, byCountryLanguage, bySource]);\n  const handleGetTrendData = useCallback(metricKey => {\n    return getTrendData(metricKey, historicalData);\n  }, [historicalData]);\n  const handleApplyFilters = useCallback((data, widgetKey) => {\n    return applyFilters(data, widgetKey, debouncedFilters);\n  }, [debouncedFilters]);\n\n  // Handle chart click for drill-down\n  const handleChartClick = useCallback((data, widgetKey) => {\n    setDrillDownData({\n      data,\n      widgetKey\n    });\n  }, []);\n\n  // Save thresholds wrapper\n  const handleSaveThresholds = useCallback(newThresholds => {\n    setThresholds(newThresholds);\n    if (saveThresholds(newThresholds)) {\n      toast.success('Thresholds saved successfully');\n    } else {\n      toast.error('Failed to save thresholds');\n    }\n  }, []);\n\n  // Chart colors\n  const chartColors = ['#3b82f6', '#10b981', '#f59e0b', '#ef4444', '#8b5cf6', '#06b6d4', '#ec4899', '#84cc16'];\n\n  // Wrapper functions for widget helpers\n  const handleRenderWidgetRefresh = widgetKey => {\n    return renderWidgetRefresh(widgetKey, widgetStates, handleWidgetRefresh);\n  };\n  const handleRenderWidgetActions = (widgetKey, widgetName, hasData = true) => {\n    return renderWidgetActions(widgetKey, widgetName, widgetStates, handleWidgetRefresh, setShowFilters, showFilters, setShowTrendChart, showTrendChart, historicalData, metrics, kycStatus, byProject, byCountryLanguage, bySource);\n  };\n  const handleRenderWidgetStatus = widgetKey => {\n    return renderWidgetStatus(widgetKey, widgetStates, handleWidgetRefresh);\n  };\n  const handleRenderFilterUI = useCallback(widgetKey => {\n    return renderFilterUI(widgetKey, showFilters, filters, setFilters, setShowFilters);\n  }, [showFilters, filters]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"dashboard-layout\",\n    children: [/*#__PURE__*/_jsxDEV(Sidebar, {\n      isOpen: sidebarOpen,\n      toggleSidebar: () => setSidebarOpen(!sidebarOpen)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 451,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"crowd-dashboard\",\n      style: {\n        marginLeft: sidebarOpen ? '320px' : '80px'\n      },\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"crowd-dashboard-container\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"crowd-dashboard-header\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"header-content\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"header-left\",\n              children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"header-menu-toggle\",\n                onClick: () => setSidebarOpen(!sidebarOpen),\n                children: /*#__PURE__*/_jsxDEV(Menu, {\n                  size: 20\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 461,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 457,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n                  className: \"page-title\",\n                  children: \"Crowd Dashboard\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 464,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"page-subtitle\",\n                  children: \"View contributor metrics and analytics\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 465,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 463,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 456,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"header-user-profile\",\n              children: [/*#__PURE__*/_jsxDEV(BookmarkButton, {\n                pageName: \"Crowd Dashboard\",\n                pageType: \"page\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 469,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"user-profile\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"user-avatar\",\n                  children: ((user === null || user === void 0 ? void 0 : user.email) || 'U').charAt(0).toUpperCase()\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 471,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"user-name\",\n                  children: (user === null || user === void 0 ? void 0 : user.email) || 'User'\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 474,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  className: \"logout-btn\",\n                  onClick: logout,\n                  title: \"Logout\",\n                  children: /*#__PURE__*/_jsxDEV(LogOut, {\n                    size: 18\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 476,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 475,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 470,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 468,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 455,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 454,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"crowd-dashboard-content\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"crowd-dashboard-tabs\",\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              className: `tab-button ${activeTab === 'overview' ? 'active' : ''}`,\n              onClick: () => setActiveTab('overview'),\n              children: \"Overview\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 486,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: `tab-button ${activeTab === 'demographic-segmentation' ? 'active' : ''}`,\n              onClick: () => setActiveTab('demographic-segmentation'),\n              children: \"Demographics\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 492,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 485,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"dashboard-actions\",\n            children: [activeTab === 'overview' && /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"action-btn\",\n              onClick: () => setShowThresholdModal(true),\n              title: \"Configure thresholds\",\n              children: [/*#__PURE__*/_jsxDEV(Settings, {\n                size: 18\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 508,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                children: \"Thresholds\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 509,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 503,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"btn-action\",\n              onClick: handleRefresh,\n              disabled: refreshing,\n              title: activeTab === 'overview' ? 'Refresh all Overview widgets' : 'Refresh all Demographics widgets',\n              children: [refreshing ? /*#__PURE__*/_jsxDEV(Loader, {\n                size: 16,\n                className: \"spinning\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 518,\n                columnNumber: 31\n              }, this) : /*#__PURE__*/_jsxDEV(RefreshCw, {\n                size: 16\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 518,\n                columnNumber: 75\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                children: \"Refresh All\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 519,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 512,\n              columnNumber: 15\n            }, this), metrics.lastRefreshed && /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"last-refreshed-text\",\n              children: [\"Last refreshed: \", formatDate(metrics.lastRefreshed)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 522,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 501,\n            columnNumber: 13\n          }, this), activeTab === 'overview' && /*#__PURE__*/_jsxDEV(OverviewTab, {\n            metrics: metrics,\n            kycStatus: kycStatus,\n            byCountry: byCountry,\n            byLanguage: byLanguage,\n            byProject: byProject,\n            byCountryLanguage: byCountryLanguage,\n            bySource: bySource,\n            byContributorSource: byContributorSource,\n            byContributorStatus: byContributorStatus,\n            byContributorType: byContributorType,\n            historicalData: historicalData,\n            showTrendChart: showTrendChart,\n            setShowTrendChart: setShowTrendChart,\n            thresholds: thresholds,\n            getMetricColor: (key, value) => getMetricColor(key, value, thresholds),\n            formatNumber: formatNumber,\n            formatDate: formatDate,\n            exportToExcel: handleExportToExcel,\n            renderWidgetRefresh: handleRenderWidgetRefresh,\n            renderWidgetStatus: handleRenderWidgetStatus,\n            renderWidgetActions: handleRenderWidgetActions,\n            renderFilterUI: handleRenderFilterUI,\n            applyFilters: handleApplyFilters,\n            handleChartClick: handleChartClick,\n            handleWidgetRefresh: handleWidgetRefresh,\n            widgetStates: widgetStates\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 530,\n            columnNumber: 15\n          }, this), activeTab === 'demographic-segmentation' && /*#__PURE__*/_jsxDEV(DemographicSegmentationTab, {\n            formatNumber: formatNumber,\n            formatDate: formatDate,\n            handleChartClick: handleChartClick,\n            metrics: metrics,\n            onRefreshAll: demographicsRefreshRef,\n            autoSaveBaseline: autoSaveBaseline\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 561,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 483,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 453,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 452,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(ThresholdModal, {\n      show: showThresholdModal,\n      onClose: () => setShowThresholdModal(false),\n      thresholds: thresholds,\n      setThresholds: setThresholds\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 575,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(DrillDownModal, {\n      drillDownData: drillDownData,\n      onClose: () => setDrillDownData(null)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 583,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 450,\n    columnNumber: 5\n  }, this);\n};\n_s(CrowdDashboard, \"s7rBisBKll/n4bJuFdKnEjuwlhk=\", false, function () {\n  return [useAuth, useCrowdDashboardData];\n});\n_c = CrowdDashboard;\nexport default CrowdDashboard;\nvar _c;\n$RefreshReg$(_c, \"CrowdDashboard\");","map":{"version":3,"names":["React","useState","useEffect","useCallback","useRef","useMemo","useAuth","Sidebar","Menu","LogOut","RefreshCw","Settings","Loader","toast","BookmarkButton","OverviewTab","DemographicSegmentationTab","ThresholdModal","DrillDownModal","useCrowdDashboardData","loadBaselineData","saveBaselineData","loadThresholds","saveThresholds","formatNumber","formatDate","getMetricColor","exportToExcel","getTrendData","applyFilters","renderWidgetRefresh","renderWidgetActions","renderWidgetStatus","renderFilterUI","BASELINE_STORAGE_KEY","THRESHOLDS_STORAGE_KEY","HISTORICAL_DATA_KEY","jsxDEV","_jsxDEV","CrowdDashboard","_s","user","logout","sidebarOpen","setSidebarOpen","loading","setLoading","refreshing","setRefreshing","activeTab","setActiveTab","metrics","setMetrics","baseline","targetHC","totalApplications","totalQualified","totalActiveOnProjects","totalProductive","onboardingContributors","activeContributors","avgAppReceivedToApplied","avgAppReceivedToActive","lastRefreshed","kycStatus","setKycStatus","byCountry","setByCountry","byLanguage","setByLanguage","byProject","setByProject","byCountryLanguage","setByCountryLanguage","bySource","setBySource","byContributorSource","setByContributorSource","byContributorStatus","setByContributorStatus","byContributorType","setByContributorType","widgetStates","setWidgetStates","baseMetrics","error","thresholds","setThresholds","showThresholdModal","setShowThresholdModal","filters","setFilters","dateRange","start","end","status","project","country","language","showFilters","setShowFilters","debouncedFilters","setDebouncedFilters","timer","setTimeout","clearTimeout","drillDownData","setDrillDownData","historicalData","setHistoricalData","saved","localStorage","getItem","JSON","parse","showTrendChart","setShowTrendChart","fetchBaseMetrics","fetchActiveContributors","fetchOnboardingContributors","fetchKYCStatus","fetchByCountry","fetchByLanguage","fetchByProject","fetchByCountryLanguage","fetchBySource","fetchAvgAppReceivedToApplied","fetchAvgAppReceivedToActive","fetchByContributorSource","fetchByContributorStatus","fetchByContributorType","fetchAllData","_baseline$kycStatus","_baseline$byProject","hasOverviewData","length","saveCurrentAsBaseline","dashboardState","savedAt","Date","toISOString","success","autoSaveBaseline","existingBaseline","hasData","handleOverviewRefresh","demographicsRefreshRef","handleRefresh","current","finally","handleWidgetRefresh","widgetKey","saveHistoricalSnapshot","snapshot","timestamp","prev","lightweightSnapshot","updated","slice","setItem","stringify","reduced","retryError","handleExportToExcel","data","widgetName","handleGetTrendData","metricKey","handleApplyFilters","handleChartClick","handleSaveThresholds","newThresholds","chartColors","handleRenderWidgetRefresh","handleRenderWidgetActions","handleRenderWidgetStatus","handleRenderFilterUI","className","children","isOpen","toggleSidebar","fileName","_jsxFileName","lineNumber","columnNumber","style","marginLeft","onClick","size","pageName","pageType","email","charAt","toUpperCase","title","disabled","key","value","onRefreshAll","show","onClose","_c","$RefreshReg$"],"sources":["/Users/mmoola/Cursor/ProjectSetup/client/src/pages/CrowdDashboard.js"],"sourcesContent":["import React, { useState, useEffect, useCallback, useRef, useMemo } from 'react';\nimport { useAuth } from '../context/AuthContext';\nimport Sidebar from '../components/Sidebar';\nimport { Menu, LogOut, RefreshCw, Settings, Loader } from 'lucide-react';\nimport toast from 'react-hot-toast';\nimport BookmarkButton from '../components/BookmarkButton';\nimport '../styles/CrowdDashboard.css';\nimport '../styles/Sidebar.css';\nimport '../styles/GlobalHeader.css';\nimport OverviewTab from './CrowdDashboard/components/OverviewTab';\nimport DemographicSegmentationTab from './CrowdDashboard/components/DemographicSegmentationTab';\nimport ThresholdModal from './CrowdDashboard/components/ThresholdModal';\nimport DrillDownModal from './CrowdDashboard/components/DrillDownModal';\nimport { useCrowdDashboardData } from './CrowdDashboard/hooks';\nimport { \n  loadBaselineData, \n  saveBaselineData, \n  loadThresholds, \n  saveThresholds,\n  formatNumber, \n  formatDate, \n  getMetricColor, \n  exportToExcel, \n  getTrendData, \n  applyFilters \n} from './CrowdDashboard/utils';\nimport { \n  renderWidgetRefresh, \n  renderWidgetActions, \n  renderWidgetStatus, \n  renderFilterUI \n} from './CrowdDashboard/components/WidgetHelpers';\nimport { BASELINE_STORAGE_KEY, THRESHOLDS_STORAGE_KEY, HISTORICAL_DATA_KEY } from './CrowdDashboard/constants';\n\nconst CrowdDashboard = () => {\n  const { user, logout } = useAuth();\n  const [sidebarOpen, setSidebarOpen] = useState(true);\n  const [loading, setLoading] = useState(false); // Don't block UI - show widgets immediately\n  const [refreshing, setRefreshing] = useState(false);\n  const [activeTab, setActiveTab] = useState('overview');\n  \n  // Initialize state with baseline data if available (using lazy initializer)\n  // Load baseline once and reuse for all state initializations\n  const [metrics, setMetrics] = useState(() => {\n    const baseline = loadBaselineData();\n    return baseline?.metrics || {\n      targetHC: 0,\n      totalApplications: 0,\n      totalQualified: 0,\n      totalActiveOnProjects: 0,\n      totalProductive: 0,\n      onboardingContributors: 0,\n      activeContributors: 0,\n      avgAppReceivedToApplied: 0,\n      avgAppReceivedToActive: 0,\n      lastRefreshed: null\n    };\n  });\n  const [kycStatus, setKycStatus] = useState(() => {\n    const baseline = loadBaselineData();\n    return baseline?.kycStatus || [];\n  });\n  const [byCountry, setByCountry] = useState(() => {\n    const baseline = loadBaselineData();\n    return baseline?.byCountry || [];\n  });\n  const [byLanguage, setByLanguage] = useState(() => {\n    const baseline = loadBaselineData();\n    return baseline?.byLanguage || [];\n  });\n  const [byProject, setByProject] = useState(() => {\n    const baseline = loadBaselineData();\n    return baseline?.byProject || [];\n  });\n  const [byCountryLanguage, setByCountryLanguage] = useState(() => {\n    const baseline = loadBaselineData();\n    return baseline?.byCountryLanguage || [];\n  });\n  const [bySource, setBySource] = useState(() => {\n    const baseline = loadBaselineData();\n    return baseline?.bySource || [];\n  });\n  const [byContributorSource, setByContributorSource] = useState(() => {\n    const baseline = loadBaselineData();\n    return baseline?.byContributorSource || [];\n  });\n  const [byContributorStatus, setByContributorStatus] = useState(() => {\n    const baseline = loadBaselineData();\n    return baseline?.byContributorStatus || [];\n  });\n  const [byContributorType, setByContributorType] = useState(() => {\n    const baseline = loadBaselineData();\n    return baseline?.byContributorType || [];\n  });\n  \n  \n  // Track loading and error states per widget\n  const [widgetStates, setWidgetStates] = useState({\n    baseMetrics: { loading: false, error: null },\n    activeContributors: { loading: false, error: null },\n    onboardingContributors: { loading: false, error: null },\n    kycStatus: { loading: false, error: null },\n    bySource: { loading: false, error: null },\n    byContributorSource: { loading: false, error: null },\n    byContributorStatus: { loading: false, error: null },\n    byContributorType: { loading: false, error: null },\n    byCountry: { loading: false, error: null },\n    byLanguage: { loading: false, error: null },\n    byProject: { loading: false, error: null },\n    byCountryLanguage: { loading: false, error: null }\n  });\n\n  const [thresholds, setThresholds] = useState(loadThresholds);\n  const [showThresholdModal, setShowThresholdModal] = useState(false);\n  \n  // Filtering state - separate state for each widget to avoid unnecessary re-renders\n  const [filters, setFilters] = useState({\n    dateRange: { start: null, end: null },\n    status: null,\n    project: null,\n    country: null,\n    language: null\n  });\n  const [showFilters, setShowFilters] = useState({});\n  \n  // Debounced filter values to prevent excessive re-renders\n  const [debouncedFilters, setDebouncedFilters] = useState(filters);\n  \n  // Debounce filter changes\n  useEffect(() => {\n    const timer = setTimeout(() => {\n      setDebouncedFilters(filters);\n    }, 300);\n    return () => clearTimeout(timer);\n  }, [filters]);\n\n  const [drillDownData, setDrillDownData] = useState(null);\n  \n  // Historical data state\n  const [historicalData, setHistoricalData] = useState(() => {\n    try {\n      const saved = localStorage.getItem(HISTORICAL_DATA_KEY);\n      if (saved) {\n        return JSON.parse(saved);\n      }\n    } catch (error) {\n      // Silently fail historical data loading\n    }\n    return [];\n  });\n  const [showTrendChart, setShowTrendChart] = useState({});\n\n  // Use extracted data fetching hook\n  const {\n    fetchBaseMetrics,\n    fetchActiveContributors,\n    fetchOnboardingContributors,\n    fetchKYCStatus,\n    fetchByCountry,\n    fetchByLanguage,\n    fetchByProject,\n    fetchByCountryLanguage,\n    fetchBySource,\n    fetchAvgAppReceivedToApplied,\n    fetchAvgAppReceivedToActive,\n    fetchByContributorSource,\n    fetchByContributorStatus,\n    fetchByContributorType,\n    fetchAllData\n  } = useCrowdDashboardData(\n    setMetrics,\n    setKycStatus,\n    setByCountry,\n    setByLanguage,\n    setByProject,\n    setByCountryLanguage,\n    setBySource,\n    setByContributorSource,\n    setByContributorStatus,\n    setByContributorType,\n    setWidgetStates\n  );\n\n  // All fetch functions are now provided by useCrowdDashboardData hook\n\n  // Log baseline data on mount and fetch only if baseline doesn't exist\n  // This must be after fetchAllData is defined\n  useEffect(() => {\n    const baseline = loadBaselineData();\n    if (baseline) {\n      // Only fetch if baseline is missing critical overview data\n      const hasOverviewData = baseline.metrics && \n                             (baseline.metrics.totalApplications > 0 || \n                              baseline.kycStatus?.length > 0 || \n                              baseline.byProject?.length > 0);\n      \n      if (!hasOverviewData) {\n        fetchAllData(true); // Silent fetch\n      }\n    } else {\n      fetchAllData(true); // Silent fetch on first load\n    }\n  }, [fetchAllData]);\n\n  // Save current dashboard state as baseline\n  const saveCurrentAsBaseline = useCallback(() => {\n    const dashboardState = {\n      metrics,\n      kycStatus,\n      byCountry,\n      byLanguage,\n      byProject,\n      byCountryLanguage,\n      bySource,\n      byContributorSource,\n      byContributorStatus,\n      byContributorType,\n      // Note: Demographic data is saved separately in DemographicSegmentationTab component\n      savedAt: new Date().toISOString()\n    };\n    if (saveBaselineData(dashboardState)) {\n      toast.success('Baseline data saved successfully');\n    } else {\n      toast.error('Failed to save baseline data');\n    }\n  }, [metrics, kycStatus, byCountry, byLanguage, byProject, byCountryLanguage, bySource, byContributorSource, byContributorStatus, byContributorType]);\n\n  // Auto-save baseline whenever data changes (debounced)\n  // This will be called from both main component and demographic tab\n  // We'll merge with existing baseline to preserve all data\n  const autoSaveBaseline = useCallback(() => {\n    const existingBaseline = loadBaselineData() || {};\n    const dashboardState = {\n      ...existingBaseline, // Preserve demographic data if it exists\n      metrics,\n      kycStatus,\n      byCountry,\n      byLanguage,\n      byProject,\n      byCountryLanguage,\n      bySource,\n      byContributorSource,\n      byContributorStatus,\n      byContributorType,\n      savedAt: new Date().toISOString()\n    };\n    saveBaselineData(dashboardState);\n  }, [metrics, kycStatus, byCountry, byLanguage, byProject, byCountryLanguage, bySource, byContributorSource, byContributorStatus, byContributorType]);\n\n  useEffect(() => {\n    // Only auto-save if we have meaningful data (not all zeros/empty)\n    const hasData = metrics.totalApplications > 0 || \n                   metrics.totalQualified > 0 || \n                   kycStatus.length > 0 || \n                   byProject.length > 0;\n    \n    if (hasData) {\n      const timer = setTimeout(() => {\n        autoSaveBaseline();\n      }, 2000); // Debounce: save 2 seconds after last change\n      \n      return () => clearTimeout(timer);\n    }\n  }, [metrics, kycStatus, byCountry, byLanguage, byProject, byCountryLanguage, bySource, byContributorSource, byContributorStatus, byContributorType, autoSaveBaseline]);\n\n  // Overview tab refresh handler\n  const handleOverviewRefresh = useCallback(() => {\n    setRefreshing(true);\n    fetchAllData(false);\n    setTimeout(() => setRefreshing(false), 1000);\n  }, [fetchAllData]);\n\n  // Ref to store demographics refresh function\n  const demographicsRefreshRef = useRef(null);\n\n  // Tab-specific refresh handler\n  const handleRefresh = useCallback(() => {\n    if (activeTab === 'overview') {\n      handleOverviewRefresh();\n    } else if (activeTab === 'demographic-segmentation' && demographicsRefreshRef.current) {\n      setRefreshing(true);\n      demographicsRefreshRef.current(false).finally(() => {\n        setTimeout(() => setRefreshing(false), 1000);\n      });\n    }\n  }, [activeTab, handleOverviewRefresh]);\n\n  // Widget-level refresh handlers\n  const handleWidgetRefresh = (widgetKey) => {\n    switch(widgetKey) {\n      case 'baseMetrics':\n        fetchBaseMetrics(false, widgetKey);\n        break;\n      case 'activeContributors':\n        fetchActiveContributors(false, widgetKey);\n        break;\n      case 'onboardingContributors':\n        fetchOnboardingContributors(false, widgetKey);\n        break;\n      case 'avgAppReceivedToApplied':\n        fetchAvgAppReceivedToApplied(false, widgetKey);\n        break;\n      case 'avgAppReceivedToActive':\n        fetchAvgAppReceivedToActive(false, widgetKey);\n        break;\n      case 'kycStatus':\n        fetchKYCStatus(false, widgetKey);\n        break;\n      case 'byCountry':\n        fetchByCountry(false, widgetKey);\n        break;\n      case 'byLanguage':\n        fetchByLanguage(false, widgetKey);\n        break;\n      case 'byProject':\n        fetchByProject(false, widgetKey);\n        break;\n      case 'byCountryLanguage':\n        fetchByCountryLanguage(false, widgetKey, true); // Start with top 20 for fast refresh\n        break;\n      case 'bySource':\n        fetchBySource(false, widgetKey);\n        break;\n      case 'byContributorSource':\n        fetchByContributorSource(false, widgetKey);\n        break;\n      case 'byContributorStatus':\n        fetchByContributorStatus(false, widgetKey);\n        break;\n      case 'byContributorType':\n        fetchByContributorType(false, widgetKey);\n        break;\n      default:\n        break;\n    }\n  };\n\n  // formatDate is imported from utils\n\n  // Save historical data snapshot\n  const saveHistoricalSnapshot = useCallback(() => {\n    const snapshot = {\n      timestamp: new Date().toISOString(),\n      metrics: { ...metrics },\n      kycStatus: [...kycStatus],\n      byProject: [...byProject],\n      byCountryLanguage: [...byCountryLanguage]\n    };\n    setHistoricalData(prev => {\n      // Reduce snapshot size - exclude large arrays and keep only essential data\n      const lightweightSnapshot = {\n        timestamp: snapshot.timestamp,\n        metrics: snapshot.metrics,\n        kycStatus: snapshot.kycStatus,\n        byProject: snapshot.byProject\n        // Exclude byCountryLanguage to save space\n      };\n      const updated = [...prev, lightweightSnapshot].slice(-30); // Keep last 30 snapshots (reduced from 100)\n      try {\n        localStorage.setItem(HISTORICAL_DATA_KEY, JSON.stringify(updated));\n      } catch (error) {\n        // If quota exceeded, try to clear old data and keep only last 10\n        try {\n          const reduced = updated.slice(-10);\n          localStorage.setItem(HISTORICAL_DATA_KEY, JSON.stringify(reduced));\n        } catch (retryError) {\n          // Silently fail if even reduced data can't be saved\n        }\n      }\n      return updated;\n    });\n  }, [metrics, kycStatus, byProject, byCountryLanguage]);\n\n  // Auto-save historical snapshot when data changes\n  useEffect(() => {\n    const hasData = metrics.totalApplications > 0 || kycStatus.length > 0 || byProject.length > 0;\n    if (hasData) {\n      const timer = setTimeout(() => {\n        saveHistoricalSnapshot();\n      }, 5000); // Save snapshot 5 seconds after data update\n      return () => clearTimeout(timer);\n    }\n  }, [metrics, kycStatus, byProject, byCountryLanguage, saveHistoricalSnapshot]);\n\n  // exportToExcel, getTrendData, and applyFilters are imported from utils\n  // Create wrapper functions that pass the required parameters\n  const handleExportToExcel = useCallback((widgetKey, data, widgetName) => {\n    exportToExcel(widgetKey, data, widgetName, metrics, kycStatus, byProject, byCountryLanguage, bySource);\n  }, [metrics, kycStatus, byProject, byCountryLanguage, bySource]);\n\n  const handleGetTrendData = useCallback((metricKey) => {\n    return getTrendData(metricKey, historicalData);\n  }, [historicalData]);\n\n  const handleApplyFilters = useCallback((data, widgetKey) => {\n    return applyFilters(data, widgetKey, debouncedFilters);\n  }, [debouncedFilters]);\n\n  // Handle chart click for drill-down\n  const handleChartClick = useCallback((data, widgetKey) => {\n    setDrillDownData({ data, widgetKey });\n  }, []);\n\n  // Save thresholds wrapper\n  const handleSaveThresholds = useCallback((newThresholds) => {\n    setThresholds(newThresholds);\n    if (saveThresholds(newThresholds)) {\n      toast.success('Thresholds saved successfully');\n    } else {\n      toast.error('Failed to save thresholds');\n    }\n  }, []);\n\n  // Chart colors\n  const chartColors = ['#3b82f6', '#10b981', '#f59e0b', '#ef4444', '#8b5cf6', '#06b6d4', '#ec4899', '#84cc16'];\n\n  // Wrapper functions for widget helpers\n  const handleRenderWidgetRefresh = (widgetKey) => {\n    return renderWidgetRefresh(widgetKey, widgetStates, handleWidgetRefresh);\n  };\n\n  const handleRenderWidgetActions = (widgetKey, widgetName, hasData = true) => {\n    return renderWidgetActions(\n      widgetKey,\n      widgetName,\n      widgetStates,\n      handleWidgetRefresh,\n      setShowFilters,\n      showFilters,\n      setShowTrendChart,\n      showTrendChart,\n      historicalData,\n      metrics,\n      kycStatus,\n      byProject,\n      byCountryLanguage,\n      bySource\n    );\n  };\n\n  const handleRenderWidgetStatus = (widgetKey) => {\n    return renderWidgetStatus(widgetKey, widgetStates, handleWidgetRefresh);\n  };\n\n  const handleRenderFilterUI = useCallback((widgetKey) => {\n    return renderFilterUI(widgetKey, showFilters, filters, setFilters, setShowFilters);\n  }, [showFilters, filters]);\n\n  return (\n    <div className=\"dashboard-layout\">\n      <Sidebar isOpen={sidebarOpen} toggleSidebar={() => setSidebarOpen(!sidebarOpen)} />\n      <div className=\"crowd-dashboard\" style={{ marginLeft: sidebarOpen ? '320px' : '80px' }}>\n        <div className=\"crowd-dashboard-container\">\n          <div className=\"crowd-dashboard-header\">\n            <div className=\"header-content\">\n              <div className=\"header-left\">\n                <button\n                  className=\"header-menu-toggle\"\n                  onClick={() => setSidebarOpen(!sidebarOpen)}\n                >\n                  <Menu size={20} />\n                </button>\n                <div>\n                  <h1 className=\"page-title\">Crowd Dashboard</h1>\n                  <p className=\"page-subtitle\">View contributor metrics and analytics</p>\n                </div>\n              </div>\n              <div className=\"header-user-profile\">\n                <BookmarkButton pageName=\"Crowd Dashboard\" pageType=\"page\" />\n                <div className=\"user-profile\">\n                  <div className=\"user-avatar\">\n                    {(user?.email || 'U').charAt(0).toUpperCase()}\n                  </div>\n                  <span className=\"user-name\">{user?.email || 'User'}</span>\n                  <button className=\"logout-btn\" onClick={logout} title=\"Logout\">\n                    <LogOut size={18} />\n                  </button>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          <div className=\"crowd-dashboard-content\">\n            {/* Tabs */}\n            <div className=\"crowd-dashboard-tabs\">\n              <button\n                className={`tab-button ${activeTab === 'overview' ? 'active' : ''}`}\n                onClick={() => setActiveTab('overview')}\n              >\n                Overview\n              </button>\n              <button\n                className={`tab-button ${activeTab === 'demographic-segmentation' ? 'active' : ''}`}\n                onClick={() => setActiveTab('demographic-segmentation')}\n              >\n                Demographics\n              </button>\n            </div>\n\n            {/* Action Buttons */}\n            <div className=\"dashboard-actions\">\n              {activeTab === 'overview' && (\n              <button \n                className=\"action-btn\" \n                onClick={() => setShowThresholdModal(true)}\n                title=\"Configure thresholds\"\n              >\n                <Settings size={18} />\n                <span>Thresholds</span>\n              </button>\n              )}\n              <button \n                className=\"btn-action\" \n                onClick={handleRefresh}\n                disabled={refreshing}\n                title={activeTab === 'overview' ? 'Refresh all Overview widgets' : 'Refresh all Demographics widgets'}\n              >\n                {refreshing ? <Loader size={16} className=\"spinning\" /> : <RefreshCw size={16} />}\n                <span>Refresh All</span>\n              </button>\n              {metrics.lastRefreshed && (\n                <span className=\"last-refreshed-text\">\n                  Last refreshed: {formatDate(metrics.lastRefreshed)}\n                </span>\n              )}\n            </div>\n\n            {/* Tab Content */}\n            {activeTab === 'overview' && (\n              <OverviewTab\n                metrics={metrics}\n                kycStatus={kycStatus}\n                byCountry={byCountry}\n                byLanguage={byLanguage}\n                byProject={byProject}\n                byCountryLanguage={byCountryLanguage}\n                bySource={bySource}\n                byContributorSource={byContributorSource}\n                byContributorStatus={byContributorStatus}\n                byContributorType={byContributorType}\n                historicalData={historicalData}\n                showTrendChart={showTrendChart}\n                setShowTrendChart={setShowTrendChart}\n                thresholds={thresholds}\n                getMetricColor={(key, value) => getMetricColor(key, value, thresholds)}\n                formatNumber={formatNumber}\n                formatDate={formatDate}\n                exportToExcel={handleExportToExcel}\n                renderWidgetRefresh={handleRenderWidgetRefresh}\n                renderWidgetStatus={handleRenderWidgetStatus}\n                renderWidgetActions={handleRenderWidgetActions}\n                renderFilterUI={handleRenderFilterUI}\n                applyFilters={handleApplyFilters}\n                handleChartClick={handleChartClick}\n                handleWidgetRefresh={handleWidgetRefresh}\n                widgetStates={widgetStates}\n              />\n            )}\n\n            {activeTab === 'demographic-segmentation' && (\n              <DemographicSegmentationTab\n                formatNumber={formatNumber}\n                formatDate={formatDate}\n                handleChartClick={handleChartClick}\n                metrics={metrics}\n                onRefreshAll={demographicsRefreshRef}\n                autoSaveBaseline={autoSaveBaseline}\n              />\n            )}\n          </div>\n        </div>\n      </div>\n\n      {/* Threshold Configuration Modal */}\n      <ThresholdModal\n        show={showThresholdModal}\n        onClose={() => setShowThresholdModal(false)}\n        thresholds={thresholds}\n        setThresholds={setThresholds}\n      />\n\n      {/* Drill-Down Modal */}\n      <DrillDownModal\n        drillDownData={drillDownData}\n        onClose={() => setDrillDownData(null)}\n      />\n    </div>\n  );\n};\n\nexport default CrowdDashboard;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}