{"ast":null,"code":"import React,{useState,useRef}from'react';import{useAuth}from'../context/AuthContext';import Sidebar from'../components/Sidebar';import{Menu,LogOut,FileText,BarChart3,Save}from'lucide-react';import SaveReportModal from'../components/AdvancedReportBuilder/SaveReportModal';import toast from'react-hot-toast';import AdvancedBuilderCanvas from'../components/AdvancedReportBuilder/AdvancedBuilderCanvas';import AdvancedReportsList from'../components/AdvancedReportBuilder/AdvancedReportsList';import'../styles/Sidebar.css';import'../styles/GlobalHeader.css';import'../styles/AdvancedReportBuilder.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const AdvancedReportBuilder=()=>{const{user,logout}=useAuth();const[sidebarOpen,setSidebarOpen]=useState(true);const[activeTab,setActiveTab]=useState('builder');// 'builder' or 'reports'\nconst[showSaveModal,setShowSaveModal]=useState(false);const builderCanvasRef=useRef(null);const handleSave=reportConfig=>{try{// Load existing reports\nconst existing=localStorage.getItem('advanced_saved_reports');const reports=existing?JSON.parse(existing):[];// Check if updating existing or creating new\nconst existingIndex=reports.findIndex(r=>r.id===reportConfig.id);if(existingIndex>=0){reports[existingIndex]=reportConfig;toast.success('Report updated successfully!');}else{reports.push(reportConfig);toast.success('Report saved successfully!');}localStorage.setItem('advanced_saved_reports',JSON.stringify(reports));// Switch to Reports tab to show the saved report\nsetActiveTab('reports');}catch(error){console.error('Error saving report:',error);toast.error('Failed to save report');}};const getReportConfig=()=>{// Get report config from builder canvas\nif(builderCanvasRef.current&&builderCanvasRef.current.getReportConfig){return builderCanvasRef.current.getReportConfig();}return null;};return/*#__PURE__*/_jsxs(\"div\",{className:\"dashboard-layout\",children:[/*#__PURE__*/_jsx(Sidebar,{isOpen:sidebarOpen,toggleSidebar:()=>setSidebarOpen(!sidebarOpen)}),/*#__PURE__*/_jsx(\"div\",{style:{marginLeft:sidebarOpen?'320px':'80px',transition:'margin-left 0.3s ease',width:sidebarOpen?'calc(100% - 320px)':'calc(100% - 80px)'},children:/*#__PURE__*/_jsxs(\"div\",{className:\"advanced-report-builder-container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"advanced-report-builder-header\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"header-content\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"header-left\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"header-menu-toggle\",onClick:()=>setSidebarOpen(!sidebarOpen),\"aria-label\":\"Toggle sidebar\",children:/*#__PURE__*/_jsx(Menu,{size:20})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"page-title\",children:\"Advanced Report Builder\"}),/*#__PURE__*/_jsx(\"p\",{className:\"page-subtitle\",children:\"Create reports with drag-and-drop interface\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"header-right\",children:[activeTab==='builder'&&/*#__PURE__*/_jsxs(\"button\",{className:\"save-report-btn\",onClick:()=>setShowSaveModal(true),children:[/*#__PURE__*/_jsx(Save,{size:16}),\" Save Report\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"header-user-profile\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"user-profile\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"user-avatar\",children:((user===null||user===void 0?void 0:user.email)||'U').charAt(0).toUpperCase()}),/*#__PURE__*/_jsx(\"span\",{className:\"user-name\",children:(user===null||user===void 0?void 0:user.email)||'User'}),/*#__PURE__*/_jsx(\"button\",{className:\"logout-btn\",onClick:logout,title:\"Logout\",children:/*#__PURE__*/_jsx(LogOut,{size:18})})]})})]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"advanced-builder-tabs\",children:[/*#__PURE__*/_jsxs(\"button\",{className:\"advanced-tab-button \".concat(activeTab==='builder'?'active':''),onClick:()=>setActiveTab('builder'),children:[/*#__PURE__*/_jsx(FileText,{size:16}),\" Builder\"]}),/*#__PURE__*/_jsxs(\"button\",{className:\"advanced-tab-button \".concat(activeTab==='reports'?'active':''),onClick:()=>setActiveTab('reports'),children:[/*#__PURE__*/_jsx(BarChart3,{size:16}),\" Reports\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"advanced-builder-content\",children:[activeTab==='builder'&&/*#__PURE__*/_jsx(AdvancedBuilderCanvas,{ref:builderCanvasRef}),activeTab==='reports'&&/*#__PURE__*/_jsx(AdvancedReportsList,{onEditReport:report=>{// Load report in builder\nsetActiveTab('builder');// TODO: Pass report data to builder\n}})]})]})}),/*#__PURE__*/_jsx(SaveReportModal,{show:showSaveModal,onClose:()=>setShowSaveModal(false),reportConfig:getReportConfig()||{name:'',objectType:'',fields:[],relationships:[],subqueries:[],filters:[],category:'Uncategorized'},onSave:handleSave})]});};export default AdvancedReportBuilder;","map":{"version":3,"names":["React","useState","useRef","useAuth","Sidebar","Menu","LogOut","FileText","BarChart3","Save","SaveReportModal","toast","AdvancedBuilderCanvas","AdvancedReportsList","jsx","_jsx","jsxs","_jsxs","AdvancedReportBuilder","user","logout","sidebarOpen","setSidebarOpen","activeTab","setActiveTab","showSaveModal","setShowSaveModal","builderCanvasRef","handleSave","reportConfig","existing","localStorage","getItem","reports","JSON","parse","existingIndex","findIndex","r","id","success","push","setItem","stringify","error","console","getReportConfig","current","className","children","isOpen","toggleSidebar","style","marginLeft","transition","width","onClick","size","email","charAt","toUpperCase","title","concat","ref","onEditReport","report","show","onClose","name","objectType","fields","relationships","subqueries","filters","category","onSave"],"sources":["/Users/mmoola/Cursor/ProjectSetup/client/src/pages/AdvancedReportBuilder.js"],"sourcesContent":["import React, { useState, useRef } from 'react';\nimport { useAuth } from '../context/AuthContext';\nimport Sidebar from '../components/Sidebar';\nimport { Menu, LogOut, FileText, BarChart3, Save } from 'lucide-react';\nimport SaveReportModal from '../components/AdvancedReportBuilder/SaveReportModal';\nimport toast from 'react-hot-toast';\nimport AdvancedBuilderCanvas from '../components/AdvancedReportBuilder/AdvancedBuilderCanvas';\nimport AdvancedReportsList from '../components/AdvancedReportBuilder/AdvancedReportsList';\nimport '../styles/Sidebar.css';\nimport '../styles/GlobalHeader.css';\nimport '../styles/AdvancedReportBuilder.css';\n\nconst AdvancedReportBuilder = () => {\n  const { user, logout } = useAuth();\n  const [sidebarOpen, setSidebarOpen] = useState(true);\n  const [activeTab, setActiveTab] = useState('builder'); // 'builder' or 'reports'\n  const [showSaveModal, setShowSaveModal] = useState(false);\n  const builderCanvasRef = useRef(null);\n\n  const handleSave = (reportConfig) => {\n    try {\n      // Load existing reports\n      const existing = localStorage.getItem('advanced_saved_reports');\n      const reports = existing ? JSON.parse(existing) : [];\n      \n      // Check if updating existing or creating new\n      const existingIndex = reports.findIndex(r => r.id === reportConfig.id);\n      if (existingIndex >= 0) {\n        reports[existingIndex] = reportConfig;\n        toast.success('Report updated successfully!');\n      } else {\n        reports.push(reportConfig);\n        toast.success('Report saved successfully!');\n      }\n      \n      localStorage.setItem('advanced_saved_reports', JSON.stringify(reports));\n      \n      // Switch to Reports tab to show the saved report\n      setActiveTab('reports');\n    } catch (error) {\n      console.error('Error saving report:', error);\n      toast.error('Failed to save report');\n    }\n  };\n\n  const getReportConfig = () => {\n    // Get report config from builder canvas\n    if (builderCanvasRef.current && builderCanvasRef.current.getReportConfig) {\n      return builderCanvasRef.current.getReportConfig();\n    }\n    return null;\n  };\n\n  return (\n    <div className=\"dashboard-layout\">\n      <Sidebar isOpen={sidebarOpen} toggleSidebar={() => setSidebarOpen(!sidebarOpen)} />\n      <div \n        style={{ \n          marginLeft: sidebarOpen ? '320px' : '80px', \n          transition: 'margin-left 0.3s ease', \n          width: sidebarOpen ? 'calc(100% - 320px)' : 'calc(100% - 80px)' \n        }}\n      >\n        <div className=\"advanced-report-builder-container\">\n          {/* Header */}\n          <div className=\"advanced-report-builder-header\">\n            <div className=\"header-content\">\n              <div className=\"header-left\">\n                <button\n                  className=\"header-menu-toggle\"\n                  onClick={() => setSidebarOpen(!sidebarOpen)}\n                  aria-label=\"Toggle sidebar\"\n                >\n                  <Menu size={20} />\n                </button>\n                <div>\n                  <h1 className=\"page-title\">Advanced Report Builder</h1>\n                  <p className=\"page-subtitle\">Create reports with drag-and-drop interface</p>\n                </div>\n              </div>\n              <div className=\"header-right\">\n                {activeTab === 'builder' && (\n                  <button\n                    className=\"save-report-btn\"\n                    onClick={() => setShowSaveModal(true)}\n                  >\n                    <Save size={16} /> Save Report\n                  </button>\n                )}\n                <div className=\"header-user-profile\">\n                  <div className=\"user-profile\">\n                    <div className=\"user-avatar\">\n                      {(user?.email || 'U').charAt(0).toUpperCase()}\n                    </div>\n                    <span className=\"user-name\">{user?.email || 'User'}</span>\n                    <button className=\"logout-btn\" onClick={logout} title=\"Logout\">\n                      <LogOut size={18} />\n                    </button>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          {/* Tabs */}\n          <div className=\"advanced-builder-tabs\">\n            <button\n              className={`advanced-tab-button ${activeTab === 'builder' ? 'active' : ''}`}\n              onClick={() => setActiveTab('builder')}\n            >\n              <FileText size={16} /> Builder\n            </button>\n            <button\n              className={`advanced-tab-button ${activeTab === 'reports' ? 'active' : ''}`}\n              onClick={() => setActiveTab('reports')}\n            >\n              <BarChart3 size={16} /> Reports\n            </button>\n          </div>\n\n          {/* Content */}\n          <div className=\"advanced-builder-content\">\n            {activeTab === 'builder' && (\n              <AdvancedBuilderCanvas ref={builderCanvasRef} />\n            )}\n            {activeTab === 'reports' && (\n              <AdvancedReportsList onEditReport={(report) => {\n                // Load report in builder\n                setActiveTab('builder');\n                // TODO: Pass report data to builder\n              }} />\n            )}\n          </div>\n        </div>\n      </div>\n\n      {/* Save Modal */}\n      <SaveReportModal\n        show={showSaveModal}\n        onClose={() => setShowSaveModal(false)}\n        reportConfig={getReportConfig() || {\n          name: '',\n          objectType: '',\n          fields: [],\n          relationships: [],\n          subqueries: [],\n          filters: [],\n          category: 'Uncategorized'\n        }}\n        onSave={handleSave}\n      />\n    </div>\n  );\n};\n\nexport default AdvancedReportBuilder;\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}