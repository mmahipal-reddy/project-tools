{"ast":null,"code":"var _jsxFileName = \"/Users/mmoola/Cursor/ProjectSetup/client/src/pages/ReportBuilder.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useCallback, useRef } from 'react';\nimport { useAuth } from '../context/AuthContext';\nimport Sidebar from '../components/Sidebar';\nimport { Menu, LogOut } from 'lucide-react';\nimport apiClient from '../config/api';\nimport axios from 'axios';\nimport { exportData } from '../utils/crossFeature/exportService';\nimport toast from 'react-hot-toast';\nimport SavedReportsPanel from '../components/ReportBuilder/SavedReportsPanel';\nimport ReportConfiguration from '../components/ReportBuilder/ReportConfiguration';\nimport ReportViewPanel from '../components/ReportBuilder/ReportViewPanel';\nimport ReportsList from '../components/ReportBuilder/ReportsList';\nimport PreviewModal from '../components/ReportBuilder/PreviewModal';\nimport DeleteConfirmModal from '../components/ReportBuilder/DeleteConfirmModal';\nimport ScheduleModal from '../components/ReportBuilder/ScheduleModal';\nimport { hasPermission, PERMISSIONS, ROLES } from '../utils/rbac';\nimport '../styles/Sidebar.css';\nimport '../styles/GlobalHeader.css';\n\n// Custom axios instance for report generation with longer timeout\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst reportApiClient = axios.create({\n  baseURL: process.env.REACT_APP_API_URL || '/api',\n  headers: {\n    'Content-Type': 'application/json'\n  },\n  timeout: 600000 // 10 minutes for report generation\n});\n\n// Add auth token to report API client\nreportApiClient.interceptors.request.use(config => {\n  const token = localStorage.getItem('token');\n  if (token) {\n    config.headers.Authorization = `Bearer ${token}`;\n  }\n  return config;\n});\nconst ReportBuilder = () => {\n  _s();\n  const {\n    user,\n    logout\n  } = useAuth();\n  const [sidebarOpen, setSidebarOpen] = useState(true);\n  const [activeTab, setActiveTab] = useState('configuration');\n  const [viewMode, setViewMode] = useState(false);\n  const [selectedReportId, setSelectedReportId] = useState(null);\n  const [reportConfig, setReportConfig] = useState({\n    name: '',\n    objectType: '',\n    fields: [],\n    filters: {},\n    groupBy: null,\n    sortBy: null,\n    sortOrder: 'ASC',\n    limit: 10000,\n    category: 'Uncategorized'\n  });\n  const [availableObjects, setAvailableObjects] = useState([]);\n  const [availableFields, setAvailableFields] = useState([]);\n  const [filterOptions, setFilterOptions] = useState({});\n  const [previewData, setPreviewData] = useState(null);\n  const [fieldLabelMap, setFieldLabelMap] = useState({});\n  const [loading, setLoading] = useState(false);\n  const [loadingFields, setLoadingFields] = useState(false);\n  const [isPreviewing, setIsPreviewing] = useState(false);\n  const [isGenerating, setIsGenerating] = useState(false);\n  const [savedReports, setSavedReports] = useState([]);\n  const [showPreview, setShowPreview] = useState(false);\n  const [reportsHistory, setReportsHistory] = useState([]);\n  const [loadingHistory, setLoadingHistory] = useState(false);\n  const [showScheduleModal, setShowScheduleModal] = useState(false);\n  const [scheduleFormData, setScheduleFormData] = useState({\n    schedule: 'daily',\n    format: 'excel',\n    recipients: []\n  });\n  const [selectedCategory, setSelectedCategory] = useState('All');\n  const [showDeleteConfirm, setShowDeleteConfirm] = useState(false);\n  const [reportToDelete, setReportToDelete] = useState(null);\n  const [showPreviewModal, setShowPreviewModal] = useState(false);\n  const [previewModalData, setPreviewModalData] = useState(null);\n\n  // Use refs to track if operations are in progress (refs don't cause re-renders)\n  const previewInProgressRef = useRef(false);\n  const generateInProgressRef = useRef(false);\n  useEffect(() => {\n    loadAvailableObjects();\n    loadSavedReports();\n    if (activeTab === 'reports') {\n      loadReportsHistory();\n    }\n  }, [activeTab]);\n  useEffect(() => {\n    if (reportConfig.objectType) {\n      loadFieldsForObject(reportConfig.objectType);\n      loadFilterOptions(reportConfig.objectType);\n    } else {\n      setAvailableFields([]);\n      setFilterOptions({});\n    }\n  }, [reportConfig.objectType]);\n  useEffect(() => {\n    const labelMap = {};\n    availableFields.forEach(field => {\n      labelMap[field.name] = field.label || field.name;\n    });\n    // Add common field labels that might not be in availableFields (handle both naming conventions)\n    if (!labelMap['Active_Contributors__c']) {\n      labelMap['Active_Contributors__c'] = 'Active Contributors';\n    }\n    if (!labelMap['Active_Contributors_c__c']) {\n      labelMap['Active_Contributors_c__c'] = 'Active Contributors';\n    }\n    if (!labelMap['Applied_Contributors__c']) {\n      labelMap['Applied_Contributors__c'] = 'Applied Contributors';\n    }\n    if (!labelMap['Applied_Contributors_c__c']) {\n      labelMap['Applied_Contributors_c__c'] = 'Applied Contributors';\n    }\n    if (!labelMap['Qualified_Contributors__c']) {\n      labelMap['Qualified_Contributors__c'] = 'Qualified Contributors';\n    }\n    if (!labelMap['Qualified_Contributors_c__c']) {\n      labelMap['Qualified_Contributors_c__c'] = 'Qualified Contributors';\n    }\n    if (!labelMap['Removed__c']) {\n      labelMap['Removed__c'] = 'Removed';\n    }\n    if (!labelMap['Removed_c__c']) {\n      labelMap['Removed_c__c'] = 'Removed';\n    }\n    if (!labelMap['Total_Applied__c']) {\n      labelMap['Total_Applied__c'] = 'Total Applied';\n    }\n    if (!labelMap['Total_Qualified__c']) {\n      labelMap['Total_Qualified__c'] = 'Total Qualified';\n    }\n    setFieldLabelMap(labelMap);\n  }, [availableFields]);\n  const loadAvailableObjects = async () => {\n    try {\n      const response = await apiClient.get('/update-object-fields/objects');\n      if (response.data.success) {\n        setAvailableObjects(response.data.objects || []);\n      }\n    } catch (error) {\n      console.error('Error loading objects:', error);\n      toast.error('Failed to load available objects');\n    }\n  };\n  const loadFieldsForObject = async objectType => {\n    setLoadingFields(true);\n    try {\n      // Add forReporting=true query parameter to include read-only fields (like Total_Applied__c)\n      const response = await apiClient.get(`/update-object-fields/fields/${encodeURIComponent(objectType)}?forReporting=true`);\n      if (response.data.success) {\n        setAvailableFields(response.data.fields || []);\n      } else {\n        toast.error(response.data.error || 'Failed to load fields');\n      }\n    } catch (error) {\n      var _error$response, _error$response$data;\n      console.error('Error loading fields:', error);\n      toast.error(((_error$response = error.response) === null || _error$response === void 0 ? void 0 : (_error$response$data = _error$response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.error) || 'Failed to load fields');\n      setAvailableFields([]);\n    } finally {\n      setLoadingFields(false);\n    }\n  };\n  const loadFilterOptions = async objectType => {\n    try {\n      const response = await apiClient.get(`/update-object-fields/filter-options/${encodeURIComponent(objectType)}`);\n      if (response.data.success) {\n        setFilterOptions(response.data.filterOptions || {});\n      }\n    } catch (error) {\n      console.error('Error loading filter options:', error);\n    }\n  };\n  const loadSavedReports = () => {\n    try {\n      const saved = localStorage.getItem('saved_reports');\n      if (saved) {\n        setSavedReports(JSON.parse(saved));\n      }\n    } catch (error) {\n      console.error('Error loading saved reports:', error);\n    }\n  };\n  const loadReportsHistory = async () => {\n    setLoadingHistory(true);\n    try {\n      const [historyResponse, scheduledResponse] = await Promise.all([apiClient.get('/reports/history').catch(() => ({\n        data: {\n          success: true,\n          reports: []\n        }\n      })), apiClient.get('/scheduled-reports').catch(() => ({\n        data: {\n          success: true,\n          reports: []\n        }\n      }))]);\n      const manualReports = historyResponse.data.success ? historyResponse.data.reports || [] : [];\n      const scheduledReports = scheduledResponse.data.success ? (scheduledResponse.data.reports || []).map(r => ({\n        ...r,\n        type: 'scheduled',\n        generatedAt: r.lastRunAt || r.createdAt\n      })) : [];\n      const allReports = [...manualReports, ...scheduledReports].sort((a, b) => {\n        const dateA = new Date(a.generatedAt || a.createdAt || 0);\n        const dateB = new Date(b.generatedAt || b.createdAt || 0);\n        return dateB - dateA;\n      });\n      setReportsHistory(allReports);\n    } catch (error) {\n      console.error('Error loading reports history:', error);\n      toast.error('Failed to load reports history');\n    } finally {\n      setLoadingHistory(false);\n    }\n  };\n  const getCategories = () => {\n    const categories = new Set();\n    reportsHistory.forEach(report => {\n      categories.add(report.category || 'Uncategorized');\n    });\n    return Array.from(categories).sort();\n  };\n  const saveReport = () => {\n    if (!reportConfig.name) {\n      toast.error('Please enter a report name');\n      return;\n    }\n    if (!reportConfig.objectType) {\n      toast.error('Please select an object type');\n      return;\n    }\n    if (reportConfig.fields.length === 0) {\n      toast.error('Please select at least one field');\n      return;\n    }\n    try {\n      const reportToSave = {\n        ...reportConfig,\n        id: selectedReportId || `report_${Date.now()}`,\n        createdAt: new Date().toISOString(),\n        updatedAt: new Date().toISOString(),\n        fieldLabels: fieldLabelMap // Save field labels with the report\n      };\n\n      // Ensure filters are included (even if empty)\n      if (!reportToSave.filters) {\n        reportToSave.filters = {};\n      }\n      console.log('[ReportBuilder] Saving report with filters:', JSON.stringify(reportToSave.filters, null, 2));\n      console.log('[ReportBuilder] Saving report with fieldLabels:', Object.keys(reportToSave.fieldLabels || {}).length, 'labels');\n      let reports;\n      if (selectedReportId) {\n        reports = savedReports.map(r => r.id === selectedReportId ? reportToSave : r);\n      } else {\n        reports = [...savedReports, reportToSave];\n      }\n      localStorage.setItem('saved_reports', JSON.stringify(reports));\n      setSavedReports(reports);\n      setSelectedReportId(null);\n      toast.success('Report saved successfully');\n    } catch (error) {\n      console.error('[ReportBuilder] Error saving report:', error);\n      toast.error('Failed to save report');\n    }\n  };\n  const previewReport = useCallback(async event => {\n    // Prevent any default behavior\n    if (event) {\n      event.preventDefault();\n      event.stopPropagation();\n    }\n    console.log('[Preview] previewReport called', {\n      previewInProgress: previewInProgressRef.current,\n      generateInProgress: generateInProgressRef.current\n    });\n\n    // Early return if already in progress\n    if (previewInProgressRef.current || generateInProgressRef.current) {\n      console.log('[Preview] Already processing, returning early');\n      return;\n    }\n    if (!reportConfig.objectType || reportConfig.fields.length === 0) {\n      toast.error('Please select an object type and at least one field');\n      return;\n    }\n    console.log('[Preview] Starting preview...');\n    previewInProgressRef.current = true;\n    setIsPreviewing(true);\n    // Don't set shared loading state - use isPreviewing instead\n    try {\n      const response = await reportApiClient.post('/reports/preview', {\n        objectType: reportConfig.objectType,\n        fields: reportConfig.fields,\n        filters: reportConfig.filters,\n        sortBy: reportConfig.sortBy,\n        sortOrder: reportConfig.sortOrder,\n        groupBy: reportConfig.groupBy,\n        limit: reportConfig.limit,\n        fieldLabels: fieldLabelMap\n      });\n      if (response.data.success) {\n        const data = response.data.records || [];\n        console.log('[Preview] Response received:', {\n          success: response.data.success,\n          recordCount: data.length,\n          totalCount: response.data.count,\n          fieldLabels: response.data.fieldLabels,\n          sampleRecord: data[0] || null,\n          fieldsInSample: data[0] ? Object.keys(data[0]) : []\n        });\n\n        // Check for Falcon project specifically\n        const falconProject = data.find(r => r.Name && r.Name.includes('Falcon Background Gen Guardrail'));\n        if (falconProject) {\n          // Find all count-related fields dynamically\n          const countFields = Object.keys(falconProject).filter(k => k.includes('Contributor') || k.includes('Removed'));\n          const countFieldValues = {};\n          countFields.forEach(field => {\n            countFieldValues[field] = falconProject[field];\n          });\n          console.log('[Preview] ========== FALCON PROJECT DEBUG ==========');\n          console.log('[Preview] Project:', falconProject.Name);\n          console.log('[Preview] All fields in record:', Object.keys(falconProject));\n          console.log('[Preview] Count-related fields found:', countFields);\n          console.log('[Preview] Count field values:', countFieldValues);\n          console.log('[Preview] Field labels available:', Object.keys(response.data.fieldLabels || {}).filter(k => k.includes('Contributor') || k.includes('Removed')));\n        } else {\n          console.warn('[Preview] Falcon project NOT found in response records');\n          console.log('[Preview] Project names in response:', data.slice(0, 5).map(r => r.Name));\n        }\n\n        // Merge backend field labels with frontend fieldLabelMap\n        const mergedFieldLabels = {\n          ...fieldLabelMap,\n          ...(response.data.fieldLabels || {})\n        };\n\n        // Update fieldLabelMap with backend labels\n        if (response.data.fieldLabels) {\n          setFieldLabelMap(prev => ({\n            ...prev,\n            ...response.data.fieldLabels\n          }));\n        }\n        setPreviewModalData({\n          data,\n          fieldLabels: mergedFieldLabels,\n          count: data.length,\n          totalCount: response.data.count || data.length,\n          hasMore: response.data.hasMore || false\n        });\n        setShowPreviewModal(true);\n        toast.success(`Preview: ${response.data.count || data.length} records`);\n      }\n    } catch (error) {\n      var _error$response2, _error$response2$data;\n      console.error('Error previewing report:', error);\n      toast.error(((_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : (_error$response2$data = _error$response2.data) === null || _error$response2$data === void 0 ? void 0 : _error$response2$data.error) || 'Failed to preview report');\n    } finally {\n      previewInProgressRef.current = false;\n      setIsPreviewing(false);\n    }\n  }, [reportConfig.objectType, reportConfig.fields, reportConfig.filters, reportConfig.sortBy, reportConfig.sortOrder, reportConfig.groupBy, reportConfig.limit, reportConfig.name, reportConfig.category, fieldLabelMap]);\n  const generateReport = useCallback(async event => {\n    // Prevent any default behavior\n    if (event) {\n      event.preventDefault();\n      event.stopPropagation();\n    }\n    console.log('[Generate] generateReport called', {\n      previewInProgress: previewInProgressRef.current,\n      generateInProgress: generateInProgressRef.current\n    });\n\n    // Early return if already in progress\n    if (previewInProgressRef.current || generateInProgressRef.current) {\n      console.log('[Generate] Already processing, returning early');\n      return;\n    }\n    if (!reportConfig.objectType || reportConfig.fields.length === 0) {\n      toast.error('Please select an object type and at least one field');\n      return;\n    }\n    console.log('[Generate] Starting generation...');\n    generateInProgressRef.current = true;\n    setIsGenerating(true);\n    // Don't set shared loading state - use isGenerating instead\n    try {\n      const response = await reportApiClient.post('/reports/generate', {\n        objectType: reportConfig.objectType,\n        fields: reportConfig.fields,\n        filters: reportConfig.filters,\n        sortBy: reportConfig.sortBy,\n        sortOrder: reportConfig.sortOrder,\n        groupBy: reportConfig.groupBy,\n        limit: reportConfig.limit,\n        reportName: reportConfig.name || `Report ${new Date().toLocaleString()}`,\n        category: reportConfig.category || 'Uncategorized',\n        fieldLabels: fieldLabelMap\n      });\n      if (response.data.success) {\n        const data = response.data.records || [];\n        setPreviewData(data);\n        setFieldLabelMap(response.data.fieldLabels || fieldLabelMap);\n        setShowPreview(true);\n        setViewMode(true); // Switch to report view to show the generated report\n        toast.success(`Generated and saved ${response.data.count || data.length} records`);\n        if (activeTab === 'reports') {\n          loadReportsHistory();\n        }\n        setActiveTab('configuration'); // Keep on configuration tab but show report view\n      }\n    } catch (error) {\n      var _error$response3, _error$response3$data;\n      console.error('Error generating report:', error);\n      toast.error(((_error$response3 = error.response) === null || _error$response3 === void 0 ? void 0 : (_error$response3$data = _error$response3.data) === null || _error$response3$data === void 0 ? void 0 : _error$response3$data.error) || 'Failed to generate report');\n    } finally {\n      generateInProgressRef.current = false;\n      setIsGenerating(false);\n    }\n  }, [reportConfig.objectType, reportConfig.fields, reportConfig.filters, reportConfig.sortBy, reportConfig.sortOrder, reportConfig.limit, reportConfig.name, reportConfig.category, fieldLabelMap, activeTab]);\n  const exportReport = () => {\n    if (!previewData || previewData.length === 0) {\n      toast.error('No data to export. Please generate a report first.');\n      return;\n    }\n    const exportDataWithLabels = previewData.map(row => {\n      const mappedRow = {};\n      Object.keys(row).forEach(key => {\n        const label = fieldLabelMap[key] || key;\n        mappedRow[label] = row[key];\n      });\n      return mappedRow;\n    });\n    const result = exportData(exportDataWithLabels, reportConfig.name || 'report', reportConfig.format);\n    if (result.success) {\n      toast.success(`Exported to ${result.filename}`);\n    } else {\n      toast.error(result.error || 'Export failed');\n    }\n  };\n  const addField = fieldName => {\n    if (!reportConfig.fields.includes(fieldName)) {\n      setReportConfig({\n        ...reportConfig,\n        fields: [...reportConfig.fields, fieldName]\n      });\n    }\n  };\n  const removeField = fieldName => {\n    setReportConfig({\n      ...reportConfig,\n      fields: reportConfig.fields.filter(f => f !== fieldName)\n    });\n  };\n  const handleFieldToggle = fieldName => {\n    if (reportConfig.fields.includes(fieldName)) {\n      removeField(fieldName);\n    } else {\n      addField(fieldName);\n    }\n  };\n  const updateFilter = (field, value) => {\n    setReportConfig({\n      ...reportConfig,\n      filters: {\n        ...reportConfig.filters,\n        [field]: value\n      }\n    });\n  };\n  const loadSavedReport = report => {\n    console.log('[ReportBuilder] Loading saved report:', report.name, 'Filters:', JSON.stringify(report.filters, null, 2));\n    setReportConfig({\n      name: report.name || '',\n      objectType: report.objectType || '',\n      fields: report.fields || [],\n      filters: report.filters || {},\n      groupBy: report.groupBy || null,\n      sortBy: report.sortBy || null,\n      sortOrder: report.sortOrder || 'ASC',\n      format: report.format || 'excel',\n      limit: report.limit || 10000,\n      category: report.category || 'Uncategorized'\n    });\n    // Load field labels if available\n    if (report.fieldLabels) {\n      setFieldLabelMap(report.fieldLabels);\n    }\n    setSelectedReportId(report.id);\n    setShowPreview(false);\n    setPreviewData(null);\n    setViewMode(false);\n    setActiveTab('configuration');\n  };\n  const createNewReport = () => {\n    setReportConfig({\n      name: '',\n      objectType: '',\n      fields: [],\n      filters: {},\n      groupBy: null,\n      sortBy: null,\n      sortOrder: 'ASC',\n      format: 'excel',\n      limit: 10000,\n      category: 'Uncategorized'\n    });\n    setSelectedReportId(null);\n    setShowPreview(false);\n    setPreviewData(null);\n    setViewMode(false);\n  };\n  const handleScheduleReport = () => {\n    if (!reportConfig.name || !reportConfig.objectType || reportConfig.fields.length === 0) {\n      toast.error('Please complete the report configuration first');\n      return;\n    }\n    setScheduleFormData({\n      scheduleType: 'recurring',\n      schedule: 'daily',\n      format: 'excel',\n      runTime: '09:00',\n      timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,\n      enabled: true,\n      emailConfig: {\n        recipients: [],\n        subject: `Report: ${reportConfig.name || 'Untitled'}`,\n        body: '',\n        attachFile: true,\n        includeLink: false,\n        embedData: false,\n        deliveryMethod: 'email',\n        cloudStorage: 'none'\n      }\n    });\n    setShowScheduleModal(true);\n  };\n  const handleCreateScheduledReport = async finalScheduleData => {\n    try {\n      const scheduleData = finalScheduleData || scheduleFormData;\n      const response = await apiClient.post('/scheduled-reports', {\n        name: reportConfig.name,\n        objectType: reportConfig.objectType,\n        fields: reportConfig.fields,\n        filters: reportConfig.filters,\n        scheduleType: scheduleData.scheduleType || 'recurring',\n        schedule: scheduleData.schedule || 'daily',\n        runTime: scheduleData.runTime || '09:00',\n        timezone: scheduleData.timezone || Intl.DateTimeFormat().resolvedOptions().timeZone,\n        dayOfWeek: scheduleData.dayOfWeek,\n        dayOfMonth: scheduleData.dayOfMonth,\n        cronExpression: scheduleData.cronExpression,\n        runDate: scheduleData.runDate,\n        format: scheduleData.format || reportConfig.format || 'excel',\n        emailConfig: scheduleData.emailConfig,\n        enabled: scheduleData.enabled !== false,\n        limit: reportConfig.limit\n      });\n      if (response.data.success) {\n        toast.success('Scheduled report created successfully');\n        setShowScheduleModal(false);\n        if (activeTab === 'reports') {\n          loadReportsHistory();\n        }\n      }\n    } catch (error) {\n      var _error$response4, _error$response4$data;\n      toast.error(((_error$response4 = error.response) === null || _error$response4 === void 0 ? void 0 : (_error$response4$data = _error$response4.data) === null || _error$response4$data === void 0 ? void 0 : _error$response4$data.error) || 'Failed to create scheduled report');\n    }\n  };\n  const handleDeleteReport = reportId => {\n    setReportToDelete(reportId);\n    setShowDeleteConfirm(true);\n  };\n  const handleDeleteSavedReport = reportId => {\n    setReportToDelete(reportId);\n    setShowDeleteConfirm(true);\n  };\n  const confirmDeleteReport = async () => {\n    if (!reportToDelete) return;\n\n    // Check if it's a saved report (starts with \"report_\") or a history report\n    const isSavedReport = savedReports.some(r => r.id === reportToDelete);\n    if (isSavedReport) {\n      // Delete from saved reports\n      try {\n        const updatedReports = savedReports.filter(r => r.id !== reportToDelete);\n        localStorage.setItem('saved_reports', JSON.stringify(updatedReports));\n        setSavedReports(updatedReports);\n        if (selectedReportId === reportToDelete) {\n          setSelectedReportId(null);\n          createNewReport();\n        }\n        toast.success('Saved report deleted');\n      } catch (error) {\n        toast.error('Failed to delete saved report');\n      }\n    } else {\n      // Delete from history\n      try {\n        const response = await apiClient.delete(`/reports/history/${reportToDelete}`);\n        if (response.data.success) {\n          toast.success('Report deleted');\n          loadReportsHistory();\n        }\n      } catch (error) {\n        toast.error('Failed to delete report');\n      }\n    }\n    setShowDeleteConfirm(false);\n    setReportToDelete(null);\n  };\n  const handleViewReport = async reportId => {\n    try {\n      const response = await apiClient.get(`/reports/history/${reportId}`);\n      if (response.data.success) {\n        const report = response.data.report;\n        setPreviewData(report.data || []);\n        setFieldLabelMap(report.fieldLabels || {});\n        setReportConfig({\n          name: report.name || '',\n          objectType: report.objectType || '',\n          fields: report.fields || [],\n          filters: report.filters || {},\n          category: report.category || 'Uncategorized'\n        });\n        setShowPreview(true);\n        setViewMode(true);\n        setSelectedReportId(reportId);\n        setActiveTab('configuration');\n      }\n    } catch (error) {\n      toast.error('Failed to load report');\n    }\n  };\n  const handleEditReport = async reportId => {\n    try {\n      const response = await apiClient.get(`/reports/history/${reportId}`);\n      if (response.data.success) {\n        const report = response.data.report;\n        setReportConfig({\n          name: report.name || '',\n          objectType: report.objectType || '',\n          fields: report.fields || [],\n          filters: report.filters || {},\n          sortBy: report.sortBy || null,\n          sortOrder: report.sortOrder || 'ASC',\n          format: report.format || 'excel',\n          limit: report.limit || 10000,\n          category: report.category || 'Uncategorized'\n        });\n        setSelectedReportId(report.id);\n        setShowPreview(false);\n        setPreviewData(null);\n        setViewMode(false);\n        setActiveTab('configuration');\n      }\n    } catch (error) {\n      toast.error('Failed to load report');\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"dashboard-layout\",\n    children: [/*#__PURE__*/_jsxDEV(Sidebar, {\n      isOpen: sidebarOpen,\n      toggleSidebar: () => setSidebarOpen(!sidebarOpen)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 709,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginLeft: sidebarOpen ? '320px' : '80px',\n        transition: 'margin-left 0.3s ease',\n        width: sidebarOpen ? 'calc(100% - 320px)' : 'calc(100% - 80px)'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"header\", {\n        className: \"dashboard-header\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"header-content\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"header-left\",\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"header-menu-toggle\",\n              onClick: () => setSidebarOpen(!sidebarOpen),\n              \"aria-label\": \"Toggle sidebar\",\n              children: /*#__PURE__*/_jsxDEV(Menu, {\n                size: 20\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 720,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 715,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n                className: \"page-title\",\n                children: \"Report Builder\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 723,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"page-subtitle\",\n                children: \"Create custom reports from Salesforce data\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 724,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 722,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 714,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"header-user-profile\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"user-profile\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"user-avatar\",\n                children: ((user === null || user === void 0 ? void 0 : user.email) || 'U').charAt(0).toUpperCase()\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 729,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"user-name\",\n                children: (user === null || user === void 0 ? void 0 : user.email) || 'User'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 732,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"logout-btn\",\n                onClick: logout,\n                title: \"Logout\",\n                children: /*#__PURE__*/_jsxDEV(LogOut, {\n                  size: 18\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 734,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 733,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 728,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 727,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 713,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 712,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"main\", {\n        style: {\n          padding: '24px',\n          background: '#f5f5f5',\n          minHeight: 'calc(100vh - 80px)'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            marginBottom: '24px',\n            borderBottom: '2px solid #e5e7eb'\n          },\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              display: 'flex',\n              gap: '0'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => {\n                setActiveTab('configuration');\n                setViewMode(false);\n              },\n              style: {\n                padding: '12px 24px',\n                background: 'transparent',\n                border: 'none',\n                borderBottom: activeTab === 'configuration' ? '2px solid #08979C' : '2px solid transparent',\n                color: activeTab === 'configuration' ? '#08979C' : '#666',\n                fontWeight: activeTab === 'configuration' ? '600' : '400',\n                cursor: 'pointer',\n                fontSize: '14px',\n                marginBottom: '-2px'\n              },\n              children: \"Report Configuration\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 745,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => {\n                setActiveTab('reports');\n                loadReportsHistory();\n              },\n              style: {\n                padding: '12px 24px',\n                background: 'transparent',\n                border: 'none',\n                borderBottom: activeTab === 'reports' ? '2px solid #08979C' : '2px solid transparent',\n                color: activeTab === 'reports' ? '#08979C' : '#666',\n                fontWeight: activeTab === 'reports' ? '600' : '400',\n                cursor: 'pointer',\n                fontSize: '14px',\n                marginBottom: '-2px'\n              },\n              children: \"Reports\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 764,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 744,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 743,\n          columnNumber: 11\n        }, this), activeTab === 'configuration' ? /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            background: '#fff',\n            borderRadius: '8px',\n            padding: '24px',\n            boxShadow: '0 2px 4px rgba(0,0,0,0.1)'\n          },\n          children: showPreview && previewData && viewMode ?\n          /*#__PURE__*/\n          // Full width Report View\n          _jsxDEV(ReportViewPanel, {\n            previewData: previewData,\n            fieldLabelMap: fieldLabelMap,\n            reportName: reportConfig.name,\n            totalCount: previewData.length,\n            hasMore: false,\n            onEdit: () => {\n              setViewMode(false);\n              handleEditReport(selectedReportId);\n            },\n            onClose: () => {\n              setShowPreview(false);\n              setViewMode(false);\n              setPreviewData(null);\n              setActiveTab('reports');\n              loadReportsHistory();\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 790,\n            columnNumber: 17\n          }, this) :\n          /*#__PURE__*/\n          // Normal configuration view with left panel\n          _jsxDEV(\"div\", {\n            style: {\n              display: 'flex',\n              gap: '24px'\n            },\n            children: [/*#__PURE__*/_jsxDEV(SavedReportsPanel, {\n              savedReports: savedReports,\n              selectedReportId: selectedReportId,\n              onSelectReport: loadSavedReport,\n              onCreateNew: createNewReport,\n              onDeleteReport: handleDeleteSavedReport\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 811,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                flex: 1\n              },\n              children: /*#__PURE__*/_jsxDEV(ReportConfiguration, {\n                reportConfig: reportConfig,\n                setReportConfig: setReportConfig,\n                availableObjects: availableObjects,\n                availableFields: availableFields,\n                filterOptions: filterOptions,\n                loadingFields: loadingFields,\n                loading: loading,\n                isPreviewing: isPreviewing,\n                isGenerating: isGenerating,\n                previewData: previewData,\n                viewMode: viewMode,\n                onSave: saveReport,\n                onPreview: previewReport,\n                onGenerate: generateReport,\n                onSchedule: handleScheduleReport,\n                onFieldToggle: handleFieldToggle,\n                onFilterChange: updateFilter\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 819,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 818,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 810,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 787,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(ReportsList, {\n          reportsHistory: reportsHistory,\n          loadingHistory: loadingHistory,\n          selectedCategory: selectedCategory,\n          categories: getCategories(),\n          onCategoryChange: setSelectedCategory,\n          onRefresh: loadReportsHistory,\n          onView: handleViewReport,\n          onEdit: handleEditReport,\n          onDelete: handleDeleteReport\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 843,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(PreviewModal, {\n          show: showPreviewModal,\n          data: previewModalData === null || previewModalData === void 0 ? void 0 : previewModalData.data,\n          fieldLabels: (previewModalData === null || previewModalData === void 0 ? void 0 : previewModalData.fieldLabels) || fieldLabelMap || {},\n          totalCount: previewModalData === null || previewModalData === void 0 ? void 0 : previewModalData.totalCount,\n          hasMore: previewModalData === null || previewModalData === void 0 ? void 0 : previewModalData.hasMore,\n          onClose: () => setShowPreviewModal(false)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 857,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(DeleteConfirmModal, {\n          show: showDeleteConfirm,\n          onConfirm: confirmDeleteReport,\n          onCancel: () => {\n            setShowDeleteConfirm(false);\n            setReportToDelete(null);\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 866,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(ScheduleModal, {\n          show: showScheduleModal,\n          formData: scheduleFormData,\n          onClose: () => setShowScheduleModal(false),\n          onSave: handleCreateScheduledReport,\n          onChange: setScheduleFormData,\n          reportName: reportConfig.name\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 875,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 741,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 711,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 708,\n    columnNumber: 5\n  }, this);\n};\n_s(ReportBuilder, \"RqJo4muT1i/4UP9Vrsb+pwnpWLw=\", false, function () {\n  return [useAuth];\n});\n_c = ReportBuilder;\nexport default ReportBuilder;\nvar _c;\n$RefreshReg$(_c, \"ReportBuilder\");","map":{"version":3,"names":["React","useState","useEffect","useCallback","useRef","useAuth","Sidebar","Menu","LogOut","apiClient","axios","exportData","toast","SavedReportsPanel","ReportConfiguration","ReportViewPanel","ReportsList","PreviewModal","DeleteConfirmModal","ScheduleModal","hasPermission","PERMISSIONS","ROLES","jsxDEV","_jsxDEV","reportApiClient","create","baseURL","process","env","REACT_APP_API_URL","headers","timeout","interceptors","request","use","config","token","localStorage","getItem","Authorization","ReportBuilder","_s","user","logout","sidebarOpen","setSidebarOpen","activeTab","setActiveTab","viewMode","setViewMode","selectedReportId","setSelectedReportId","reportConfig","setReportConfig","name","objectType","fields","filters","groupBy","sortBy","sortOrder","limit","category","availableObjects","setAvailableObjects","availableFields","setAvailableFields","filterOptions","setFilterOptions","previewData","setPreviewData","fieldLabelMap","setFieldLabelMap","loading","setLoading","loadingFields","setLoadingFields","isPreviewing","setIsPreviewing","isGenerating","setIsGenerating","savedReports","setSavedReports","showPreview","setShowPreview","reportsHistory","setReportsHistory","loadingHistory","setLoadingHistory","showScheduleModal","setShowScheduleModal","scheduleFormData","setScheduleFormData","schedule","format","recipients","selectedCategory","setSelectedCategory","showDeleteConfirm","setShowDeleteConfirm","reportToDelete","setReportToDelete","showPreviewModal","setShowPreviewModal","previewModalData","setPreviewModalData","previewInProgressRef","generateInProgressRef","loadAvailableObjects","loadSavedReports","loadReportsHistory","loadFieldsForObject","loadFilterOptions","labelMap","forEach","field","label","response","get","data","success","objects","error","console","encodeURIComponent","_error$response","_error$response$data","saved","JSON","parse","historyResponse","scheduledResponse","Promise","all","catch","reports","manualReports","scheduledReports","map","r","type","generatedAt","lastRunAt","createdAt","allReports","sort","a","b","dateA","Date","dateB","getCategories","categories","Set","report","add","Array","from","saveReport","length","reportToSave","id","now","toISOString","updatedAt","fieldLabels","log","stringify","Object","keys","setItem","previewReport","event","preventDefault","stopPropagation","previewInProgress","current","generateInProgress","post","records","recordCount","totalCount","count","sampleRecord","fieldsInSample","falconProject","find","Name","includes","countFields","filter","k","countFieldValues","warn","slice","mergedFieldLabels","prev","hasMore","_error$response2","_error$response2$data","generateReport","reportName","toLocaleString","_error$response3","_error$response3$data","exportReport","exportDataWithLabels","row","mappedRow","key","result","filename","addField","fieldName","removeField","f","handleFieldToggle","updateFilter","value","loadSavedReport","createNewReport","handleScheduleReport","scheduleType","runTime","timezone","Intl","DateTimeFormat","resolvedOptions","timeZone","enabled","emailConfig","subject","body","attachFile","includeLink","embedData","deliveryMethod","cloudStorage","handleCreateScheduledReport","finalScheduleData","scheduleData","dayOfWeek","dayOfMonth","cronExpression","runDate","_error$response4","_error$response4$data","handleDeleteReport","reportId","handleDeleteSavedReport","confirmDeleteReport","isSavedReport","some","updatedReports","delete","handleViewReport","handleEditReport","className","children","isOpen","toggleSidebar","fileName","_jsxFileName","lineNumber","columnNumber","style","marginLeft","transition","width","onClick","size","email","charAt","toUpperCase","title","padding","background","minHeight","marginBottom","borderBottom","display","gap","border","color","fontWeight","cursor","fontSize","borderRadius","boxShadow","onEdit","onClose","onSelectReport","onCreateNew","onDeleteReport","flex","onSave","onPreview","onGenerate","onSchedule","onFieldToggle","onFilterChange","onCategoryChange","onRefresh","onView","onDelete","show","onConfirm","onCancel","formData","onChange","_c","$RefreshReg$"],"sources":["/Users/mmoola/Cursor/ProjectSetup/client/src/pages/ReportBuilder.js"],"sourcesContent":["import React, { useState, useEffect, useCallback, useRef } from 'react';\nimport { useAuth } from '../context/AuthContext';\nimport Sidebar from '../components/Sidebar';\nimport { Menu, LogOut } from 'lucide-react';\nimport apiClient from '../config/api';\nimport axios from 'axios';\nimport { exportData } from '../utils/crossFeature/exportService';\nimport toast from 'react-hot-toast';\nimport SavedReportsPanel from '../components/ReportBuilder/SavedReportsPanel';\nimport ReportConfiguration from '../components/ReportBuilder/ReportConfiguration';\nimport ReportViewPanel from '../components/ReportBuilder/ReportViewPanel';\nimport ReportsList from '../components/ReportBuilder/ReportsList';\nimport PreviewModal from '../components/ReportBuilder/PreviewModal';\nimport DeleteConfirmModal from '../components/ReportBuilder/DeleteConfirmModal';\nimport ScheduleModal from '../components/ReportBuilder/ScheduleModal';\nimport { hasPermission, PERMISSIONS, ROLES } from '../utils/rbac';\nimport '../styles/Sidebar.css';\nimport '../styles/GlobalHeader.css';\n\n// Custom axios instance for report generation with longer timeout\nconst reportApiClient = axios.create({\n  baseURL: process.env.REACT_APP_API_URL || '/api',\n  headers: {\n    'Content-Type': 'application/json',\n  },\n  timeout: 600000, // 10 minutes for report generation\n});\n\n// Add auth token to report API client\nreportApiClient.interceptors.request.use((config) => {\n  const token = localStorage.getItem('token');\n  if (token) {\n    config.headers.Authorization = `Bearer ${token}`;\n  }\n  return config;\n});\n\nconst ReportBuilder = () => {\n  const { user, logout } = useAuth();\n  const [sidebarOpen, setSidebarOpen] = useState(true);\n  const [activeTab, setActiveTab] = useState('configuration');\n  const [viewMode, setViewMode] = useState(false);\n  const [selectedReportId, setSelectedReportId] = useState(null);\n  const [reportConfig, setReportConfig] = useState({\n    name: '',\n    objectType: '',\n    fields: [],\n    filters: {},\n    groupBy: null,\n    sortBy: null,\n    sortOrder: 'ASC',\n    limit: 10000,\n    category: 'Uncategorized'\n  });\n  const [availableObjects, setAvailableObjects] = useState([]);\n  const [availableFields, setAvailableFields] = useState([]);\n  const [filterOptions, setFilterOptions] = useState({});\n  const [previewData, setPreviewData] = useState(null);\n  const [fieldLabelMap, setFieldLabelMap] = useState({});\n  const [loading, setLoading] = useState(false);\n  const [loadingFields, setLoadingFields] = useState(false);\n  const [isPreviewing, setIsPreviewing] = useState(false);\n  const [isGenerating, setIsGenerating] = useState(false);\n  const [savedReports, setSavedReports] = useState([]);\n  const [showPreview, setShowPreview] = useState(false);\n  const [reportsHistory, setReportsHistory] = useState([]);\n  const [loadingHistory, setLoadingHistory] = useState(false);\n  const [showScheduleModal, setShowScheduleModal] = useState(false);\n  const [scheduleFormData, setScheduleFormData] = useState({\n    schedule: 'daily',\n    format: 'excel',\n    recipients: []\n  });\n  const [selectedCategory, setSelectedCategory] = useState('All');\n  const [showDeleteConfirm, setShowDeleteConfirm] = useState(false);\n  const [reportToDelete, setReportToDelete] = useState(null);\n  const [showPreviewModal, setShowPreviewModal] = useState(false);\n  const [previewModalData, setPreviewModalData] = useState(null);\n\n  // Use refs to track if operations are in progress (refs don't cause re-renders)\n  const previewInProgressRef = useRef(false);\n  const generateInProgressRef = useRef(false);\n\n  useEffect(() => {\n    loadAvailableObjects();\n    loadSavedReports();\n    if (activeTab === 'reports') {\n      loadReportsHistory();\n    }\n  }, [activeTab]);\n\n  useEffect(() => {\n    if (reportConfig.objectType) {\n      loadFieldsForObject(reportConfig.objectType);\n      loadFilterOptions(reportConfig.objectType);\n    } else {\n      setAvailableFields([]);\n      setFilterOptions({});\n    }\n  }, [reportConfig.objectType]);\n\n  useEffect(() => {\n    const labelMap = {};\n    availableFields.forEach(field => {\n      labelMap[field.name] = field.label || field.name;\n    });\n    // Add common field labels that might not be in availableFields (handle both naming conventions)\n    if (!labelMap['Active_Contributors__c']) {\n      labelMap['Active_Contributors__c'] = 'Active Contributors';\n    }\n    if (!labelMap['Active_Contributors_c__c']) {\n      labelMap['Active_Contributors_c__c'] = 'Active Contributors';\n    }\n    if (!labelMap['Applied_Contributors__c']) {\n      labelMap['Applied_Contributors__c'] = 'Applied Contributors';\n    }\n    if (!labelMap['Applied_Contributors_c__c']) {\n      labelMap['Applied_Contributors_c__c'] = 'Applied Contributors';\n    }\n    if (!labelMap['Qualified_Contributors__c']) {\n      labelMap['Qualified_Contributors__c'] = 'Qualified Contributors';\n    }\n    if (!labelMap['Qualified_Contributors_c__c']) {\n      labelMap['Qualified_Contributors_c__c'] = 'Qualified Contributors';\n    }\n    if (!labelMap['Removed__c']) {\n      labelMap['Removed__c'] = 'Removed';\n    }\n    if (!labelMap['Removed_c__c']) {\n      labelMap['Removed_c__c'] = 'Removed';\n    }\n    if (!labelMap['Total_Applied__c']) {\n      labelMap['Total_Applied__c'] = 'Total Applied';\n    }\n    if (!labelMap['Total_Qualified__c']) {\n      labelMap['Total_Qualified__c'] = 'Total Qualified';\n    }\n    setFieldLabelMap(labelMap);\n  }, [availableFields]);\n\n  const loadAvailableObjects = async () => {\n    try {\n      const response = await apiClient.get('/update-object-fields/objects');\n      if (response.data.success) {\n        setAvailableObjects(response.data.objects || []);\n      }\n    } catch (error) {\n      console.error('Error loading objects:', error);\n      toast.error('Failed to load available objects');\n    }\n  };\n\n  const loadFieldsForObject = async (objectType) => {\n    setLoadingFields(true);\n    try {\n      // Add forReporting=true query parameter to include read-only fields (like Total_Applied__c)\n      const response = await apiClient.get(`/update-object-fields/fields/${encodeURIComponent(objectType)}?forReporting=true`);\n      if (response.data.success) {\n        setAvailableFields(response.data.fields || []);\n      } else {\n        toast.error(response.data.error || 'Failed to load fields');\n      }\n    } catch (error) {\n      console.error('Error loading fields:', error);\n      toast.error(error.response?.data?.error || 'Failed to load fields');\n      setAvailableFields([]);\n    } finally {\n      setLoadingFields(false);\n    }\n  };\n\n  const loadFilterOptions = async (objectType) => {\n    try {\n      const response = await apiClient.get(`/update-object-fields/filter-options/${encodeURIComponent(objectType)}`);\n      if (response.data.success) {\n        setFilterOptions(response.data.filterOptions || {});\n      }\n    } catch (error) {\n      console.error('Error loading filter options:', error);\n    }\n  };\n\n  const loadSavedReports = () => {\n    try {\n      const saved = localStorage.getItem('saved_reports');\n      if (saved) {\n        setSavedReports(JSON.parse(saved));\n      }\n    } catch (error) {\n      console.error('Error loading saved reports:', error);\n    }\n  };\n\n  const loadReportsHistory = async () => {\n    setLoadingHistory(true);\n    try {\n      const [historyResponse, scheduledResponse] = await Promise.all([\n        apiClient.get('/reports/history').catch(() => ({ data: { success: true, reports: [] } })),\n        apiClient.get('/scheduled-reports').catch(() => ({ data: { success: true, reports: [] } }))\n      ]);\n\n      const manualReports = historyResponse.data.success ? (historyResponse.data.reports || []) : [];\n      const scheduledReports = scheduledResponse.data.success ? (scheduledResponse.data.reports || []).map(r => ({\n        ...r,\n        type: 'scheduled',\n        generatedAt: r.lastRunAt || r.createdAt\n      })) : [];\n\n      const allReports = [...manualReports, ...scheduledReports].sort((a, b) => {\n        const dateA = new Date(a.generatedAt || a.createdAt || 0);\n        const dateB = new Date(b.generatedAt || b.createdAt || 0);\n        return dateB - dateA;\n      });\n\n      setReportsHistory(allReports);\n    } catch (error) {\n      console.error('Error loading reports history:', error);\n      toast.error('Failed to load reports history');\n    } finally {\n      setLoadingHistory(false);\n    }\n  };\n\n  const getCategories = () => {\n    const categories = new Set();\n    reportsHistory.forEach(report => {\n      categories.add(report.category || 'Uncategorized');\n    });\n    return Array.from(categories).sort();\n  };\n\n  const saveReport = () => {\n    if (!reportConfig.name) {\n      toast.error('Please enter a report name');\n      return;\n    }\n    if (!reportConfig.objectType) {\n      toast.error('Please select an object type');\n      return;\n    }\n    if (reportConfig.fields.length === 0) {\n      toast.error('Please select at least one field');\n      return;\n    }\n\n    try {\n      const reportToSave = {\n        ...reportConfig,\n        id: selectedReportId || `report_${Date.now()}`,\n        createdAt: new Date().toISOString(),\n        updatedAt: new Date().toISOString(),\n        fieldLabels: fieldLabelMap // Save field labels with the report\n      };\n      \n      // Ensure filters are included (even if empty)\n      if (!reportToSave.filters) {\n        reportToSave.filters = {};\n      }\n      \n      console.log('[ReportBuilder] Saving report with filters:', JSON.stringify(reportToSave.filters, null, 2));\n      console.log('[ReportBuilder] Saving report with fieldLabels:', Object.keys(reportToSave.fieldLabels || {}).length, 'labels');\n      \n      let reports;\n      if (selectedReportId) {\n        reports = savedReports.map(r => r.id === selectedReportId ? reportToSave : r);\n      } else {\n        reports = [...savedReports, reportToSave];\n      }\n      \n      localStorage.setItem('saved_reports', JSON.stringify(reports));\n      setSavedReports(reports);\n      setSelectedReportId(null);\n      toast.success('Report saved successfully');\n    } catch (error) {\n      console.error('[ReportBuilder] Error saving report:', error);\n      toast.error('Failed to save report');\n    }\n  };\n\n  const previewReport = useCallback(async (event) => {\n    // Prevent any default behavior\n    if (event) {\n      event.preventDefault();\n      event.stopPropagation();\n    }\n\n    console.log('[Preview] previewReport called', { \n      previewInProgress: previewInProgressRef.current,\n      generateInProgress: generateInProgressRef.current\n    });\n    \n    // Early return if already in progress\n    if (previewInProgressRef.current || generateInProgressRef.current) {\n      console.log('[Preview] Already processing, returning early');\n      return;\n    }\n\n    if (!reportConfig.objectType || reportConfig.fields.length === 0) {\n      toast.error('Please select an object type and at least one field');\n      return;\n    }\n\n    console.log('[Preview] Starting preview...');\n    previewInProgressRef.current = true;\n    setIsPreviewing(true);\n    // Don't set shared loading state - use isPreviewing instead\n    try {\n      const response = await reportApiClient.post('/reports/preview', {\n        objectType: reportConfig.objectType,\n        fields: reportConfig.fields,\n        filters: reportConfig.filters,\n        sortBy: reportConfig.sortBy,\n        sortOrder: reportConfig.sortOrder,\n        groupBy: reportConfig.groupBy,\n        limit: reportConfig.limit,\n        fieldLabels: fieldLabelMap\n      });\n\n      if (response.data.success) {\n        const data = response.data.records || [];\n        console.log('[Preview] Response received:', {\n          success: response.data.success,\n          recordCount: data.length,\n          totalCount: response.data.count,\n          fieldLabels: response.data.fieldLabels,\n          sampleRecord: data[0] || null,\n          fieldsInSample: data[0] ? Object.keys(data[0]) : []\n        });\n        \n        // Check for Falcon project specifically\n        const falconProject = data.find(r => r.Name && r.Name.includes('Falcon Background Gen Guardrail'));\n        if (falconProject) {\n          // Find all count-related fields dynamically\n          const countFields = Object.keys(falconProject).filter(k => \n            k.includes('Contributor') || k.includes('Removed')\n          );\n          const countFieldValues = {};\n          countFields.forEach(field => {\n            countFieldValues[field] = falconProject[field];\n          });\n          \n          console.log('[Preview] ========== FALCON PROJECT DEBUG ==========');\n          console.log('[Preview] Project:', falconProject.Name);\n          console.log('[Preview] All fields in record:', Object.keys(falconProject));\n          console.log('[Preview] Count-related fields found:', countFields);\n          console.log('[Preview] Count field values:', countFieldValues);\n          console.log('[Preview] Field labels available:', Object.keys(response.data.fieldLabels || {}).filter(k => k.includes('Contributor') || k.includes('Removed')));\n        } else {\n          console.warn('[Preview] Falcon project NOT found in response records');\n          console.log('[Preview] Project names in response:', data.slice(0, 5).map(r => r.Name));\n        }\n        \n        // Merge backend field labels with frontend fieldLabelMap\n        const mergedFieldLabels = {\n          ...fieldLabelMap,\n          ...(response.data.fieldLabels || {})\n        };\n        \n        // Update fieldLabelMap with backend labels\n        if (response.data.fieldLabels) {\n          setFieldLabelMap(prev => ({\n            ...prev,\n            ...response.data.fieldLabels\n          }));\n        }\n        \n        setPreviewModalData({\n          data,\n          fieldLabels: mergedFieldLabels,\n          count: data.length,\n          totalCount: response.data.count || data.length,\n          hasMore: response.data.hasMore || false\n        });\n        setShowPreviewModal(true);\n        toast.success(`Preview: ${response.data.count || data.length} records`);\n      }\n    } catch (error) {\n      console.error('Error previewing report:', error);\n      toast.error(error.response?.data?.error || 'Failed to preview report');\n    } finally {\n      previewInProgressRef.current = false;\n      setIsPreviewing(false);\n    }\n  }, [reportConfig.objectType, reportConfig.fields, reportConfig.filters, reportConfig.sortBy, reportConfig.sortOrder, reportConfig.groupBy, reportConfig.limit, reportConfig.name, reportConfig.category, fieldLabelMap]);\n\n  const generateReport = useCallback(async (event) => {\n    // Prevent any default behavior\n    if (event) {\n      event.preventDefault();\n      event.stopPropagation();\n    }\n\n    console.log('[Generate] generateReport called', { \n      previewInProgress: previewInProgressRef.current,\n      generateInProgress: generateInProgressRef.current\n    });\n    \n    // Early return if already in progress\n    if (previewInProgressRef.current || generateInProgressRef.current) {\n      console.log('[Generate] Already processing, returning early');\n      return;\n    }\n\n    if (!reportConfig.objectType || reportConfig.fields.length === 0) {\n      toast.error('Please select an object type and at least one field');\n      return;\n    }\n\n    console.log('[Generate] Starting generation...');\n    generateInProgressRef.current = true;\n    setIsGenerating(true);\n    // Don't set shared loading state - use isGenerating instead\n    try {\n      const response = await reportApiClient.post('/reports/generate', {\n        objectType: reportConfig.objectType,\n        fields: reportConfig.fields,\n        filters: reportConfig.filters,\n        sortBy: reportConfig.sortBy,\n        sortOrder: reportConfig.sortOrder,\n        groupBy: reportConfig.groupBy,\n        limit: reportConfig.limit,\n        reportName: reportConfig.name || `Report ${new Date().toLocaleString()}`,\n        category: reportConfig.category || 'Uncategorized',\n        fieldLabels: fieldLabelMap\n      });\n\n      if (response.data.success) {\n        const data = response.data.records || [];\n        setPreviewData(data);\n        setFieldLabelMap(response.data.fieldLabels || fieldLabelMap);\n        setShowPreview(true);\n        setViewMode(true); // Switch to report view to show the generated report\n        toast.success(`Generated and saved ${response.data.count || data.length} records`);\n        if (activeTab === 'reports') {\n          loadReportsHistory();\n        }\n        setActiveTab('configuration'); // Keep on configuration tab but show report view\n      }\n    } catch (error) {\n      console.error('Error generating report:', error);\n      toast.error(error.response?.data?.error || 'Failed to generate report');\n    } finally {\n      generateInProgressRef.current = false;\n      setIsGenerating(false);\n    }\n  }, [reportConfig.objectType, reportConfig.fields, reportConfig.filters, reportConfig.sortBy, reportConfig.sortOrder, reportConfig.limit, reportConfig.name, reportConfig.category, fieldLabelMap, activeTab]);\n\n  const exportReport = () => {\n    if (!previewData || previewData.length === 0) {\n      toast.error('No data to export. Please generate a report first.');\n      return;\n    }\n\n    const exportDataWithLabels = previewData.map(row => {\n      const mappedRow = {};\n      Object.keys(row).forEach(key => {\n        const label = fieldLabelMap[key] || key;\n        mappedRow[label] = row[key];\n      });\n      return mappedRow;\n    });\n\n    const result = exportData(exportDataWithLabels, reportConfig.name || 'report', reportConfig.format);\n    if (result.success) {\n      toast.success(`Exported to ${result.filename}`);\n    } else {\n      toast.error(result.error || 'Export failed');\n    }\n  };\n\n  const addField = (fieldName) => {\n    if (!reportConfig.fields.includes(fieldName)) {\n      setReportConfig({\n        ...reportConfig,\n        fields: [...reportConfig.fields, fieldName]\n      });\n    }\n  };\n\n  const removeField = (fieldName) => {\n    setReportConfig({\n      ...reportConfig,\n      fields: reportConfig.fields.filter(f => f !== fieldName)\n    });\n  };\n\n  const handleFieldToggle = (fieldName) => {\n    if (reportConfig.fields.includes(fieldName)) {\n      removeField(fieldName);\n    } else {\n      addField(fieldName);\n    }\n  };\n\n  const updateFilter = (field, value) => {\n    setReportConfig({\n      ...reportConfig,\n      filters: {\n        ...reportConfig.filters,\n        [field]: value\n      }\n    });\n  };\n\n  const loadSavedReport = (report) => {\n    console.log('[ReportBuilder] Loading saved report:', report.name, 'Filters:', JSON.stringify(report.filters, null, 2));\n    setReportConfig({\n      name: report.name || '',\n      objectType: report.objectType || '',\n      fields: report.fields || [],\n      filters: report.filters || {},\n      groupBy: report.groupBy || null,\n      sortBy: report.sortBy || null,\n      sortOrder: report.sortOrder || 'ASC',\n      format: report.format || 'excel',\n      limit: report.limit || 10000,\n      category: report.category || 'Uncategorized'\n    });\n    // Load field labels if available\n    if (report.fieldLabels) {\n      setFieldLabelMap(report.fieldLabels);\n    }\n    setSelectedReportId(report.id);\n    setShowPreview(false);\n    setPreviewData(null);\n    setViewMode(false);\n    setActiveTab('configuration');\n  };\n\n  const createNewReport = () => {\n    setReportConfig({\n      name: '',\n      objectType: '',\n      fields: [],\n      filters: {},\n      groupBy: null,\n      sortBy: null,\n      sortOrder: 'ASC',\n      format: 'excel',\n      limit: 10000,\n      category: 'Uncategorized'\n    });\n    setSelectedReportId(null);\n    setShowPreview(false);\n    setPreviewData(null);\n    setViewMode(false);\n  };\n\n  const handleScheduleReport = () => {\n    if (!reportConfig.name || !reportConfig.objectType || reportConfig.fields.length === 0) {\n      toast.error('Please complete the report configuration first');\n      return;\n    }\n    setScheduleFormData({\n      scheduleType: 'recurring',\n      schedule: 'daily',\n      format: 'excel',\n      runTime: '09:00',\n      timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,\n      enabled: true,\n      emailConfig: {\n        recipients: [],\n        subject: `Report: ${reportConfig.name || 'Untitled'}`,\n        body: '',\n        attachFile: true,\n        includeLink: false,\n        embedData: false,\n        deliveryMethod: 'email',\n        cloudStorage: 'none'\n      }\n    });\n    setShowScheduleModal(true);\n  };\n\n  const handleCreateScheduledReport = async (finalScheduleData) => {\n    try {\n      const scheduleData = finalScheduleData || scheduleFormData;\n      const response = await apiClient.post('/scheduled-reports', {\n        name: reportConfig.name,\n        objectType: reportConfig.objectType,\n        fields: reportConfig.fields,\n        filters: reportConfig.filters,\n        scheduleType: scheduleData.scheduleType || 'recurring',\n        schedule: scheduleData.schedule || 'daily',\n        runTime: scheduleData.runTime || '09:00',\n        timezone: scheduleData.timezone || Intl.DateTimeFormat().resolvedOptions().timeZone,\n        dayOfWeek: scheduleData.dayOfWeek,\n        dayOfMonth: scheduleData.dayOfMonth,\n        cronExpression: scheduleData.cronExpression,\n        runDate: scheduleData.runDate,\n        format: scheduleData.format || reportConfig.format || 'excel',\n        emailConfig: scheduleData.emailConfig,\n        enabled: scheduleData.enabled !== false,\n        limit: reportConfig.limit\n      });\n\n      if (response.data.success) {\n        toast.success('Scheduled report created successfully');\n        setShowScheduleModal(false);\n        if (activeTab === 'reports') {\n          loadReportsHistory();\n        }\n      }\n    } catch (error) {\n      toast.error(error.response?.data?.error || 'Failed to create scheduled report');\n    }\n  };\n\n  const handleDeleteReport = (reportId) => {\n    setReportToDelete(reportId);\n    setShowDeleteConfirm(true);\n  };\n\n  const handleDeleteSavedReport = (reportId) => {\n    setReportToDelete(reportId);\n    setShowDeleteConfirm(true);\n  };\n\n  const confirmDeleteReport = async () => {\n    if (!reportToDelete) return;\n    \n    // Check if it's a saved report (starts with \"report_\") or a history report\n    const isSavedReport = savedReports.some(r => r.id === reportToDelete);\n    \n    if (isSavedReport) {\n      // Delete from saved reports\n      try {\n        const updatedReports = savedReports.filter(r => r.id !== reportToDelete);\n        localStorage.setItem('saved_reports', JSON.stringify(updatedReports));\n        setSavedReports(updatedReports);\n        if (selectedReportId === reportToDelete) {\n          setSelectedReportId(null);\n          createNewReport();\n        }\n        toast.success('Saved report deleted');\n      } catch (error) {\n        toast.error('Failed to delete saved report');\n      }\n    } else {\n      // Delete from history\n      try {\n        const response = await apiClient.delete(`/reports/history/${reportToDelete}`);\n        if (response.data.success) {\n          toast.success('Report deleted');\n          loadReportsHistory();\n        }\n      } catch (error) {\n        toast.error('Failed to delete report');\n      }\n    }\n    \n    setShowDeleteConfirm(false);\n    setReportToDelete(null);\n  };\n\n  const handleViewReport = async (reportId) => {\n    try {\n      const response = await apiClient.get(`/reports/history/${reportId}`);\n      if (response.data.success) {\n        const report = response.data.report;\n        setPreviewData(report.data || []);\n        setFieldLabelMap(report.fieldLabels || {});\n        setReportConfig({\n          name: report.name || '',\n          objectType: report.objectType || '',\n          fields: report.fields || [],\n          filters: report.filters || {},\n          category: report.category || 'Uncategorized'\n        });\n        setShowPreview(true);\n        setViewMode(true);\n        setSelectedReportId(reportId);\n        setActiveTab('configuration');\n      }\n    } catch (error) {\n      toast.error('Failed to load report');\n    }\n  };\n\n  const handleEditReport = async (reportId) => {\n    try {\n      const response = await apiClient.get(`/reports/history/${reportId}`);\n      if (response.data.success) {\n        const report = response.data.report;\n        setReportConfig({\n          name: report.name || '',\n          objectType: report.objectType || '',\n          fields: report.fields || [],\n          filters: report.filters || {},\n          sortBy: report.sortBy || null,\n          sortOrder: report.sortOrder || 'ASC',\n          format: report.format || 'excel',\n          limit: report.limit || 10000,\n          category: report.category || 'Uncategorized'\n        });\n        setSelectedReportId(report.id);\n        setShowPreview(false);\n        setPreviewData(null);\n        setViewMode(false);\n        setActiveTab('configuration');\n      }\n    } catch (error) {\n      toast.error('Failed to load report');\n    }\n  };\n\n  return (\n    <div className=\"dashboard-layout\">\n      <Sidebar isOpen={sidebarOpen} toggleSidebar={() => setSidebarOpen(!sidebarOpen)} />\n      \n      <div style={{ marginLeft: sidebarOpen ? '320px' : '80px', transition: 'margin-left 0.3s ease', width: sidebarOpen ? 'calc(100% - 320px)' : 'calc(100% - 80px)' }}>\n        <header className=\"dashboard-header\">\n          <div className=\"header-content\">\n            <div className=\"header-left\">\n              <button \n                className=\"header-menu-toggle\"\n                onClick={() => setSidebarOpen(!sidebarOpen)}\n                aria-label=\"Toggle sidebar\"\n              >\n                <Menu size={20} />\n              </button>\n              <div>\n                <h1 className=\"page-title\">Report Builder</h1>\n                <p className=\"page-subtitle\">Create custom reports from Salesforce data</p>\n              </div>\n            </div>\n            <div className=\"header-user-profile\">\n              <div className=\"user-profile\">\n                <div className=\"user-avatar\">\n                  {(user?.email || 'U').charAt(0).toUpperCase()}\n                </div>\n                <span className=\"user-name\">{user?.email || 'User'}</span>\n                <button className=\"logout-btn\" onClick={logout} title=\"Logout\">\n                  <LogOut size={18} />\n                </button>\n              </div>\n            </div>\n          </div>\n        </header>\n\n        <main style={{ padding: '24px', background: '#f5f5f5', minHeight: 'calc(100vh - 80px)' }}>\n          {/* Tabs */}\n          <div style={{ marginBottom: '24px', borderBottom: '2px solid #e5e7eb' }}>\n            <div style={{ display: 'flex', gap: '0' }}>\n              <button\n                onClick={() => {\n                  setActiveTab('configuration');\n                  setViewMode(false);\n                }}\n                style={{\n                  padding: '12px 24px',\n                  background: 'transparent',\n                  border: 'none',\n                  borderBottom: activeTab === 'configuration' ? '2px solid #08979C' : '2px solid transparent',\n                  color: activeTab === 'configuration' ? '#08979C' : '#666',\n                  fontWeight: activeTab === 'configuration' ? '600' : '400',\n                  cursor: 'pointer',\n                  fontSize: '14px',\n                  marginBottom: '-2px'\n                }}\n              >\n                Report Configuration\n              </button>\n              <button\n                onClick={() => {\n                  setActiveTab('reports');\n                  loadReportsHistory();\n                }}\n                style={{\n                  padding: '12px 24px',\n                  background: 'transparent',\n                  border: 'none',\n                  borderBottom: activeTab === 'reports' ? '2px solid #08979C' : '2px solid transparent',\n                  color: activeTab === 'reports' ? '#08979C' : '#666',\n                  fontWeight: activeTab === 'reports' ? '600' : '400',\n                  cursor: 'pointer',\n                  fontSize: '14px',\n                  marginBottom: '-2px'\n                }}\n              >\n                Reports\n              </button>\n            </div>\n          </div>\n\n          {activeTab === 'configuration' ? (\n            <div style={{ background: '#fff', borderRadius: '8px', padding: '24px', boxShadow: '0 2px 4px rgba(0,0,0,0.1)' }}>\n              {showPreview && previewData && viewMode ? (\n                // Full width Report View\n                <ReportViewPanel\n                  previewData={previewData}\n                  fieldLabelMap={fieldLabelMap}\n                  reportName={reportConfig.name}\n                  totalCount={previewData.length}\n                  hasMore={false}\n                  onEdit={() => {\n                    setViewMode(false);\n                    handleEditReport(selectedReportId);\n                  }}\n                  onClose={() => {\n                    setShowPreview(false);\n                    setViewMode(false);\n                    setPreviewData(null);\n                    setActiveTab('reports');\n                    loadReportsHistory();\n                  }}\n                />\n              ) : (\n                // Normal configuration view with left panel\n                <div style={{ display: 'flex', gap: '24px' }}>\n                  <SavedReportsPanel\n                    savedReports={savedReports}\n                    selectedReportId={selectedReportId}\n                    onSelectReport={loadSavedReport}\n                    onCreateNew={createNewReport}\n                    onDeleteReport={handleDeleteSavedReport}\n                  />\n                  <div style={{ flex: 1 }}>\n                    <ReportConfiguration\n                      reportConfig={reportConfig}\n                      setReportConfig={setReportConfig}\n                      availableObjects={availableObjects}\n                      availableFields={availableFields}\n                      filterOptions={filterOptions}\n                      loadingFields={loadingFields}\n                      loading={loading}\n                      isPreviewing={isPreviewing}\n                      isGenerating={isGenerating}\n                      previewData={previewData}\n                      viewMode={viewMode}\n                      onSave={saveReport}\n                      onPreview={previewReport}\n                      onGenerate={generateReport}\n                      onSchedule={handleScheduleReport}\n                      onFieldToggle={handleFieldToggle}\n                      onFilterChange={updateFilter}\n                    />\n                  </div>\n                </div>\n              )}\n            </div>\n          ) : (\n            <ReportsList\n              reportsHistory={reportsHistory}\n              loadingHistory={loadingHistory}\n              selectedCategory={selectedCategory}\n              categories={getCategories()}\n              onCategoryChange={setSelectedCategory}\n              onRefresh={loadReportsHistory}\n              onView={handleViewReport}\n              onEdit={handleEditReport}\n              onDelete={handleDeleteReport}\n            />\n          )}\n\n          {/* Modals */}\n          <PreviewModal\n            show={showPreviewModal}\n            data={previewModalData?.data}\n            fieldLabels={previewModalData?.fieldLabels || fieldLabelMap || {}}\n            totalCount={previewModalData?.totalCount}\n            hasMore={previewModalData?.hasMore}\n            onClose={() => setShowPreviewModal(false)}\n          />\n\n          <DeleteConfirmModal\n            show={showDeleteConfirm}\n            onConfirm={confirmDeleteReport}\n            onCancel={() => {\n              setShowDeleteConfirm(false);\n              setReportToDelete(null);\n            }}\n          />\n\n          <ScheduleModal\n            show={showScheduleModal}\n            formData={scheduleFormData}\n            onClose={() => setShowScheduleModal(false)}\n            onSave={handleCreateScheduledReport}\n            onChange={setScheduleFormData}\n            reportName={reportConfig.name}\n          />\n        </main>\n      </div>\n    </div>\n  );\n};\n\nexport default ReportBuilder;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}