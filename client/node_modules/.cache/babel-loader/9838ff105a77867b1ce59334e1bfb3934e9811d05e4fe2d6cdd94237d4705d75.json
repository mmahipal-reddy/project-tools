{"ast":null,"code":"// Universal Export Service - Supports CSV, Excel, and PDF exports\nimport*as XLSX from'xlsx';// Optional PDF support - requires: npm install jspdf jspdf-autotable\nlet jsPDF=null;try{jsPDF=require('jspdf').default||require('jspdf');require('jspdf-autotable');}catch(e){console.warn('jsPDF not available. PDF export will not work. Install with: npm install jspdf jspdf-autotable');}/**\n * Export data to Excel\n * @param {Array} data - Array of objects\n * @param {string} filename - Output filename\n * @param {string} sheetName - Sheet name (default: 'Sheet1')\n */export const exportToExcel=function(data){let filename=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'export';let sheetName=arguments.length>2&&arguments[2]!==undefined?arguments[2]:'Sheet1';try{if(!data||data.length===0){throw new Error('No data to export');}// Convert data to worksheet\nconst ws=XLSX.utils.json_to_sheet(data);const wb=XLSX.utils.book_new();XLSX.utils.book_append_sheet(wb,ws,sheetName);// Generate filename with timestamp\nconst timestamp=new Date().toISOString().split('T')[0];const fullFilename=\"\".concat(filename,\"_\").concat(timestamp,\".xlsx\");// Write and download\nXLSX.writeFile(wb,fullFilename);return{success:true,filename:fullFilename};}catch(error){console.error('Error exporting to Excel:',error);return{success:false,error:error.message};}};/**\n * Export data to CSV\n * @param {Array} data - Array of objects\n * @param {string} filename - Output filename\n */export const exportToCSV=function(data){let filename=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'export';try{if(!data||data.length===0){throw new Error('No data to export');}// Convert to CSV\nconst ws=XLSX.utils.json_to_sheet(data);const csv=XLSX.utils.sheet_to_csv(ws);// Create blob and download\nconst blob=new Blob([csv],{type:'text/csv;charset=utf-8;'});const link=document.createElement('a');const url=URL.createObjectURL(blob);const timestamp=new Date().toISOString().split('T')[0];const fullFilename=\"\".concat(filename,\"_\").concat(timestamp,\".csv\");link.setAttribute('href',url);link.setAttribute('download',fullFilename);link.style.visibility='hidden';document.body.appendChild(link);link.click();document.body.removeChild(link);return{success:true,filename:fullFilename};}catch(error){console.error('Error exporting to CSV:',error);return{success:false,error:error.message};}};/**\n * Export data to PDF\n * @param {Array} data - Array of objects\n * @param {string} filename - Output filename\n * @param {string} title - PDF title\n */export const exportToPDF=function(data){let filename=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'export';let title=arguments.length>2&&arguments[2]!==undefined?arguments[2]:'Export Report';try{if(!jsPDF){throw new Error('PDF export requires jsPDF. Install with: npm install jspdf jspdf-autotable');}if(!data||data.length===0){throw new Error('No data to export');}const doc=new jsPDF();// Add title\ndoc.setFontSize(16);doc.text(title,14,15);// Prepare table data\nconst headers=Object.keys(data[0]);const rows=data.map(item=>headers.map(header=>item[header]||''));// Add table\ndoc.autoTable({head:[headers],body:rows,startY:25,styles:{fontSize:8},headStyles:{fillColor:[1,118,211]}// #0176d3\n});// Generate filename with timestamp\nconst timestamp=new Date().toISOString().split('T')[0];const fullFilename=\"\".concat(filename,\"_\").concat(timestamp,\".pdf\");// Save\ndoc.save(fullFilename);return{success:true,filename:fullFilename};}catch(error){console.error('Error exporting to PDF:',error);return{success:false,error:error.message};}};/**\n * Universal export function - detects format from filename or uses default\n * @param {Array} data - Array of objects\n * @param {string} filename - Output filename (with or without extension)\n * @param {string} format - Format: 'excel', 'csv', 'pdf' (optional, auto-detected from filename)\n */export const exportData=function(data){let filename=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'export';let format=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;// Auto-detect format from filename\nif(!format){if(filename.endsWith('.xlsx')||filename.endsWith('.xls')){format='excel';}else if(filename.endsWith('.csv')){format='csv';}else if(filename.endsWith('.pdf')){format='pdf';}else{format='excel';// Default\n}}// Remove extension from filename if present\nconst baseFilename=filename.replace(/\\.(xlsx|xls|csv|pdf)$/i,'');switch(format.toLowerCase()){case'excel':case'xlsx':return exportToExcel(data,baseFilename);case'csv':return exportToCSV(data,baseFilename);case'pdf':return exportToPDF(data,baseFilename);default:return{success:false,error:\"Unsupported format: \".concat(format)};}};","map":{"version":3,"names":["XLSX","jsPDF","require","default","e","console","warn","exportToExcel","data","filename","arguments","length","undefined","sheetName","Error","ws","utils","json_to_sheet","wb","book_new","book_append_sheet","timestamp","Date","toISOString","split","fullFilename","concat","writeFile","success","error","message","exportToCSV","csv","sheet_to_csv","blob","Blob","type","link","document","createElement","url","URL","createObjectURL","setAttribute","style","visibility","body","appendChild","click","removeChild","exportToPDF","title","doc","setFontSize","text","headers","Object","keys","rows","map","item","header","autoTable","head","startY","styles","fontSize","headStyles","fillColor","save","exportData","format","endsWith","baseFilename","replace","toLowerCase"],"sources":["/Users/mmoola/Cursor/ProjectSetup/client/src/utils/crossFeature/exportService.js"],"sourcesContent":["// Universal Export Service - Supports CSV, Excel, and PDF exports\n\nimport * as XLSX from 'xlsx';\n\n// Optional PDF support - requires: npm install jspdf jspdf-autotable\nlet jsPDF = null;\ntry {\n  jsPDF = require('jspdf').default || require('jspdf');\n  require('jspdf-autotable');\n} catch (e) {\n  console.warn('jsPDF not available. PDF export will not work. Install with: npm install jspdf jspdf-autotable');\n}\n\n/**\n * Export data to Excel\n * @param {Array} data - Array of objects\n * @param {string} filename - Output filename\n * @param {string} sheetName - Sheet name (default: 'Sheet1')\n */\nexport const exportToExcel = (data, filename = 'export', sheetName = 'Sheet1') => {\n  try {\n    if (!data || data.length === 0) {\n      throw new Error('No data to export');\n    }\n\n    // Convert data to worksheet\n    const ws = XLSX.utils.json_to_sheet(data);\n    const wb = XLSX.utils.book_new();\n    XLSX.utils.book_append_sheet(wb, ws, sheetName);\n\n    // Generate filename with timestamp\n    const timestamp = new Date().toISOString().split('T')[0];\n    const fullFilename = `${filename}_${timestamp}.xlsx`;\n\n    // Write and download\n    XLSX.writeFile(wb, fullFilename);\n    return { success: true, filename: fullFilename };\n  } catch (error) {\n    console.error('Error exporting to Excel:', error);\n    return { success: false, error: error.message };\n  }\n};\n\n/**\n * Export data to CSV\n * @param {Array} data - Array of objects\n * @param {string} filename - Output filename\n */\nexport const exportToCSV = (data, filename = 'export') => {\n  try {\n    if (!data || data.length === 0) {\n      throw new Error('No data to export');\n    }\n\n    // Convert to CSV\n    const ws = XLSX.utils.json_to_sheet(data);\n    const csv = XLSX.utils.sheet_to_csv(ws);\n\n    // Create blob and download\n    const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });\n    const link = document.createElement('a');\n    const url = URL.createObjectURL(blob);\n    \n    const timestamp = new Date().toISOString().split('T')[0];\n    const fullFilename = `${filename}_${timestamp}.csv`;\n    \n    link.setAttribute('href', url);\n    link.setAttribute('download', fullFilename);\n    link.style.visibility = 'hidden';\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n    \n    return { success: true, filename: fullFilename };\n  } catch (error) {\n    console.error('Error exporting to CSV:', error);\n    return { success: false, error: error.message };\n  }\n};\n\n/**\n * Export data to PDF\n * @param {Array} data - Array of objects\n * @param {string} filename - Output filename\n * @param {string} title - PDF title\n */\nexport const exportToPDF = (data, filename = 'export', title = 'Export Report') => {\n  try {\n    if (!jsPDF) {\n      throw new Error('PDF export requires jsPDF. Install with: npm install jspdf jspdf-autotable');\n    }\n    \n    if (!data || data.length === 0) {\n      throw new Error('No data to export');\n    }\n\n    const doc = new jsPDF();\n    \n    // Add title\n    doc.setFontSize(16);\n    doc.text(title, 14, 15);\n    \n    // Prepare table data\n    const headers = Object.keys(data[0]);\n    const rows = data.map(item => headers.map(header => item[header] || ''));\n    \n    // Add table\n    doc.autoTable({\n      head: [headers],\n      body: rows,\n      startY: 25,\n      styles: { fontSize: 8 },\n      headStyles: { fillColor: [1, 118, 211] } // #0176d3\n    });\n    \n    // Generate filename with timestamp\n    const timestamp = new Date().toISOString().split('T')[0];\n    const fullFilename = `${filename}_${timestamp}.pdf`;\n    \n    // Save\n    doc.save(fullFilename);\n    return { success: true, filename: fullFilename };\n  } catch (error) {\n    console.error('Error exporting to PDF:', error);\n    return { success: false, error: error.message };\n  }\n};\n\n/**\n * Universal export function - detects format from filename or uses default\n * @param {Array} data - Array of objects\n * @param {string} filename - Output filename (with or without extension)\n * @param {string} format - Format: 'excel', 'csv', 'pdf' (optional, auto-detected from filename)\n */\nexport const exportData = (data, filename = 'export', format = null) => {\n  // Auto-detect format from filename\n  if (!format) {\n    if (filename.endsWith('.xlsx') || filename.endsWith('.xls')) {\n      format = 'excel';\n    } else if (filename.endsWith('.csv')) {\n      format = 'csv';\n    } else if (filename.endsWith('.pdf')) {\n      format = 'pdf';\n    } else {\n      format = 'excel'; // Default\n    }\n  }\n  \n  // Remove extension from filename if present\n  const baseFilename = filename.replace(/\\.(xlsx|xls|csv|pdf)$/i, '');\n  \n  switch (format.toLowerCase()) {\n    case 'excel':\n    case 'xlsx':\n      return exportToExcel(data, baseFilename);\n    case 'csv':\n      return exportToCSV(data, baseFilename);\n    case 'pdf':\n      return exportToPDF(data, baseFilename);\n    default:\n      return { success: false, error: `Unsupported format: ${format}` };\n  }\n};\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}