{"ast":null,"code":"// Universal Export Service - Supports CSV, Excel, and PDF exports\n\nimport * as XLSX from 'xlsx';\n\n// Optional PDF support - requires: npm install jspdf jspdf-autotable\nlet jsPDF = null;\ntry {\n  jsPDF = require('jspdf').default || require('jspdf');\n  require('jspdf-autotable');\n} catch (e) {\n  console.warn('jsPDF not available. PDF export will not work. Install with: npm install jspdf jspdf-autotable');\n}\n\n/**\n * Export data to Excel\n * @param {Array} data - Array of objects\n * @param {string} filename - Output filename\n * @param {string} sheetName - Sheet name (default: 'Sheet1')\n */\nexport const exportToExcel = (data, filename = 'export', sheetName = 'Sheet1') => {\n  try {\n    if (!data || data.length === 0) {\n      throw new Error('No data to export');\n    }\n\n    // Convert data to worksheet\n    const ws = XLSX.utils.json_to_sheet(data);\n    const wb = XLSX.utils.book_new();\n    XLSX.utils.book_append_sheet(wb, ws, sheetName);\n\n    // Generate filename with timestamp\n    const timestamp = new Date().toISOString().split('T')[0];\n    const fullFilename = `${filename}_${timestamp}.xlsx`;\n\n    // Write and download\n    XLSX.writeFile(wb, fullFilename);\n    return {\n      success: true,\n      filename: fullFilename\n    };\n  } catch (error) {\n    console.error('Error exporting to Excel:', error);\n    return {\n      success: false,\n      error: error.message\n    };\n  }\n};\n\n/**\n * Export data to CSV\n * @param {Array} data - Array of objects\n * @param {string} filename - Output filename\n */\nexport const exportToCSV = (data, filename = 'export') => {\n  try {\n    if (!data || data.length === 0) {\n      throw new Error('No data to export');\n    }\n\n    // Convert to CSV\n    const ws = XLSX.utils.json_to_sheet(data);\n    const csv = XLSX.utils.sheet_to_csv(ws);\n\n    // Create blob and download\n    const blob = new Blob([csv], {\n      type: 'text/csv;charset=utf-8;'\n    });\n    const link = document.createElement('a');\n    const url = URL.createObjectURL(blob);\n    const timestamp = new Date().toISOString().split('T')[0];\n    const fullFilename = `${filename}_${timestamp}.csv`;\n    link.setAttribute('href', url);\n    link.setAttribute('download', fullFilename);\n    link.style.visibility = 'hidden';\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n    return {\n      success: true,\n      filename: fullFilename\n    };\n  } catch (error) {\n    console.error('Error exporting to CSV:', error);\n    return {\n      success: false,\n      error: error.message\n    };\n  }\n};\n\n/**\n * Export data to PDF\n * @param {Array} data - Array of objects\n * @param {string} filename - Output filename\n * @param {string} title - PDF title\n */\nexport const exportToPDF = (data, filename = 'export', title = 'Export Report') => {\n  try {\n    if (!jsPDF) {\n      throw new Error('PDF export requires jsPDF. Install with: npm install jspdf jspdf-autotable');\n    }\n    if (!data || data.length === 0) {\n      throw new Error('No data to export');\n    }\n    const doc = new jsPDF();\n\n    // Add title\n    doc.setFontSize(16);\n    doc.text(title, 14, 15);\n\n    // Prepare table data\n    const headers = Object.keys(data[0]);\n    const rows = data.map(item => headers.map(header => item[header] || ''));\n\n    // Add table\n    doc.autoTable({\n      head: [headers],\n      body: rows,\n      startY: 25,\n      styles: {\n        fontSize: 8\n      },\n      headStyles: {\n        fillColor: [1, 118, 211]\n      } // #0176d3\n    });\n\n    // Generate filename with timestamp\n    const timestamp = new Date().toISOString().split('T')[0];\n    const fullFilename = `${filename}_${timestamp}.pdf`;\n\n    // Save\n    doc.save(fullFilename);\n    return {\n      success: true,\n      filename: fullFilename\n    };\n  } catch (error) {\n    console.error('Error exporting to PDF:', error);\n    return {\n      success: false,\n      error: error.message\n    };\n  }\n};\n\n/**\n * Universal export function - detects format from filename or uses default\n * @param {Array} data - Array of objects\n * @param {string} filename - Output filename (with or without extension)\n * @param {string} format - Format: 'excel', 'csv', 'pdf' (optional, auto-detected from filename)\n */\nexport const exportData = (data, filename = 'export', format = null) => {\n  // Auto-detect format from filename\n  if (!format) {\n    if (filename.endsWith('.xlsx') || filename.endsWith('.xls')) {\n      format = 'excel';\n    } else if (filename.endsWith('.csv')) {\n      format = 'csv';\n    } else if (filename.endsWith('.pdf')) {\n      format = 'pdf';\n    } else {\n      format = 'excel'; // Default\n    }\n  }\n\n  // Remove extension from filename if present\n  const baseFilename = filename.replace(/\\.(xlsx|xls|csv|pdf)$/i, '');\n  switch (format.toLowerCase()) {\n    case 'excel':\n    case 'xlsx':\n      return exportToExcel(data, baseFilename);\n    case 'csv':\n      return exportToCSV(data, baseFilename);\n    case 'pdf':\n      return exportToPDF(data, baseFilename);\n    default:\n      return {\n        success: false,\n        error: `Unsupported format: ${format}`\n      };\n  }\n};","map":{"version":3,"names":["XLSX","jsPDF","require","default","e","console","warn","exportToExcel","data","filename","sheetName","length","Error","ws","utils","json_to_sheet","wb","book_new","book_append_sheet","timestamp","Date","toISOString","split","fullFilename","writeFile","success","error","message","exportToCSV","csv","sheet_to_csv","blob","Blob","type","link","document","createElement","url","URL","createObjectURL","setAttribute","style","visibility","body","appendChild","click","removeChild","exportToPDF","title","doc","setFontSize","text","headers","Object","keys","rows","map","item","header","autoTable","head","startY","styles","fontSize","headStyles","fillColor","save","exportData","format","endsWith","baseFilename","replace","toLowerCase"],"sources":["/Users/mmoola/Cursor/ProjectSetup/client/src/utils/crossFeature/exportService.js"],"sourcesContent":["// Universal Export Service - Supports CSV, Excel, and PDF exports\n\nimport * as XLSX from 'xlsx';\n\n// Optional PDF support - requires: npm install jspdf jspdf-autotable\nlet jsPDF = null;\ntry {\n  jsPDF = require('jspdf').default || require('jspdf');\n  require('jspdf-autotable');\n} catch (e) {\n  console.warn('jsPDF not available. PDF export will not work. Install with: npm install jspdf jspdf-autotable');\n}\n\n/**\n * Export data to Excel\n * @param {Array} data - Array of objects\n * @param {string} filename - Output filename\n * @param {string} sheetName - Sheet name (default: 'Sheet1')\n */\nexport const exportToExcel = (data, filename = 'export', sheetName = 'Sheet1') => {\n  try {\n    if (!data || data.length === 0) {\n      throw new Error('No data to export');\n    }\n\n    // Convert data to worksheet\n    const ws = XLSX.utils.json_to_sheet(data);\n    const wb = XLSX.utils.book_new();\n    XLSX.utils.book_append_sheet(wb, ws, sheetName);\n\n    // Generate filename with timestamp\n    const timestamp = new Date().toISOString().split('T')[0];\n    const fullFilename = `${filename}_${timestamp}.xlsx`;\n\n    // Write and download\n    XLSX.writeFile(wb, fullFilename);\n    return { success: true, filename: fullFilename };\n  } catch (error) {\n    console.error('Error exporting to Excel:', error);\n    return { success: false, error: error.message };\n  }\n};\n\n/**\n * Export data to CSV\n * @param {Array} data - Array of objects\n * @param {string} filename - Output filename\n */\nexport const exportToCSV = (data, filename = 'export') => {\n  try {\n    if (!data || data.length === 0) {\n      throw new Error('No data to export');\n    }\n\n    // Convert to CSV\n    const ws = XLSX.utils.json_to_sheet(data);\n    const csv = XLSX.utils.sheet_to_csv(ws);\n\n    // Create blob and download\n    const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });\n    const link = document.createElement('a');\n    const url = URL.createObjectURL(blob);\n    \n    const timestamp = new Date().toISOString().split('T')[0];\n    const fullFilename = `${filename}_${timestamp}.csv`;\n    \n    link.setAttribute('href', url);\n    link.setAttribute('download', fullFilename);\n    link.style.visibility = 'hidden';\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n    \n    return { success: true, filename: fullFilename };\n  } catch (error) {\n    console.error('Error exporting to CSV:', error);\n    return { success: false, error: error.message };\n  }\n};\n\n/**\n * Export data to PDF\n * @param {Array} data - Array of objects\n * @param {string} filename - Output filename\n * @param {string} title - PDF title\n */\nexport const exportToPDF = (data, filename = 'export', title = 'Export Report') => {\n  try {\n    if (!jsPDF) {\n      throw new Error('PDF export requires jsPDF. Install with: npm install jspdf jspdf-autotable');\n    }\n    \n    if (!data || data.length === 0) {\n      throw new Error('No data to export');\n    }\n\n    const doc = new jsPDF();\n    \n    // Add title\n    doc.setFontSize(16);\n    doc.text(title, 14, 15);\n    \n    // Prepare table data\n    const headers = Object.keys(data[0]);\n    const rows = data.map(item => headers.map(header => item[header] || ''));\n    \n    // Add table\n    doc.autoTable({\n      head: [headers],\n      body: rows,\n      startY: 25,\n      styles: { fontSize: 8 },\n      headStyles: { fillColor: [1, 118, 211] } // #0176d3\n    });\n    \n    // Generate filename with timestamp\n    const timestamp = new Date().toISOString().split('T')[0];\n    const fullFilename = `${filename}_${timestamp}.pdf`;\n    \n    // Save\n    doc.save(fullFilename);\n    return { success: true, filename: fullFilename };\n  } catch (error) {\n    console.error('Error exporting to PDF:', error);\n    return { success: false, error: error.message };\n  }\n};\n\n/**\n * Universal export function - detects format from filename or uses default\n * @param {Array} data - Array of objects\n * @param {string} filename - Output filename (with or without extension)\n * @param {string} format - Format: 'excel', 'csv', 'pdf' (optional, auto-detected from filename)\n */\nexport const exportData = (data, filename = 'export', format = null) => {\n  // Auto-detect format from filename\n  if (!format) {\n    if (filename.endsWith('.xlsx') || filename.endsWith('.xls')) {\n      format = 'excel';\n    } else if (filename.endsWith('.csv')) {\n      format = 'csv';\n    } else if (filename.endsWith('.pdf')) {\n      format = 'pdf';\n    } else {\n      format = 'excel'; // Default\n    }\n  }\n  \n  // Remove extension from filename if present\n  const baseFilename = filename.replace(/\\.(xlsx|xls|csv|pdf)$/i, '');\n  \n  switch (format.toLowerCase()) {\n    case 'excel':\n    case 'xlsx':\n      return exportToExcel(data, baseFilename);\n    case 'csv':\n      return exportToCSV(data, baseFilename);\n    case 'pdf':\n      return exportToPDF(data, baseFilename);\n    default:\n      return { success: false, error: `Unsupported format: ${format}` };\n  }\n};\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}