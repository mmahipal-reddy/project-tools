{"ast":null,"code":"import React from'react';import{X,FileText}from'lucide-react';import FieldChip from'../FieldChip';import'../../../../styles/SubqueryCard.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const SubqueryCard=_ref=>{let{subquery,fields,onFieldAdd,onFieldRemove,onRemove}=_ref;const handleDrop=e=>{e.preventDefault();e.stopPropagation();try{const dataStr=e.dataTransfer.getData('application/json');if(!dataStr){return;// No data to process\n}const data=JSON.parse(dataStr);if(data.type==='subquery-field'&&data.relationshipName===subquery.relationshipName){var _data$field;const fieldName=typeof data.field==='string'?data.field:data.field.name;const fieldLabel=typeof data.field==='string'?data.field:data.field.label||data.field.name;const fieldWithPath={name:\"SUBQUERY:\".concat(subquery.relationshipName,\".\").concat(fieldName),label:\"\".concat(subquery.relationshipName,\" \").concat(fieldLabel),type:((_data$field=data.field)===null||_data$field===void 0?void 0:_data$field.type)||'string'};onFieldAdd(fieldWithPath);}}catch(error){console.error('Error handling drop:',error);// Silently fail - don't show browser alert\n}};const handleDragOver=e=>{e.preventDefault();e.stopPropagation();e.dataTransfer.dropEffect='move';};return/*#__PURE__*/_jsxs(\"div\",{className:\"query-card subquery-card\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"card-header\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"card-title\",children:[/*#__PURE__*/_jsx(FileText,{size:18}),/*#__PURE__*/_jsxs(\"span\",{children:[\"\\uD83D\\uDCCB \",subquery.fieldLabel||subquery.relationshipName]}),/*#__PURE__*/_jsxs(\"span\",{className:\"card-subtitle\",children:[\"\\u2192 \",subquery.targetObject,\" (Child Records)\"]})]}),/*#__PURE__*/_jsx(\"button\",{className:\"card-remove-btn\",onClick:onRemove,title:\"Remove subquery\",children:/*#__PURE__*/_jsx(X,{size:16})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"card-content\",onDrop:handleDrop,onDragOver:handleDragOver,children:fields.length===0?/*#__PURE__*/_jsx(\"div\",{className:\"card-empty\",children:/*#__PURE__*/_jsx(\"p\",{children:\"Drag child record fields here\"})}):/*#__PURE__*/_jsx(\"div\",{className:\"card-fields\",children:fields.map(field=>{const fieldName=typeof field==='string'?field:field.name;const fieldLabel=typeof field==='string'?field:field.label||field.name;return/*#__PURE__*/_jsx(FieldChip,{label:fieldLabel,name:fieldName,onRemove:()=>onFieldRemove(fieldName)},fieldName);})})})]});};export default SubqueryCard;","map":{"version":3,"names":["React","X","FileText","FieldChip","jsx","_jsx","jsxs","_jsxs","SubqueryCard","_ref","subquery","fields","onFieldAdd","onFieldRemove","onRemove","handleDrop","e","preventDefault","stopPropagation","dataStr","dataTransfer","getData","data","JSON","parse","type","relationshipName","_data$field","fieldName","field","name","fieldLabel","label","fieldWithPath","concat","error","console","handleDragOver","dropEffect","className","children","size","targetObject","onClick","title","onDrop","onDragOver","length","map"],"sources":["/Users/mmoola/Cursor/ProjectSetup/client/src/components/AdvancedReportBuilder/QueryCanvas/cards/SubqueryCard.js"],"sourcesContent":["import React from 'react';\nimport { X, FileText } from 'lucide-react';\nimport FieldChip from '../FieldChip';\nimport '../../../../styles/SubqueryCard.css';\n\nconst SubqueryCard = ({ subquery, fields, onFieldAdd, onFieldRemove, onRemove }) => {\n  const handleDrop = (e) => {\n    e.preventDefault();\n    e.stopPropagation();\n    try {\n      const dataStr = e.dataTransfer.getData('application/json');\n      if (!dataStr) {\n        return; // No data to process\n      }\n      \n      const data = JSON.parse(dataStr);\n      if (data.type === 'subquery-field' && \n          data.relationshipName === subquery.relationshipName) {\n        const fieldName = typeof data.field === 'string' ? data.field : data.field.name;\n        const fieldLabel = typeof data.field === 'string' ? data.field : (data.field.label || data.field.name);\n        const fieldWithPath = {\n          name: `SUBQUERY:${subquery.relationshipName}.${fieldName}`,\n          label: `${subquery.relationshipName} ${fieldLabel}`,\n          type: data.field?.type || 'string'\n        };\n        onFieldAdd(fieldWithPath);\n      }\n    } catch (error) {\n      console.error('Error handling drop:', error);\n      // Silently fail - don't show browser alert\n    }\n  };\n\n  const handleDragOver = (e) => {\n    e.preventDefault();\n    e.stopPropagation();\n    e.dataTransfer.dropEffect = 'move';\n  };\n\n  return (\n    <div className=\"query-card subquery-card\">\n      <div className=\"card-header\">\n        <div className=\"card-title\">\n          <FileText size={18} />\n          <span>ðŸ“‹ {subquery.fieldLabel || subquery.relationshipName}</span>\n          <span className=\"card-subtitle\">â†’ {subquery.targetObject} (Child Records)</span>\n        </div>\n        <button className=\"card-remove-btn\" onClick={onRemove} title=\"Remove subquery\">\n          <X size={16} />\n        </button>\n      </div>\n      \n      <div\n        className=\"card-content\"\n        onDrop={handleDrop}\n        onDragOver={handleDragOver}\n      >\n        {fields.length === 0 ? (\n          <div className=\"card-empty\">\n            <p>Drag child record fields here</p>\n          </div>\n        ) : (\n          <div className=\"card-fields\">\n            {fields.map(field => {\n              const fieldName = typeof field === 'string' ? field : field.name;\n              const fieldLabel = typeof field === 'string' ? field : (field.label || field.name);\n              return (\n                <FieldChip\n                  key={fieldName}\n                  label={fieldLabel}\n                  name={fieldName}\n                  onRemove={() => onFieldRemove(fieldName)}\n                />\n              );\n            })}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default SubqueryCard;\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}