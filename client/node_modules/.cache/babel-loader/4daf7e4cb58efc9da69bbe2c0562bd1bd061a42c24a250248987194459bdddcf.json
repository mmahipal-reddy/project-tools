{"ast":null,"code":"import React from'react';import{X,Link2}from'lucide-react';import FieldChip from'../FieldChip';import'../../../../styles/RelationshipCard.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const RelationshipCard=_ref=>{let{relationship,fields,onFieldAdd,onFieldRemove,onRemove}=_ref;const handleDrop=e=>{e.preventDefault();e.stopPropagation();try{const dataStr=e.dataTransfer.getData('application/json');if(!dataStr){return;// No data to process\n}const data=JSON.parse(dataStr);if(data.type==='relationship-field'&&data.relationshipName===relationship.relationshipName){var _data$field;const fieldName=typeof data.field==='string'?data.field:data.field.name;const fieldLabel=typeof data.field==='string'?data.field:data.field.label||data.field.name;const fieldWithPath={name:\"\".concat(relationship.relationshipName,\".\").concat(fieldName),label:\"\".concat(relationship.relationshipName,\" \").concat(fieldLabel),type:((_data$field=data.field)===null||_data$field===void 0?void 0:_data$field.type)||'string'};onFieldAdd(fieldWithPath);}}catch(error){console.error('Error handling drop:',error);// Silently fail - don't show browser alert\n}};const handleDragOver=e=>{e.preventDefault();e.stopPropagation();e.dataTransfer.dropEffect='move';};return/*#__PURE__*/_jsxs(\"div\",{className:\"query-card relationship-card\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"card-header\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"card-title\",children:[/*#__PURE__*/_jsx(Link2,{size:18}),/*#__PURE__*/_jsx(\"span\",{children:relationship.fieldLabel||relationship.relationshipName}),/*#__PURE__*/_jsxs(\"span\",{className:\"card-subtitle\",children:[\"\\u2192 \",relationship.targetObject]})]}),/*#__PURE__*/_jsx(\"button\",{className:\"card-remove-btn\",onClick:onRemove,title:\"Remove relationship\",children:/*#__PURE__*/_jsx(X,{size:16})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"card-content\",onDrop:handleDrop,onDragOver:handleDragOver,children:fields.length===0?/*#__PURE__*/_jsx(\"div\",{className:\"card-empty\",children:/*#__PURE__*/_jsx(\"p\",{children:\"Drag related fields here\"})}):/*#__PURE__*/_jsx(\"div\",{className:\"card-fields\",children:fields.map(field=>{const fieldName=typeof field==='string'?field:field.name;const fieldLabel=typeof field==='string'?field:field.label||field.name;return/*#__PURE__*/_jsx(FieldChip,{label:fieldLabel,name:fieldName,onRemove:()=>onFieldRemove(fieldName)},fieldName);})})})]});};export default RelationshipCard;","map":{"version":3,"names":["React","X","Link2","FieldChip","jsx","_jsx","jsxs","_jsxs","RelationshipCard","_ref","relationship","fields","onFieldAdd","onFieldRemove","onRemove","handleDrop","e","preventDefault","stopPropagation","dataStr","dataTransfer","getData","data","JSON","parse","type","relationshipName","_data$field","fieldName","field","name","fieldLabel","label","fieldWithPath","concat","error","console","handleDragOver","dropEffect","className","children","size","targetObject","onClick","title","onDrop","onDragOver","length","map"],"sources":["/Users/mmoola/Documents/GitHub/project-tools/client/src/components/AdvancedReportBuilder/QueryCanvas/cards/RelationshipCard.js"],"sourcesContent":["import React from 'react';\nimport { X, Link2 } from 'lucide-react';\nimport FieldChip from '../FieldChip';\nimport '../../../../styles/RelationshipCard.css';\n\nconst RelationshipCard = ({ relationship, fields, onFieldAdd, onFieldRemove, onRemove }) => {\n  const handleDrop = (e) => {\n    e.preventDefault();\n    e.stopPropagation();\n    try {\n      const dataStr = e.dataTransfer.getData('application/json');\n      if (!dataStr) {\n        return; // No data to process\n      }\n      \n      const data = JSON.parse(dataStr);\n      if (data.type === 'relationship-field' && \n          data.relationshipName === relationship.relationshipName) {\n        const fieldName = typeof data.field === 'string' ? data.field : data.field.name;\n        const fieldLabel = typeof data.field === 'string' ? data.field : (data.field.label || data.field.name);\n        const fieldWithPath = {\n          name: `${relationship.relationshipName}.${fieldName}`,\n          label: `${relationship.relationshipName} ${fieldLabel}`,\n          type: data.field?.type || 'string'\n        };\n        onFieldAdd(fieldWithPath);\n      }\n    } catch (error) {\n      console.error('Error handling drop:', error);\n      // Silently fail - don't show browser alert\n    }\n  };\n\n  const handleDragOver = (e) => {\n    e.preventDefault();\n    e.stopPropagation();\n    e.dataTransfer.dropEffect = 'move';\n  };\n\n  return (\n    <div className=\"query-card relationship-card\">\n      <div className=\"card-header\">\n        <div className=\"card-title\">\n          <Link2 size={18} />\n          <span>{relationship.fieldLabel || relationship.relationshipName}</span>\n          <span className=\"card-subtitle\">â†’ {relationship.targetObject}</span>\n        </div>\n        <button className=\"card-remove-btn\" onClick={onRemove} title=\"Remove relationship\">\n          <X size={16} />\n        </button>\n      </div>\n      \n      <div\n        className=\"card-content\"\n        onDrop={handleDrop}\n        onDragOver={handleDragOver}\n      >\n        {fields.length === 0 ? (\n          <div className=\"card-empty\">\n            <p>Drag related fields here</p>\n          </div>\n        ) : (\n          <div className=\"card-fields\">\n            {fields.map(field => {\n              const fieldName = typeof field === 'string' ? field : field.name;\n              const fieldLabel = typeof field === 'string' ? field : (field.label || field.name);\n              return (\n                <FieldChip\n                  key={fieldName}\n                  label={fieldLabel}\n                  name={fieldName}\n                  onRemove={() => onFieldRemove(fieldName)}\n                />\n              );\n            })}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default RelationshipCard;\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}