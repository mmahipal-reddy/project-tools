{"ast":null,"code":"/**\n * Security utilities\n * Provides functions for input sanitization and security checks\n */\n\n/**\n * Sanitizes string input to prevent XSS attacks\n * Removes potentially dangerous HTML/JavaScript\n * @param {string} input - Input string to sanitize\n * @returns {string} - Sanitized string\n */\nexport const sanitizeString = input => {\n  if (!input || typeof input !== 'string') return input;\n\n  // Remove HTML tags\n  let sanitized = input.replace(/<[^>]*>/g, '');\n\n  // Remove potentially dangerous JavaScript patterns\n  sanitized = sanitized.replace(/javascript:/gi, '').replace(/on\\w+\\s*=/gi, '').replace(/<script/gi, '').replace(/<\\/script>/gi, '').replace(/<iframe/gi, '').replace(/<object/gi, '').replace(/<embed/gi, '').replace(/<link/gi, '').replace(/<style/gi, '');\n\n  // Remove null bytes\n  sanitized = sanitized.replace(/\\0/g, '');\n  return sanitized.trim();\n};\n\n/**\n * Sanitizes object recursively\n * @param {object} obj - Object to sanitize\n * @returns {object} - Sanitized object\n */\nexport const sanitizeObject = obj => {\n  if (!obj || typeof obj !== 'object') return obj;\n  if (Array.isArray(obj)) {\n    return obj.map(item => sanitizeObject(item));\n  }\n  const sanitized = {};\n  for (const key in obj) {\n    if (obj.hasOwnProperty(key)) {\n      const value = obj[key];\n      if (typeof value === 'string') {\n        sanitized[key] = sanitizeString(value);\n      } else if (typeof value === 'object' && value !== null) {\n        sanitized[key] = sanitizeObject(value);\n      } else {\n        sanitized[key] = value;\n      }\n    }\n  }\n  return sanitized;\n};\n\n/**\n * Escapes special characters for use in SQL queries\n * Note: This is a basic escape. Always use parameterized queries when possible.\n * @param {string} input - Input string to escape\n * @returns {string} - Escaped string\n */\nexport const escapeSql = input => {\n  if (!input || typeof input !== 'string') return input;\n  return input.replace(/\\\\/g, '\\\\\\\\').replace(/'/g, \"\\\\'\").replace(/\"/g, '\\\\\"').replace(/\\0/g, '\\\\0').replace(/\\n/g, '\\\\n').replace(/\\r/g, '\\\\r').replace(/\\x1a/g, '\\\\Z');\n};\n\n/**\n * Validates input length\n * @param {string} input - Input to validate\n * @param {number} maxLength - Maximum allowed length\n * @returns {boolean} - True if valid, false otherwise\n */\nexport const isValidLength = (input, maxLength) => {\n  if (!input) return true;\n  return input.length <= maxLength;\n};\n\n/**\n * Checks for SQL injection patterns\n * @param {string} input - Input to check\n * @returns {boolean} - True if potentially dangerous, false otherwise\n */\nexport const containsSqlInjection = input => {\n  if (!input || typeof input !== 'string') return false;\n  const sqlPatterns = [/(\\b(SELECT|INSERT|UPDATE|DELETE|DROP|CREATE|ALTER|EXEC|EXECUTE|UNION|SCRIPT)\\b)/gi, /('|(\\\\')|(;)|(--)|(\\/\\*)|(\\*\\/)|(\\+)|(\\%))/gi, /((\\%27)|(\\'))((\\%6F)|o|(\\%4F))((\\%72)|r|(\\%52))/gi,\n  // 'or'\n  /((\\%27)|(\\'))((\\%55)|u|(\\%75))((\\%4E)|n|(\\%6E))((\\%49)|i|(\\%69))((\\%4F)|o|(\\%6F))((\\%4E)|n|(\\%6E))/gi,\n  // 'union'\n  /((\\%27)|(\\'))((\\%4F)|o|(\\%6F))((\\%52)|r|(\\%72))/gi // 'or'\n  ];\n  return sqlPatterns.some(pattern => pattern.test(input));\n};\n\n/**\n * Checks for XSS patterns\n * @param {string} input - Input to check\n * @returns {boolean} - True if potentially dangerous, false otherwise\n */\nexport const containsXss = input => {\n  if (!input || typeof input !== 'string') return false;\n  const xssPatterns = [/<script/gi, /<iframe/gi, /<object/gi, /<embed/gi, /javascript:/gi, /on\\w+\\s*=/gi, /<img[^>]+src[^>]*=.*javascript:/gi, /<link[^>]+href[^>]*=.*javascript:/gi];\n  return xssPatterns.some(pattern => pattern.test(input));\n};\n\n/**\n * Validates input for security threats\n * @param {string} input - Input to validate\n * @returns {object} - { isSafe: boolean, threats: string[] }\n */\nexport const validateSecurity = input => {\n  if (!input || typeof input !== 'string') {\n    return {\n      isSafe: true,\n      threats: []\n    };\n  }\n  const threats = [];\n  if (containsSqlInjection(input)) {\n    threats.push('SQL_INJECTION');\n  }\n  if (containsXss(input)) {\n    threats.push('XSS');\n  }\n  return {\n    isSafe: threats.length === 0,\n    threats\n  };\n};\n\n/**\n * Sanitizes and validates input for security\n * @param {string} input - Input to sanitize and validate\n * @returns {object} - { sanitized: string, isSafe: boolean, threats: string[] }\n */\nexport const sanitizeAndValidate = input => {\n  const sanitized = sanitizeString(input);\n  const security = validateSecurity(sanitized);\n  return {\n    sanitized,\n    ...security\n  };\n};","map":{"version":3,"names":["sanitizeString","input","sanitized","replace","trim","sanitizeObject","obj","Array","isArray","map","item","key","hasOwnProperty","value","escapeSql","isValidLength","maxLength","length","containsSqlInjection","sqlPatterns","some","pattern","test","containsXss","xssPatterns","validateSecurity","isSafe","threats","push","sanitizeAndValidate","security"],"sources":["/Users/mmoola/Cursor/ProjectSetup/client/src/utils/security.js"],"sourcesContent":["/**\n * Security utilities\n * Provides functions for input sanitization and security checks\n */\n\n/**\n * Sanitizes string input to prevent XSS attacks\n * Removes potentially dangerous HTML/JavaScript\n * @param {string} input - Input string to sanitize\n * @returns {string} - Sanitized string\n */\nexport const sanitizeString = (input) => {\n  if (!input || typeof input !== 'string') return input;\n  \n  // Remove HTML tags\n  let sanitized = input.replace(/<[^>]*>/g, '');\n  \n  // Remove potentially dangerous JavaScript patterns\n  sanitized = sanitized\n    .replace(/javascript:/gi, '')\n    .replace(/on\\w+\\s*=/gi, '')\n    .replace(/<script/gi, '')\n    .replace(/<\\/script>/gi, '')\n    .replace(/<iframe/gi, '')\n    .replace(/<object/gi, '')\n    .replace(/<embed/gi, '')\n    .replace(/<link/gi, '')\n    .replace(/<style/gi, '');\n  \n  // Remove null bytes\n  sanitized = sanitized.replace(/\\0/g, '');\n  \n  return sanitized.trim();\n};\n\n/**\n * Sanitizes object recursively\n * @param {object} obj - Object to sanitize\n * @returns {object} - Sanitized object\n */\nexport const sanitizeObject = (obj) => {\n  if (!obj || typeof obj !== 'object') return obj;\n  \n  if (Array.isArray(obj)) {\n    return obj.map(item => sanitizeObject(item));\n  }\n  \n  const sanitized = {};\n  for (const key in obj) {\n    if (obj.hasOwnProperty(key)) {\n      const value = obj[key];\n      if (typeof value === 'string') {\n        sanitized[key] = sanitizeString(value);\n      } else if (typeof value === 'object' && value !== null) {\n        sanitized[key] = sanitizeObject(value);\n      } else {\n        sanitized[key] = value;\n      }\n    }\n  }\n  \n  return sanitized;\n};\n\n/**\n * Escapes special characters for use in SQL queries\n * Note: This is a basic escape. Always use parameterized queries when possible.\n * @param {string} input - Input string to escape\n * @returns {string} - Escaped string\n */\nexport const escapeSql = (input) => {\n  if (!input || typeof input !== 'string') return input;\n  \n  return input\n    .replace(/\\\\/g, '\\\\\\\\')\n    .replace(/'/g, \"\\\\'\")\n    .replace(/\"/g, '\\\\\"')\n    .replace(/\\0/g, '\\\\0')\n    .replace(/\\n/g, '\\\\n')\n    .replace(/\\r/g, '\\\\r')\n    .replace(/\\x1a/g, '\\\\Z');\n};\n\n/**\n * Validates input length\n * @param {string} input - Input to validate\n * @param {number} maxLength - Maximum allowed length\n * @returns {boolean} - True if valid, false otherwise\n */\nexport const isValidLength = (input, maxLength) => {\n  if (!input) return true;\n  return input.length <= maxLength;\n};\n\n/**\n * Checks for SQL injection patterns\n * @param {string} input - Input to check\n * @returns {boolean} - True if potentially dangerous, false otherwise\n */\nexport const containsSqlInjection = (input) => {\n  if (!input || typeof input !== 'string') return false;\n  \n  const sqlPatterns = [\n    /(\\b(SELECT|INSERT|UPDATE|DELETE|DROP|CREATE|ALTER|EXEC|EXECUTE|UNION|SCRIPT)\\b)/gi,\n    /('|(\\\\')|(;)|(--)|(\\/\\*)|(\\*\\/)|(\\+)|(\\%))/gi,\n    /((\\%27)|(\\'))((\\%6F)|o|(\\%4F))((\\%72)|r|(\\%52))/gi, // 'or'\n    /((\\%27)|(\\'))((\\%55)|u|(\\%75))((\\%4E)|n|(\\%6E))((\\%49)|i|(\\%69))((\\%4F)|o|(\\%6F))((\\%4E)|n|(\\%6E))/gi, // 'union'\n    /((\\%27)|(\\'))((\\%4F)|o|(\\%6F))((\\%52)|r|(\\%72))/gi, // 'or'\n  ];\n  \n  return sqlPatterns.some(pattern => pattern.test(input));\n};\n\n/**\n * Checks for XSS patterns\n * @param {string} input - Input to check\n * @returns {boolean} - True if potentially dangerous, false otherwise\n */\nexport const containsXss = (input) => {\n  if (!input || typeof input !== 'string') return false;\n  \n  const xssPatterns = [\n    /<script/gi,\n    /<iframe/gi,\n    /<object/gi,\n    /<embed/gi,\n    /javascript:/gi,\n    /on\\w+\\s*=/gi,\n    /<img[^>]+src[^>]*=.*javascript:/gi,\n    /<link[^>]+href[^>]*=.*javascript:/gi,\n  ];\n  \n  return xssPatterns.some(pattern => pattern.test(input));\n};\n\n/**\n * Validates input for security threats\n * @param {string} input - Input to validate\n * @returns {object} - { isSafe: boolean, threats: string[] }\n */\nexport const validateSecurity = (input) => {\n  if (!input || typeof input !== 'string') {\n    return { isSafe: true, threats: [] };\n  }\n  \n  const threats = [];\n  \n  if (containsSqlInjection(input)) {\n    threats.push('SQL_INJECTION');\n  }\n  \n  if (containsXss(input)) {\n    threats.push('XSS');\n  }\n  \n  return {\n    isSafe: threats.length === 0,\n    threats\n  };\n};\n\n/**\n * Sanitizes and validates input for security\n * @param {string} input - Input to sanitize and validate\n * @returns {object} - { sanitized: string, isSafe: boolean, threats: string[] }\n */\nexport const sanitizeAndValidate = (input) => {\n  const sanitized = sanitizeString(input);\n  const security = validateSecurity(sanitized);\n  \n  return {\n    sanitized,\n    ...security\n  };\n};\n\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}