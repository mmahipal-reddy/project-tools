{"ast":null,"code":"import _objectSpread from\"/Users/mmoola/Documents/GitHub/project-tools/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect,useRef,useCallback}from'react';import{useAuth}from'../context/AuthContext';import Sidebar from'../components/Sidebar';import useSidebarWidth from'../hooks/useSidebarWidth';import{Menu,LogOut,Search,X,Info,Plus,ChevronDown,ChevronUp,Trash2,Loader,Save,Copy,FolderOpen,Download,Upload,FileText}from'lucide-react';import apiClient from'../config/api';import toast from'react-hot-toast';import*as XLSX from'xlsx';import'../styles/CreateWorkStream.css';import'../styles/Sidebar.css';import'../styles/GlobalHeader.css';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const CreateWorkStream=_ref=>{let{hideHeader=false}=_ref;const{user,logout}=useAuth();const[sidebarOpen,setSidebarOpen]=useState(true);const sidebarWidth=useSidebarWidth(sidebarOpen);const[submitting,setSubmitting]=useState(false);const[showForm,setShowForm]=useState(false);// New state to control form visibility\n// Project Objectives without workstreams\nconst[projectObjectives,setProjectObjectives]=useState([]);const[allProjectObjectives,setAllProjectObjectives]=useState([]);// Store all fetched data for filtering\nconst[loadingPOs,setLoadingPOs]=useState(true);const[poOffset,setPoOffset]=useState(0);const[poHasMore,setPoHasMore]=useState(true);const[loadingMorePOs,setLoadingMorePOs]=useState(false);const infiniteScrollRef=useRef(null);const[statusFilter,setStatusFilter]=useState('');// Filter by status\n// Workstreams array - each workstream has its own form data\nconst[workstreams,setWorkstreams]=useState([{id:Date.now(),projectWorkstreamName:'',projectObjective:'',projectObjectiveId:'',refresh:false,deliveryToolName:'',clientWorkstreamIdentifier:'',functionality:''}]);// Track expanded/collapsed state for each workstream\nconst[expandedWorkstreams,setExpandedWorkstreams]=useState({[Date.now()]:true});// Templates state\nconst[savedTemplates,setSavedTemplates]=useState([]);const[showTemplateModal,setShowTemplateModal]=useState(false);const[templateName,setTemplateName]=useState('');const[showLoadTemplateModal,setShowLoadTemplateModal]=useState(false);const[showImportPreview,setShowImportPreview]=useState(false);const[importedWorkstreams,setImportedWorkstreams]=useState([]);const[importing,setImporting]=useState(false);const[resolvingObjectives,setResolvingObjectives]=useState(false);// Project Objective search - per workstream\nconst[projectObjectiveSearchTerms,setProjectObjectiveSearchTerms]=useState({});const[projectObjectiveSearchResults,setProjectObjectiveSearchResults]=useState({});const[loadingProjectObjectiveSearch,setLoadingProjectObjectiveSearch]=useState({});const[showProjectObjectiveDropdowns,setShowProjectObjectiveDropdowns]=useState({});const projectObjectiveSearchTimeoutRefs=useRef({});const recentSelectionsRef=useRef({});// Track recent selections to prevent search loop\n// Fetch project objectives without workstreams\nconst fetchProjectObjectives=useCallback(async function(){let offset=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;let append=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;try{if(offset===0){setLoadingPOs(true);}else{setLoadingMorePOs(true);}const response=await apiClient.get('/workstream/project-objectives-without-workstreams',{params:{limit:1000,offset},timeout:120000// 2 minutes to match backend timeout\n});if(response.data.success){const newPOs=response.data.projectObjectives;if(append){setAllProjectObjectives(prev=>[...prev,...newPOs]);}else{setAllProjectObjectives(newPOs);setPoOffset(0);// Reset offset when starting fresh\n}// Update offset and hasMore\nconst newOffset=append?poOffset+newPOs.length:newPOs.length;setPoOffset(newOffset);// If we got exactly 1000 records, assume there might be more\n// Also check the hasMore flag from backend\nconst hasMoreRecords=response.data.hasMore||newPOs.length===1000;setPoHasMore(hasMoreRecords);}}catch(error){var _error$response,_error$response$data;toast.error(((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.error)||'Failed to fetch project objectives');}finally{setLoadingPOs(false);setLoadingMorePOs(false);}},[]);// Load saved templates from localStorage\nuseEffect(()=>{try{const saved=localStorage.getItem('workstreamTemplates');if(saved){setSavedTemplates(JSON.parse(saved));}}catch(error){console.error('Error loading templates:',error);}},[]);// Initial load\nuseEffect(()=>{if(!showForm){fetchProjectObjectives(0,false);}},[showForm,fetchProjectObjectives]);// Infinite scroll for project objectives\nuseEffect(()=>{const observer=new IntersectionObserver(entries=>{if(entries[0].isIntersecting&&poHasMore&&!loadingMorePOs&&!showForm){fetchProjectObjectives(poOffset,true);}},{threshold:0.1});if(infiniteScrollRef.current){observer.observe(infiniteScrollRef.current);}return()=>{if(infiniteScrollRef.current){observer.unobserve(infiniteScrollRef.current);}};},[poHasMore,loadingMorePOs,poOffset,showForm,fetchProjectObjectives]);// Filter project objectives by status\nuseEffect(()=>{if(statusFilter===''){setProjectObjectives(allProjectObjectives);}else{setProjectObjectives(allProjectObjectives.filter(po=>po.status===statusFilter));}},[statusFilter,allProjectObjectives]);// Get unique status values for filter dropdown (exclude '--' and empty values)\nconst uniqueStatuses=Array.from(new Set(allProjectObjectives.map(po=>po.status).filter(s=>s&&s!=='--'))).sort();// Delivery Tool Name picklist (excluding QF as per original requirement)\nconst deliveryToolNameOptions=['--None--','A9','ADAP','Ampersand','Appen Collect','AppenLex','Baseline','EWOQ','Exotel','Other','Polyglot','SRT','TryRating','UHRS','Test','Test Tool'];// Functionality picklist values\nconst functionalityOptions=['--None--','System Access','System Access & Productivity','Productivity'];// Close search results when clicking outside\nuseEffect(()=>{const handleClickOutside=event=>{Object.keys(showProjectObjectiveDropdowns).forEach(workstreamId=>{if(showProjectObjectiveDropdowns[workstreamId]&&!event.target.closest(\".project-objective-search-container-\".concat(workstreamId))){setShowProjectObjectiveDropdowns(prev=>_objectSpread(_objectSpread({},prev),{},{[workstreamId]:false}));}});};document.addEventListener('mousedown',handleClickOutside);return()=>{document.removeEventListener('mousedown',handleClickOutside);};},[showProjectObjectiveDropdowns]);// Search Project Objectives when search term changes (per workstream)\nuseEffect(()=>{Object.keys(projectObjectiveSearchTerms).forEach(workstreamId=>{const searchTerm=projectObjectiveSearchTerms[workstreamId];const workstream=workstreams.find(w=>w.id===workstreamId);// Clear any existing timeout\nif(projectObjectiveSearchTimeoutRefs.current[workstreamId]){clearTimeout(projectObjectiveSearchTimeoutRefs.current[workstreamId]);delete projectObjectiveSearchTimeoutRefs.current[workstreamId];}// IMPORTANT: Don't search if an objective is already selected\n// This prevents the search loop when user selects an objective\nif(workstream&&workstream.projectObjectiveId){setProjectObjectiveSearchResults(prev=>_objectSpread(_objectSpread({},prev),{},{[workstreamId]:[]}));setShowProjectObjectiveDropdowns(prev=>_objectSpread(_objectSpread({},prev),{},{[workstreamId]:false}));setLoadingProjectObjectiveSearch(prev=>_objectSpread(_objectSpread({},prev),{},{[workstreamId]:false}));return;}// Don't search if search term is empty\nif(!searchTerm||searchTerm.trim()===''){setProjectObjectiveSearchResults(prev=>_objectSpread(_objectSpread({},prev),{},{[workstreamId]:[]}));setShowProjectObjectiveDropdowns(prev=>_objectSpread(_objectSpread({},prev),{},{[workstreamId]:false}));setLoadingProjectObjectiveSearch(prev=>_objectSpread(_objectSpread({},prev),{},{[workstreamId]:false}));return;}// Check if this is a recent selection (within last 2 seconds)\nconst recentSelection=recentSelectionsRef.current[workstreamId];if(recentSelection){const timeSinceSelection=Date.now()-recentSelection.timestamp;if(timeSinceSelection<2000){// This is a recent selection, don't search\nsetProjectObjectiveSearchResults(prev=>_objectSpread(_objectSpread({},prev),{},{[workstreamId]:[]}));setShowProjectObjectiveDropdowns(prev=>_objectSpread(_objectSpread({},prev),{},{[workstreamId]:false}));setLoadingProjectObjectiveSearch(prev=>_objectSpread(_objectSpread({},prev),{},{[workstreamId]:false}));return;}}// Only search if user is actively typing (not just matching selected value)\nprojectObjectiveSearchTimeoutRefs.current[workstreamId]=setTimeout(async()=>{// Get fresh search term and workstream\nconst currentSearchTerm=projectObjectiveSearchTerms[workstreamId];if(!currentSearchTerm||currentSearchTerm.trim()===''){return;}// CRITICAL: Re-check if objective was selected during timeout - if so, abort search\nconst currentWorkstream=workstreams.find(w=>w.id===workstreamId);if(currentWorkstream&&currentWorkstream.projectObjectiveId){// An objective was selected, don't search\nsetProjectObjectiveSearchResults(prev=>_objectSpread(_objectSpread({},prev),{},{[workstreamId]:[]}));setShowProjectObjectiveDropdowns(prev=>_objectSpread(_objectSpread({},prev),{},{[workstreamId]:false}));setLoadingProjectObjectiveSearch(prev=>_objectSpread(_objectSpread({},prev),{},{[workstreamId]:false}));return;}// Check again if this is a recent selection\nconst currentRecentSelection=recentSelectionsRef.current[workstreamId];if(currentRecentSelection){const timeSinceSelection=Date.now()-currentRecentSelection.timestamp;if(timeSinceSelection<2000){// This is a recent selection, don't search\nsetProjectObjectiveSearchResults(prev=>_objectSpread(_objectSpread({},prev),{},{[workstreamId]:[]}));setShowProjectObjectiveDropdowns(prev=>_objectSpread(_objectSpread({},prev),{},{[workstreamId]:false}));setLoadingProjectObjectiveSearch(prev=>_objectSpread(_objectSpread({},prev),{},{[workstreamId]:false}));return;}}setLoadingProjectObjectiveSearch(prev=>_objectSpread(_objectSpread({},prev),{},{[workstreamId]:true}));try{const response=await apiClient.get(\"/workstream/search-project-objectives?search=\".concat(encodeURIComponent(currentSearchTerm)));if(response.data.success){// CRITICAL: Final check before showing results - make sure objective wasn't selected during API call\nconst finalWorkstream=workstreams.find(w=>w.id===workstreamId);if(finalWorkstream&&finalWorkstream.projectObjectiveId){// An objective was selected during the API call, don't show results\nsetProjectObjectiveSearchResults(prev=>_objectSpread(_objectSpread({},prev),{},{[workstreamId]:[]}));setShowProjectObjectiveDropdowns(prev=>_objectSpread(_objectSpread({},prev),{},{[workstreamId]:false}));setLoadingProjectObjectiveSearch(prev=>_objectSpread(_objectSpread({},prev),{},{[workstreamId]:false}));return;}// Check for recent selection\nconst finalRecentSelection=recentSelectionsRef.current[workstreamId];if(finalRecentSelection){const timeSinceSelection=Date.now()-finalRecentSelection.timestamp;if(timeSinceSelection<2000){// Objective was just selected, don't show results\nsetProjectObjectiveSearchResults(prev=>_objectSpread(_objectSpread({},prev),{},{[workstreamId]:[]}));setShowProjectObjectiveDropdowns(prev=>_objectSpread(_objectSpread({},prev),{},{[workstreamId]:false}));setLoadingProjectObjectiveSearch(prev=>_objectSpread(_objectSpread({},prev),{},{[workstreamId]:false}));return;}}// All checks passed, show results\nsetProjectObjectiveSearchResults(prev=>_objectSpread(_objectSpread({},prev),{},{[workstreamId]:response.data.projectObjectives||[]}));setShowProjectObjectiveDropdowns(prev=>_objectSpread(_objectSpread({},prev),{},{[workstreamId]:true}));}}catch(error){setProjectObjectiveSearchResults(prev=>_objectSpread(_objectSpread({},prev),{},{[workstreamId]:[]}));}finally{setLoadingProjectObjectiveSearch(prev=>_objectSpread(_objectSpread({},prev),{},{[workstreamId]:false}));}},300);});return()=>{Object.keys(projectObjectiveSearchTimeoutRefs.current).forEach(workstreamId=>{if(projectObjectiveSearchTimeoutRefs.current[workstreamId]){clearTimeout(projectObjectiveSearchTimeoutRefs.current[workstreamId]);delete projectObjectiveSearchTimeoutRefs.current[workstreamId];}});};},[projectObjectiveSearchTerms,workstreams]);const handleProjectObjectiveSelect=(workstreamId,objective)=>{const selectedName=objective.contributorFacingProjectName||objective.name;// Clear any pending search timeout immediately\nif(projectObjectiveSearchTimeoutRefs.current[workstreamId]){clearTimeout(projectObjectiveSearchTimeoutRefs.current[workstreamId]);delete projectObjectiveSearchTimeoutRefs.current[workstreamId];}// Mark this as a recent selection to prevent search loop\nrecentSelectionsRef.current[workstreamId]={name:selectedName,timestamp:Date.now()};// Update workstream with selected objective\nsetWorkstreams(prev=>prev.map(ws=>ws.id===workstreamId?_objectSpread(_objectSpread({},ws),{},{projectObjective:selectedName,projectObjectiveId:objective.id}):ws));// Clear search term instead of setting it to selected name - this prevents re-triggering search\nsetProjectObjectiveSearchTerms(prev=>_objectSpread(_objectSpread({},prev),{},{[workstreamId]:''}));// Immediately close dropdown and clear results\nsetShowProjectObjectiveDropdowns(prev=>_objectSpread(_objectSpread({},prev),{},{[workstreamId]:false}));setProjectObjectiveSearchResults(prev=>_objectSpread(_objectSpread({},prev),{},{[workstreamId]:[]}));setLoadingProjectObjectiveSearch(prev=>_objectSpread(_objectSpread({},prev),{},{[workstreamId]:false}));// Clear the recent selection flag after a delay\nsetTimeout(()=>{if(recentSelectionsRef.current[workstreamId]){delete recentSelectionsRef.current[workstreamId];}},2000);};const handleClearProjectObjective=workstreamId=>{setWorkstreams(prev=>prev.map(ws=>ws.id===workstreamId?_objectSpread(_objectSpread({},ws),{},{projectObjective:'',projectObjectiveId:''}):ws));setProjectObjectiveSearchTerms(prev=>_objectSpread(_objectSpread({},prev),{},{[workstreamId]:''}));setProjectObjectiveSearchResults(prev=>_objectSpread(_objectSpread({},prev),{},{[workstreamId]:[]}));setShowProjectObjectiveDropdowns(prev=>_objectSpread(_objectSpread({},prev),{},{[workstreamId]:false}));};const handleInputChange=(workstreamId,field,value)=>{setWorkstreams(prev=>prev.map(ws=>ws.id===workstreamId?_objectSpread(_objectSpread({},ws),{},{[field]:value}):ws));};const handleSearchTermChange=(workstreamId,value)=>{setProjectObjectiveSearchTerms(prev=>_objectSpread(_objectSpread({},prev),{},{[workstreamId]:value}));if(value===''){handleClearProjectObjective(workstreamId);}};const toggleWorkstreamExpanded=workstreamId=>{setExpandedWorkstreams(prev=>_objectSpread(_objectSpread({},prev),{},{[workstreamId]:!prev[workstreamId]}));};const addWorkstream=()=>{const newId=Date.now();setWorkstreams(prev=>[...prev,{id:newId,projectWorkstreamName:'',projectObjective:'',projectObjectiveId:'',refresh:false,deliveryToolName:'',clientWorkstreamIdentifier:'',functionality:''}]);setExpandedWorkstreams(prev=>_objectSpread(_objectSpread({},prev),{},{[newId]:true}));setProjectObjectiveSearchTerms(prev=>_objectSpread(_objectSpread({},prev),{},{[newId]:''}));};const removeWorkstream=workstreamId=>{if(workstreams.length===1){toast.error('At least one workstream is required');return;}setWorkstreams(prev=>prev.filter(ws=>ws.id!==workstreamId));setExpandedWorkstreams(prev=>{const newState=_objectSpread({},prev);delete newState[workstreamId];return newState;});setProjectObjectiveSearchTerms(prev=>{const newState=_objectSpread({},prev);delete newState[workstreamId];return newState;});setProjectObjectiveSearchResults(prev=>{const newState=_objectSpread({},prev);delete newState[workstreamId];return newState;});setShowProjectObjectiveDropdowns(prev=>{const newState=_objectSpread({},prev);delete newState[workstreamId];return newState;});if(projectObjectiveSearchTimeoutRefs.current[workstreamId]){clearTimeout(projectObjectiveSearchTimeoutRefs.current[workstreamId]);delete projectObjectiveSearchTimeoutRefs.current[workstreamId];}};const validateWorkstream=workstream=>{// Project Objective is required (either ID or name)\nif(!workstream.projectObjectiveId&&(!workstream.projectObjective||workstream.projectObjective.trim()==='')){return'Project Objective is required';}if(!workstream.deliveryToolName||workstream.deliveryToolName==='--None--'||workstream.deliveryToolName.trim()===''){return'Delivery Tool Name is required';}if(!workstream.clientWorkstreamIdentifier||workstream.clientWorkstreamIdentifier.trim()===''){return'Client Workstream Identifier is required';}if(!workstream.functionality||workstream.functionality==='--None--'||workstream.functionality.trim()===''){return'Functionality is required';}return null;};const handleSubmit=async e=>{e.preventDefault();// Validate all workstreams\nconst validationErrors=[];workstreams.forEach((workstream,index)=>{const error=validateWorkstream(workstream);if(error){validationErrors.push(\"Workstream \".concat(index+1,\": \").concat(error));}});if(validationErrors.length>0){toast.error(validationErrors[0]);return;}setSubmitting(true);try{// Create all workstreams - each under its respective project objective\nconst createPromises=workstreams.map(workstream=>apiClient.post('/workstream/create',{projectWorkstreamName:workstream.projectWorkstreamName,projectObjective:workstream.projectObjective,projectObjectiveId:workstream.projectObjectiveId,refresh:workstream.refresh,deliveryToolName:workstream.deliveryToolName,clientWorkstreamIdentifier:workstream.clientWorkstreamIdentifier,functionality:workstream.functionality}));const results=await Promise.all(createPromises);const successCount=results.filter(r=>r.data.success).length;if(successCount===workstreams.length){toast.success(\"Successfully created \".concat(successCount,\" workstream(s)\"));// Reset all workstreams and hide form\nconst newId=Date.now();setWorkstreams([{id:newId,projectWorkstreamName:'',projectObjective:'',projectObjectiveId:'',refresh:false,deliveryToolName:'',clientWorkstreamIdentifier:'',functionality:''}]);setExpandedWorkstreams({[newId]:true});setProjectObjectiveSearchTerms({[newId]:''});setProjectObjectiveSearchResults({});setShowProjectObjectiveDropdowns({});setShowForm(false);// Reload project objectives list\nfetchProjectObjectives(0,false);}else{toast.error(\"Created \".concat(successCount,\" of \").concat(workstreams.length,\" workstream(s)\"));}}catch(error){var _error$response2,_error$response2$data;const errorMessage=((_error$response2=error.response)===null||_error$response2===void 0?void 0:(_error$response2$data=_error$response2.data)===null||_error$response2$data===void 0?void 0:_error$response2$data.error)||error.message||'Failed to create workstream(s)';toast.error(errorMessage);}finally{setSubmitting(false);}};const handleCancel=()=>{// Reset all workstreams and hide form\nconst newId=Date.now();setWorkstreams([{id:newId,projectWorkstreamName:'',projectObjective:'',projectObjectiveId:'',refresh:false,deliveryToolName:'',clientWorkstreamIdentifier:'',functionality:''}]);setExpandedWorkstreams({[newId]:true});setProjectObjectiveSearchTerms({[newId]:''});setProjectObjectiveSearchResults({});setShowProjectObjectiveDropdowns({});setShowForm(false);// Reload project objectives list\nfetchProjectObjectives(0,false);};const handleAddWorkstream=()=>{setShowForm(true);};// Save current workstreams as template\nconst handleSaveTemplate=()=>{if(workstreams.length===0){toast.error('No workstreams to save as template');return;}setShowTemplateModal(true);};const confirmSaveTemplate=()=>{if(!templateName.trim()){toast.error('Please enter a template name');return;}try{const template={id:Date.now(),name:templateName.trim(),createdAt:new Date().toISOString(),workstreams:workstreams.map(ws=>({projectWorkstreamName:ws.projectWorkstreamName,projectObjective:ws.projectObjective,projectObjectiveId:ws.projectObjectiveId,refresh:ws.refresh,deliveryToolName:ws.deliveryToolName,clientWorkstreamIdentifier:ws.clientWorkstreamIdentifier,functionality:ws.functionality}))};const updatedTemplates=[...savedTemplates,template];setSavedTemplates(updatedTemplates);localStorage.setItem('workstreamTemplates',JSON.stringify(updatedTemplates));toast.success('Template saved successfully');setShowTemplateModal(false);setTemplateName('');}catch(error){console.error('Error saving template:',error);toast.error('Failed to save template');}};// Load template\nconst handleLoadTemplate=template=>{try{const newWorkstreams=template.workstreams.map((ws,index)=>_objectSpread({id:Date.now()+index},ws));setWorkstreams(newWorkstreams);setExpandedWorkstreams(newWorkstreams.reduce((acc,ws)=>{acc[ws.id]=true;return acc;},{}));setShowLoadTemplateModal(false);toast.success(\"Template \\\"\".concat(template.name,\"\\\" loaded successfully\"));}catch(error){console.error('Error loading template:',error);toast.error('Failed to load template');}};// Delete template\nconst handleDeleteTemplate=templateId=>{try{const updatedTemplates=savedTemplates.filter(t=>t.id!==templateId);setSavedTemplates(updatedTemplates);localStorage.setItem('workstreamTemplates',JSON.stringify(updatedTemplates));toast.success('Template deleted successfully');}catch(error){console.error('Error deleting template:',error);toast.error('Failed to delete template');}};// Clone workstream\nconst handleCloneWorkstream=workstreamId=>{const workstreamToClone=workstreams.find(ws=>ws.id===workstreamId);if(!workstreamToClone)return;const clonedWorkstream=_objectSpread(_objectSpread({},workstreamToClone),{},{id:Date.now(),projectWorkstreamName:\"\".concat(workstreamToClone.projectWorkstreamName,\" (Copy)\"),projectObjective:'',projectObjectiveId:''});setWorkstreams(prev=>[...prev,clonedWorkstream]);setExpandedWorkstreams(prev=>_objectSpread(_objectSpread({},prev),{},{[clonedWorkstream.id]:true}));toast.success('Workstream cloned successfully');};// Download template for workstream creation\nconst handleDownloadTemplate=()=>{try{const templateData=[{'Project Workstream Name':'Example Workstream 1','Project Objective Name':'Example Project Objective','Project Objective ID':'','Delivery Tool Name':'Tool1','Client Workstream Identifier':'WS-001','Functionality':'Functionality1','Refresh':false},{'Project Workstream Name':'Example Workstream 2','Project Objective Name':'Example Project Objective 2','Project Objective ID':'','Delivery Tool Name':'Tool2','Client Workstream Identifier':'WS-002','Functionality':'Functionality2','Refresh':false}];const ws=XLSX.utils.json_to_sheet(templateData);const wb=XLSX.utils.book_new();XLSX.utils.book_append_sheet(wb,ws,'Workstream Template');XLSX.writeFile(wb,\"Workstream_Creation_Template_\".concat(new Date().toISOString().split('T')[0],\".xlsx\"));toast.success('Template downloaded successfully');}catch(error){console.error('Error downloading template:',error);toast.error('Failed to download template');}};// Handle template file import\nconst handleImportTemplate=async event=>{const file=event.target.files[0];if(!file)return;const reader=new FileReader();reader.onload=async e=>{try{const data=new Uint8Array(e.target.result);const workbook=XLSX.read(data,{type:'array'});const firstSheetName=workbook.SheetNames[0];const worksheet=workbook.Sheets[firstSheetName];const jsonData=XLSX.utils.sheet_to_json(worksheet);if(jsonData.length===0){toast.error('Template file is empty');return;}// Map imported data to workstream format\nlet imported=jsonData.map((row,index)=>({id:Date.now()+index,projectWorkstreamName:row['Project Workstream Name']||row['projectWorkstreamName']||'',projectObjective:row['Project Objective Name']||row['projectObjective']||row['Project Objective']||'',projectObjectiveId:row['Project Objective ID']||row['projectObjectiveId']||'',deliveryToolName:row['Delivery Tool Name']||row['deliveryToolName']||'',clientWorkstreamIdentifier:row['Client Workstream Identifier']||row['clientWorkstreamIdentifier']||'',functionality:row['Functionality']||row['functionality']||'',refresh:row['Refresh']||row['refresh']||false}));// Resolve Project Objective names to IDs if ID is not provided\nconst unresolvedObjectives=imported.filter(ws=>ws.projectObjective&&!ws.projectObjectiveId);if(unresolvedObjectives.length>0){setResolvingObjectives(true);toast('Resolving project objective names to IDs...',{icon:'⏳',duration:2000});// Resolve each project objective name to ID\nfor(const ws of unresolvedObjectives){try{const searchTerm=ws.projectObjective.trim();if(searchTerm){const response=await apiClient.get(\"/workstream/search-project-objectives?search=\".concat(encodeURIComponent(searchTerm)));if(response.data.success&&response.data.projectObjectives&&response.data.projectObjectives.length>0){// Try to find exact match first\nlet matched=response.data.projectObjectives.find(po=>po.name===searchTerm||po.contributorFacingProjectName===searchTerm||po.name&&po.name.toLowerCase()===searchTerm.toLowerCase()||po.contributorFacingProjectName&&po.contributorFacingProjectName.toLowerCase()===searchTerm.toLowerCase());// If no exact match, use the first result\nif(!matched){matched=response.data.projectObjectives[0];}if(matched){ws.projectObjectiveId=matched.id;ws.projectObjective=matched.contributorFacingProjectName||matched.name||ws.projectObjective;}}}}catch(error){console.error(\"Error resolving project objective for \\\"\".concat(ws.projectObjective,\"\\\":\"),error);// Continue with other workstreams even if one fails\n}}setResolvingObjectives(false);}setImportedWorkstreams(imported);setShowImportPreview(true);const resolvedCount=unresolvedObjectives.length>0?unresolvedObjectives.filter(ws=>ws.projectObjectiveId).length:0;if(unresolvedObjectives.length>0){toast.success(\"Imported \".concat(imported.length,\" workstream(s). Resolved \").concat(resolvedCount,\" of \").concat(unresolvedObjectives.length,\" project objective(s).\"));}else{toast.success(\"Imported \".concat(imported.length,\" workstream(s) from template\"));}}catch(error){console.error('Error importing template:',error);toast.error('Failed to import template. Please check the file format.');}};reader.readAsArrayBuffer(file);// Reset file input\nevent.target.value='';};// Create workstreams from imported template\nconst handleCreateFromImport=async()=>{if(importedWorkstreams.length===0){toast.error('No workstreams to create');return;}// Resolve any remaining unresolved project objectives\nconst unresolved=importedWorkstreams.filter(ws=>ws.projectObjective&&!ws.projectObjectiveId);if(unresolved.length>0){toast('Resolving remaining project objectives...',{icon:'⏳'});for(const ws of unresolved){try{const searchTerm=ws.projectObjective.trim();if(searchTerm){const response=await apiClient.get(\"/workstream/search-project-objectives?search=\".concat(encodeURIComponent(searchTerm)));if(response.data.success&&response.data.projectObjectives&&response.data.projectObjectives.length>0){// Try to find exact match first\nlet matched=response.data.projectObjectives.find(po=>po.name===searchTerm||po.contributorFacingProjectName===searchTerm||po.name&&po.name.toLowerCase()===searchTerm.toLowerCase()||po.contributorFacingProjectName&&po.contributorFacingProjectName.toLowerCase()===searchTerm.toLowerCase());// If no exact match, use the first result\nif(!matched){matched=response.data.projectObjectives[0];}if(matched){ws.projectObjectiveId=matched.id;ws.projectObjective=matched.contributorFacingProjectName||matched.name||ws.projectObjective;}}}}catch(error){console.error(\"Error resolving project objective for \\\"\".concat(ws.projectObjective,\"\\\":\"),error);}}// Update the imported workstreams state with resolved IDs\nsetImportedWorkstreams([...importedWorkstreams]);}// Validate all imported workstreams\nconst validationErrors=[];importedWorkstreams.forEach((workstream,index)=>{const error=validateWorkstream(workstream);if(error){validationErrors.push(\"Row \".concat(index+1,\": \").concat(error));}});if(validationErrors.length>0){toast.error(validationErrors[0]);return;}setImporting(true);try{// Create all workstreams\nconst createPromises=importedWorkstreams.map(workstream=>apiClient.post('/workstream/create',{projectWorkstreamName:workstream.projectWorkstreamName,projectObjective:workstream.projectObjective,projectObjectiveId:workstream.projectObjectiveId,refresh:workstream.refresh,deliveryToolName:workstream.deliveryToolName,clientWorkstreamIdentifier:workstream.clientWorkstreamIdentifier,functionality:workstream.functionality}));const results=await Promise.all(createPromises);const successCount=results.filter(r=>r.data.success).length;if(successCount===importedWorkstreams.length){toast.success(\"Successfully created \".concat(successCount,\" workstream(s) from template\"));setShowImportPreview(false);setImportedWorkstreams([]);// Reload project objectives list\nfetchProjectObjectives(0,false);}else{toast.error(\"Created \".concat(successCount,\" of \").concat(importedWorkstreams.length,\" workstream(s)\"));}}catch(error){var _error$response3,_error$response3$data;const errorMessage=((_error$response3=error.response)===null||_error$response3===void 0?void 0:(_error$response3$data=_error$response3.data)===null||_error$response3$data===void 0?void 0:_error$response3$data.error)||error.message||'Failed to create workstream(s)';toast.error(errorMessage);}finally{setImporting(false);}};const renderWorkstreamForm=(workstream,index)=>{const isExpanded=expandedWorkstreams[workstream.id]!==false;const searchTerm=projectObjectiveSearchTerms[workstream.id]||'';const searchResults=projectObjectiveSearchResults[workstream.id]||[];const loadingSearch=loadingProjectObjectiveSearch[workstream.id]||false;const showDropdown=showProjectObjectiveDropdowns[workstream.id]||false;return/*#__PURE__*/_jsxs(\"div\",{className:\"workstream-form-card\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"create-workstream-header-section\",onClick:()=>toggleWorkstreamExpanded(workstream.id),children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"create-workstream-toggle\",onClick:e=>{e.stopPropagation();toggleWorkstreamExpanded(workstream.id);},children:isExpanded?/*#__PURE__*/_jsx(ChevronUp,{size:18}):/*#__PURE__*/_jsx(ChevronDown,{size:18})}),/*#__PURE__*/_jsxs(\"span\",{className:\"create-workstream-title-text\",children:[\"WorkStream \",index+1,workstream.projectObjective?\" - \".concat(workstream.projectObjective):'']}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'8px',alignItems:'center'},children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"create-workstream-remove\",onClick:e=>{e.stopPropagation();handleCloneWorkstream(workstream.id);},title:\"Clone workstream\",style:{background:'transparent',border:'none',cursor:'pointer',padding:'4px',display:'flex',alignItems:'center'},children:/*#__PURE__*/_jsx(Copy,{size:16,style:{color:'#0176d3'}})}),workstreams.length>1&&/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"create-workstream-remove\",onClick:e=>{e.stopPropagation();removeWorkstream(workstream.id);},title:\"Remove workstream\",children:/*#__PURE__*/_jsx(Trash2,{size:16})})]})]}),isExpanded&&/*#__PURE__*/_jsx(\"div\",{className:\"workstream-form-content\",children:/*#__PURE__*/_jsx(\"div\",{className:\"form-section-card\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"form-grid-two-column\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-column\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Project Workstream Name\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:workstream.projectWorkstreamName,onChange:e=>handleInputChange(workstream.id,'projectWorkstreamName',e.target.value),className:\"form-input-compact\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsxs(\"label\",{children:[\"Project Objective \",/*#__PURE__*/_jsx(\"span\",{className:\"required\",children:\"*\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"project-objective-search-container project-objective-search-container-\".concat(workstream.id),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"search-input-wrapper\",children:[/*#__PURE__*/_jsx(Search,{size:14,className:\"search-icon\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Search for project objective...\",value:workstream.projectObjectiveId?workstream.projectObjective:searchTerm,readOnly:!!workstream.projectObjectiveId,onChange:e=>{// Only allow changes if no objective is selected\nif(!workstream.projectObjectiveId){handleSearchTermChange(workstream.id,e.target.value);}},onFocus:()=>{// If there's a selection, allow clearing it\nif(workstream.projectObjectiveId){// User can click X button to clear\n}else if(searchResults.length>0){setShowProjectObjectiveDropdowns(prev=>_objectSpread(_objectSpread({},prev),{},{[workstream.id]:true}));}},onClick:()=>{// If there's a selection and user clicks, don't clear automatically\n// They need to use the X button\nif(!workstream.projectObjectiveId&&searchResults.length>0){setShowProjectObjectiveDropdowns(prev=>_objectSpread(_objectSpread({},prev),{},{[workstream.id]:true}));}},className:\"form-input-compact search-input\",style:workstream.projectObjectiveId?{cursor:'default'}:{}}),workstream.projectObjectiveId&&/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>handleClearProjectObjective(workstream.id),className:\"clear-button\",title:\"Clear selection\",children:/*#__PURE__*/_jsx(X,{size:14})})]}),loadingSearch&&/*#__PURE__*/_jsx(\"div\",{className:\"searching-indicator\",children:\"Searching...\"}),showDropdown&&searchResults.length>0&&!workstream.projectObjectiveId&&/*#__PURE__*/_jsx(\"div\",{className:\"search-results-dropdown\",children:searchResults.map(objective=>/*#__PURE__*/_jsxs(\"div\",{onClick:()=>handleProjectObjectiveSelect(workstream.id,objective),className:\"search-result-item \".concat(workstream.projectObjectiveId===objective.id?'selected':''),children:[/*#__PURE__*/_jsx(\"div\",{className:\"search-result-name\",children:objective.contributorFacingProjectName||objective.name}),objective.projectName&&/*#__PURE__*/_jsxs(\"div\",{className:\"search-result-subtitle\",children:[\"Project: \",objective.projectName]})]},objective.id))})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"form-group\",style:{marginTop:'6px'},children:/*#__PURE__*/_jsxs(\"label\",{className:\"checkbox-label\",style:{marginBottom:0},children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:workstream.refresh,onChange:e=>handleInputChange(workstream.id,'refresh',e.target.checked),className:\"checkbox-input\",style:{marginRight:'8px',marginTop:'0',verticalAlign:'middle'}}),/*#__PURE__*/_jsx(\"span\",{className:\"checkbox-text\",style:{verticalAlign:'middle'},children:\"Refresh\"}),/*#__PURE__*/_jsx(Info,{size:12,className:\"info-icon\",style:{marginLeft:'6px',verticalAlign:'middle'}})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-column\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsxs(\"label\",{children:[\"Delivery Tool Name \",/*#__PURE__*/_jsx(\"span\",{className:\"required\",children:\"*\"})]}),/*#__PURE__*/_jsxs(\"select\",{value:workstream.deliveryToolName,onChange:e=>handleInputChange(workstream.id,'deliveryToolName',e.target.value),className:\"form-input-compact\",required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"--None--\"}),deliveryToolNameOptions.filter(opt=>opt!=='--None--').map(option=>/*#__PURE__*/_jsx(\"option\",{value:option,children:option},option))]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsxs(\"label\",{children:[\"Client Workstream Identifier \",/*#__PURE__*/_jsx(\"span\",{className:\"required\",children:\"*\"}),/*#__PURE__*/_jsx(Info,{size:12,className:\"info-icon\"})]}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:workstream.clientWorkstreamIdentifier,onChange:e=>handleInputChange(workstream.id,'clientWorkstreamIdentifier',e.target.value),className:\"form-input-compact\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsxs(\"label\",{children:[\"Functionality \",/*#__PURE__*/_jsx(\"span\",{className:\"required\",children:\"*\"}),/*#__PURE__*/_jsx(Info,{size:12,className:\"info-icon\"})]}),/*#__PURE__*/_jsxs(\"select\",{value:workstream.functionality,onChange:e=>handleInputChange(workstream.id,'functionality',e.target.value),className:\"form-input-compact\",required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"--None--\"}),functionalityOptions.filter(opt=>opt!=='--None--').map(option=>/*#__PURE__*/_jsx(\"option\",{value:option,children:option},option))]})]})]})]})})})]},workstream.id);};const content=/*#__PURE__*/_jsxs(\"div\",{className:\"create-workstream-content\",children:[!showForm?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:'12px',marginTop:'8px',paddingTop:'8px',flexWrap:'wrap',gap:'12px'},children:[/*#__PURE__*/_jsx(\"h2\",{style:{margin:'0 0 8px 0',fontSize:'18px',fontWeight:600,color:'#002329'},children:\"Project Objectives Without Workstreams\"}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'8px',alignItems:'center',flexWrap:'wrap'},children:[/*#__PURE__*/_jsxs(\"button\",{type:\"button\",className:\"btn-secondary\",onClick:handleDownloadTemplate,style:{display:'flex',alignItems:'center',gap:'6px'},title:\"Download template for workstream creation\",children:[/*#__PURE__*/_jsx(FileText,{size:16}),\"Download Template\"]}),/*#__PURE__*/_jsxs(\"label\",{className:\"btn-secondary\",style:{display:'flex',alignItems:'center',gap:'6px',cursor:'pointer',margin:0},title:\"Import template file\",children:[/*#__PURE__*/_jsx(Upload,{size:16}),\"Import Template\",/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\".xlsx,.xls\",onChange:handleImportTemplate,style:{display:'none'}})]}),/*#__PURE__*/_jsxs(\"button\",{type:\"button\",className:\"btn-primary\",onClick:handleAddWorkstream,style:{display:'flex',alignItems:'center',gap:'8px'},children:[/*#__PURE__*/_jsx(Plus,{size:16}),\"Add Workstream\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'12px',alignItems:'center',marginBottom:'16px'},children:[/*#__PURE__*/_jsx(\"label\",{style:{fontSize:'14px',fontWeight:500,color:'#002329'},children:\"Filter by Status:\"}),/*#__PURE__*/_jsxs(\"select\",{value:statusFilter,onChange:e=>setStatusFilter(e.target.value),style:{fontSize:'14px',padding:'8px 12px',border:'1px solid var(--border-color)',borderRadius:'var(--radius-md)',background:'var(--surface)',color:'var(--text-primary)',minWidth:'180px',cursor:'pointer',fontFamily:'Poppins'},children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"All Status\"}),uniqueStatuses.map(status=>/*#__PURE__*/_jsx(\"option\",{value:status,children:status},status))]}),statusFilter&&/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>setStatusFilter(''),style:{fontSize:'13px',padding:'6px 12px',background:'transparent',border:'1px solid var(--border-color)',borderRadius:'var(--radius-md)',color:'var(--text-secondary)',cursor:'pointer',fontFamily:'Poppins'},children:\"Clear Filter\"})]}),loadingPOs&&allProjectObjectives.length===0?/*#__PURE__*/_jsxs(\"div\",{style:{textAlign:'center',padding:'40px'},children:[/*#__PURE__*/_jsx(Loader,{className:\"spinning\",size:24}),/*#__PURE__*/_jsx(\"p\",{children:\"Loading project objectives...\"})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"project-objectives-table-container\",style:{maxHeight:'70vh',overflowY:'auto'},children:[/*#__PURE__*/_jsxs(\"table\",{className:\"project-objectives-table\",style:{width:'100%'},children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Project Objective\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Associated Project\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Project Objective Status\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:projectObjectives.length===0?/*#__PURE__*/_jsx(\"tr\",{children:/*#__PURE__*/_jsx(\"td\",{colSpan:\"3\",className:\"no-data\",style:{textAlign:'center',padding:'40px'},children:\"No project objectives without workstreams found\"})}):projectObjectives.map((po,index)=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:po.name||'--'}),/*#__PURE__*/_jsx(\"td\",{children:po.projectName||'--'}),/*#__PURE__*/_jsx(\"td\",{children:po.status||'--'})]},po.id||index))})]}),(poHasMore||allProjectObjectives.length>=1000)&&!loadingMorePOs&&allProjectObjectives.length>0&&!loadingPOs&&/*#__PURE__*/_jsxs(\"div\",{style:{textAlign:'center',padding:'20px',borderTop:'1px solid var(--border-color)'},children:[/*#__PURE__*/_jsxs(\"button\",{type:\"button\",className:\"btn-secondary\",onClick:()=>fetchProjectObjectives(poOffset,true),style:{display:'inline-flex',alignItems:'center',gap:'8px',padding:'10px 24px',fontSize:'14px',fontWeight:600},children:[/*#__PURE__*/_jsx(Plus,{size:16}),\"Show More (\",allProjectObjectives.length,\" loaded\",poHasMore?', more available':'',\")\"]}),/*#__PURE__*/_jsx(\"div\",{style:{marginTop:'8px',fontSize:'12px',color:'#666'},children:\"Click to load next 1000 project objectives\"})]}),loadingMorePOs&&/*#__PURE__*/_jsxs(\"div\",{style:{textAlign:'center',padding:'20px',borderTop:'1px solid var(--border-color)'},children:[/*#__PURE__*/_jsx(Loader,{className:\"spinning\",size:16}),/*#__PURE__*/_jsx(\"span\",{style:{marginLeft:'8px'},children:\"Loading more project objectives...\"})]}),poHasMore&&!loadingMorePOs&&/*#__PURE__*/_jsx(\"div\",{ref:infiniteScrollRef,style:{height:'20px',width:'100%'}}),allProjectObjectives.length>0&&!poHasMore&&/*#__PURE__*/_jsx(\"div\",{style:{textAlign:'center',padding:'16px',borderTop:'1px solid var(--border-color)',color:'#666',fontSize:'13px'},children:statusFilter?/*#__PURE__*/_jsxs(_Fragment,{children:[\"Showing \",projectObjectives.length,\" of \",allProjectObjectives.length,\" project objectives (filtered by status: \",statusFilter,\")\"]}):/*#__PURE__*/_jsxs(_Fragment,{children:[\"All \",allProjectObjectives.length,\" project objectives loaded\"]})})]})]}):/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"create-workstream-form\",children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:'16px'},children:[/*#__PURE__*/_jsx(\"h2\",{style:{margin:0,fontSize:'18px',fontWeight:600,color:'#002329'},children:\"Create Workstream\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn-secondary\",onClick:()=>setShowForm(false),children:\"Back to List\"})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'16px',display:'flex',gap:'12px',alignItems:'center',flexWrap:'wrap'},children:[/*#__PURE__*/_jsxs(\"button\",{type:\"button\",className:\"btn-primary\",onClick:addWorkstream,style:{display:'flex',alignItems:'center',gap:'8px'},children:[/*#__PURE__*/_jsx(Plus,{size:16}),\"Add WorkStream\"]}),/*#__PURE__*/_jsxs(\"button\",{type:\"button\",className:\"btn-secondary\",onClick:handleSaveTemplate,disabled:workstreams.length===0,style:{display:'flex',alignItems:'center',gap:'8px'},title:\"Save current workstreams as template\",children:[/*#__PURE__*/_jsx(Save,{size:16}),\"Save Template\"]}),/*#__PURE__*/_jsxs(\"button\",{type:\"button\",className:\"btn-secondary\",onClick:()=>setShowLoadTemplateModal(true),disabled:savedTemplates.length===0,style:{display:'flex',alignItems:'center',gap:'8px'},title:\"Load a saved template\",children:[/*#__PURE__*/_jsx(FolderOpen,{size:16}),\"Load Template\"]})]}),workstreams.map((workstream,index)=>renderWorkstreamForm(workstream,index)),/*#__PURE__*/_jsxs(\"div\",{className:\"form-actions\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn-secondary\",onClick:handleCancel,children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn-primary\",disabled:submitting,children:submitting?'Creating...':\"Create \".concat(workstreams.length,\" WorkStream\").concat(workstreams.length>1?'s':'')})]})]}),showTemplateModal&&/*#__PURE__*/_jsx(\"div\",{style:{position:'fixed',top:0,left:0,right:0,bottom:0,background:'rgba(0, 0, 0, 0.5)',display:'flex',alignItems:'center',justifyContent:'center',zIndex:1000},children:/*#__PURE__*/_jsxs(\"div\",{style:{background:'white',padding:'24px',borderRadius:'8px',minWidth:'400px',maxWidth:'500px'},children:[/*#__PURE__*/_jsx(\"h3\",{style:{margin:'0 0 16px 0',fontSize:'18px',fontWeight:600},children:\"Save Template\"}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'16px'},children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:'8px',fontSize:'14px',fontWeight:500},children:\"Template Name:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:templateName,onChange:e=>setTemplateName(e.target.value),placeholder:\"Enter template name\",style:{width:'100%',padding:'8px 12px',border:'1px solid var(--border-color)',borderRadius:'4px',fontSize:'14px'},autoFocus:true,onKeyPress:e=>{if(e.key==='Enter'){confirmSaveTemplate();}}})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'12px',justifyContent:'flex-end'},children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn-secondary\",onClick:()=>{setShowTemplateModal(false);setTemplateName('');},children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn-primary\",onClick:confirmSaveTemplate,disabled:!templateName.trim(),children:\"Save\"})]})]})}),showLoadTemplateModal&&/*#__PURE__*/_jsx(\"div\",{style:{position:'fixed',top:0,left:0,right:0,bottom:0,background:'rgba(0, 0, 0, 0.5)',display:'flex',alignItems:'center',justifyContent:'center',zIndex:1000},children:/*#__PURE__*/_jsxs(\"div\",{style:{background:'white',padding:'24px',borderRadius:'8px',minWidth:'500px',maxWidth:'600px',maxHeight:'80vh',overflow:'auto'},children:[/*#__PURE__*/_jsx(\"h3\",{style:{margin:'0 0 16px 0',fontSize:'18px',fontWeight:600},children:\"Load Template\"}),savedTemplates.length===0?/*#__PURE__*/_jsx(\"p\",{style:{color:'#666',fontSize:'14px'},children:\"No saved templates found.\"}):/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',flexDirection:'column',gap:'12px'},children:savedTemplates.map(template=>/*#__PURE__*/_jsxs(\"div\",{style:{padding:'12px',border:'1px solid var(--border-color)',borderRadius:'4px',display:'flex',justifyContent:'space-between',alignItems:'center'},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:500,fontSize:'14px',marginBottom:'4px'},children:template.name}),/*#__PURE__*/_jsxs(\"div\",{style:{fontSize:'12px',color:'#666'},children:[template.workstreams.length,\" workstream(s) \\u2022 Created \",new Date(template.createdAt).toLocaleDateString()]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'8px'},children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn-primary\",onClick:()=>handleLoadTemplate(template),style:{fontSize:'12px',padding:'6px 12px'},children:\"Load\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn-secondary\",onClick:()=>handleDeleteTemplate(template.id),style:{fontSize:'12px',padding:'6px 12px',color:'#d32f2f'},title:\"Delete template\",children:/*#__PURE__*/_jsx(Trash2,{size:14})})]})]},template.id))}),/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',justifyContent:'flex-end',marginTop:'16px'},children:/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn-secondary\",onClick:()=>setShowLoadTemplateModal(false),children:\"Close\"})})]})})]});// Import Preview Modal (shared between both render paths)\nconst importPreviewModal=showImportPreview&&/*#__PURE__*/_jsx(\"div\",{style:{position:'fixed',top:0,left:0,right:0,bottom:0,background:'rgba(0, 0, 0, 0.5)',display:'flex',alignItems:'center',justifyContent:'center',zIndex:9999},children:/*#__PURE__*/_jsxs(\"div\",{style:{background:'white',padding:'24px',borderRadius:'8px',minWidth:'800px',maxWidth:'90vw',maxHeight:'90vh',display:'flex',flexDirection:'column'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:'16px'},children:[/*#__PURE__*/_jsx(\"h3\",{style:{margin:0,fontSize:'18px',fontWeight:600},children:\"Import Preview\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setShowImportPreview(false);setImportedWorkstreams([]);setResolvingObjectives(false);},style:{background:'none',border:'none',cursor:'pointer',padding:'4px',display:'flex',alignItems:'center'},children:/*#__PURE__*/_jsx(X,{size:20})})]}),resolvingObjectives&&/*#__PURE__*/_jsxs(\"div\",{style:{padding:'12px',background:'#f0f9ff',borderRadius:'4px',marginBottom:'16px',display:'flex',alignItems:'center',gap:'8px'},children:[/*#__PURE__*/_jsx(Loader,{className:\"spinning\",size:16,style:{color:'#08979C'}}),/*#__PURE__*/_jsx(\"span\",{style:{fontSize:'13px',color:'#0369a1'},children:\"Resolving project objectives...\"})]}),/*#__PURE__*/_jsx(\"div\",{style:{flex:1,overflow:'auto',marginBottom:'16px'},children:/*#__PURE__*/_jsxs(\"table\",{style:{width:'100%',borderCollapse:'collapse',fontSize:'13px'},children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Project Workstream Name\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Project Objective\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Delivery Tool Name\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Client Workstream Identifier\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Functionality\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:importedWorkstreams.map((ws,index)=>{const error=validateWorkstream(ws);return/*#__PURE__*/_jsxs(\"tr\",{style:{background:error?'#fee':'white'},children:[/*#__PURE__*/_jsx(\"td\",{style:{padding:'8px',border:'1px solid #e5e7eb'},children:ws.projectWorkstreamName||'--'}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'8px',border:'1px solid #e5e7eb'},children:ws.projectObjective||'--'}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'8px',border:'1px solid #e5e7eb'},children:ws.deliveryToolName||'--'}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'8px',border:'1px solid #e5e7eb'},children:ws.clientWorkstreamIdentifier||'--'}),/*#__PURE__*/_jsxs(\"td\",{style:{padding:'8px',border:'1px solid #e5e7eb'},children:[ws.functionality||'--',error&&/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'11px',color:'#c33',marginTop:'4px'},children:error})]})]},index);})})]})}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'flex-end',gap:'8px'},children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setShowImportPreview(false);setImportedWorkstreams([]);},className:\"btn-secondary\",children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleCreateFromImport,disabled:importing||importedWorkstreams.some(ws=>validateWorkstream(ws)),className:\"btn-primary\",children:importing?'Creating...':\"Create \".concat(importedWorkstreams.length,\" Workstream(s)\")})]})]})});if(hideHeader){return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"create-workstream-content-wrapper\",children:content}),importPreviewModal]});}return/*#__PURE__*/_jsxs(\"div\",{className:\"dashboard-layout\",children:[/*#__PURE__*/_jsx(Sidebar,{isOpen:sidebarOpen,toggleSidebar:()=>setSidebarOpen(!sidebarOpen)}),/*#__PURE__*/_jsx(\"div\",{className:\"create-workstream\",style:{marginLeft:\"\".concat(sidebarWidth,\"px\"),width:\"calc(100% - \".concat(sidebarWidth,\"px)\"),transition:'margin-left 0.2s ease, width 0.2s ease'},children:/*#__PURE__*/_jsxs(\"div\",{className:\"create-workstream-container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"create-workstream-header\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"header-content\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"header-left\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"header-menu-toggle\",onClick:()=>setSidebarOpen(!sidebarOpen),\"aria-label\":\"Toggle sidebar\",children:/*#__PURE__*/_jsx(Menu,{size:20})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"page-title\",children:\"New Project Workstream\"}),/*#__PURE__*/_jsx(\"p\",{className:\"page-subtitle\",children:\"Create a new project workstream\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"header-user-profile\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"user-profile\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"user-avatar\",children:((user===null||user===void 0?void 0:user.email)||'U').charAt(0).toUpperCase()}),/*#__PURE__*/_jsx(\"span\",{className:\"user-name\",children:(user===null||user===void 0?void 0:user.email)||'User'}),/*#__PURE__*/_jsx(\"button\",{className:\"logout-btn\",onClick:logout,title:\"Logout\",children:/*#__PURE__*/_jsx(LogOut,{size:18})})]})})]})}),content]})}),importPreviewModal]});};export default CreateWorkStream;","map":{"version":3,"names":["React","useState","useEffect","useRef","useCallback","useAuth","Sidebar","useSidebarWidth","Menu","LogOut","Search","X","Info","Plus","ChevronDown","ChevronUp","Trash2","Loader","Save","Copy","FolderOpen","Download","Upload","FileText","apiClient","toast","XLSX","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","CreateWorkStream","_ref","hideHeader","user","logout","sidebarOpen","setSidebarOpen","sidebarWidth","submitting","setSubmitting","showForm","setShowForm","projectObjectives","setProjectObjectives","allProjectObjectives","setAllProjectObjectives","loadingPOs","setLoadingPOs","poOffset","setPoOffset","poHasMore","setPoHasMore","loadingMorePOs","setLoadingMorePOs","infiniteScrollRef","statusFilter","setStatusFilter","workstreams","setWorkstreams","id","Date","now","projectWorkstreamName","projectObjective","projectObjectiveId","refresh","deliveryToolName","clientWorkstreamIdentifier","functionality","expandedWorkstreams","setExpandedWorkstreams","savedTemplates","setSavedTemplates","showTemplateModal","setShowTemplateModal","templateName","setTemplateName","showLoadTemplateModal","setShowLoadTemplateModal","showImportPreview","setShowImportPreview","importedWorkstreams","setImportedWorkstreams","importing","setImporting","resolvingObjectives","setResolvingObjectives","projectObjectiveSearchTerms","setProjectObjectiveSearchTerms","projectObjectiveSearchResults","setProjectObjectiveSearchResults","loadingProjectObjectiveSearch","setLoadingProjectObjectiveSearch","showProjectObjectiveDropdowns","setShowProjectObjectiveDropdowns","projectObjectiveSearchTimeoutRefs","recentSelectionsRef","fetchProjectObjectives","offset","arguments","length","undefined","append","response","get","params","limit","timeout","data","success","newPOs","prev","newOffset","hasMoreRecords","hasMore","error","_error$response","_error$response$data","saved","localStorage","getItem","JSON","parse","console","observer","IntersectionObserver","entries","isIntersecting","threshold","current","observe","unobserve","filter","po","status","uniqueStatuses","Array","from","Set","map","s","sort","deliveryToolNameOptions","functionalityOptions","handleClickOutside","event","Object","keys","forEach","workstreamId","target","closest","concat","_objectSpread","document","addEventListener","removeEventListener","searchTerm","workstream","find","w","clearTimeout","trim","recentSelection","timeSinceSelection","timestamp","setTimeout","currentSearchTerm","currentWorkstream","currentRecentSelection","encodeURIComponent","finalWorkstream","finalRecentSelection","handleProjectObjectiveSelect","objective","selectedName","contributorFacingProjectName","name","ws","handleClearProjectObjective","handleInputChange","field","value","handleSearchTermChange","toggleWorkstreamExpanded","addWorkstream","newId","removeWorkstream","newState","validateWorkstream","handleSubmit","e","preventDefault","validationErrors","index","push","createPromises","post","results","Promise","all","successCount","r","_error$response2","_error$response2$data","errorMessage","message","handleCancel","handleAddWorkstream","handleSaveTemplate","confirmSaveTemplate","template","createdAt","toISOString","updatedTemplates","setItem","stringify","handleLoadTemplate","newWorkstreams","reduce","acc","handleDeleteTemplate","templateId","t","handleCloneWorkstream","workstreamToClone","clonedWorkstream","handleDownloadTemplate","templateData","utils","json_to_sheet","wb","book_new","book_append_sheet","writeFile","split","handleImportTemplate","file","files","reader","FileReader","onload","Uint8Array","result","workbook","read","type","firstSheetName","SheetNames","worksheet","Sheets","jsonData","sheet_to_json","imported","row","unresolvedObjectives","icon","duration","matched","toLowerCase","resolvedCount","readAsArrayBuffer","handleCreateFromImport","unresolved","_error$response3","_error$response3$data","renderWorkstreamForm","isExpanded","searchResults","loadingSearch","showDropdown","className","children","onClick","stopPropagation","size","style","display","gap","alignItems","title","background","border","cursor","padding","color","onChange","placeholder","readOnly","onFocus","projectName","marginTop","marginBottom","checked","marginRight","verticalAlign","marginLeft","required","opt","option","content","justifyContent","paddingTop","flexWrap","margin","fontSize","fontWeight","accept","borderRadius","minWidth","fontFamily","textAlign","maxHeight","overflowY","width","colSpan","borderTop","ref","height","onSubmit","disabled","position","top","left","right","bottom","zIndex","maxWidth","autoFocus","onKeyPress","key","overflow","flexDirection","toLocaleDateString","importPreviewModal","flex","borderCollapse","some","isOpen","toggleSidebar","transition","email","charAt","toUpperCase"],"sources":["/Users/mmoola/Documents/GitHub/project-tools/client/src/pages/CreateWorkStream.js"],"sourcesContent":["import React, { useState, useEffect, useRef, useCallback } from 'react';\nimport { useAuth } from '../context/AuthContext';\nimport Sidebar from '../components/Sidebar';\nimport useSidebarWidth from '../hooks/useSidebarWidth';\nimport { Menu, LogOut, Search, X, Info, Plus, ChevronDown, ChevronUp, Trash2, Loader, Save, Copy, FolderOpen, Download, Upload, FileText } from 'lucide-react';\nimport apiClient from '../config/api';\nimport toast from 'react-hot-toast';\nimport * as XLSX from 'xlsx';\nimport '../styles/CreateWorkStream.css';\nimport '../styles/Sidebar.css';\nimport '../styles/GlobalHeader.css';\n\nconst CreateWorkStream = ({ hideHeader = false }) => {\n  const { user, logout } = useAuth();\n  const [sidebarOpen, setSidebarOpen] = useState(true);\n  const sidebarWidth = useSidebarWidth(sidebarOpen);\n  const [submitting, setSubmitting] = useState(false);\n  const [showForm, setShowForm] = useState(false); // New state to control form visibility\n  \n  // Project Objectives without workstreams\n  const [projectObjectives, setProjectObjectives] = useState([]);\n  const [allProjectObjectives, setAllProjectObjectives] = useState([]); // Store all fetched data for filtering\n  const [loadingPOs, setLoadingPOs] = useState(true);\n  const [poOffset, setPoOffset] = useState(0);\n  const [poHasMore, setPoHasMore] = useState(true);\n  const [loadingMorePOs, setLoadingMorePOs] = useState(false);\n  const infiniteScrollRef = useRef(null);\n  const [statusFilter, setStatusFilter] = useState(''); // Filter by status\n  \n  // Workstreams array - each workstream has its own form data\n  const [workstreams, setWorkstreams] = useState([\n    {\n      id: Date.now(),\n      projectWorkstreamName: '',\n      projectObjective: '',\n      projectObjectiveId: '',\n      refresh: false,\n      deliveryToolName: '',\n      clientWorkstreamIdentifier: '',\n      functionality: ''\n    }\n  ]);\n  \n  // Track expanded/collapsed state for each workstream\n  const [expandedWorkstreams, setExpandedWorkstreams] = useState({ [Date.now()]: true });\n  \n  // Templates state\n  const [savedTemplates, setSavedTemplates] = useState([]);\n  const [showTemplateModal, setShowTemplateModal] = useState(false);\n  const [templateName, setTemplateName] = useState('');\n  const [showLoadTemplateModal, setShowLoadTemplateModal] = useState(false);\n  const [showImportPreview, setShowImportPreview] = useState(false);\n  const [importedWorkstreams, setImportedWorkstreams] = useState([]);\n  const [importing, setImporting] = useState(false);\n  const [resolvingObjectives, setResolvingObjectives] = useState(false);\n\n  // Project Objective search - per workstream\n  const [projectObjectiveSearchTerms, setProjectObjectiveSearchTerms] = useState({});\n  const [projectObjectiveSearchResults, setProjectObjectiveSearchResults] = useState({});\n  const [loadingProjectObjectiveSearch, setLoadingProjectObjectiveSearch] = useState({});\n  const [showProjectObjectiveDropdowns, setShowProjectObjectiveDropdowns] = useState({});\n  const projectObjectiveSearchTimeoutRefs = useRef({});\n  const recentSelectionsRef = useRef({}); // Track recent selections to prevent search loop\n\n  // Fetch project objectives without workstreams\n  const fetchProjectObjectives = useCallback(async (offset = 0, append = false) => {\n    try {\n      if (offset === 0) {\n        setLoadingPOs(true);\n      } else {\n        setLoadingMorePOs(true);\n      }\n      \n      const response = await apiClient.get('/workstream/project-objectives-without-workstreams', {\n        params: { limit: 1000, offset },\n        timeout: 120000 // 2 minutes to match backend timeout\n      });\n      \n      if (response.data.success) {\n        const newPOs = response.data.projectObjectives;\n        if (append) {\n          setAllProjectObjectives(prev => [...prev, ...newPOs]);\n        } else {\n          setAllProjectObjectives(newPOs);\n          setPoOffset(0); // Reset offset when starting fresh\n        }\n        \n        // Update offset and hasMore\n        const newOffset = append ? poOffset + newPOs.length : newPOs.length;\n        setPoOffset(newOffset);\n        \n        // If we got exactly 1000 records, assume there might be more\n        // Also check the hasMore flag from backend\n        const hasMoreRecords = response.data.hasMore || newPOs.length === 1000;\n        setPoHasMore(hasMoreRecords);\n      }\n    } catch (error) {\n      toast.error(error.response?.data?.error || 'Failed to fetch project objectives');\n    } finally {\n      setLoadingPOs(false);\n      setLoadingMorePOs(false);\n    }\n  }, []);\n\n  // Load saved templates from localStorage\n  useEffect(() => {\n    try {\n      const saved = localStorage.getItem('workstreamTemplates');\n      if (saved) {\n        setSavedTemplates(JSON.parse(saved));\n      }\n    } catch (error) {\n      console.error('Error loading templates:', error);\n    }\n  }, []);\n\n  // Initial load\n  useEffect(() => {\n    if (!showForm) {\n      fetchProjectObjectives(0, false);\n    }\n  }, [showForm, fetchProjectObjectives]);\n\n  // Infinite scroll for project objectives\n  useEffect(() => {\n    const observer = new IntersectionObserver(\n      (entries) => {\n        if (entries[0].isIntersecting && poHasMore && !loadingMorePOs && !showForm) {\n          fetchProjectObjectives(poOffset, true);\n        }\n      },\n      { threshold: 0.1 }\n    );\n\n    if (infiniteScrollRef.current) {\n      observer.observe(infiniteScrollRef.current);\n    }\n\n    return () => {\n      if (infiniteScrollRef.current) {\n        observer.unobserve(infiniteScrollRef.current);\n      }\n    };\n  }, [poHasMore, loadingMorePOs, poOffset, showForm, fetchProjectObjectives]);\n\n  // Filter project objectives by status\n  useEffect(() => {\n    if (statusFilter === '') {\n      setProjectObjectives(allProjectObjectives);\n    } else {\n      setProjectObjectives(allProjectObjectives.filter(po => po.status === statusFilter));\n    }\n  }, [statusFilter, allProjectObjectives]);\n\n  // Get unique status values for filter dropdown (exclude '--' and empty values)\n  const uniqueStatuses = Array.from(new Set(allProjectObjectives.map(po => po.status).filter(s => s && s !== '--'))).sort();\n\n  // Delivery Tool Name picklist (excluding QF as per original requirement)\n  const deliveryToolNameOptions = [\n    '--None--',\n    'A9',\n    'ADAP',\n    'Ampersand',\n    'Appen Collect',\n    'AppenLex',\n    'Baseline',\n    'EWOQ',\n    'Exotel',\n    'Other',\n    'Polyglot',\n    'SRT',\n    'TryRating',\n    'UHRS',\n    'Test',\n    'Test Tool'\n  ];\n\n  // Functionality picklist values\n  const functionalityOptions = [\n    '--None--',\n    'System Access',\n    'System Access & Productivity',\n    'Productivity'\n  ];\n\n  // Close search results when clicking outside\n  useEffect(() => {\n    const handleClickOutside = (event) => {\n      Object.keys(showProjectObjectiveDropdowns).forEach(workstreamId => {\n        if (showProjectObjectiveDropdowns[workstreamId] && !event.target.closest(`.project-objective-search-container-${workstreamId}`)) {\n          setShowProjectObjectiveDropdowns(prev => ({\n            ...prev,\n            [workstreamId]: false\n          }));\n        }\n      });\n    };\n\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => {\n      document.removeEventListener('mousedown', handleClickOutside);\n    };\n  }, [showProjectObjectiveDropdowns]);\n\n  // Search Project Objectives when search term changes (per workstream)\n  useEffect(() => {\n    Object.keys(projectObjectiveSearchTerms).forEach(workstreamId => {\n      const searchTerm = projectObjectiveSearchTerms[workstreamId];\n      const workstream = workstreams.find(w => w.id === workstreamId);\n      \n      // Clear any existing timeout\n      if (projectObjectiveSearchTimeoutRefs.current[workstreamId]) {\n        clearTimeout(projectObjectiveSearchTimeoutRefs.current[workstreamId]);\n        delete projectObjectiveSearchTimeoutRefs.current[workstreamId];\n      }\n\n      // IMPORTANT: Don't search if an objective is already selected\n      // This prevents the search loop when user selects an objective\n      if (workstream && workstream.projectObjectiveId) {\n        setProjectObjectiveSearchResults(prev => ({ ...prev, [workstreamId]: [] }));\n        setShowProjectObjectiveDropdowns(prev => ({ ...prev, [workstreamId]: false }));\n        setLoadingProjectObjectiveSearch(prev => ({ ...prev, [workstreamId]: false }));\n        return;\n      }\n\n      // Don't search if search term is empty\n      if (!searchTerm || searchTerm.trim() === '') {\n        setProjectObjectiveSearchResults(prev => ({ ...prev, [workstreamId]: [] }));\n        setShowProjectObjectiveDropdowns(prev => ({ ...prev, [workstreamId]: false }));\n        setLoadingProjectObjectiveSearch(prev => ({ ...prev, [workstreamId]: false }));\n        return;\n      }\n\n      // Check if this is a recent selection (within last 2 seconds)\n      const recentSelection = recentSelectionsRef.current[workstreamId];\n      if (recentSelection) {\n        const timeSinceSelection = Date.now() - recentSelection.timestamp;\n        if (timeSinceSelection < 2000) {\n          // This is a recent selection, don't search\n          setProjectObjectiveSearchResults(prev => ({ ...prev, [workstreamId]: [] }));\n          setShowProjectObjectiveDropdowns(prev => ({ ...prev, [workstreamId]: false }));\n          setLoadingProjectObjectiveSearch(prev => ({ ...prev, [workstreamId]: false }));\n          return;\n        }\n      }\n\n      // Only search if user is actively typing (not just matching selected value)\n      projectObjectiveSearchTimeoutRefs.current[workstreamId] = setTimeout(async () => {\n        // Get fresh search term and workstream\n        const currentSearchTerm = projectObjectiveSearchTerms[workstreamId];\n        if (!currentSearchTerm || currentSearchTerm.trim() === '') {\n          return;\n        }\n        \n        // CRITICAL: Re-check if objective was selected during timeout - if so, abort search\n        const currentWorkstream = workstreams.find(w => w.id === workstreamId);\n        if (currentWorkstream && currentWorkstream.projectObjectiveId) {\n          // An objective was selected, don't search\n          setProjectObjectiveSearchResults(prev => ({ ...prev, [workstreamId]: [] }));\n          setShowProjectObjectiveDropdowns(prev => ({ ...prev, [workstreamId]: false }));\n          setLoadingProjectObjectiveSearch(prev => ({ ...prev, [workstreamId]: false }));\n          return;\n        }\n        \n        // Check again if this is a recent selection\n        const currentRecentSelection = recentSelectionsRef.current[workstreamId];\n        if (currentRecentSelection) {\n          const timeSinceSelection = Date.now() - currentRecentSelection.timestamp;\n          if (timeSinceSelection < 2000) {\n            // This is a recent selection, don't search\n            setProjectObjectiveSearchResults(prev => ({ ...prev, [workstreamId]: [] }));\n            setShowProjectObjectiveDropdowns(prev => ({ ...prev, [workstreamId]: false }));\n            setLoadingProjectObjectiveSearch(prev => ({ ...prev, [workstreamId]: false }));\n            return;\n          }\n        }\n        \n        setLoadingProjectObjectiveSearch(prev => ({ ...prev, [workstreamId]: true }));\n        try {\n          const response = await apiClient.get(`/workstream/search-project-objectives?search=${encodeURIComponent(currentSearchTerm)}`);\n          if (response.data.success) {\n            // CRITICAL: Final check before showing results - make sure objective wasn't selected during API call\n            const finalWorkstream = workstreams.find(w => w.id === workstreamId);\n            if (finalWorkstream && finalWorkstream.projectObjectiveId) {\n              // An objective was selected during the API call, don't show results\n              setProjectObjectiveSearchResults(prev => ({ ...prev, [workstreamId]: [] }));\n              setShowProjectObjectiveDropdowns(prev => ({ ...prev, [workstreamId]: false }));\n              setLoadingProjectObjectiveSearch(prev => ({ ...prev, [workstreamId]: false }));\n              return;\n            }\n            \n            // Check for recent selection\n            const finalRecentSelection = recentSelectionsRef.current[workstreamId];\n            if (finalRecentSelection) {\n              const timeSinceSelection = Date.now() - finalRecentSelection.timestamp;\n              if (timeSinceSelection < 2000) {\n                // Objective was just selected, don't show results\n                setProjectObjectiveSearchResults(prev => ({ ...prev, [workstreamId]: [] }));\n                setShowProjectObjectiveDropdowns(prev => ({ ...prev, [workstreamId]: false }));\n                setLoadingProjectObjectiveSearch(prev => ({ ...prev, [workstreamId]: false }));\n                return;\n              }\n            }\n            \n            // All checks passed, show results\n            setProjectObjectiveSearchResults(prev => ({ ...prev, [workstreamId]: response.data.projectObjectives || [] }));\n            setShowProjectObjectiveDropdowns(prev => ({ ...prev, [workstreamId]: true }));\n          }\n        } catch (error) {\n          setProjectObjectiveSearchResults(prev => ({ ...prev, [workstreamId]: [] }));\n        } finally {\n          setLoadingProjectObjectiveSearch(prev => ({ ...prev, [workstreamId]: false }));\n        }\n      }, 300);\n    });\n\n    return () => {\n      Object.keys(projectObjectiveSearchTimeoutRefs.current).forEach(workstreamId => {\n        if (projectObjectiveSearchTimeoutRefs.current[workstreamId]) {\n          clearTimeout(projectObjectiveSearchTimeoutRefs.current[workstreamId]);\n          delete projectObjectiveSearchTimeoutRefs.current[workstreamId];\n        }\n      });\n    };\n  }, [projectObjectiveSearchTerms, workstreams]);\n\n  const handleProjectObjectiveSelect = (workstreamId, objective) => {\n    const selectedName = objective.contributorFacingProjectName || objective.name;\n    \n    // Clear any pending search timeout immediately\n    if (projectObjectiveSearchTimeoutRefs.current[workstreamId]) {\n      clearTimeout(projectObjectiveSearchTimeoutRefs.current[workstreamId]);\n      delete projectObjectiveSearchTimeoutRefs.current[workstreamId];\n    }\n    \n    // Mark this as a recent selection to prevent search loop\n    recentSelectionsRef.current[workstreamId] = {\n      name: selectedName,\n      timestamp: Date.now()\n    };\n    \n    // Update workstream with selected objective\n    setWorkstreams(prev => prev.map(ws => \n      ws.id === workstreamId \n        ? {\n            ...ws,\n            projectObjective: selectedName,\n            projectObjectiveId: objective.id\n          }\n        : ws\n    ));\n    \n    // Clear search term instead of setting it to selected name - this prevents re-triggering search\n    setProjectObjectiveSearchTerms(prev => ({\n      ...prev,\n      [workstreamId]: ''\n    }));\n    \n    // Immediately close dropdown and clear results\n    setShowProjectObjectiveDropdowns(prev => ({ ...prev, [workstreamId]: false }));\n    setProjectObjectiveSearchResults(prev => ({ ...prev, [workstreamId]: [] }));\n    setLoadingProjectObjectiveSearch(prev => ({ ...prev, [workstreamId]: false }));\n    \n    // Clear the recent selection flag after a delay\n    setTimeout(() => {\n      if (recentSelectionsRef.current[workstreamId]) {\n        delete recentSelectionsRef.current[workstreamId];\n      }\n    }, 2000);\n  };\n\n  const handleClearProjectObjective = (workstreamId) => {\n    setWorkstreams(prev => prev.map(ws => \n      ws.id === workstreamId \n        ? {\n            ...ws,\n            projectObjective: '',\n            projectObjectiveId: ''\n          }\n        : ws\n    ));\n    setProjectObjectiveSearchTerms(prev => ({ ...prev, [workstreamId]: '' }));\n    setProjectObjectiveSearchResults(prev => ({ ...prev, [workstreamId]: [] }));\n    setShowProjectObjectiveDropdowns(prev => ({ ...prev, [workstreamId]: false }));\n  };\n\n  const handleInputChange = (workstreamId, field, value) => {\n    setWorkstreams(prev => prev.map(ws => \n      ws.id === workstreamId ? { ...ws, [field]: value } : ws\n    ));\n  };\n\n  const handleSearchTermChange = (workstreamId, value) => {\n    setProjectObjectiveSearchTerms(prev => ({\n      ...prev,\n      [workstreamId]: value\n    }));\n    if (value === '') {\n      handleClearProjectObjective(workstreamId);\n    }\n  };\n\n  const toggleWorkstreamExpanded = (workstreamId) => {\n    setExpandedWorkstreams(prev => ({\n      ...prev,\n      [workstreamId]: !prev[workstreamId]\n    }));\n  };\n\n  const addWorkstream = () => {\n    const newId = Date.now();\n    setWorkstreams(prev => [...prev, {\n      id: newId,\n      projectWorkstreamName: '',\n      projectObjective: '',\n      projectObjectiveId: '',\n      refresh: false,\n      deliveryToolName: '',\n      clientWorkstreamIdentifier: '',\n      functionality: ''\n    }]);\n    setExpandedWorkstreams(prev => ({ ...prev, [newId]: true }));\n    setProjectObjectiveSearchTerms(prev => ({ ...prev, [newId]: '' }));\n  };\n\n  const removeWorkstream = (workstreamId) => {\n    if (workstreams.length === 1) {\n      toast.error('At least one workstream is required');\n      return;\n    }\n    setWorkstreams(prev => prev.filter(ws => ws.id !== workstreamId));\n    setExpandedWorkstreams(prev => {\n      const newState = { ...prev };\n      delete newState[workstreamId];\n      return newState;\n    });\n    setProjectObjectiveSearchTerms(prev => {\n      const newState = { ...prev };\n      delete newState[workstreamId];\n      return newState;\n    });\n    setProjectObjectiveSearchResults(prev => {\n      const newState = { ...prev };\n      delete newState[workstreamId];\n      return newState;\n    });\n    setShowProjectObjectiveDropdowns(prev => {\n      const newState = { ...prev };\n      delete newState[workstreamId];\n      return newState;\n    });\n    if (projectObjectiveSearchTimeoutRefs.current[workstreamId]) {\n      clearTimeout(projectObjectiveSearchTimeoutRefs.current[workstreamId]);\n      delete projectObjectiveSearchTimeoutRefs.current[workstreamId];\n    }\n  };\n\n  const validateWorkstream = (workstream) => {\n    // Project Objective is required (either ID or name)\n    if (!workstream.projectObjectiveId && (!workstream.projectObjective || workstream.projectObjective.trim() === '')) {\n      return 'Project Objective is required';\n    }\n    if (!workstream.deliveryToolName || workstream.deliveryToolName === '--None--' || workstream.deliveryToolName.trim() === '') {\n      return 'Delivery Tool Name is required';\n    }\n    if (!workstream.clientWorkstreamIdentifier || workstream.clientWorkstreamIdentifier.trim() === '') {\n      return 'Client Workstream Identifier is required';\n    }\n    if (!workstream.functionality || workstream.functionality === '--None--' || workstream.functionality.trim() === '') {\n      return 'Functionality is required';\n    }\n    return null;\n  };\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n\n    // Validate all workstreams\n    const validationErrors = [];\n    workstreams.forEach((workstream, index) => {\n      const error = validateWorkstream(workstream);\n      if (error) {\n        validationErrors.push(`Workstream ${index + 1}: ${error}`);\n      }\n    });\n\n    if (validationErrors.length > 0) {\n      toast.error(validationErrors[0]);\n      return;\n    }\n\n    setSubmitting(true);\n    try {\n      // Create all workstreams - each under its respective project objective\n      const createPromises = workstreams.map(workstream => \n        apiClient.post('/workstream/create', {\n          projectWorkstreamName: workstream.projectWorkstreamName,\n          projectObjective: workstream.projectObjective,\n          projectObjectiveId: workstream.projectObjectiveId,\n          refresh: workstream.refresh,\n          deliveryToolName: workstream.deliveryToolName,\n          clientWorkstreamIdentifier: workstream.clientWorkstreamIdentifier,\n          functionality: workstream.functionality\n        })\n      );\n\n      const results = await Promise.all(createPromises);\n      const successCount = results.filter(r => r.data.success).length;\n      \n      if (successCount === workstreams.length) {\n        toast.success(`Successfully created ${successCount} workstream(s)`);\n        // Reset all workstreams and hide form\n        const newId = Date.now();\n        setWorkstreams([{\n          id: newId,\n          projectWorkstreamName: '',\n          projectObjective: '',\n          projectObjectiveId: '',\n          refresh: false,\n          deliveryToolName: '',\n          clientWorkstreamIdentifier: '',\n          functionality: ''\n        }]);\n        setExpandedWorkstreams({ [newId]: true });\n        setProjectObjectiveSearchTerms({ [newId]: '' });\n        setProjectObjectiveSearchResults({});\n        setShowProjectObjectiveDropdowns({});\n        setShowForm(false);\n        // Reload project objectives list\n        fetchProjectObjectives(0, false);\n      } else {\n        toast.error(`Created ${successCount} of ${workstreams.length} workstream(s)`);\n      }\n    } catch (error) {\n      const errorMessage = error.response?.data?.error || error.message || 'Failed to create workstream(s)';\n      toast.error(errorMessage);\n    } finally {\n      setSubmitting(false);\n    }\n  };\n\n  const handleCancel = () => {\n    // Reset all workstreams and hide form\n    const newId = Date.now();\n    setWorkstreams([{\n      id: newId,\n      projectWorkstreamName: '',\n      projectObjective: '',\n      projectObjectiveId: '',\n      refresh: false,\n      deliveryToolName: '',\n      clientWorkstreamIdentifier: '',\n      functionality: ''\n    }]);\n    setExpandedWorkstreams({ [newId]: true });\n    setProjectObjectiveSearchTerms({ [newId]: '' });\n    setProjectObjectiveSearchResults({});\n    setShowProjectObjectiveDropdowns({});\n    setShowForm(false);\n    // Reload project objectives list\n    fetchProjectObjectives(0, false);\n  };\n\n  const handleAddWorkstream = () => {\n    setShowForm(true);\n  };\n\n  // Save current workstreams as template\n  const handleSaveTemplate = () => {\n    if (workstreams.length === 0) {\n      toast.error('No workstreams to save as template');\n      return;\n    }\n    setShowTemplateModal(true);\n  };\n\n  const confirmSaveTemplate = () => {\n    if (!templateName.trim()) {\n      toast.error('Please enter a template name');\n      return;\n    }\n\n    try {\n      const template = {\n        id: Date.now(),\n        name: templateName.trim(),\n        createdAt: new Date().toISOString(),\n        workstreams: workstreams.map(ws => ({\n          projectWorkstreamName: ws.projectWorkstreamName,\n          projectObjective: ws.projectObjective,\n          projectObjectiveId: ws.projectObjectiveId,\n          refresh: ws.refresh,\n          deliveryToolName: ws.deliveryToolName,\n          clientWorkstreamIdentifier: ws.clientWorkstreamIdentifier,\n          functionality: ws.functionality\n        }))\n      };\n\n      const updatedTemplates = [...savedTemplates, template];\n      setSavedTemplates(updatedTemplates);\n      localStorage.setItem('workstreamTemplates', JSON.stringify(updatedTemplates));\n      toast.success('Template saved successfully');\n      setShowTemplateModal(false);\n      setTemplateName('');\n    } catch (error) {\n      console.error('Error saving template:', error);\n      toast.error('Failed to save template');\n    }\n  };\n\n  // Load template\n  const handleLoadTemplate = (template) => {\n    try {\n      const newWorkstreams = template.workstreams.map((ws, index) => ({\n        id: Date.now() + index,\n        ...ws\n      }));\n      setWorkstreams(newWorkstreams);\n      setExpandedWorkstreams(newWorkstreams.reduce((acc, ws) => {\n        acc[ws.id] = true;\n        return acc;\n      }, {}));\n      setShowLoadTemplateModal(false);\n      toast.success(`Template \"${template.name}\" loaded successfully`);\n    } catch (error) {\n      console.error('Error loading template:', error);\n      toast.error('Failed to load template');\n    }\n  };\n\n  // Delete template\n  const handleDeleteTemplate = (templateId) => {\n    try {\n      const updatedTemplates = savedTemplates.filter(t => t.id !== templateId);\n      setSavedTemplates(updatedTemplates);\n      localStorage.setItem('workstreamTemplates', JSON.stringify(updatedTemplates));\n      toast.success('Template deleted successfully');\n    } catch (error) {\n      console.error('Error deleting template:', error);\n      toast.error('Failed to delete template');\n    }\n  };\n\n  // Clone workstream\n  const handleCloneWorkstream = (workstreamId) => {\n    const workstreamToClone = workstreams.find(ws => ws.id === workstreamId);\n    if (!workstreamToClone) return;\n\n    const clonedWorkstream = {\n      ...workstreamToClone,\n      id: Date.now(),\n      projectWorkstreamName: `${workstreamToClone.projectWorkstreamName} (Copy)`,\n      projectObjective: '',\n      projectObjectiveId: ''\n    };\n\n    setWorkstreams(prev => [...prev, clonedWorkstream]);\n    setExpandedWorkstreams(prev => ({ ...prev, [clonedWorkstream.id]: true }));\n    toast.success('Workstream cloned successfully');\n  };\n\n  // Download template for workstream creation\n  const handleDownloadTemplate = () => {\n    try {\n      const templateData = [\n        {\n          'Project Workstream Name': 'Example Workstream 1',\n          'Project Objective Name': 'Example Project Objective',\n          'Project Objective ID': '',\n          'Delivery Tool Name': 'Tool1',\n          'Client Workstream Identifier': 'WS-001',\n          'Functionality': 'Functionality1',\n          'Refresh': false\n        },\n        {\n          'Project Workstream Name': 'Example Workstream 2',\n          'Project Objective Name': 'Example Project Objective 2',\n          'Project Objective ID': '',\n          'Delivery Tool Name': 'Tool2',\n          'Client Workstream Identifier': 'WS-002',\n          'Functionality': 'Functionality2',\n          'Refresh': false\n        }\n      ];\n\n      const ws = XLSX.utils.json_to_sheet(templateData);\n      const wb = XLSX.utils.book_new();\n      XLSX.utils.book_append_sheet(wb, ws, 'Workstream Template');\n      XLSX.writeFile(wb, `Workstream_Creation_Template_${new Date().toISOString().split('T')[0]}.xlsx`);\n      toast.success('Template downloaded successfully');\n    } catch (error) {\n      console.error('Error downloading template:', error);\n      toast.error('Failed to download template');\n    }\n  };\n\n  // Handle template file import\n  const handleImportTemplate = async (event) => {\n    const file = event.target.files[0];\n    if (!file) return;\n\n    const reader = new FileReader();\n    reader.onload = async (e) => {\n      try {\n        const data = new Uint8Array(e.target.result);\n        const workbook = XLSX.read(data, { type: 'array' });\n        const firstSheetName = workbook.SheetNames[0];\n        const worksheet = workbook.Sheets[firstSheetName];\n        const jsonData = XLSX.utils.sheet_to_json(worksheet);\n\n        if (jsonData.length === 0) {\n          toast.error('Template file is empty');\n          return;\n        }\n\n        // Map imported data to workstream format\n        let imported = jsonData.map((row, index) => ({\n          id: Date.now() + index,\n          projectWorkstreamName: row['Project Workstream Name'] || row['projectWorkstreamName'] || '',\n          projectObjective: row['Project Objective Name'] || row['projectObjective'] || row['Project Objective'] || '',\n          projectObjectiveId: row['Project Objective ID'] || row['projectObjectiveId'] || '',\n          deliveryToolName: row['Delivery Tool Name'] || row['deliveryToolName'] || '',\n          clientWorkstreamIdentifier: row['Client Workstream Identifier'] || row['clientWorkstreamIdentifier'] || '',\n          functionality: row['Functionality'] || row['functionality'] || '',\n          refresh: row['Refresh'] || row['refresh'] || false\n        }));\n\n        // Resolve Project Objective names to IDs if ID is not provided\n        const unresolvedObjectives = imported.filter(ws => ws.projectObjective && !ws.projectObjectiveId);\n        if (unresolvedObjectives.length > 0) {\n          setResolvingObjectives(true);\n          toast('Resolving project objective names to IDs...', { icon: '⏳', duration: 2000 });\n          \n          // Resolve each project objective name to ID\n          for (const ws of unresolvedObjectives) {\n            try {\n              const searchTerm = ws.projectObjective.trim();\n              if (searchTerm) {\n                const response = await apiClient.get(`/workstream/search-project-objectives?search=${encodeURIComponent(searchTerm)}`);\n                if (response.data.success && response.data.projectObjectives && response.data.projectObjectives.length > 0) {\n                  // Try to find exact match first\n                  let matched = response.data.projectObjectives.find(po => \n                    po.name === searchTerm || \n                    po.contributorFacingProjectName === searchTerm ||\n                    (po.name && po.name.toLowerCase() === searchTerm.toLowerCase()) ||\n                    (po.contributorFacingProjectName && po.contributorFacingProjectName.toLowerCase() === searchTerm.toLowerCase())\n                  );\n                  \n                  // If no exact match, use the first result\n                  if (!matched) {\n                    matched = response.data.projectObjectives[0];\n                  }\n                  \n                  if (matched) {\n                    ws.projectObjectiveId = matched.id;\n                    ws.projectObjective = matched.contributorFacingProjectName || matched.name || ws.projectObjective;\n                  }\n                }\n              }\n            } catch (error) {\n              console.error(`Error resolving project objective for \"${ws.projectObjective}\":`, error);\n              // Continue with other workstreams even if one fails\n            }\n          }\n          \n          setResolvingObjectives(false);\n        }\n\n        setImportedWorkstreams(imported);\n        setShowImportPreview(true);\n        const resolvedCount = unresolvedObjectives.length > 0 ? unresolvedObjectives.filter(ws => ws.projectObjectiveId).length : 0;\n        if (unresolvedObjectives.length > 0) {\n          toast.success(`Imported ${imported.length} workstream(s). Resolved ${resolvedCount} of ${unresolvedObjectives.length} project objective(s).`);\n        } else {\n          toast.success(`Imported ${imported.length} workstream(s) from template`);\n        }\n      } catch (error) {\n        console.error('Error importing template:', error);\n        toast.error('Failed to import template. Please check the file format.');\n      }\n    };\n    reader.readAsArrayBuffer(file);\n    // Reset file input\n    event.target.value = '';\n  };\n\n  // Create workstreams from imported template\n  const handleCreateFromImport = async () => {\n    if (importedWorkstreams.length === 0) {\n      toast.error('No workstreams to create');\n      return;\n    }\n\n    // Resolve any remaining unresolved project objectives\n    const unresolved = importedWorkstreams.filter(ws => ws.projectObjective && !ws.projectObjectiveId);\n    if (unresolved.length > 0) {\n      toast('Resolving remaining project objectives...', { icon: '⏳' });\n      \n      for (const ws of unresolved) {\n        try {\n          const searchTerm = ws.projectObjective.trim();\n          if (searchTerm) {\n            const response = await apiClient.get(`/workstream/search-project-objectives?search=${encodeURIComponent(searchTerm)}`);\n            if (response.data.success && response.data.projectObjectives && response.data.projectObjectives.length > 0) {\n              // Try to find exact match first\n              let matched = response.data.projectObjectives.find(po => \n                po.name === searchTerm || \n                po.contributorFacingProjectName === searchTerm ||\n                (po.name && po.name.toLowerCase() === searchTerm.toLowerCase()) ||\n                (po.contributorFacingProjectName && po.contributorFacingProjectName.toLowerCase() === searchTerm.toLowerCase())\n              );\n              \n              // If no exact match, use the first result\n              if (!matched) {\n                matched = response.data.projectObjectives[0];\n              }\n              \n              if (matched) {\n                ws.projectObjectiveId = matched.id;\n                ws.projectObjective = matched.contributorFacingProjectName || matched.name || ws.projectObjective;\n              }\n            }\n          }\n        } catch (error) {\n          console.error(`Error resolving project objective for \"${ws.projectObjective}\":`, error);\n        }\n      }\n      \n      // Update the imported workstreams state with resolved IDs\n      setImportedWorkstreams([...importedWorkstreams]);\n    }\n\n    // Validate all imported workstreams\n    const validationErrors = [];\n    importedWorkstreams.forEach((workstream, index) => {\n      const error = validateWorkstream(workstream);\n      if (error) {\n        validationErrors.push(`Row ${index + 1}: ${error}`);\n      }\n    });\n\n    if (validationErrors.length > 0) {\n      toast.error(validationErrors[0]);\n      return;\n    }\n\n    setImporting(true);\n    try {\n      // Create all workstreams\n      const createPromises = importedWorkstreams.map(workstream => \n        apiClient.post('/workstream/create', {\n          projectWorkstreamName: workstream.projectWorkstreamName,\n          projectObjective: workstream.projectObjective,\n          projectObjectiveId: workstream.projectObjectiveId,\n          refresh: workstream.refresh,\n          deliveryToolName: workstream.deliveryToolName,\n          clientWorkstreamIdentifier: workstream.clientWorkstreamIdentifier,\n          functionality: workstream.functionality\n        })\n      );\n\n      const results = await Promise.all(createPromises);\n      const successCount = results.filter(r => r.data.success).length;\n      \n      if (successCount === importedWorkstreams.length) {\n        toast.success(`Successfully created ${successCount} workstream(s) from template`);\n        setShowImportPreview(false);\n        setImportedWorkstreams([]);\n        // Reload project objectives list\n        fetchProjectObjectives(0, false);\n      } else {\n        toast.error(`Created ${successCount} of ${importedWorkstreams.length} workstream(s)`);\n      }\n    } catch (error) {\n      const errorMessage = error.response?.data?.error || error.message || 'Failed to create workstream(s)';\n      toast.error(errorMessage);\n    } finally {\n      setImporting(false);\n    }\n  };\n\n  const renderWorkstreamForm = (workstream, index) => {\n    const isExpanded = expandedWorkstreams[workstream.id] !== false;\n    const searchTerm = projectObjectiveSearchTerms[workstream.id] || '';\n    const searchResults = projectObjectiveSearchResults[workstream.id] || [];\n    const loadingSearch = loadingProjectObjectiveSearch[workstream.id] || false;\n    const showDropdown = showProjectObjectiveDropdowns[workstream.id] || false;\n\n    return (\n      <div key={workstream.id} className=\"workstream-form-card\">\n        <div \n          className=\"create-workstream-header-section\"\n          onClick={() => toggleWorkstreamExpanded(workstream.id)}\n        >\n          <button\n            type=\"button\"\n            className=\"create-workstream-toggle\"\n            onClick={(e) => {\n              e.stopPropagation();\n              toggleWorkstreamExpanded(workstream.id);\n            }}\n          >\n            {isExpanded ? <ChevronUp size={18} /> : <ChevronDown size={18} />}\n          </button>\n          <span className=\"create-workstream-title-text\">\n            WorkStream {index + 1}{workstream.projectObjective ? ` - ${workstream.projectObjective}` : ''}\n          </span>\n          <div style={{ display: 'flex', gap: '8px', alignItems: 'center' }}>\n            <button\n              type=\"button\"\n              className=\"create-workstream-remove\"\n              onClick={(e) => {\n                e.stopPropagation();\n                handleCloneWorkstream(workstream.id);\n              }}\n              title=\"Clone workstream\"\n              style={{ background: 'transparent', border: 'none', cursor: 'pointer', padding: '4px', display: 'flex', alignItems: 'center' }}\n            >\n              <Copy size={16} style={{ color: '#0176d3' }} />\n            </button>\n            {workstreams.length > 1 && (\n              <button\n                type=\"button\"\n                className=\"create-workstream-remove\"\n                onClick={(e) => {\n                  e.stopPropagation();\n                  removeWorkstream(workstream.id);\n                }}\n                title=\"Remove workstream\"\n              >\n                <Trash2 size={16} />\n              </button>\n            )}\n          </div>\n        </div>\n\n        {isExpanded && (\n          <div className=\"workstream-form-content\">\n            <div className=\"form-section-card\">\n              <div className=\"form-grid-two-column\">\n                <div className=\"form-column\">\n                  <div className=\"form-group\">\n                    <label>Project Workstream Name</label>\n                    <input\n                      type=\"text\"\n                      value={workstream.projectWorkstreamName}\n                      onChange={(e) => handleInputChange(workstream.id, 'projectWorkstreamName', e.target.value)}\n                      className=\"form-input-compact\"\n                    />\n                  </div>\n\n                  <div className=\"form-group\">\n                    <label>\n                      Project Objective <span className=\"required\">*</span>\n                    </label>\n                    <div className={`project-objective-search-container project-objective-search-container-${workstream.id}`}>\n                      <div className=\"search-input-wrapper\">\n                        <Search size={14} className=\"search-icon\" />\n                        <input\n                          type=\"text\"\n                          placeholder=\"Search for project objective...\"\n                          value={workstream.projectObjectiveId ? workstream.projectObjective : searchTerm}\n                          readOnly={!!workstream.projectObjectiveId}\n                          onChange={(e) => {\n                            // Only allow changes if no objective is selected\n                            if (!workstream.projectObjectiveId) {\n                              handleSearchTermChange(workstream.id, e.target.value);\n                            }\n                          }}\n                          onFocus={() => {\n                            // If there's a selection, allow clearing it\n                            if (workstream.projectObjectiveId) {\n                              // User can click X button to clear\n                            } else if (searchResults.length > 0) {\n                              setShowProjectObjectiveDropdowns(prev => ({ ...prev, [workstream.id]: true }));\n                            }\n                          }}\n                          onClick={() => {\n                            // If there's a selection and user clicks, don't clear automatically\n                            // They need to use the X button\n                            if (!workstream.projectObjectiveId && searchResults.length > 0) {\n                              setShowProjectObjectiveDropdowns(prev => ({ ...prev, [workstream.id]: true }));\n                            }\n                          }}\n                          className=\"form-input-compact search-input\"\n                          style={workstream.projectObjectiveId ? { cursor: 'default' } : {}}\n                        />\n                        {workstream.projectObjectiveId && (\n                          <button\n                            type=\"button\"\n                            onClick={() => handleClearProjectObjective(workstream.id)}\n                            className=\"clear-button\"\n                            title=\"Clear selection\"\n                          >\n                            <X size={14} />\n                          </button>\n                        )}\n                      </div>\n                      {loadingSearch && (\n                        <div className=\"searching-indicator\">Searching...</div>\n                      )}\n                      {showDropdown && searchResults.length > 0 && !workstream.projectObjectiveId && (\n                        <div className=\"search-results-dropdown\">\n                          {searchResults.map((objective) => (\n                            <div\n                              key={objective.id}\n                              onClick={() => handleProjectObjectiveSelect(workstream.id, objective)}\n                              className={`search-result-item ${workstream.projectObjectiveId === objective.id ? 'selected' : ''}`}\n                            >\n                              <div className=\"search-result-name\">\n                                {objective.contributorFacingProjectName || objective.name}\n                              </div>\n                              {objective.projectName && (\n                                <div className=\"search-result-subtitle\">\n                                  Project: {objective.projectName}\n                                </div>\n                              )}\n                            </div>\n                          ))}\n                        </div>\n                      )}\n                    </div>\n                  </div>\n\n                  <div className=\"form-group\" style={{ marginTop: '6px' }}>\n                    <label className=\"checkbox-label\" style={{ marginBottom: 0 }}>\n                      <input\n                        type=\"checkbox\"\n                        checked={workstream.refresh}\n                        onChange={(e) => handleInputChange(workstream.id, 'refresh', e.target.checked)}\n                        className=\"checkbox-input\"\n                        style={{ marginRight: '8px', marginTop: '0', verticalAlign: 'middle' }}\n                      />\n                      <span className=\"checkbox-text\" style={{ verticalAlign: 'middle' }}>Refresh</span>\n                      <Info size={12} className=\"info-icon\" style={{ marginLeft: '6px', verticalAlign: 'middle' }} />\n                    </label>\n                  </div>\n                </div>\n\n                <div className=\"form-column\">\n                  <div className=\"form-group\">\n                    <label>\n                      Delivery Tool Name <span className=\"required\">*</span>\n                    </label>\n                    <select\n                      value={workstream.deliveryToolName}\n                      onChange={(e) => handleInputChange(workstream.id, 'deliveryToolName', e.target.value)}\n                      className=\"form-input-compact\"\n                      required\n                    >\n                      <option value=\"\">--None--</option>\n                      {deliveryToolNameOptions.filter(opt => opt !== '--None--').map((option) => (\n                        <option key={option} value={option}>{option}</option>\n                      ))}\n                    </select>\n                  </div>\n\n                  <div className=\"form-group\">\n                    <label>\n                      Client Workstream Identifier <span className=\"required\">*</span>\n                      <Info size={12} className=\"info-icon\" />\n                    </label>\n                    <input\n                      type=\"text\"\n                      value={workstream.clientWorkstreamIdentifier}\n                      onChange={(e) => handleInputChange(workstream.id, 'clientWorkstreamIdentifier', e.target.value)}\n                      className=\"form-input-compact\"\n                      required\n                    />\n                  </div>\n\n                  <div className=\"form-group\">\n                    <label>\n                      Functionality <span className=\"required\">*</span>\n                      <Info size={12} className=\"info-icon\" />\n                    </label>\n                    <select\n                      value={workstream.functionality}\n                      onChange={(e) => handleInputChange(workstream.id, 'functionality', e.target.value)}\n                      className=\"form-input-compact\"\n                      required\n                    >\n                      <option value=\"\">--None--</option>\n                      {functionalityOptions.filter(opt => opt !== '--None--').map((option) => (\n                        <option key={option} value={option}>{option}</option>\n                      ))}\n                    </select>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        )}\n      </div>\n    );\n  };\n\n  const content = (\n    <div className=\"create-workstream-content\">\n      {!showForm ? (\n        <>\n          {/* Header with Add Workstream button */}\n          <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '12px', marginTop: '8px', paddingTop: '8px', flexWrap: 'wrap', gap: '12px' }}>\n            <h2 style={{ margin: '0 0 8px 0', fontSize: '18px', fontWeight: 600, color: '#002329' }}>\n              Project Objectives Without Workstreams\n            </h2>\n            <div style={{ display: 'flex', gap: '8px', alignItems: 'center', flexWrap: 'wrap' }}>\n              <button\n                type=\"button\"\n                className=\"btn-secondary\"\n                onClick={handleDownloadTemplate}\n                style={{ display: 'flex', alignItems: 'center', gap: '6px' }}\n                title=\"Download template for workstream creation\"\n              >\n                <FileText size={16} />\n                Download Template\n              </button>\n              <label\n                className=\"btn-secondary\"\n                style={{ display: 'flex', alignItems: 'center', gap: '6px', cursor: 'pointer', margin: 0 }}\n                title=\"Import template file\"\n              >\n                <Upload size={16} />\n                Import Template\n                <input\n                  type=\"file\"\n                  accept=\".xlsx,.xls\"\n                  onChange={handleImportTemplate}\n                  style={{ display: 'none' }}\n                />\n              </label>\n              <button\n                type=\"button\"\n                className=\"btn-primary\"\n                onClick={handleAddWorkstream}\n                style={{ display: 'flex', alignItems: 'center', gap: '8px' }}\n              >\n                <Plus size={16} />\n                Add Workstream\n              </button>\n            </div>\n          </div>\n\n          {/* Filter Section */}\n          <div style={{ display: 'flex', gap: '12px', alignItems: 'center', marginBottom: '16px' }}>\n            <label style={{ fontSize: '14px', fontWeight: 500, color: '#002329' }}>\n              Filter by Status:\n            </label>\n            <select\n              value={statusFilter}\n              onChange={(e) => setStatusFilter(e.target.value)}\n              style={{\n                fontSize: '14px',\n                padding: '8px 12px',\n                border: '1px solid var(--border-color)',\n                borderRadius: 'var(--radius-md)',\n                background: 'var(--surface)',\n                color: 'var(--text-primary)',\n                minWidth: '180px',\n                cursor: 'pointer',\n                fontFamily: 'Poppins'\n              }}\n            >\n              <option value=\"\">All Status</option>\n              {uniqueStatuses.map(status => (\n                <option key={status} value={status}>{status}</option>\n              ))}\n            </select>\n            {statusFilter && (\n              <button\n                type=\"button\"\n                onClick={() => setStatusFilter('')}\n                style={{\n                  fontSize: '13px',\n                  padding: '6px 12px',\n                  background: 'transparent',\n                  border: '1px solid var(--border-color)',\n                  borderRadius: 'var(--radius-md)',\n                  color: 'var(--text-secondary)',\n                  cursor: 'pointer',\n                  fontFamily: 'Poppins'\n                }}\n              >\n                Clear Filter\n              </button>\n            )}\n          </div>\n\n          {/* Project Objectives Table */}\n          {loadingPOs && allProjectObjectives.length === 0 ? (\n            <div style={{ textAlign: 'center', padding: '40px' }}>\n              <Loader className=\"spinning\" size={24} />\n              <p>Loading project objectives...</p>\n            </div>\n          ) : (\n            <div className=\"project-objectives-table-container\" style={{ maxHeight: '70vh', overflowY: 'auto' }}>\n              <table className=\"project-objectives-table\" style={{ width: '100%' }}>\n                <thead>\n                  <tr>\n                    <th>Project Objective</th>\n                    <th>Associated Project</th>\n                    <th>Project Objective Status</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  {projectObjectives.length === 0 ? (\n                    <tr>\n                      <td colSpan=\"3\" className=\"no-data\" style={{ textAlign: 'center', padding: '40px' }}>\n                        No project objectives without workstreams found\n                      </td>\n                    </tr>\n                  ) : (\n                    projectObjectives.map((po, index) => (\n                      <tr key={po.id || index}>\n                        <td>{po.name || '--'}</td>\n                        <td>{po.projectName || '--'}</td>\n                        <td>{po.status || '--'}</td>\n                      </tr>\n                    ))\n                  )}\n                </tbody>\n              </table>\n              \n              {/* Show More Button and Loading States */}\n              {((poHasMore || allProjectObjectives.length >= 1000) && !loadingMorePOs && allProjectObjectives.length > 0 && !loadingPOs) && (\n                <div style={{ textAlign: 'center', padding: '20px', borderTop: '1px solid var(--border-color)' }}>\n                  <button\n                    type=\"button\"\n                    className=\"btn-secondary\"\n                    onClick={() => fetchProjectObjectives(poOffset, true)}\n                    style={{\n                      display: 'inline-flex',\n                      alignItems: 'center',\n                      gap: '8px',\n                      padding: '10px 24px',\n                      fontSize: '14px',\n                      fontWeight: 600\n                    }}\n                  >\n                    <Plus size={16} />\n                    Show More ({allProjectObjectives.length} loaded{poHasMore ? ', more available' : ''})\n                  </button>\n                  <div style={{ marginTop: '8px', fontSize: '12px', color: '#666' }}>\n                    Click to load next 1000 project objectives\n                  </div>\n                </div>\n              )}\n              \n              {loadingMorePOs && (\n                <div style={{ textAlign: 'center', padding: '20px', borderTop: '1px solid var(--border-color)' }}>\n                  <Loader className=\"spinning\" size={16} />\n                  <span style={{ marginLeft: '8px' }}>Loading more project objectives...</span>\n                </div>\n              )}\n              \n              {/* Infinite scroll trigger (backup - hidden but still functional) */}\n              {poHasMore && !loadingMorePOs && (\n                <div\n                  ref={infiniteScrollRef}\n                  style={{ height: '20px', width: '100%' }}\n                />\n              )}\n              \n              {allProjectObjectives.length > 0 && !poHasMore && (\n                <div style={{ textAlign: 'center', padding: '16px', borderTop: '1px solid var(--border-color)', color: '#666', fontSize: '13px' }}>\n                  {statusFilter ? (\n                    <>Showing {projectObjectives.length} of {allProjectObjectives.length} project objectives (filtered by status: {statusFilter})</>\n                  ) : (\n                    <>All {allProjectObjectives.length} project objectives loaded</>\n                  )}\n                </div>\n              )}\n            </div>\n          )}\n        </>\n      ) : (\n        <form onSubmit={handleSubmit} className=\"create-workstream-form\">\n          <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '16px' }}>\n            <h2 style={{ margin: 0, fontSize: '18px', fontWeight: 600, color: '#002329' }}>\n              Create Workstream\n            </h2>\n            <button\n              type=\"button\"\n              className=\"btn-secondary\"\n              onClick={() => setShowForm(false)}\n            >\n              Back to List\n            </button>\n          </div>\n\n          <div style={{ marginBottom: '16px', display: 'flex', gap: '12px', alignItems: 'center', flexWrap: 'wrap' }}>\n            <button\n              type=\"button\"\n              className=\"btn-primary\"\n              onClick={addWorkstream}\n              style={{ display: 'flex', alignItems: 'center', gap: '8px' }}\n            >\n              <Plus size={16} />\n              Add WorkStream\n            </button>\n            <button\n              type=\"button\"\n              className=\"btn-secondary\"\n              onClick={handleSaveTemplate}\n              disabled={workstreams.length === 0}\n              style={{ display: 'flex', alignItems: 'center', gap: '8px' }}\n              title=\"Save current workstreams as template\"\n            >\n              <Save size={16} />\n              Save Template\n            </button>\n            <button\n              type=\"button\"\n              className=\"btn-secondary\"\n              onClick={() => setShowLoadTemplateModal(true)}\n              disabled={savedTemplates.length === 0}\n              style={{ display: 'flex', alignItems: 'center', gap: '8px' }}\n              title=\"Load a saved template\"\n            >\n              <FolderOpen size={16} />\n              Load Template\n            </button>\n          </div>\n\n          {workstreams.map((workstream, index) => renderWorkstreamForm(workstream, index))}\n\n          <div className=\"form-actions\">\n            <button\n              type=\"button\"\n              className=\"btn-secondary\"\n              onClick={handleCancel}\n            >\n              Cancel\n            </button>\n            <button\n              type=\"submit\"\n              className=\"btn-primary\"\n              disabled={submitting}\n            >\n              {submitting ? 'Creating...' : `Create ${workstreams.length} WorkStream${workstreams.length > 1 ? 's' : ''}`}\n            </button>\n          </div>\n        </form>\n      )}\n\n      {/* Save Template Modal */}\n      {showTemplateModal && (\n        <div style={{\n          position: 'fixed',\n          top: 0,\n          left: 0,\n          right: 0,\n          bottom: 0,\n          background: 'rgba(0, 0, 0, 0.5)',\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n          zIndex: 1000\n        }}>\n          <div style={{\n            background: 'white',\n            padding: '24px',\n            borderRadius: '8px',\n            minWidth: '400px',\n            maxWidth: '500px'\n          }}>\n            <h3 style={{ margin: '0 0 16px 0', fontSize: '18px', fontWeight: 600 }}>Save Template</h3>\n            <div style={{ marginBottom: '16px' }}>\n              <label style={{ display: 'block', marginBottom: '8px', fontSize: '14px', fontWeight: 500 }}>\n                Template Name:\n              </label>\n              <input\n                type=\"text\"\n                value={templateName}\n                onChange={(e) => setTemplateName(e.target.value)}\n                placeholder=\"Enter template name\"\n                style={{\n                  width: '100%',\n                  padding: '8px 12px',\n                  border: '1px solid var(--border-color)',\n                  borderRadius: '4px',\n                  fontSize: '14px'\n                }}\n                autoFocus\n                onKeyPress={(e) => {\n                  if (e.key === 'Enter') {\n                    confirmSaveTemplate();\n                  }\n                }}\n              />\n            </div>\n            <div style={{ display: 'flex', gap: '12px', justifyContent: 'flex-end' }}>\n              <button\n                type=\"button\"\n                className=\"btn-secondary\"\n                onClick={() => {\n                  setShowTemplateModal(false);\n                  setTemplateName('');\n                }}\n              >\n                Cancel\n              </button>\n              <button\n                type=\"button\"\n                className=\"btn-primary\"\n                onClick={confirmSaveTemplate}\n                disabled={!templateName.trim()}\n              >\n                Save\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Load Template Modal */}\n      {showLoadTemplateModal && (\n        <div style={{\n          position: 'fixed',\n          top: 0,\n          left: 0,\n          right: 0,\n          bottom: 0,\n          background: 'rgba(0, 0, 0, 0.5)',\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n          zIndex: 1000\n        }}>\n          <div style={{\n            background: 'white',\n            padding: '24px',\n            borderRadius: '8px',\n            minWidth: '500px',\n            maxWidth: '600px',\n            maxHeight: '80vh',\n            overflow: 'auto'\n          }}>\n            <h3 style={{ margin: '0 0 16px 0', fontSize: '18px', fontWeight: 600 }}>Load Template</h3>\n            {savedTemplates.length === 0 ? (\n              <p style={{ color: '#666', fontSize: '14px' }}>No saved templates found.</p>\n            ) : (\n              <div style={{ display: 'flex', flexDirection: 'column', gap: '12px' }}>\n                {savedTemplates.map((template) => (\n                  <div\n                    key={template.id}\n                    style={{\n                      padding: '12px',\n                      border: '1px solid var(--border-color)',\n                      borderRadius: '4px',\n                      display: 'flex',\n                      justifyContent: 'space-between',\n                      alignItems: 'center'\n                    }}\n                  >\n                    <div>\n                      <div style={{ fontWeight: 500, fontSize: '14px', marginBottom: '4px' }}>\n                        {template.name}\n                      </div>\n                      <div style={{ fontSize: '12px', color: '#666' }}>\n                        {template.workstreams.length} workstream(s) • Created {new Date(template.createdAt).toLocaleDateString()}\n                      </div>\n                    </div>\n                    <div style={{ display: 'flex', gap: '8px' }}>\n                      <button\n                        type=\"button\"\n                        className=\"btn-primary\"\n                        onClick={() => handleLoadTemplate(template)}\n                        style={{ fontSize: '12px', padding: '6px 12px' }}\n                      >\n                        Load\n                      </button>\n                      <button\n                        type=\"button\"\n                        className=\"btn-secondary\"\n                        onClick={() => handleDeleteTemplate(template.id)}\n                        style={{ fontSize: '12px', padding: '6px 12px', color: '#d32f2f' }}\n                        title=\"Delete template\"\n                      >\n                        <Trash2 size={14} />\n                      </button>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            )}\n            <div style={{ display: 'flex', justifyContent: 'flex-end', marginTop: '16px' }}>\n              <button\n                type=\"button\"\n                className=\"btn-secondary\"\n                onClick={() => setShowLoadTemplateModal(false)}\n              >\n                Close\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n\n  // Import Preview Modal (shared between both render paths)\n  const importPreviewModal = showImportPreview && (\n        <div style={{\n          position: 'fixed',\n          top: 0,\n          left: 0,\n          right: 0,\n          bottom: 0,\n          background: 'rgba(0, 0, 0, 0.5)',\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n          zIndex: 9999\n        }}>\n          <div style={{\n            background: 'white',\n            padding: '24px',\n            borderRadius: '8px',\n            minWidth: '800px',\n            maxWidth: '90vw',\n            maxHeight: '90vh',\n            display: 'flex',\n            flexDirection: 'column'\n          }}>\n            <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '16px' }}>\n              <h3 style={{ margin: 0, fontSize: '18px', fontWeight: 600 }}>Import Preview</h3>\n              <button\n                onClick={() => {\n                  setShowImportPreview(false);\n                  setImportedWorkstreams([]);\n                  setResolvingObjectives(false);\n                }}\n                style={{\n                  background: 'none',\n                  border: 'none',\n                  cursor: 'pointer',\n                  padding: '4px',\n                  display: 'flex',\n                  alignItems: 'center'\n                }}\n              >\n                <X size={20} />\n              </button>\n            </div>\n            \n            {resolvingObjectives && (\n              <div style={{ padding: '12px', background: '#f0f9ff', borderRadius: '4px', marginBottom: '16px', display: 'flex', alignItems: 'center', gap: '8px' }}>\n                <Loader className=\"spinning\" size={16} style={{ color: '#08979C' }} />\n                <span style={{ fontSize: '13px', color: '#0369a1' }}>Resolving project objectives...</span>\n              </div>\n            )}\n            \n            <div style={{ flex: 1, overflow: 'auto', marginBottom: '16px' }}>\n              <table style={{ width: '100%', borderCollapse: 'collapse', fontSize: '13px' }}>\n                <thead>\n                  <tr>\n                    <th>Project Workstream Name</th>\n                    <th>Project Objective</th>\n                    <th>Delivery Tool Name</th>\n                    <th>Client Workstream Identifier</th>\n                    <th>Functionality</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  {importedWorkstreams.map((ws, index) => {\n                    const error = validateWorkstream(ws);\n                    return (\n                      <tr key={index} style={{ background: error ? '#fee' : 'white' }}>\n                        <td style={{ padding: '8px', border: '1px solid #e5e7eb' }}>{ws.projectWorkstreamName || '--'}</td>\n                        <td style={{ padding: '8px', border: '1px solid #e5e7eb' }}>{ws.projectObjective || '--'}</td>\n                        <td style={{ padding: '8px', border: '1px solid #e5e7eb' }}>{ws.deliveryToolName || '--'}</td>\n                        <td style={{ padding: '8px', border: '1px solid #e5e7eb' }}>{ws.clientWorkstreamIdentifier || '--'}</td>\n                        <td style={{ padding: '8px', border: '1px solid #e5e7eb' }}>\n                          {ws.functionality || '--'}\n                          {error && <div style={{ fontSize: '11px', color: '#c33', marginTop: '4px' }}>{error}</div>}\n                        </td>\n                      </tr>\n                    );\n                  })}\n                </tbody>\n              </table>\n            </div>\n            \n            <div style={{ display: 'flex', justifyContent: 'flex-end', gap: '8px' }}>\n              <button\n                onClick={() => {\n                  setShowImportPreview(false);\n                  setImportedWorkstreams([]);\n                }}\n                className=\"btn-secondary\"\n              >\n                Cancel\n              </button>\n              <button\n                onClick={handleCreateFromImport}\n                disabled={importing || importedWorkstreams.some(ws => validateWorkstream(ws))}\n                className=\"btn-primary\"\n              >\n                {importing ? 'Creating...' : `Create ${importedWorkstreams.length} Workstream(s)`}\n              </button>\n            </div>\n          </div>\n        </div>\n      );\n\n  if (hideHeader) {\n    return (\n      <>\n        <div className=\"create-workstream-content-wrapper\">{content}</div>\n        {importPreviewModal}\n      </>\n    );\n  }\n\n  return (\n    <div className=\"dashboard-layout\">\n      <Sidebar isOpen={sidebarOpen} toggleSidebar={() => setSidebarOpen(!sidebarOpen)} />\n      \n      <div className=\"create-workstream\" style={{ marginLeft: `${sidebarWidth}px`, width: `calc(100% - ${sidebarWidth}px)`, transition: 'margin-left 0.2s ease, width 0.2s ease' }}>\n        <div className=\"create-workstream-container\">\n          <div className=\"create-workstream-header\">\n            <div className=\"header-content\">\n              <div className=\"header-left\">\n                <button \n                  className=\"header-menu-toggle\"\n                  onClick={() => setSidebarOpen(!sidebarOpen)}\n                  aria-label=\"Toggle sidebar\"\n                >\n                  <Menu size={20} />\n                </button>\n                <div>\n                  <h1 className=\"page-title\">New Project Workstream</h1>\n                  <p className=\"page-subtitle\">Create a new project workstream</p>\n                </div>\n              </div>\n              <div className=\"header-user-profile\">\n                <div className=\"user-profile\">\n                  <div className=\"user-avatar\">\n                    {(user?.email || 'U').charAt(0).toUpperCase()}\n                  </div>\n                  <span className=\"user-name\">{user?.email || 'User'}</span>\n                  <button className=\"logout-btn\" onClick={logout} title=\"Logout\">\n                    <LogOut size={18} />\n                  </button>\n                </div>\n              </div>\n            </div>\n          </div>\n          {content}\n        </div>\n      </div>\n      {importPreviewModal}\n    </div>\n  );\n};\n\nexport default CreateWorkStream;\n"],"mappings":"wIAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,CAAEC,MAAM,CAAEC,WAAW,KAAQ,OAAO,CACvE,OAASC,OAAO,KAAQ,wBAAwB,CAChD,MAAO,CAAAC,OAAO,KAAM,uBAAuB,CAC3C,MAAO,CAAAC,eAAe,KAAM,0BAA0B,CACtD,OAASC,IAAI,CAAEC,MAAM,CAAEC,MAAM,CAAEC,CAAC,CAAEC,IAAI,CAAEC,IAAI,CAAEC,WAAW,CAAEC,SAAS,CAAEC,MAAM,CAAEC,MAAM,CAAEC,IAAI,CAAEC,IAAI,CAAEC,UAAU,CAAEC,QAAQ,CAAEC,MAAM,CAAEC,QAAQ,KAAQ,cAAc,CAC9J,MAAO,CAAAC,SAAS,KAAM,eAAe,CACrC,MAAO,CAAAC,KAAK,KAAM,iBAAiB,CACnC,MAAO,GAAK,CAAAC,IAAI,KAAM,MAAM,CAC5B,MAAO,gCAAgC,CACvC,MAAO,uBAAuB,CAC9B,MAAO,4BAA4B,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,CAAAC,QAAA,IAAAC,SAAA,yBAEpC,KAAM,CAAAC,gBAAgB,CAAGC,IAAA,EAA4B,IAA3B,CAAEC,UAAU,CAAG,KAAM,CAAC,CAAAD,IAAA,CAC9C,KAAM,CAAEE,IAAI,CAAEC,MAAO,CAAC,CAAGhC,OAAO,CAAC,CAAC,CAClC,KAAM,CAACiC,WAAW,CAAEC,cAAc,CAAC,CAAGtC,QAAQ,CAAC,IAAI,CAAC,CACpD,KAAM,CAAAuC,YAAY,CAAGjC,eAAe,CAAC+B,WAAW,CAAC,CACjD,KAAM,CAACG,UAAU,CAAEC,aAAa,CAAC,CAAGzC,QAAQ,CAAC,KAAK,CAAC,CACnD,KAAM,CAAC0C,QAAQ,CAAEC,WAAW,CAAC,CAAG3C,QAAQ,CAAC,KAAK,CAAC,CAAE;AAEjD;AACA,KAAM,CAAC4C,iBAAiB,CAAEC,oBAAoB,CAAC,CAAG7C,QAAQ,CAAC,EAAE,CAAC,CAC9D,KAAM,CAAC8C,oBAAoB,CAAEC,uBAAuB,CAAC,CAAG/C,QAAQ,CAAC,EAAE,CAAC,CAAE;AACtE,KAAM,CAACgD,UAAU,CAAEC,aAAa,CAAC,CAAGjD,QAAQ,CAAC,IAAI,CAAC,CAClD,KAAM,CAACkD,QAAQ,CAAEC,WAAW,CAAC,CAAGnD,QAAQ,CAAC,CAAC,CAAC,CAC3C,KAAM,CAACoD,SAAS,CAAEC,YAAY,CAAC,CAAGrD,QAAQ,CAAC,IAAI,CAAC,CAChD,KAAM,CAACsD,cAAc,CAAEC,iBAAiB,CAAC,CAAGvD,QAAQ,CAAC,KAAK,CAAC,CAC3D,KAAM,CAAAwD,iBAAiB,CAAGtD,MAAM,CAAC,IAAI,CAAC,CACtC,KAAM,CAACuD,YAAY,CAAEC,eAAe,CAAC,CAAG1D,QAAQ,CAAC,EAAE,CAAC,CAAE;AAEtD;AACA,KAAM,CAAC2D,WAAW,CAAEC,cAAc,CAAC,CAAG5D,QAAQ,CAAC,CAC7C,CACE6D,EAAE,CAAEC,IAAI,CAACC,GAAG,CAAC,CAAC,CACdC,qBAAqB,CAAE,EAAE,CACzBC,gBAAgB,CAAE,EAAE,CACpBC,kBAAkB,CAAE,EAAE,CACtBC,OAAO,CAAE,KAAK,CACdC,gBAAgB,CAAE,EAAE,CACpBC,0BAA0B,CAAE,EAAE,CAC9BC,aAAa,CAAE,EACjB,CAAC,CACF,CAAC,CAEF;AACA,KAAM,CAACC,mBAAmB,CAAEC,sBAAsB,CAAC,CAAGxE,QAAQ,CAAC,CAAE,CAAC8D,IAAI,CAACC,GAAG,CAAC,CAAC,EAAG,IAAK,CAAC,CAAC,CAEtF;AACA,KAAM,CAACU,cAAc,CAAEC,iBAAiB,CAAC,CAAG1E,QAAQ,CAAC,EAAE,CAAC,CACxD,KAAM,CAAC2E,iBAAiB,CAAEC,oBAAoB,CAAC,CAAG5E,QAAQ,CAAC,KAAK,CAAC,CACjE,KAAM,CAAC6E,YAAY,CAAEC,eAAe,CAAC,CAAG9E,QAAQ,CAAC,EAAE,CAAC,CACpD,KAAM,CAAC+E,qBAAqB,CAAEC,wBAAwB,CAAC,CAAGhF,QAAQ,CAAC,KAAK,CAAC,CACzE,KAAM,CAACiF,iBAAiB,CAAEC,oBAAoB,CAAC,CAAGlF,QAAQ,CAAC,KAAK,CAAC,CACjE,KAAM,CAACmF,mBAAmB,CAAEC,sBAAsB,CAAC,CAAGpF,QAAQ,CAAC,EAAE,CAAC,CAClE,KAAM,CAACqF,SAAS,CAAEC,YAAY,CAAC,CAAGtF,QAAQ,CAAC,KAAK,CAAC,CACjD,KAAM,CAACuF,mBAAmB,CAAEC,sBAAsB,CAAC,CAAGxF,QAAQ,CAAC,KAAK,CAAC,CAErE;AACA,KAAM,CAACyF,2BAA2B,CAAEC,8BAA8B,CAAC,CAAG1F,QAAQ,CAAC,CAAC,CAAC,CAAC,CAClF,KAAM,CAAC2F,6BAA6B,CAAEC,gCAAgC,CAAC,CAAG5F,QAAQ,CAAC,CAAC,CAAC,CAAC,CACtF,KAAM,CAAC6F,6BAA6B,CAAEC,gCAAgC,CAAC,CAAG9F,QAAQ,CAAC,CAAC,CAAC,CAAC,CACtF,KAAM,CAAC+F,6BAA6B,CAAEC,gCAAgC,CAAC,CAAGhG,QAAQ,CAAC,CAAC,CAAC,CAAC,CACtF,KAAM,CAAAiG,iCAAiC,CAAG/F,MAAM,CAAC,CAAC,CAAC,CAAC,CACpD,KAAM,CAAAgG,mBAAmB,CAAGhG,MAAM,CAAC,CAAC,CAAC,CAAC,CAAE;AAExC;AACA,KAAM,CAAAiG,sBAAsB,CAAGhG,WAAW,CAAC,gBAAsC,IAA/B,CAAAiG,MAAM,CAAAC,SAAA,CAAAC,MAAA,IAAAD,SAAA,MAAAE,SAAA,CAAAF,SAAA,IAAG,CAAC,IAAE,CAAAG,MAAM,CAAAH,SAAA,CAAAC,MAAA,IAAAD,SAAA,MAAAE,SAAA,CAAAF,SAAA,IAAG,KAAK,CAC1E,GAAI,CACF,GAAID,MAAM,GAAK,CAAC,CAAE,CAChBnD,aAAa,CAAC,IAAI,CAAC,CACrB,CAAC,IAAM,CACLM,iBAAiB,CAAC,IAAI,CAAC,CACzB,CAEA,KAAM,CAAAkD,QAAQ,CAAG,KAAM,CAAAlF,SAAS,CAACmF,GAAG,CAAC,oDAAoD,CAAE,CACzFC,MAAM,CAAE,CAAEC,KAAK,CAAE,IAAI,CAAER,MAAO,CAAC,CAC/BS,OAAO,CAAE,MAAO;AAClB,CAAC,CAAC,CAEF,GAAIJ,QAAQ,CAACK,IAAI,CAACC,OAAO,CAAE,CACzB,KAAM,CAAAC,MAAM,CAAGP,QAAQ,CAACK,IAAI,CAAClE,iBAAiB,CAC9C,GAAI4D,MAAM,CAAE,CACVzD,uBAAuB,CAACkE,IAAI,EAAI,CAAC,GAAGA,IAAI,CAAE,GAAGD,MAAM,CAAC,CAAC,CACvD,CAAC,IAAM,CACLjE,uBAAuB,CAACiE,MAAM,CAAC,CAC/B7D,WAAW,CAAC,CAAC,CAAC,CAAE;AAClB,CAEA;AACA,KAAM,CAAA+D,SAAS,CAAGV,MAAM,CAAGtD,QAAQ,CAAG8D,MAAM,CAACV,MAAM,CAAGU,MAAM,CAACV,MAAM,CACnEnD,WAAW,CAAC+D,SAAS,CAAC,CAEtB;AACA;AACA,KAAM,CAAAC,cAAc,CAAGV,QAAQ,CAACK,IAAI,CAACM,OAAO,EAAIJ,MAAM,CAACV,MAAM,GAAK,IAAI,CACtEjD,YAAY,CAAC8D,cAAc,CAAC,CAC9B,CACF,CAAE,MAAOE,KAAK,CAAE,KAAAC,eAAA,CAAAC,oBAAA,CACd/F,KAAK,CAAC6F,KAAK,CAAC,EAAAC,eAAA,CAAAD,KAAK,CAACZ,QAAQ,UAAAa,eAAA,kBAAAC,oBAAA,CAAdD,eAAA,CAAgBR,IAAI,UAAAS,oBAAA,iBAApBA,oBAAA,CAAsBF,KAAK,GAAI,oCAAoC,CAAC,CAClF,CAAC,OAAS,CACRpE,aAAa,CAAC,KAAK,CAAC,CACpBM,iBAAiB,CAAC,KAAK,CAAC,CAC1B,CACF,CAAC,CAAE,EAAE,CAAC,CAEN;AACAtD,SAAS,CAAC,IAAM,CACd,GAAI,CACF,KAAM,CAAAuH,KAAK,CAAGC,YAAY,CAACC,OAAO,CAAC,qBAAqB,CAAC,CACzD,GAAIF,KAAK,CAAE,CACT9C,iBAAiB,CAACiD,IAAI,CAACC,KAAK,CAACJ,KAAK,CAAC,CAAC,CACtC,CACF,CAAE,MAAOH,KAAK,CAAE,CACdQ,OAAO,CAACR,KAAK,CAAC,0BAA0B,CAAEA,KAAK,CAAC,CAClD,CACF,CAAC,CAAE,EAAE,CAAC,CAEN;AACApH,SAAS,CAAC,IAAM,CACd,GAAI,CAACyC,QAAQ,CAAE,CACbyD,sBAAsB,CAAC,CAAC,CAAE,KAAK,CAAC,CAClC,CACF,CAAC,CAAE,CAACzD,QAAQ,CAAEyD,sBAAsB,CAAC,CAAC,CAEtC;AACAlG,SAAS,CAAC,IAAM,CACd,KAAM,CAAA6H,QAAQ,CAAG,GAAI,CAAAC,oBAAoB,CACtCC,OAAO,EAAK,CACX,GAAIA,OAAO,CAAC,CAAC,CAAC,CAACC,cAAc,EAAI7E,SAAS,EAAI,CAACE,cAAc,EAAI,CAACZ,QAAQ,CAAE,CAC1EyD,sBAAsB,CAACjD,QAAQ,CAAE,IAAI,CAAC,CACxC,CACF,CAAC,CACD,CAAEgF,SAAS,CAAE,GAAI,CACnB,CAAC,CAED,GAAI1E,iBAAiB,CAAC2E,OAAO,CAAE,CAC7BL,QAAQ,CAACM,OAAO,CAAC5E,iBAAiB,CAAC2E,OAAO,CAAC,CAC7C,CAEA,MAAO,IAAM,CACX,GAAI3E,iBAAiB,CAAC2E,OAAO,CAAE,CAC7BL,QAAQ,CAACO,SAAS,CAAC7E,iBAAiB,CAAC2E,OAAO,CAAC,CAC/C,CACF,CAAC,CACH,CAAC,CAAE,CAAC/E,SAAS,CAAEE,cAAc,CAAEJ,QAAQ,CAAER,QAAQ,CAAEyD,sBAAsB,CAAC,CAAC,CAE3E;AACAlG,SAAS,CAAC,IAAM,CACd,GAAIwD,YAAY,GAAK,EAAE,CAAE,CACvBZ,oBAAoB,CAACC,oBAAoB,CAAC,CAC5C,CAAC,IAAM,CACLD,oBAAoB,CAACC,oBAAoB,CAACwF,MAAM,CAACC,EAAE,EAAIA,EAAE,CAACC,MAAM,GAAK/E,YAAY,CAAC,CAAC,CACrF,CACF,CAAC,CAAE,CAACA,YAAY,CAAEX,oBAAoB,CAAC,CAAC,CAExC;AACA,KAAM,CAAA2F,cAAc,CAAGC,KAAK,CAACC,IAAI,CAAC,GAAI,CAAAC,GAAG,CAAC9F,oBAAoB,CAAC+F,GAAG,CAACN,EAAE,EAAIA,EAAE,CAACC,MAAM,CAAC,CAACF,MAAM,CAACQ,CAAC,EAAIA,CAAC,EAAIA,CAAC,GAAK,IAAI,CAAC,CAAC,CAAC,CAACC,IAAI,CAAC,CAAC,CAEzH;AACA,KAAM,CAAAC,uBAAuB,CAAG,CAC9B,UAAU,CACV,IAAI,CACJ,MAAM,CACN,WAAW,CACX,eAAe,CACf,UAAU,CACV,UAAU,CACV,MAAM,CACN,QAAQ,CACR,OAAO,CACP,UAAU,CACV,KAAK,CACL,WAAW,CACX,MAAM,CACN,MAAM,CACN,WAAW,CACZ,CAED;AACA,KAAM,CAAAC,oBAAoB,CAAG,CAC3B,UAAU,CACV,eAAe,CACf,8BAA8B,CAC9B,cAAc,CACf,CAED;AACAhJ,SAAS,CAAC,IAAM,CACd,KAAM,CAAAiJ,kBAAkB,CAAIC,KAAK,EAAK,CACpCC,MAAM,CAACC,IAAI,CAACtD,6BAA6B,CAAC,CAACuD,OAAO,CAACC,YAAY,EAAI,CACjE,GAAIxD,6BAA6B,CAACwD,YAAY,CAAC,EAAI,CAACJ,KAAK,CAACK,MAAM,CAACC,OAAO,wCAAAC,MAAA,CAAwCH,YAAY,CAAE,CAAC,CAAE,CAC/HvD,gCAAgC,CAACiB,IAAI,EAAA0C,aAAA,CAAAA,aAAA,IAChC1C,IAAI,MACP,CAACsC,YAAY,EAAG,KAAK,EACrB,CAAC,CACL,CACF,CAAC,CAAC,CACJ,CAAC,CAEDK,QAAQ,CAACC,gBAAgB,CAAC,WAAW,CAAEX,kBAAkB,CAAC,CAC1D,MAAO,IAAM,CACXU,QAAQ,CAACE,mBAAmB,CAAC,WAAW,CAAEZ,kBAAkB,CAAC,CAC/D,CAAC,CACH,CAAC,CAAE,CAACnD,6BAA6B,CAAC,CAAC,CAEnC;AACA9F,SAAS,CAAC,IAAM,CACdmJ,MAAM,CAACC,IAAI,CAAC5D,2BAA2B,CAAC,CAAC6D,OAAO,CAACC,YAAY,EAAI,CAC/D,KAAM,CAAAQ,UAAU,CAAGtE,2BAA2B,CAAC8D,YAAY,CAAC,CAC5D,KAAM,CAAAS,UAAU,CAAGrG,WAAW,CAACsG,IAAI,CAACC,CAAC,EAAIA,CAAC,CAACrG,EAAE,GAAK0F,YAAY,CAAC,CAE/D;AACA,GAAItD,iCAAiC,CAACkC,OAAO,CAACoB,YAAY,CAAC,CAAE,CAC3DY,YAAY,CAAClE,iCAAiC,CAACkC,OAAO,CAACoB,YAAY,CAAC,CAAC,CACrE,MAAO,CAAAtD,iCAAiC,CAACkC,OAAO,CAACoB,YAAY,CAAC,CAChE,CAEA;AACA;AACA,GAAIS,UAAU,EAAIA,UAAU,CAAC9F,kBAAkB,CAAE,CAC/C0B,gCAAgC,CAACqB,IAAI,EAAA0C,aAAA,CAAAA,aAAA,IAAU1C,IAAI,MAAE,CAACsC,YAAY,EAAG,EAAE,EAAG,CAAC,CAC3EvD,gCAAgC,CAACiB,IAAI,EAAA0C,aAAA,CAAAA,aAAA,IAAU1C,IAAI,MAAE,CAACsC,YAAY,EAAG,KAAK,EAAG,CAAC,CAC9EzD,gCAAgC,CAACmB,IAAI,EAAA0C,aAAA,CAAAA,aAAA,IAAU1C,IAAI,MAAE,CAACsC,YAAY,EAAG,KAAK,EAAG,CAAC,CAC9E,OACF,CAEA;AACA,GAAI,CAACQ,UAAU,EAAIA,UAAU,CAACK,IAAI,CAAC,CAAC,GAAK,EAAE,CAAE,CAC3CxE,gCAAgC,CAACqB,IAAI,EAAA0C,aAAA,CAAAA,aAAA,IAAU1C,IAAI,MAAE,CAACsC,YAAY,EAAG,EAAE,EAAG,CAAC,CAC3EvD,gCAAgC,CAACiB,IAAI,EAAA0C,aAAA,CAAAA,aAAA,IAAU1C,IAAI,MAAE,CAACsC,YAAY,EAAG,KAAK,EAAG,CAAC,CAC9EzD,gCAAgC,CAACmB,IAAI,EAAA0C,aAAA,CAAAA,aAAA,IAAU1C,IAAI,MAAE,CAACsC,YAAY,EAAG,KAAK,EAAG,CAAC,CAC9E,OACF,CAEA;AACA,KAAM,CAAAc,eAAe,CAAGnE,mBAAmB,CAACiC,OAAO,CAACoB,YAAY,CAAC,CACjE,GAAIc,eAAe,CAAE,CACnB,KAAM,CAAAC,kBAAkB,CAAGxG,IAAI,CAACC,GAAG,CAAC,CAAC,CAAGsG,eAAe,CAACE,SAAS,CACjE,GAAID,kBAAkB,CAAG,IAAI,CAAE,CAC7B;AACA1E,gCAAgC,CAACqB,IAAI,EAAA0C,aAAA,CAAAA,aAAA,IAAU1C,IAAI,MAAE,CAACsC,YAAY,EAAG,EAAE,EAAG,CAAC,CAC3EvD,gCAAgC,CAACiB,IAAI,EAAA0C,aAAA,CAAAA,aAAA,IAAU1C,IAAI,MAAE,CAACsC,YAAY,EAAG,KAAK,EAAG,CAAC,CAC9EzD,gCAAgC,CAACmB,IAAI,EAAA0C,aAAA,CAAAA,aAAA,IAAU1C,IAAI,MAAE,CAACsC,YAAY,EAAG,KAAK,EAAG,CAAC,CAC9E,OACF,CACF,CAEA;AACAtD,iCAAiC,CAACkC,OAAO,CAACoB,YAAY,CAAC,CAAGiB,UAAU,CAAC,SAAY,CAC/E;AACA,KAAM,CAAAC,iBAAiB,CAAGhF,2BAA2B,CAAC8D,YAAY,CAAC,CACnE,GAAI,CAACkB,iBAAiB,EAAIA,iBAAiB,CAACL,IAAI,CAAC,CAAC,GAAK,EAAE,CAAE,CACzD,OACF,CAEA;AACA,KAAM,CAAAM,iBAAiB,CAAG/G,WAAW,CAACsG,IAAI,CAACC,CAAC,EAAIA,CAAC,CAACrG,EAAE,GAAK0F,YAAY,CAAC,CACtE,GAAImB,iBAAiB,EAAIA,iBAAiB,CAACxG,kBAAkB,CAAE,CAC7D;AACA0B,gCAAgC,CAACqB,IAAI,EAAA0C,aAAA,CAAAA,aAAA,IAAU1C,IAAI,MAAE,CAACsC,YAAY,EAAG,EAAE,EAAG,CAAC,CAC3EvD,gCAAgC,CAACiB,IAAI,EAAA0C,aAAA,CAAAA,aAAA,IAAU1C,IAAI,MAAE,CAACsC,YAAY,EAAG,KAAK,EAAG,CAAC,CAC9EzD,gCAAgC,CAACmB,IAAI,EAAA0C,aAAA,CAAAA,aAAA,IAAU1C,IAAI,MAAE,CAACsC,YAAY,EAAG,KAAK,EAAG,CAAC,CAC9E,OACF,CAEA;AACA,KAAM,CAAAoB,sBAAsB,CAAGzE,mBAAmB,CAACiC,OAAO,CAACoB,YAAY,CAAC,CACxE,GAAIoB,sBAAsB,CAAE,CAC1B,KAAM,CAAAL,kBAAkB,CAAGxG,IAAI,CAACC,GAAG,CAAC,CAAC,CAAG4G,sBAAsB,CAACJ,SAAS,CACxE,GAAID,kBAAkB,CAAG,IAAI,CAAE,CAC7B;AACA1E,gCAAgC,CAACqB,IAAI,EAAA0C,aAAA,CAAAA,aAAA,IAAU1C,IAAI,MAAE,CAACsC,YAAY,EAAG,EAAE,EAAG,CAAC,CAC3EvD,gCAAgC,CAACiB,IAAI,EAAA0C,aAAA,CAAAA,aAAA,IAAU1C,IAAI,MAAE,CAACsC,YAAY,EAAG,KAAK,EAAG,CAAC,CAC9EzD,gCAAgC,CAACmB,IAAI,EAAA0C,aAAA,CAAAA,aAAA,IAAU1C,IAAI,MAAE,CAACsC,YAAY,EAAG,KAAK,EAAG,CAAC,CAC9E,OACF,CACF,CAEAzD,gCAAgC,CAACmB,IAAI,EAAA0C,aAAA,CAAAA,aAAA,IAAU1C,IAAI,MAAE,CAACsC,YAAY,EAAG,IAAI,EAAG,CAAC,CAC7E,GAAI,CACF,KAAM,CAAA9C,QAAQ,CAAG,KAAM,CAAAlF,SAAS,CAACmF,GAAG,iDAAAgD,MAAA,CAAiDkB,kBAAkB,CAACH,iBAAiB,CAAC,CAAE,CAAC,CAC7H,GAAIhE,QAAQ,CAACK,IAAI,CAACC,OAAO,CAAE,CACzB;AACA,KAAM,CAAA8D,eAAe,CAAGlH,WAAW,CAACsG,IAAI,CAACC,CAAC,EAAIA,CAAC,CAACrG,EAAE,GAAK0F,YAAY,CAAC,CACpE,GAAIsB,eAAe,EAAIA,eAAe,CAAC3G,kBAAkB,CAAE,CACzD;AACA0B,gCAAgC,CAACqB,IAAI,EAAA0C,aAAA,CAAAA,aAAA,IAAU1C,IAAI,MAAE,CAACsC,YAAY,EAAG,EAAE,EAAG,CAAC,CAC3EvD,gCAAgC,CAACiB,IAAI,EAAA0C,aAAA,CAAAA,aAAA,IAAU1C,IAAI,MAAE,CAACsC,YAAY,EAAG,KAAK,EAAG,CAAC,CAC9EzD,gCAAgC,CAACmB,IAAI,EAAA0C,aAAA,CAAAA,aAAA,IAAU1C,IAAI,MAAE,CAACsC,YAAY,EAAG,KAAK,EAAG,CAAC,CAC9E,OACF,CAEA;AACA,KAAM,CAAAuB,oBAAoB,CAAG5E,mBAAmB,CAACiC,OAAO,CAACoB,YAAY,CAAC,CACtE,GAAIuB,oBAAoB,CAAE,CACxB,KAAM,CAAAR,kBAAkB,CAAGxG,IAAI,CAACC,GAAG,CAAC,CAAC,CAAG+G,oBAAoB,CAACP,SAAS,CACtE,GAAID,kBAAkB,CAAG,IAAI,CAAE,CAC7B;AACA1E,gCAAgC,CAACqB,IAAI,EAAA0C,aAAA,CAAAA,aAAA,IAAU1C,IAAI,MAAE,CAACsC,YAAY,EAAG,EAAE,EAAG,CAAC,CAC3EvD,gCAAgC,CAACiB,IAAI,EAAA0C,aAAA,CAAAA,aAAA,IAAU1C,IAAI,MAAE,CAACsC,YAAY,EAAG,KAAK,EAAG,CAAC,CAC9EzD,gCAAgC,CAACmB,IAAI,EAAA0C,aAAA,CAAAA,aAAA,IAAU1C,IAAI,MAAE,CAACsC,YAAY,EAAG,KAAK,EAAG,CAAC,CAC9E,OACF,CACF,CAEA;AACA3D,gCAAgC,CAACqB,IAAI,EAAA0C,aAAA,CAAAA,aAAA,IAAU1C,IAAI,MAAE,CAACsC,YAAY,EAAG9C,QAAQ,CAACK,IAAI,CAAClE,iBAAiB,EAAI,EAAE,EAAG,CAAC,CAC9GoD,gCAAgC,CAACiB,IAAI,EAAA0C,aAAA,CAAAA,aAAA,IAAU1C,IAAI,MAAE,CAACsC,YAAY,EAAG,IAAI,EAAG,CAAC,CAC/E,CACF,CAAE,MAAOlC,KAAK,CAAE,CACdzB,gCAAgC,CAACqB,IAAI,EAAA0C,aAAA,CAAAA,aAAA,IAAU1C,IAAI,MAAE,CAACsC,YAAY,EAAG,EAAE,EAAG,CAAC,CAC7E,CAAC,OAAS,CACRzD,gCAAgC,CAACmB,IAAI,EAAA0C,aAAA,CAAAA,aAAA,IAAU1C,IAAI,MAAE,CAACsC,YAAY,EAAG,KAAK,EAAG,CAAC,CAChF,CACF,CAAC,CAAE,GAAG,CAAC,CACT,CAAC,CAAC,CAEF,MAAO,IAAM,CACXH,MAAM,CAACC,IAAI,CAACpD,iCAAiC,CAACkC,OAAO,CAAC,CAACmB,OAAO,CAACC,YAAY,EAAI,CAC7E,GAAItD,iCAAiC,CAACkC,OAAO,CAACoB,YAAY,CAAC,CAAE,CAC3DY,YAAY,CAAClE,iCAAiC,CAACkC,OAAO,CAACoB,YAAY,CAAC,CAAC,CACrE,MAAO,CAAAtD,iCAAiC,CAACkC,OAAO,CAACoB,YAAY,CAAC,CAChE,CACF,CAAC,CAAC,CACJ,CAAC,CACH,CAAC,CAAE,CAAC9D,2BAA2B,CAAE9B,WAAW,CAAC,CAAC,CAE9C,KAAM,CAAAoH,4BAA4B,CAAGA,CAACxB,YAAY,CAAEyB,SAAS,GAAK,CAChE,KAAM,CAAAC,YAAY,CAAGD,SAAS,CAACE,4BAA4B,EAAIF,SAAS,CAACG,IAAI,CAE7E;AACA,GAAIlF,iCAAiC,CAACkC,OAAO,CAACoB,YAAY,CAAC,CAAE,CAC3DY,YAAY,CAAClE,iCAAiC,CAACkC,OAAO,CAACoB,YAAY,CAAC,CAAC,CACrE,MAAO,CAAAtD,iCAAiC,CAACkC,OAAO,CAACoB,YAAY,CAAC,CAChE,CAEA;AACArD,mBAAmB,CAACiC,OAAO,CAACoB,YAAY,CAAC,CAAG,CAC1C4B,IAAI,CAAEF,YAAY,CAClBV,SAAS,CAAEzG,IAAI,CAACC,GAAG,CAAC,CACtB,CAAC,CAED;AACAH,cAAc,CAACqD,IAAI,EAAIA,IAAI,CAAC4B,GAAG,CAACuC,EAAE,EAChCA,EAAE,CAACvH,EAAE,GAAK0F,YAAY,CAAAI,aAAA,CAAAA,aAAA,IAEbyB,EAAE,MACLnH,gBAAgB,CAAEgH,YAAY,CAC9B/G,kBAAkB,CAAE8G,SAAS,CAACnH,EAAE,GAElCuH,EACN,CAAC,CAAC,CAEF;AACA1F,8BAA8B,CAACuB,IAAI,EAAA0C,aAAA,CAAAA,aAAA,IAC9B1C,IAAI,MACP,CAACsC,YAAY,EAAG,EAAE,EAClB,CAAC,CAEH;AACAvD,gCAAgC,CAACiB,IAAI,EAAA0C,aAAA,CAAAA,aAAA,IAAU1C,IAAI,MAAE,CAACsC,YAAY,EAAG,KAAK,EAAG,CAAC,CAC9E3D,gCAAgC,CAACqB,IAAI,EAAA0C,aAAA,CAAAA,aAAA,IAAU1C,IAAI,MAAE,CAACsC,YAAY,EAAG,EAAE,EAAG,CAAC,CAC3EzD,gCAAgC,CAACmB,IAAI,EAAA0C,aAAA,CAAAA,aAAA,IAAU1C,IAAI,MAAE,CAACsC,YAAY,EAAG,KAAK,EAAG,CAAC,CAE9E;AACAiB,UAAU,CAAC,IAAM,CACf,GAAItE,mBAAmB,CAACiC,OAAO,CAACoB,YAAY,CAAC,CAAE,CAC7C,MAAO,CAAArD,mBAAmB,CAACiC,OAAO,CAACoB,YAAY,CAAC,CAClD,CACF,CAAC,CAAE,IAAI,CAAC,CACV,CAAC,CAED,KAAM,CAAA8B,2BAA2B,CAAI9B,YAAY,EAAK,CACpD3F,cAAc,CAACqD,IAAI,EAAIA,IAAI,CAAC4B,GAAG,CAACuC,EAAE,EAChCA,EAAE,CAACvH,EAAE,GAAK0F,YAAY,CAAAI,aAAA,CAAAA,aAAA,IAEbyB,EAAE,MACLnH,gBAAgB,CAAE,EAAE,CACpBC,kBAAkB,CAAE,EAAE,GAExBkH,EACN,CAAC,CAAC,CACF1F,8BAA8B,CAACuB,IAAI,EAAA0C,aAAA,CAAAA,aAAA,IAAU1C,IAAI,MAAE,CAACsC,YAAY,EAAG,EAAE,EAAG,CAAC,CACzE3D,gCAAgC,CAACqB,IAAI,EAAA0C,aAAA,CAAAA,aAAA,IAAU1C,IAAI,MAAE,CAACsC,YAAY,EAAG,EAAE,EAAG,CAAC,CAC3EvD,gCAAgC,CAACiB,IAAI,EAAA0C,aAAA,CAAAA,aAAA,IAAU1C,IAAI,MAAE,CAACsC,YAAY,EAAG,KAAK,EAAG,CAAC,CAChF,CAAC,CAED,KAAM,CAAA+B,iBAAiB,CAAGA,CAAC/B,YAAY,CAAEgC,KAAK,CAAEC,KAAK,GAAK,CACxD5H,cAAc,CAACqD,IAAI,EAAIA,IAAI,CAAC4B,GAAG,CAACuC,EAAE,EAChCA,EAAE,CAACvH,EAAE,GAAK0F,YAAY,CAAAI,aAAA,CAAAA,aAAA,IAAQyB,EAAE,MAAE,CAACG,KAAK,EAAGC,KAAK,GAAKJ,EACvD,CAAC,CAAC,CACJ,CAAC,CAED,KAAM,CAAAK,sBAAsB,CAAGA,CAAClC,YAAY,CAAEiC,KAAK,GAAK,CACtD9F,8BAA8B,CAACuB,IAAI,EAAA0C,aAAA,CAAAA,aAAA,IAC9B1C,IAAI,MACP,CAACsC,YAAY,EAAGiC,KAAK,EACrB,CAAC,CACH,GAAIA,KAAK,GAAK,EAAE,CAAE,CAChBH,2BAA2B,CAAC9B,YAAY,CAAC,CAC3C,CACF,CAAC,CAED,KAAM,CAAAmC,wBAAwB,CAAInC,YAAY,EAAK,CACjD/E,sBAAsB,CAACyC,IAAI,EAAA0C,aAAA,CAAAA,aAAA,IACtB1C,IAAI,MACP,CAACsC,YAAY,EAAG,CAACtC,IAAI,CAACsC,YAAY,CAAC,EACnC,CAAC,CACL,CAAC,CAED,KAAM,CAAAoC,aAAa,CAAGA,CAAA,GAAM,CAC1B,KAAM,CAAAC,KAAK,CAAG9H,IAAI,CAACC,GAAG,CAAC,CAAC,CACxBH,cAAc,CAACqD,IAAI,EAAI,CAAC,GAAGA,IAAI,CAAE,CAC/BpD,EAAE,CAAE+H,KAAK,CACT5H,qBAAqB,CAAE,EAAE,CACzBC,gBAAgB,CAAE,EAAE,CACpBC,kBAAkB,CAAE,EAAE,CACtBC,OAAO,CAAE,KAAK,CACdC,gBAAgB,CAAE,EAAE,CACpBC,0BAA0B,CAAE,EAAE,CAC9BC,aAAa,CAAE,EACjB,CAAC,CAAC,CAAC,CACHE,sBAAsB,CAACyC,IAAI,EAAA0C,aAAA,CAAAA,aAAA,IAAU1C,IAAI,MAAE,CAAC2E,KAAK,EAAG,IAAI,EAAG,CAAC,CAC5DlG,8BAA8B,CAACuB,IAAI,EAAA0C,aAAA,CAAAA,aAAA,IAAU1C,IAAI,MAAE,CAAC2E,KAAK,EAAG,EAAE,EAAG,CAAC,CACpE,CAAC,CAED,KAAM,CAAAC,gBAAgB,CAAItC,YAAY,EAAK,CACzC,GAAI5F,WAAW,CAAC2C,MAAM,GAAK,CAAC,CAAE,CAC5B9E,KAAK,CAAC6F,KAAK,CAAC,qCAAqC,CAAC,CAClD,OACF,CACAzD,cAAc,CAACqD,IAAI,EAAIA,IAAI,CAACqB,MAAM,CAAC8C,EAAE,EAAIA,EAAE,CAACvH,EAAE,GAAK0F,YAAY,CAAC,CAAC,CACjE/E,sBAAsB,CAACyC,IAAI,EAAI,CAC7B,KAAM,CAAA6E,QAAQ,CAAAnC,aAAA,IAAQ1C,IAAI,CAAE,CAC5B,MAAO,CAAA6E,QAAQ,CAACvC,YAAY,CAAC,CAC7B,MAAO,CAAAuC,QAAQ,CACjB,CAAC,CAAC,CACFpG,8BAA8B,CAACuB,IAAI,EAAI,CACrC,KAAM,CAAA6E,QAAQ,CAAAnC,aAAA,IAAQ1C,IAAI,CAAE,CAC5B,MAAO,CAAA6E,QAAQ,CAACvC,YAAY,CAAC,CAC7B,MAAO,CAAAuC,QAAQ,CACjB,CAAC,CAAC,CACFlG,gCAAgC,CAACqB,IAAI,EAAI,CACvC,KAAM,CAAA6E,QAAQ,CAAAnC,aAAA,IAAQ1C,IAAI,CAAE,CAC5B,MAAO,CAAA6E,QAAQ,CAACvC,YAAY,CAAC,CAC7B,MAAO,CAAAuC,QAAQ,CACjB,CAAC,CAAC,CACF9F,gCAAgC,CAACiB,IAAI,EAAI,CACvC,KAAM,CAAA6E,QAAQ,CAAAnC,aAAA,IAAQ1C,IAAI,CAAE,CAC5B,MAAO,CAAA6E,QAAQ,CAACvC,YAAY,CAAC,CAC7B,MAAO,CAAAuC,QAAQ,CACjB,CAAC,CAAC,CACF,GAAI7F,iCAAiC,CAACkC,OAAO,CAACoB,YAAY,CAAC,CAAE,CAC3DY,YAAY,CAAClE,iCAAiC,CAACkC,OAAO,CAACoB,YAAY,CAAC,CAAC,CACrE,MAAO,CAAAtD,iCAAiC,CAACkC,OAAO,CAACoB,YAAY,CAAC,CAChE,CACF,CAAC,CAED,KAAM,CAAAwC,kBAAkB,CAAI/B,UAAU,EAAK,CACzC;AACA,GAAI,CAACA,UAAU,CAAC9F,kBAAkB,GAAK,CAAC8F,UAAU,CAAC/F,gBAAgB,EAAI+F,UAAU,CAAC/F,gBAAgB,CAACmG,IAAI,CAAC,CAAC,GAAK,EAAE,CAAC,CAAE,CACjH,MAAO,+BAA+B,CACxC,CACA,GAAI,CAACJ,UAAU,CAAC5F,gBAAgB,EAAI4F,UAAU,CAAC5F,gBAAgB,GAAK,UAAU,EAAI4F,UAAU,CAAC5F,gBAAgB,CAACgG,IAAI,CAAC,CAAC,GAAK,EAAE,CAAE,CAC3H,MAAO,gCAAgC,CACzC,CACA,GAAI,CAACJ,UAAU,CAAC3F,0BAA0B,EAAI2F,UAAU,CAAC3F,0BAA0B,CAAC+F,IAAI,CAAC,CAAC,GAAK,EAAE,CAAE,CACjG,MAAO,0CAA0C,CACnD,CACA,GAAI,CAACJ,UAAU,CAAC1F,aAAa,EAAI0F,UAAU,CAAC1F,aAAa,GAAK,UAAU,EAAI0F,UAAU,CAAC1F,aAAa,CAAC8F,IAAI,CAAC,CAAC,GAAK,EAAE,CAAE,CAClH,MAAO,2BAA2B,CACpC,CACA,MAAO,KAAI,CACb,CAAC,CAED,KAAM,CAAA4B,YAAY,CAAG,KAAO,CAAAC,CAAC,EAAK,CAChCA,CAAC,CAACC,cAAc,CAAC,CAAC,CAElB;AACA,KAAM,CAAAC,gBAAgB,CAAG,EAAE,CAC3BxI,WAAW,CAAC2F,OAAO,CAAC,CAACU,UAAU,CAAEoC,KAAK,GAAK,CACzC,KAAM,CAAA/E,KAAK,CAAG0E,kBAAkB,CAAC/B,UAAU,CAAC,CAC5C,GAAI3C,KAAK,CAAE,CACT8E,gBAAgB,CAACE,IAAI,eAAA3C,MAAA,CAAe0C,KAAK,CAAG,CAAC,OAAA1C,MAAA,CAAKrC,KAAK,CAAE,CAAC,CAC5D,CACF,CAAC,CAAC,CAEF,GAAI8E,gBAAgB,CAAC7F,MAAM,CAAG,CAAC,CAAE,CAC/B9E,KAAK,CAAC6F,KAAK,CAAC8E,gBAAgB,CAAC,CAAC,CAAC,CAAC,CAChC,OACF,CAEA1J,aAAa,CAAC,IAAI,CAAC,CACnB,GAAI,CACF;AACA,KAAM,CAAA6J,cAAc,CAAG3I,WAAW,CAACkF,GAAG,CAACmB,UAAU,EAC/CzI,SAAS,CAACgL,IAAI,CAAC,oBAAoB,CAAE,CACnCvI,qBAAqB,CAAEgG,UAAU,CAAChG,qBAAqB,CACvDC,gBAAgB,CAAE+F,UAAU,CAAC/F,gBAAgB,CAC7CC,kBAAkB,CAAE8F,UAAU,CAAC9F,kBAAkB,CACjDC,OAAO,CAAE6F,UAAU,CAAC7F,OAAO,CAC3BC,gBAAgB,CAAE4F,UAAU,CAAC5F,gBAAgB,CAC7CC,0BAA0B,CAAE2F,UAAU,CAAC3F,0BAA0B,CACjEC,aAAa,CAAE0F,UAAU,CAAC1F,aAC5B,CAAC,CACH,CAAC,CAED,KAAM,CAAAkI,OAAO,CAAG,KAAM,CAAAC,OAAO,CAACC,GAAG,CAACJ,cAAc,CAAC,CACjD,KAAM,CAAAK,YAAY,CAAGH,OAAO,CAAClE,MAAM,CAACsE,CAAC,EAAIA,CAAC,CAAC9F,IAAI,CAACC,OAAO,CAAC,CAACT,MAAM,CAE/D,GAAIqG,YAAY,GAAKhJ,WAAW,CAAC2C,MAAM,CAAE,CACvC9E,KAAK,CAACuF,OAAO,yBAAA2C,MAAA,CAAyBiD,YAAY,kBAAgB,CAAC,CACnE;AACA,KAAM,CAAAf,KAAK,CAAG9H,IAAI,CAACC,GAAG,CAAC,CAAC,CACxBH,cAAc,CAAC,CAAC,CACdC,EAAE,CAAE+H,KAAK,CACT5H,qBAAqB,CAAE,EAAE,CACzBC,gBAAgB,CAAE,EAAE,CACpBC,kBAAkB,CAAE,EAAE,CACtBC,OAAO,CAAE,KAAK,CACdC,gBAAgB,CAAE,EAAE,CACpBC,0BAA0B,CAAE,EAAE,CAC9BC,aAAa,CAAE,EACjB,CAAC,CAAC,CAAC,CACHE,sBAAsB,CAAC,CAAE,CAACoH,KAAK,EAAG,IAAK,CAAC,CAAC,CACzClG,8BAA8B,CAAC,CAAE,CAACkG,KAAK,EAAG,EAAG,CAAC,CAAC,CAC/ChG,gCAAgC,CAAC,CAAC,CAAC,CAAC,CACpCI,gCAAgC,CAAC,CAAC,CAAC,CAAC,CACpCrD,WAAW,CAAC,KAAK,CAAC,CAClB;AACAwD,sBAAsB,CAAC,CAAC,CAAE,KAAK,CAAC,CAClC,CAAC,IAAM,CACL3E,KAAK,CAAC6F,KAAK,YAAAqC,MAAA,CAAYiD,YAAY,SAAAjD,MAAA,CAAO/F,WAAW,CAAC2C,MAAM,kBAAgB,CAAC,CAC/E,CACF,CAAE,MAAOe,KAAK,CAAE,KAAAwF,gBAAA,CAAAC,qBAAA,CACd,KAAM,CAAAC,YAAY,CAAG,EAAAF,gBAAA,CAAAxF,KAAK,CAACZ,QAAQ,UAAAoG,gBAAA,kBAAAC,qBAAA,CAAdD,gBAAA,CAAgB/F,IAAI,UAAAgG,qBAAA,iBAApBA,qBAAA,CAAsBzF,KAAK,GAAIA,KAAK,CAAC2F,OAAO,EAAI,gCAAgC,CACrGxL,KAAK,CAAC6F,KAAK,CAAC0F,YAAY,CAAC,CAC3B,CAAC,OAAS,CACRtK,aAAa,CAAC,KAAK,CAAC,CACtB,CACF,CAAC,CAED,KAAM,CAAAwK,YAAY,CAAGA,CAAA,GAAM,CACzB;AACA,KAAM,CAAArB,KAAK,CAAG9H,IAAI,CAACC,GAAG,CAAC,CAAC,CACxBH,cAAc,CAAC,CAAC,CACdC,EAAE,CAAE+H,KAAK,CACT5H,qBAAqB,CAAE,EAAE,CACzBC,gBAAgB,CAAE,EAAE,CACpBC,kBAAkB,CAAE,EAAE,CACtBC,OAAO,CAAE,KAAK,CACdC,gBAAgB,CAAE,EAAE,CACpBC,0BAA0B,CAAE,EAAE,CAC9BC,aAAa,CAAE,EACjB,CAAC,CAAC,CAAC,CACHE,sBAAsB,CAAC,CAAE,CAACoH,KAAK,EAAG,IAAK,CAAC,CAAC,CACzClG,8BAA8B,CAAC,CAAE,CAACkG,KAAK,EAAG,EAAG,CAAC,CAAC,CAC/ChG,gCAAgC,CAAC,CAAC,CAAC,CAAC,CACpCI,gCAAgC,CAAC,CAAC,CAAC,CAAC,CACpCrD,WAAW,CAAC,KAAK,CAAC,CAClB;AACAwD,sBAAsB,CAAC,CAAC,CAAE,KAAK,CAAC,CAClC,CAAC,CAED,KAAM,CAAA+G,mBAAmB,CAAGA,CAAA,GAAM,CAChCvK,WAAW,CAAC,IAAI,CAAC,CACnB,CAAC,CAED;AACA,KAAM,CAAAwK,kBAAkB,CAAGA,CAAA,GAAM,CAC/B,GAAIxJ,WAAW,CAAC2C,MAAM,GAAK,CAAC,CAAE,CAC5B9E,KAAK,CAAC6F,KAAK,CAAC,oCAAoC,CAAC,CACjD,OACF,CACAzC,oBAAoB,CAAC,IAAI,CAAC,CAC5B,CAAC,CAED,KAAM,CAAAwI,mBAAmB,CAAGA,CAAA,GAAM,CAChC,GAAI,CAACvI,YAAY,CAACuF,IAAI,CAAC,CAAC,CAAE,CACxB5I,KAAK,CAAC6F,KAAK,CAAC,8BAA8B,CAAC,CAC3C,OACF,CAEA,GAAI,CACF,KAAM,CAAAgG,QAAQ,CAAG,CACfxJ,EAAE,CAAEC,IAAI,CAACC,GAAG,CAAC,CAAC,CACdoH,IAAI,CAAEtG,YAAY,CAACuF,IAAI,CAAC,CAAC,CACzBkD,SAAS,CAAE,GAAI,CAAAxJ,IAAI,CAAC,CAAC,CAACyJ,WAAW,CAAC,CAAC,CACnC5J,WAAW,CAAEA,WAAW,CAACkF,GAAG,CAACuC,EAAE,GAAK,CAClCpH,qBAAqB,CAAEoH,EAAE,CAACpH,qBAAqB,CAC/CC,gBAAgB,CAAEmH,EAAE,CAACnH,gBAAgB,CACrCC,kBAAkB,CAAEkH,EAAE,CAAClH,kBAAkB,CACzCC,OAAO,CAAEiH,EAAE,CAACjH,OAAO,CACnBC,gBAAgB,CAAEgH,EAAE,CAAChH,gBAAgB,CACrCC,0BAA0B,CAAE+G,EAAE,CAAC/G,0BAA0B,CACzDC,aAAa,CAAE8G,EAAE,CAAC9G,aACpB,CAAC,CAAC,CACJ,CAAC,CAED,KAAM,CAAAkJ,gBAAgB,CAAG,CAAC,GAAG/I,cAAc,CAAE4I,QAAQ,CAAC,CACtD3I,iBAAiB,CAAC8I,gBAAgB,CAAC,CACnC/F,YAAY,CAACgG,OAAO,CAAC,qBAAqB,CAAE9F,IAAI,CAAC+F,SAAS,CAACF,gBAAgB,CAAC,CAAC,CAC7EhM,KAAK,CAACuF,OAAO,CAAC,6BAA6B,CAAC,CAC5CnC,oBAAoB,CAAC,KAAK,CAAC,CAC3BE,eAAe,CAAC,EAAE,CAAC,CACrB,CAAE,MAAOuC,KAAK,CAAE,CACdQ,OAAO,CAACR,KAAK,CAAC,wBAAwB,CAAEA,KAAK,CAAC,CAC9C7F,KAAK,CAAC6F,KAAK,CAAC,yBAAyB,CAAC,CACxC,CACF,CAAC,CAED;AACA,KAAM,CAAAsG,kBAAkB,CAAIN,QAAQ,EAAK,CACvC,GAAI,CACF,KAAM,CAAAO,cAAc,CAAGP,QAAQ,CAAC1J,WAAW,CAACkF,GAAG,CAAC,CAACuC,EAAE,CAAEgB,KAAK,GAAAzC,aAAA,EACxD9F,EAAE,CAAEC,IAAI,CAACC,GAAG,CAAC,CAAC,CAAGqI,KAAK,EACnBhB,EAAE,CACL,CAAC,CACHxH,cAAc,CAACgK,cAAc,CAAC,CAC9BpJ,sBAAsB,CAACoJ,cAAc,CAACC,MAAM,CAAC,CAACC,GAAG,CAAE1C,EAAE,GAAK,CACxD0C,GAAG,CAAC1C,EAAE,CAACvH,EAAE,CAAC,CAAG,IAAI,CACjB,MAAO,CAAAiK,GAAG,CACZ,CAAC,CAAE,CAAC,CAAC,CAAC,CAAC,CACP9I,wBAAwB,CAAC,KAAK,CAAC,CAC/BxD,KAAK,CAACuF,OAAO,eAAA2C,MAAA,CAAc2D,QAAQ,CAAClC,IAAI,0BAAuB,CAAC,CAClE,CAAE,MAAO9D,KAAK,CAAE,CACdQ,OAAO,CAACR,KAAK,CAAC,yBAAyB,CAAEA,KAAK,CAAC,CAC/C7F,KAAK,CAAC6F,KAAK,CAAC,yBAAyB,CAAC,CACxC,CACF,CAAC,CAED;AACA,KAAM,CAAA0G,oBAAoB,CAAIC,UAAU,EAAK,CAC3C,GAAI,CACF,KAAM,CAAAR,gBAAgB,CAAG/I,cAAc,CAAC6D,MAAM,CAAC2F,CAAC,EAAIA,CAAC,CAACpK,EAAE,GAAKmK,UAAU,CAAC,CACxEtJ,iBAAiB,CAAC8I,gBAAgB,CAAC,CACnC/F,YAAY,CAACgG,OAAO,CAAC,qBAAqB,CAAE9F,IAAI,CAAC+F,SAAS,CAACF,gBAAgB,CAAC,CAAC,CAC7EhM,KAAK,CAACuF,OAAO,CAAC,+BAA+B,CAAC,CAChD,CAAE,MAAOM,KAAK,CAAE,CACdQ,OAAO,CAACR,KAAK,CAAC,0BAA0B,CAAEA,KAAK,CAAC,CAChD7F,KAAK,CAAC6F,KAAK,CAAC,2BAA2B,CAAC,CAC1C,CACF,CAAC,CAED;AACA,KAAM,CAAA6G,qBAAqB,CAAI3E,YAAY,EAAK,CAC9C,KAAM,CAAA4E,iBAAiB,CAAGxK,WAAW,CAACsG,IAAI,CAACmB,EAAE,EAAIA,EAAE,CAACvH,EAAE,GAAK0F,YAAY,CAAC,CACxE,GAAI,CAAC4E,iBAAiB,CAAE,OAExB,KAAM,CAAAC,gBAAgB,CAAAzE,aAAA,CAAAA,aAAA,IACjBwE,iBAAiB,MACpBtK,EAAE,CAAEC,IAAI,CAACC,GAAG,CAAC,CAAC,CACdC,qBAAqB,IAAA0F,MAAA,CAAKyE,iBAAiB,CAACnK,qBAAqB,WAAS,CAC1EC,gBAAgB,CAAE,EAAE,CACpBC,kBAAkB,CAAE,EAAE,EACvB,CAEDN,cAAc,CAACqD,IAAI,EAAI,CAAC,GAAGA,IAAI,CAAEmH,gBAAgB,CAAC,CAAC,CACnD5J,sBAAsB,CAACyC,IAAI,EAAA0C,aAAA,CAAAA,aAAA,IAAU1C,IAAI,MAAE,CAACmH,gBAAgB,CAACvK,EAAE,EAAG,IAAI,EAAG,CAAC,CAC1ErC,KAAK,CAACuF,OAAO,CAAC,gCAAgC,CAAC,CACjD,CAAC,CAED;AACA,KAAM,CAAAsH,sBAAsB,CAAGA,CAAA,GAAM,CACnC,GAAI,CACF,KAAM,CAAAC,YAAY,CAAG,CACnB,CACE,yBAAyB,CAAE,sBAAsB,CACjD,wBAAwB,CAAE,2BAA2B,CACrD,sBAAsB,CAAE,EAAE,CAC1B,oBAAoB,CAAE,OAAO,CAC7B,8BAA8B,CAAE,QAAQ,CACxC,eAAe,CAAE,gBAAgB,CACjC,SAAS,CAAE,KACb,CAAC,CACD,CACE,yBAAyB,CAAE,sBAAsB,CACjD,wBAAwB,CAAE,6BAA6B,CACvD,sBAAsB,CAAE,EAAE,CAC1B,oBAAoB,CAAE,OAAO,CAC7B,8BAA8B,CAAE,QAAQ,CACxC,eAAe,CAAE,gBAAgB,CACjC,SAAS,CAAE,KACb,CAAC,CACF,CAED,KAAM,CAAAlD,EAAE,CAAG3J,IAAI,CAAC8M,KAAK,CAACC,aAAa,CAACF,YAAY,CAAC,CACjD,KAAM,CAAAG,EAAE,CAAGhN,IAAI,CAAC8M,KAAK,CAACG,QAAQ,CAAC,CAAC,CAChCjN,IAAI,CAAC8M,KAAK,CAACI,iBAAiB,CAACF,EAAE,CAAErD,EAAE,CAAE,qBAAqB,CAAC,CAC3D3J,IAAI,CAACmN,SAAS,CAACH,EAAE,iCAAA/E,MAAA,CAAkC,GAAI,CAAA5F,IAAI,CAAC,CAAC,CAACyJ,WAAW,CAAC,CAAC,CAACsB,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,SAAO,CAAC,CACjGrN,KAAK,CAACuF,OAAO,CAAC,kCAAkC,CAAC,CACnD,CAAE,MAAOM,KAAK,CAAE,CACdQ,OAAO,CAACR,KAAK,CAAC,6BAA6B,CAAEA,KAAK,CAAC,CACnD7F,KAAK,CAAC6F,KAAK,CAAC,6BAA6B,CAAC,CAC5C,CACF,CAAC,CAED;AACA,KAAM,CAAAyH,oBAAoB,CAAG,KAAO,CAAA3F,KAAK,EAAK,CAC5C,KAAM,CAAA4F,IAAI,CAAG5F,KAAK,CAACK,MAAM,CAACwF,KAAK,CAAC,CAAC,CAAC,CAClC,GAAI,CAACD,IAAI,CAAE,OAEX,KAAM,CAAAE,MAAM,CAAG,GAAI,CAAAC,UAAU,CAAC,CAAC,CAC/BD,MAAM,CAACE,MAAM,CAAG,KAAO,CAAAlD,CAAC,EAAK,CAC3B,GAAI,CACF,KAAM,CAAAnF,IAAI,CAAG,GAAI,CAAAsI,UAAU,CAACnD,CAAC,CAACzC,MAAM,CAAC6F,MAAM,CAAC,CAC5C,KAAM,CAAAC,QAAQ,CAAG7N,IAAI,CAAC8N,IAAI,CAACzI,IAAI,CAAE,CAAE0I,IAAI,CAAE,OAAQ,CAAC,CAAC,CACnD,KAAM,CAAAC,cAAc,CAAGH,QAAQ,CAACI,UAAU,CAAC,CAAC,CAAC,CAC7C,KAAM,CAAAC,SAAS,CAAGL,QAAQ,CAACM,MAAM,CAACH,cAAc,CAAC,CACjD,KAAM,CAAAI,QAAQ,CAAGpO,IAAI,CAAC8M,KAAK,CAACuB,aAAa,CAACH,SAAS,CAAC,CAEpD,GAAIE,QAAQ,CAACvJ,MAAM,GAAK,CAAC,CAAE,CACzB9E,KAAK,CAAC6F,KAAK,CAAC,wBAAwB,CAAC,CACrC,OACF,CAEA;AACA,GAAI,CAAA0I,QAAQ,CAAGF,QAAQ,CAAChH,GAAG,CAAC,CAACmH,GAAG,CAAE5D,KAAK,IAAM,CAC3CvI,EAAE,CAAEC,IAAI,CAACC,GAAG,CAAC,CAAC,CAAGqI,KAAK,CACtBpI,qBAAqB,CAAEgM,GAAG,CAAC,yBAAyB,CAAC,EAAIA,GAAG,CAAC,uBAAuB,CAAC,EAAI,EAAE,CAC3F/L,gBAAgB,CAAE+L,GAAG,CAAC,wBAAwB,CAAC,EAAIA,GAAG,CAAC,kBAAkB,CAAC,EAAIA,GAAG,CAAC,mBAAmB,CAAC,EAAI,EAAE,CAC5G9L,kBAAkB,CAAE8L,GAAG,CAAC,sBAAsB,CAAC,EAAIA,GAAG,CAAC,oBAAoB,CAAC,EAAI,EAAE,CAClF5L,gBAAgB,CAAE4L,GAAG,CAAC,oBAAoB,CAAC,EAAIA,GAAG,CAAC,kBAAkB,CAAC,EAAI,EAAE,CAC5E3L,0BAA0B,CAAE2L,GAAG,CAAC,8BAA8B,CAAC,EAAIA,GAAG,CAAC,4BAA4B,CAAC,EAAI,EAAE,CAC1G1L,aAAa,CAAE0L,GAAG,CAAC,eAAe,CAAC,EAAIA,GAAG,CAAC,eAAe,CAAC,EAAI,EAAE,CACjE7L,OAAO,CAAE6L,GAAG,CAAC,SAAS,CAAC,EAAIA,GAAG,CAAC,SAAS,CAAC,EAAI,KAC/C,CAAC,CAAC,CAAC,CAEH;AACA,KAAM,CAAAC,oBAAoB,CAAGF,QAAQ,CAACzH,MAAM,CAAC8C,EAAE,EAAIA,EAAE,CAACnH,gBAAgB,EAAI,CAACmH,EAAE,CAAClH,kBAAkB,CAAC,CACjG,GAAI+L,oBAAoB,CAAC3J,MAAM,CAAG,CAAC,CAAE,CACnCd,sBAAsB,CAAC,IAAI,CAAC,CAC5BhE,KAAK,CAAC,6CAA6C,CAAE,CAAE0O,IAAI,CAAE,GAAG,CAAEC,QAAQ,CAAE,IAAK,CAAC,CAAC,CAEnF;AACA,IAAK,KAAM,CAAA/E,EAAE,GAAI,CAAA6E,oBAAoB,CAAE,CACrC,GAAI,CACF,KAAM,CAAAlG,UAAU,CAAGqB,EAAE,CAACnH,gBAAgB,CAACmG,IAAI,CAAC,CAAC,CAC7C,GAAIL,UAAU,CAAE,CACd,KAAM,CAAAtD,QAAQ,CAAG,KAAM,CAAAlF,SAAS,CAACmF,GAAG,iDAAAgD,MAAA,CAAiDkB,kBAAkB,CAACb,UAAU,CAAC,CAAE,CAAC,CACtH,GAAItD,QAAQ,CAACK,IAAI,CAACC,OAAO,EAAIN,QAAQ,CAACK,IAAI,CAAClE,iBAAiB,EAAI6D,QAAQ,CAACK,IAAI,CAAClE,iBAAiB,CAAC0D,MAAM,CAAG,CAAC,CAAE,CAC1G;AACA,GAAI,CAAA8J,OAAO,CAAG3J,QAAQ,CAACK,IAAI,CAAClE,iBAAiB,CAACqH,IAAI,CAAC1B,EAAE,EACnDA,EAAE,CAAC4C,IAAI,GAAKpB,UAAU,EACtBxB,EAAE,CAAC2C,4BAA4B,GAAKnB,UAAU,EAC7CxB,EAAE,CAAC4C,IAAI,EAAI5C,EAAE,CAAC4C,IAAI,CAACkF,WAAW,CAAC,CAAC,GAAKtG,UAAU,CAACsG,WAAW,CAAC,CAAE,EAC9D9H,EAAE,CAAC2C,4BAA4B,EAAI3C,EAAE,CAAC2C,4BAA4B,CAACmF,WAAW,CAAC,CAAC,GAAKtG,UAAU,CAACsG,WAAW,CAAC,CAC/G,CAAC,CAED;AACA,GAAI,CAACD,OAAO,CAAE,CACZA,OAAO,CAAG3J,QAAQ,CAACK,IAAI,CAAClE,iBAAiB,CAAC,CAAC,CAAC,CAC9C,CAEA,GAAIwN,OAAO,CAAE,CACXhF,EAAE,CAAClH,kBAAkB,CAAGkM,OAAO,CAACvM,EAAE,CAClCuH,EAAE,CAACnH,gBAAgB,CAAGmM,OAAO,CAAClF,4BAA4B,EAAIkF,OAAO,CAACjF,IAAI,EAAIC,EAAE,CAACnH,gBAAgB,CACnG,CACF,CACF,CACF,CAAE,MAAOoD,KAAK,CAAE,CACdQ,OAAO,CAACR,KAAK,4CAAAqC,MAAA,CAA2C0B,EAAE,CAACnH,gBAAgB,QAAMoD,KAAK,CAAC,CACvF;AACF,CACF,CAEA7B,sBAAsB,CAAC,KAAK,CAAC,CAC/B,CAEAJ,sBAAsB,CAAC2K,QAAQ,CAAC,CAChC7K,oBAAoB,CAAC,IAAI,CAAC,CAC1B,KAAM,CAAAoL,aAAa,CAAGL,oBAAoB,CAAC3J,MAAM,CAAG,CAAC,CAAG2J,oBAAoB,CAAC3H,MAAM,CAAC8C,EAAE,EAAIA,EAAE,CAAClH,kBAAkB,CAAC,CAACoC,MAAM,CAAG,CAAC,CAC3H,GAAI2J,oBAAoB,CAAC3J,MAAM,CAAG,CAAC,CAAE,CACnC9E,KAAK,CAACuF,OAAO,aAAA2C,MAAA,CAAaqG,QAAQ,CAACzJ,MAAM,8BAAAoD,MAAA,CAA4B4G,aAAa,SAAA5G,MAAA,CAAOuG,oBAAoB,CAAC3J,MAAM,0BAAwB,CAAC,CAC/I,CAAC,IAAM,CACL9E,KAAK,CAACuF,OAAO,aAAA2C,MAAA,CAAaqG,QAAQ,CAACzJ,MAAM,gCAA8B,CAAC,CAC1E,CACF,CAAE,MAAOe,KAAK,CAAE,CACdQ,OAAO,CAACR,KAAK,CAAC,2BAA2B,CAAEA,KAAK,CAAC,CACjD7F,KAAK,CAAC6F,KAAK,CAAC,0DAA0D,CAAC,CACzE,CACF,CAAC,CACD4H,MAAM,CAACsB,iBAAiB,CAACxB,IAAI,CAAC,CAC9B;AACA5F,KAAK,CAACK,MAAM,CAACgC,KAAK,CAAG,EAAE,CACzB,CAAC,CAED;AACA,KAAM,CAAAgF,sBAAsB,CAAG,KAAAA,CAAA,GAAY,CACzC,GAAIrL,mBAAmB,CAACmB,MAAM,GAAK,CAAC,CAAE,CACpC9E,KAAK,CAAC6F,KAAK,CAAC,0BAA0B,CAAC,CACvC,OACF,CAEA;AACA,KAAM,CAAAoJ,UAAU,CAAGtL,mBAAmB,CAACmD,MAAM,CAAC8C,EAAE,EAAIA,EAAE,CAACnH,gBAAgB,EAAI,CAACmH,EAAE,CAAClH,kBAAkB,CAAC,CAClG,GAAIuM,UAAU,CAACnK,MAAM,CAAG,CAAC,CAAE,CACzB9E,KAAK,CAAC,2CAA2C,CAAE,CAAE0O,IAAI,CAAE,GAAI,CAAC,CAAC,CAEjE,IAAK,KAAM,CAAA9E,EAAE,GAAI,CAAAqF,UAAU,CAAE,CAC3B,GAAI,CACF,KAAM,CAAA1G,UAAU,CAAGqB,EAAE,CAACnH,gBAAgB,CAACmG,IAAI,CAAC,CAAC,CAC7C,GAAIL,UAAU,CAAE,CACd,KAAM,CAAAtD,QAAQ,CAAG,KAAM,CAAAlF,SAAS,CAACmF,GAAG,iDAAAgD,MAAA,CAAiDkB,kBAAkB,CAACb,UAAU,CAAC,CAAE,CAAC,CACtH,GAAItD,QAAQ,CAACK,IAAI,CAACC,OAAO,EAAIN,QAAQ,CAACK,IAAI,CAAClE,iBAAiB,EAAI6D,QAAQ,CAACK,IAAI,CAAClE,iBAAiB,CAAC0D,MAAM,CAAG,CAAC,CAAE,CAC1G;AACA,GAAI,CAAA8J,OAAO,CAAG3J,QAAQ,CAACK,IAAI,CAAClE,iBAAiB,CAACqH,IAAI,CAAC1B,EAAE,EACnDA,EAAE,CAAC4C,IAAI,GAAKpB,UAAU,EACtBxB,EAAE,CAAC2C,4BAA4B,GAAKnB,UAAU,EAC7CxB,EAAE,CAAC4C,IAAI,EAAI5C,EAAE,CAAC4C,IAAI,CAACkF,WAAW,CAAC,CAAC,GAAKtG,UAAU,CAACsG,WAAW,CAAC,CAAE,EAC9D9H,EAAE,CAAC2C,4BAA4B,EAAI3C,EAAE,CAAC2C,4BAA4B,CAACmF,WAAW,CAAC,CAAC,GAAKtG,UAAU,CAACsG,WAAW,CAAC,CAC/G,CAAC,CAED;AACA,GAAI,CAACD,OAAO,CAAE,CACZA,OAAO,CAAG3J,QAAQ,CAACK,IAAI,CAAClE,iBAAiB,CAAC,CAAC,CAAC,CAC9C,CAEA,GAAIwN,OAAO,CAAE,CACXhF,EAAE,CAAClH,kBAAkB,CAAGkM,OAAO,CAACvM,EAAE,CAClCuH,EAAE,CAACnH,gBAAgB,CAAGmM,OAAO,CAAClF,4BAA4B,EAAIkF,OAAO,CAACjF,IAAI,EAAIC,EAAE,CAACnH,gBAAgB,CACnG,CACF,CACF,CACF,CAAE,MAAOoD,KAAK,CAAE,CACdQ,OAAO,CAACR,KAAK,4CAAAqC,MAAA,CAA2C0B,EAAE,CAACnH,gBAAgB,QAAMoD,KAAK,CAAC,CACzF,CACF,CAEA;AACAjC,sBAAsB,CAAC,CAAC,GAAGD,mBAAmB,CAAC,CAAC,CAClD,CAEA;AACA,KAAM,CAAAgH,gBAAgB,CAAG,EAAE,CAC3BhH,mBAAmB,CAACmE,OAAO,CAAC,CAACU,UAAU,CAAEoC,KAAK,GAAK,CACjD,KAAM,CAAA/E,KAAK,CAAG0E,kBAAkB,CAAC/B,UAAU,CAAC,CAC5C,GAAI3C,KAAK,CAAE,CACT8E,gBAAgB,CAACE,IAAI,QAAA3C,MAAA,CAAQ0C,KAAK,CAAG,CAAC,OAAA1C,MAAA,CAAKrC,KAAK,CAAE,CAAC,CACrD,CACF,CAAC,CAAC,CAEF,GAAI8E,gBAAgB,CAAC7F,MAAM,CAAG,CAAC,CAAE,CAC/B9E,KAAK,CAAC6F,KAAK,CAAC8E,gBAAgB,CAAC,CAAC,CAAC,CAAC,CAChC,OACF,CAEA7G,YAAY,CAAC,IAAI,CAAC,CAClB,GAAI,CACF;AACA,KAAM,CAAAgH,cAAc,CAAGnH,mBAAmB,CAAC0D,GAAG,CAACmB,UAAU,EACvDzI,SAAS,CAACgL,IAAI,CAAC,oBAAoB,CAAE,CACnCvI,qBAAqB,CAAEgG,UAAU,CAAChG,qBAAqB,CACvDC,gBAAgB,CAAE+F,UAAU,CAAC/F,gBAAgB,CAC7CC,kBAAkB,CAAE8F,UAAU,CAAC9F,kBAAkB,CACjDC,OAAO,CAAE6F,UAAU,CAAC7F,OAAO,CAC3BC,gBAAgB,CAAE4F,UAAU,CAAC5F,gBAAgB,CAC7CC,0BAA0B,CAAE2F,UAAU,CAAC3F,0BAA0B,CACjEC,aAAa,CAAE0F,UAAU,CAAC1F,aAC5B,CAAC,CACH,CAAC,CAED,KAAM,CAAAkI,OAAO,CAAG,KAAM,CAAAC,OAAO,CAACC,GAAG,CAACJ,cAAc,CAAC,CACjD,KAAM,CAAAK,YAAY,CAAGH,OAAO,CAAClE,MAAM,CAACsE,CAAC,EAAIA,CAAC,CAAC9F,IAAI,CAACC,OAAO,CAAC,CAACT,MAAM,CAE/D,GAAIqG,YAAY,GAAKxH,mBAAmB,CAACmB,MAAM,CAAE,CAC/C9E,KAAK,CAACuF,OAAO,yBAAA2C,MAAA,CAAyBiD,YAAY,gCAA8B,CAAC,CACjFzH,oBAAoB,CAAC,KAAK,CAAC,CAC3BE,sBAAsB,CAAC,EAAE,CAAC,CAC1B;AACAe,sBAAsB,CAAC,CAAC,CAAE,KAAK,CAAC,CAClC,CAAC,IAAM,CACL3E,KAAK,CAAC6F,KAAK,YAAAqC,MAAA,CAAYiD,YAAY,SAAAjD,MAAA,CAAOvE,mBAAmB,CAACmB,MAAM,kBAAgB,CAAC,CACvF,CACF,CAAE,MAAOe,KAAK,CAAE,KAAAqJ,gBAAA,CAAAC,qBAAA,CACd,KAAM,CAAA5D,YAAY,CAAG,EAAA2D,gBAAA,CAAArJ,KAAK,CAACZ,QAAQ,UAAAiK,gBAAA,kBAAAC,qBAAA,CAAdD,gBAAA,CAAgB5J,IAAI,UAAA6J,qBAAA,iBAApBA,qBAAA,CAAsBtJ,KAAK,GAAIA,KAAK,CAAC2F,OAAO,EAAI,gCAAgC,CACrGxL,KAAK,CAAC6F,KAAK,CAAC0F,YAAY,CAAC,CAC3B,CAAC,OAAS,CACRzH,YAAY,CAAC,KAAK,CAAC,CACrB,CACF,CAAC,CAED,KAAM,CAAAsL,oBAAoB,CAAGA,CAAC5G,UAAU,CAAEoC,KAAK,GAAK,CAClD,KAAM,CAAAyE,UAAU,CAAGtM,mBAAmB,CAACyF,UAAU,CAACnG,EAAE,CAAC,GAAK,KAAK,CAC/D,KAAM,CAAAkG,UAAU,CAAGtE,2BAA2B,CAACuE,UAAU,CAACnG,EAAE,CAAC,EAAI,EAAE,CACnE,KAAM,CAAAiN,aAAa,CAAGnL,6BAA6B,CAACqE,UAAU,CAACnG,EAAE,CAAC,EAAI,EAAE,CACxE,KAAM,CAAAkN,aAAa,CAAGlL,6BAA6B,CAACmE,UAAU,CAACnG,EAAE,CAAC,EAAI,KAAK,CAC3E,KAAM,CAAAmN,YAAY,CAAGjL,6BAA6B,CAACiE,UAAU,CAACnG,EAAE,CAAC,EAAI,KAAK,CAE1E,mBACEhC,KAAA,QAAyBoP,SAAS,CAAC,sBAAsB,CAAAC,QAAA,eACvDrP,KAAA,QACEoP,SAAS,CAAC,kCAAkC,CAC5CE,OAAO,CAAEA,CAAA,GAAMzF,wBAAwB,CAAC1B,UAAU,CAACnG,EAAE,CAAE,CAAAqN,QAAA,eAEvDvP,IAAA,WACE6N,IAAI,CAAC,QAAQ,CACbyB,SAAS,CAAC,0BAA0B,CACpCE,OAAO,CAAGlF,CAAC,EAAK,CACdA,CAAC,CAACmF,eAAe,CAAC,CAAC,CACnB1F,wBAAwB,CAAC1B,UAAU,CAACnG,EAAE,CAAC,CACzC,CAAE,CAAAqN,QAAA,CAEDL,UAAU,cAAGlP,IAAA,CAACb,SAAS,EAACuQ,IAAI,CAAE,EAAG,CAAE,CAAC,cAAG1P,IAAA,CAACd,WAAW,EAACwQ,IAAI,CAAE,EAAG,CAAE,CAAC,CAC3D,CAAC,cACTxP,KAAA,SAAMoP,SAAS,CAAC,8BAA8B,CAAAC,QAAA,EAAC,aAClC,CAAC9E,KAAK,CAAG,CAAC,CAAEpC,UAAU,CAAC/F,gBAAgB,OAAAyF,MAAA,CAASM,UAAU,CAAC/F,gBAAgB,EAAK,EAAE,EACzF,CAAC,cACPpC,KAAA,QAAKyP,KAAK,CAAE,CAAEC,OAAO,CAAE,MAAM,CAAEC,GAAG,CAAE,KAAK,CAAEC,UAAU,CAAE,QAAS,CAAE,CAAAP,QAAA,eAChEvP,IAAA,WACE6N,IAAI,CAAC,QAAQ,CACbyB,SAAS,CAAC,0BAA0B,CACpCE,OAAO,CAAGlF,CAAC,EAAK,CACdA,CAAC,CAACmF,eAAe,CAAC,CAAC,CACnBlD,qBAAqB,CAAClE,UAAU,CAACnG,EAAE,CAAC,CACtC,CAAE,CACF6N,KAAK,CAAC,kBAAkB,CACxBJ,KAAK,CAAE,CAAEK,UAAU,CAAE,aAAa,CAAEC,MAAM,CAAE,MAAM,CAAEC,MAAM,CAAE,SAAS,CAAEC,OAAO,CAAE,KAAK,CAAEP,OAAO,CAAE,MAAM,CAAEE,UAAU,CAAE,QAAS,CAAE,CAAAP,QAAA,cAE/HvP,IAAA,CAACT,IAAI,EAACmQ,IAAI,CAAE,EAAG,CAACC,KAAK,CAAE,CAAES,KAAK,CAAE,SAAU,CAAE,CAAE,CAAC,CACzC,CAAC,CACRpO,WAAW,CAAC2C,MAAM,CAAG,CAAC,eACrB3E,IAAA,WACE6N,IAAI,CAAC,QAAQ,CACbyB,SAAS,CAAC,0BAA0B,CACpCE,OAAO,CAAGlF,CAAC,EAAK,CACdA,CAAC,CAACmF,eAAe,CAAC,CAAC,CACnBvF,gBAAgB,CAAC7B,UAAU,CAACnG,EAAE,CAAC,CACjC,CAAE,CACF6N,KAAK,CAAC,mBAAmB,CAAAR,QAAA,cAEzBvP,IAAA,CAACZ,MAAM,EAACsQ,IAAI,CAAE,EAAG,CAAE,CAAC,CACd,CACT,EACE,CAAC,EACH,CAAC,CAELR,UAAU,eACTlP,IAAA,QAAKsP,SAAS,CAAC,yBAAyB,CAAAC,QAAA,cACtCvP,IAAA,QAAKsP,SAAS,CAAC,mBAAmB,CAAAC,QAAA,cAChCrP,KAAA,QAAKoP,SAAS,CAAC,sBAAsB,CAAAC,QAAA,eACnCrP,KAAA,QAAKoP,SAAS,CAAC,aAAa,CAAAC,QAAA,eAC1BrP,KAAA,QAAKoP,SAAS,CAAC,YAAY,CAAAC,QAAA,eACzBvP,IAAA,UAAAuP,QAAA,CAAO,yBAAuB,CAAO,CAAC,cACtCvP,IAAA,UACE6N,IAAI,CAAC,MAAM,CACXhE,KAAK,CAAExB,UAAU,CAAChG,qBAAsB,CACxCgO,QAAQ,CAAG/F,CAAC,EAAKX,iBAAiB,CAACtB,UAAU,CAACnG,EAAE,CAAE,uBAAuB,CAAEoI,CAAC,CAACzC,MAAM,CAACgC,KAAK,CAAE,CAC3FyF,SAAS,CAAC,oBAAoB,CAC/B,CAAC,EACC,CAAC,cAENpP,KAAA,QAAKoP,SAAS,CAAC,YAAY,CAAAC,QAAA,eACzBrP,KAAA,UAAAqP,QAAA,EAAO,oBACa,cAAAvP,IAAA,SAAMsP,SAAS,CAAC,UAAU,CAAAC,QAAA,CAAC,GAAC,CAAM,CAAC,EAChD,CAAC,cACRrP,KAAA,QAAKoP,SAAS,0EAAAvH,MAAA,CAA2EM,UAAU,CAACnG,EAAE,CAAG,CAAAqN,QAAA,eACvGrP,KAAA,QAAKoP,SAAS,CAAC,sBAAsB,CAAAC,QAAA,eACnCvP,IAAA,CAAClB,MAAM,EAAC4Q,IAAI,CAAE,EAAG,CAACJ,SAAS,CAAC,aAAa,CAAE,CAAC,cAC5CtP,IAAA,UACE6N,IAAI,CAAC,MAAM,CACXyC,WAAW,CAAC,iCAAiC,CAC7CzG,KAAK,CAAExB,UAAU,CAAC9F,kBAAkB,CAAG8F,UAAU,CAAC/F,gBAAgB,CAAG8F,UAAW,CAChFmI,QAAQ,CAAE,CAAC,CAAClI,UAAU,CAAC9F,kBAAmB,CAC1C8N,QAAQ,CAAG/F,CAAC,EAAK,CACf;AACA,GAAI,CAACjC,UAAU,CAAC9F,kBAAkB,CAAE,CAClCuH,sBAAsB,CAACzB,UAAU,CAACnG,EAAE,CAAEoI,CAAC,CAACzC,MAAM,CAACgC,KAAK,CAAC,CACvD,CACF,CAAE,CACF2G,OAAO,CAAEA,CAAA,GAAM,CACb;AACA,GAAInI,UAAU,CAAC9F,kBAAkB,CAAE,CACjC;AAAA,CACD,IAAM,IAAI4M,aAAa,CAACxK,MAAM,CAAG,CAAC,CAAE,CACnCN,gCAAgC,CAACiB,IAAI,EAAA0C,aAAA,CAAAA,aAAA,IAAU1C,IAAI,MAAE,CAAC+C,UAAU,CAACnG,EAAE,EAAG,IAAI,EAAG,CAAC,CAChF,CACF,CAAE,CACFsN,OAAO,CAAEA,CAAA,GAAM,CACb;AACA;AACA,GAAI,CAACnH,UAAU,CAAC9F,kBAAkB,EAAI4M,aAAa,CAACxK,MAAM,CAAG,CAAC,CAAE,CAC9DN,gCAAgC,CAACiB,IAAI,EAAA0C,aAAA,CAAAA,aAAA,IAAU1C,IAAI,MAAE,CAAC+C,UAAU,CAACnG,EAAE,EAAG,IAAI,EAAG,CAAC,CAChF,CACF,CAAE,CACFoN,SAAS,CAAC,iCAAiC,CAC3CK,KAAK,CAAEtH,UAAU,CAAC9F,kBAAkB,CAAG,CAAE2N,MAAM,CAAE,SAAU,CAAC,CAAG,CAAC,CAAE,CACnE,CAAC,CACD7H,UAAU,CAAC9F,kBAAkB,eAC5BvC,IAAA,WACE6N,IAAI,CAAC,QAAQ,CACb2B,OAAO,CAAEA,CAAA,GAAM9F,2BAA2B,CAACrB,UAAU,CAACnG,EAAE,CAAE,CAC1DoN,SAAS,CAAC,cAAc,CACxBS,KAAK,CAAC,iBAAiB,CAAAR,QAAA,cAEvBvP,IAAA,CAACjB,CAAC,EAAC2Q,IAAI,CAAE,EAAG,CAAE,CAAC,CACT,CACT,EACE,CAAC,CACLN,aAAa,eACZpP,IAAA,QAAKsP,SAAS,CAAC,qBAAqB,CAAAC,QAAA,CAAC,cAAY,CAAK,CACvD,CACAF,YAAY,EAAIF,aAAa,CAACxK,MAAM,CAAG,CAAC,EAAI,CAAC0D,UAAU,CAAC9F,kBAAkB,eACzEvC,IAAA,QAAKsP,SAAS,CAAC,yBAAyB,CAAAC,QAAA,CACrCJ,aAAa,CAACjI,GAAG,CAAEmC,SAAS,eAC3BnJ,KAAA,QAEEsP,OAAO,CAAEA,CAAA,GAAMpG,4BAA4B,CAACf,UAAU,CAACnG,EAAE,CAAEmH,SAAS,CAAE,CACtEiG,SAAS,uBAAAvH,MAAA,CAAwBM,UAAU,CAAC9F,kBAAkB,GAAK8G,SAAS,CAACnH,EAAE,CAAG,UAAU,CAAG,EAAE,CAAG,CAAAqN,QAAA,eAEpGvP,IAAA,QAAKsP,SAAS,CAAC,oBAAoB,CAAAC,QAAA,CAChClG,SAAS,CAACE,4BAA4B,EAAIF,SAAS,CAACG,IAAI,CACtD,CAAC,CACLH,SAAS,CAACoH,WAAW,eACpBvQ,KAAA,QAAKoP,SAAS,CAAC,wBAAwB,CAAAC,QAAA,EAAC,WAC7B,CAAClG,SAAS,CAACoH,WAAW,EAC5B,CACN,GAXIpH,SAAS,CAACnH,EAYZ,CACN,CAAC,CACC,CACN,EACE,CAAC,EACH,CAAC,cAENlC,IAAA,QAAKsP,SAAS,CAAC,YAAY,CAACK,KAAK,CAAE,CAAEe,SAAS,CAAE,KAAM,CAAE,CAAAnB,QAAA,cACtDrP,KAAA,UAAOoP,SAAS,CAAC,gBAAgB,CAACK,KAAK,CAAE,CAAEgB,YAAY,CAAE,CAAE,CAAE,CAAApB,QAAA,eAC3DvP,IAAA,UACE6N,IAAI,CAAC,UAAU,CACf+C,OAAO,CAAEvI,UAAU,CAAC7F,OAAQ,CAC5B6N,QAAQ,CAAG/F,CAAC,EAAKX,iBAAiB,CAACtB,UAAU,CAACnG,EAAE,CAAE,SAAS,CAAEoI,CAAC,CAACzC,MAAM,CAAC+I,OAAO,CAAE,CAC/EtB,SAAS,CAAC,gBAAgB,CAC1BK,KAAK,CAAE,CAAEkB,WAAW,CAAE,KAAK,CAAEH,SAAS,CAAE,GAAG,CAAEI,aAAa,CAAE,QAAS,CAAE,CACxE,CAAC,cACF9Q,IAAA,SAAMsP,SAAS,CAAC,eAAe,CAACK,KAAK,CAAE,CAAEmB,aAAa,CAAE,QAAS,CAAE,CAAAvB,QAAA,CAAC,SAAO,CAAM,CAAC,cAClFvP,IAAA,CAAChB,IAAI,EAAC0Q,IAAI,CAAE,EAAG,CAACJ,SAAS,CAAC,WAAW,CAACK,KAAK,CAAE,CAAEoB,UAAU,CAAE,KAAK,CAAED,aAAa,CAAE,QAAS,CAAE,CAAE,CAAC,EAC1F,CAAC,CACL,CAAC,EACH,CAAC,cAEN5Q,KAAA,QAAKoP,SAAS,CAAC,aAAa,CAAAC,QAAA,eAC1BrP,KAAA,QAAKoP,SAAS,CAAC,YAAY,CAAAC,QAAA,eACzBrP,KAAA,UAAAqP,QAAA,EAAO,qBACc,cAAAvP,IAAA,SAAMsP,SAAS,CAAC,UAAU,CAAAC,QAAA,CAAC,GAAC,CAAM,CAAC,EACjD,CAAC,cACRrP,KAAA,WACE2J,KAAK,CAAExB,UAAU,CAAC5F,gBAAiB,CACnC4N,QAAQ,CAAG/F,CAAC,EAAKX,iBAAiB,CAACtB,UAAU,CAACnG,EAAE,CAAE,kBAAkB,CAAEoI,CAAC,CAACzC,MAAM,CAACgC,KAAK,CAAE,CACtFyF,SAAS,CAAC,oBAAoB,CAC9B0B,QAAQ,MAAAzB,QAAA,eAERvP,IAAA,WAAQ6J,KAAK,CAAC,EAAE,CAAA0F,QAAA,CAAC,UAAQ,CAAQ,CAAC,CACjClI,uBAAuB,CAACV,MAAM,CAACsK,GAAG,EAAIA,GAAG,GAAK,UAAU,CAAC,CAAC/J,GAAG,CAAEgK,MAAM,eACpElR,IAAA,WAAqB6J,KAAK,CAAEqH,MAAO,CAAA3B,QAAA,CAAE2B,MAAM,EAA9BA,MAAuC,CACrD,CAAC,EACI,CAAC,EACN,CAAC,cAENhR,KAAA,QAAKoP,SAAS,CAAC,YAAY,CAAAC,QAAA,eACzBrP,KAAA,UAAAqP,QAAA,EAAO,+BACwB,cAAAvP,IAAA,SAAMsP,SAAS,CAAC,UAAU,CAAAC,QAAA,CAAC,GAAC,CAAM,CAAC,cAChEvP,IAAA,CAAChB,IAAI,EAAC0Q,IAAI,CAAE,EAAG,CAACJ,SAAS,CAAC,WAAW,CAAE,CAAC,EACnC,CAAC,cACRtP,IAAA,UACE6N,IAAI,CAAC,MAAM,CACXhE,KAAK,CAAExB,UAAU,CAAC3F,0BAA2B,CAC7C2N,QAAQ,CAAG/F,CAAC,EAAKX,iBAAiB,CAACtB,UAAU,CAACnG,EAAE,CAAE,4BAA4B,CAAEoI,CAAC,CAACzC,MAAM,CAACgC,KAAK,CAAE,CAChGyF,SAAS,CAAC,oBAAoB,CAC9B0B,QAAQ,MACT,CAAC,EACC,CAAC,cAEN9Q,KAAA,QAAKoP,SAAS,CAAC,YAAY,CAAAC,QAAA,eACzBrP,KAAA,UAAAqP,QAAA,EAAO,gBACS,cAAAvP,IAAA,SAAMsP,SAAS,CAAC,UAAU,CAAAC,QAAA,CAAC,GAAC,CAAM,CAAC,cACjDvP,IAAA,CAAChB,IAAI,EAAC0Q,IAAI,CAAE,EAAG,CAACJ,SAAS,CAAC,WAAW,CAAE,CAAC,EACnC,CAAC,cACRpP,KAAA,WACE2J,KAAK,CAAExB,UAAU,CAAC1F,aAAc,CAChC0N,QAAQ,CAAG/F,CAAC,EAAKX,iBAAiB,CAACtB,UAAU,CAACnG,EAAE,CAAE,eAAe,CAAEoI,CAAC,CAACzC,MAAM,CAACgC,KAAK,CAAE,CACnFyF,SAAS,CAAC,oBAAoB,CAC9B0B,QAAQ,MAAAzB,QAAA,eAERvP,IAAA,WAAQ6J,KAAK,CAAC,EAAE,CAAA0F,QAAA,CAAC,UAAQ,CAAQ,CAAC,CACjCjI,oBAAoB,CAACX,MAAM,CAACsK,GAAG,EAAIA,GAAG,GAAK,UAAU,CAAC,CAAC/J,GAAG,CAAEgK,MAAM,eACjElR,IAAA,WAAqB6J,KAAK,CAAEqH,MAAO,CAAA3B,QAAA,CAAE2B,MAAM,EAA9BA,MAAuC,CACrD,CAAC,EACI,CAAC,EACN,CAAC,EACH,CAAC,EACH,CAAC,CACH,CAAC,CACH,CACN,GA3MO7I,UAAU,CAACnG,EA4MhB,CAAC,CAEV,CAAC,CAED,KAAM,CAAAiP,OAAO,cACXjR,KAAA,QAAKoP,SAAS,CAAC,2BAA2B,CAAAC,QAAA,EACvC,CAACxO,QAAQ,cACRb,KAAA,CAAAE,SAAA,EAAAmP,QAAA,eAEErP,KAAA,QAAKyP,KAAK,CAAE,CAAEC,OAAO,CAAE,MAAM,CAAEwB,cAAc,CAAE,eAAe,CAAEtB,UAAU,CAAE,QAAQ,CAAEa,YAAY,CAAE,MAAM,CAAED,SAAS,CAAE,KAAK,CAAEW,UAAU,CAAE,KAAK,CAAEC,QAAQ,CAAE,MAAM,CAAEzB,GAAG,CAAE,MAAO,CAAE,CAAAN,QAAA,eAC/KvP,IAAA,OAAI2P,KAAK,CAAE,CAAE4B,MAAM,CAAE,WAAW,CAAEC,QAAQ,CAAE,MAAM,CAAEC,UAAU,CAAE,GAAG,CAAErB,KAAK,CAAE,SAAU,CAAE,CAAAb,QAAA,CAAC,wCAEzF,CAAI,CAAC,cACLrP,KAAA,QAAKyP,KAAK,CAAE,CAAEC,OAAO,CAAE,MAAM,CAAEC,GAAG,CAAE,KAAK,CAAEC,UAAU,CAAE,QAAQ,CAAEwB,QAAQ,CAAE,MAAO,CAAE,CAAA/B,QAAA,eAClFrP,KAAA,WACE2N,IAAI,CAAC,QAAQ,CACbyB,SAAS,CAAC,eAAe,CACzBE,OAAO,CAAE9C,sBAAuB,CAChCiD,KAAK,CAAE,CAAEC,OAAO,CAAE,MAAM,CAAEE,UAAU,CAAE,QAAQ,CAAED,GAAG,CAAE,KAAM,CAAE,CAC7DE,KAAK,CAAC,2CAA2C,CAAAR,QAAA,eAEjDvP,IAAA,CAACL,QAAQ,EAAC+P,IAAI,CAAE,EAAG,CAAE,CAAC,oBAExB,EAAQ,CAAC,cACTxP,KAAA,UACEoP,SAAS,CAAC,eAAe,CACzBK,KAAK,CAAE,CAAEC,OAAO,CAAE,MAAM,CAAEE,UAAU,CAAE,QAAQ,CAAED,GAAG,CAAE,KAAK,CAAEK,MAAM,CAAE,SAAS,CAAEqB,MAAM,CAAE,CAAE,CAAE,CAC3FxB,KAAK,CAAC,sBAAsB,CAAAR,QAAA,eAE5BvP,IAAA,CAACN,MAAM,EAACgQ,IAAI,CAAE,EAAG,CAAE,CAAC,kBAEpB,cAAA1P,IAAA,UACE6N,IAAI,CAAC,MAAM,CACX6D,MAAM,CAAC,YAAY,CACnBrB,QAAQ,CAAElD,oBAAqB,CAC/BwC,KAAK,CAAE,CAAEC,OAAO,CAAE,MAAO,CAAE,CAC5B,CAAC,EACG,CAAC,cACR1P,KAAA,WACE2N,IAAI,CAAC,QAAQ,CACbyB,SAAS,CAAC,aAAa,CACvBE,OAAO,CAAEjE,mBAAoB,CAC7BoE,KAAK,CAAE,CAAEC,OAAO,CAAE,MAAM,CAAEE,UAAU,CAAE,QAAQ,CAAED,GAAG,CAAE,KAAM,CAAE,CAAAN,QAAA,eAE7DvP,IAAA,CAACf,IAAI,EAACyQ,IAAI,CAAE,EAAG,CAAE,CAAC,iBAEpB,EAAQ,CAAC,EACN,CAAC,EACH,CAAC,cAGNxP,KAAA,QAAKyP,KAAK,CAAE,CAAEC,OAAO,CAAE,MAAM,CAAEC,GAAG,CAAE,MAAM,CAAEC,UAAU,CAAE,QAAQ,CAAEa,YAAY,CAAE,MAAO,CAAE,CAAApB,QAAA,eACvFvP,IAAA,UAAO2P,KAAK,CAAE,CAAE6B,QAAQ,CAAE,MAAM,CAAEC,UAAU,CAAE,GAAG,CAAErB,KAAK,CAAE,SAAU,CAAE,CAAAb,QAAA,CAAC,mBAEvE,CAAO,CAAC,cACRrP,KAAA,WACE2J,KAAK,CAAE/H,YAAa,CACpBuO,QAAQ,CAAG/F,CAAC,EAAKvI,eAAe,CAACuI,CAAC,CAACzC,MAAM,CAACgC,KAAK,CAAE,CACjD8F,KAAK,CAAE,CACL6B,QAAQ,CAAE,MAAM,CAChBrB,OAAO,CAAE,UAAU,CACnBF,MAAM,CAAE,+BAA+B,CACvC0B,YAAY,CAAE,kBAAkB,CAChC3B,UAAU,CAAE,gBAAgB,CAC5BI,KAAK,CAAE,qBAAqB,CAC5BwB,QAAQ,CAAE,OAAO,CACjB1B,MAAM,CAAE,SAAS,CACjB2B,UAAU,CAAE,SACd,CAAE,CAAAtC,QAAA,eAEFvP,IAAA,WAAQ6J,KAAK,CAAC,EAAE,CAAA0F,QAAA,CAAC,YAAU,CAAQ,CAAC,CACnCzI,cAAc,CAACI,GAAG,CAACL,MAAM,eACxB7G,IAAA,WAAqB6J,KAAK,CAAEhD,MAAO,CAAA0I,QAAA,CAAE1I,MAAM,EAA9BA,MAAuC,CACrD,CAAC,EACI,CAAC,CACR/E,YAAY,eACX9B,IAAA,WACE6N,IAAI,CAAC,QAAQ,CACb2B,OAAO,CAAEA,CAAA,GAAMzN,eAAe,CAAC,EAAE,CAAE,CACnC4N,KAAK,CAAE,CACL6B,QAAQ,CAAE,MAAM,CAChBrB,OAAO,CAAE,UAAU,CACnBH,UAAU,CAAE,aAAa,CACzBC,MAAM,CAAE,+BAA+B,CACvC0B,YAAY,CAAE,kBAAkB,CAChCvB,KAAK,CAAE,uBAAuB,CAC9BF,MAAM,CAAE,SAAS,CACjB2B,UAAU,CAAE,SACd,CAAE,CAAAtC,QAAA,CACH,cAED,CAAQ,CACT,EACE,CAAC,CAGLlO,UAAU,EAAIF,oBAAoB,CAACwD,MAAM,GAAK,CAAC,cAC9CzE,KAAA,QAAKyP,KAAK,CAAE,CAAEmC,SAAS,CAAE,QAAQ,CAAE3B,OAAO,CAAE,MAAO,CAAE,CAAAZ,QAAA,eACnDvP,IAAA,CAACX,MAAM,EAACiQ,SAAS,CAAC,UAAU,CAACI,IAAI,CAAE,EAAG,CAAE,CAAC,cACzC1P,IAAA,MAAAuP,QAAA,CAAG,+BAA6B,CAAG,CAAC,EACjC,CAAC,cAENrP,KAAA,QAAKoP,SAAS,CAAC,oCAAoC,CAACK,KAAK,CAAE,CAAEoC,SAAS,CAAE,MAAM,CAAEC,SAAS,CAAE,MAAO,CAAE,CAAAzC,QAAA,eAClGrP,KAAA,UAAOoP,SAAS,CAAC,0BAA0B,CAACK,KAAK,CAAE,CAAEsC,KAAK,CAAE,MAAO,CAAE,CAAA1C,QAAA,eACnEvP,IAAA,UAAAuP,QAAA,cACErP,KAAA,OAAAqP,QAAA,eACEvP,IAAA,OAAAuP,QAAA,CAAI,mBAAiB,CAAI,CAAC,cAC1BvP,IAAA,OAAAuP,QAAA,CAAI,oBAAkB,CAAI,CAAC,cAC3BvP,IAAA,OAAAuP,QAAA,CAAI,0BAAwB,CAAI,CAAC,EAC/B,CAAC,CACA,CAAC,cACRvP,IAAA,UAAAuP,QAAA,CACGtO,iBAAiB,CAAC0D,MAAM,GAAK,CAAC,cAC7B3E,IAAA,OAAAuP,QAAA,cACEvP,IAAA,OAAIkS,OAAO,CAAC,GAAG,CAAC5C,SAAS,CAAC,SAAS,CAACK,KAAK,CAAE,CAAEmC,SAAS,CAAE,QAAQ,CAAE3B,OAAO,CAAE,MAAO,CAAE,CAAAZ,QAAA,CAAC,iDAErF,CAAI,CAAC,CACH,CAAC,CAELtO,iBAAiB,CAACiG,GAAG,CAAC,CAACN,EAAE,CAAE6D,KAAK,gBAC9BvK,KAAA,OAAAqP,QAAA,eACEvP,IAAA,OAAAuP,QAAA,CAAK3I,EAAE,CAAC4C,IAAI,EAAI,IAAI,CAAK,CAAC,cAC1BxJ,IAAA,OAAAuP,QAAA,CAAK3I,EAAE,CAAC6J,WAAW,EAAI,IAAI,CAAK,CAAC,cACjCzQ,IAAA,OAAAuP,QAAA,CAAK3I,EAAE,CAACC,MAAM,EAAI,IAAI,CAAK,CAAC,GAHrBD,EAAE,CAAC1E,EAAE,EAAIuI,KAId,CACL,CACF,CACI,CAAC,EACH,CAAC,CAGN,CAAChJ,SAAS,EAAIN,oBAAoB,CAACwD,MAAM,EAAI,IAAI,GAAK,CAAChD,cAAc,EAAIR,oBAAoB,CAACwD,MAAM,CAAG,CAAC,EAAI,CAACtD,UAAU,eACvHnB,KAAA,QAAKyP,KAAK,CAAE,CAAEmC,SAAS,CAAE,QAAQ,CAAE3B,OAAO,CAAE,MAAM,CAAEgC,SAAS,CAAE,+BAAgC,CAAE,CAAA5C,QAAA,eAC/FrP,KAAA,WACE2N,IAAI,CAAC,QAAQ,CACbyB,SAAS,CAAC,eAAe,CACzBE,OAAO,CAAEA,CAAA,GAAMhL,sBAAsB,CAACjD,QAAQ,CAAE,IAAI,CAAE,CACtDoO,KAAK,CAAE,CACLC,OAAO,CAAE,aAAa,CACtBE,UAAU,CAAE,QAAQ,CACpBD,GAAG,CAAE,KAAK,CACVM,OAAO,CAAE,WAAW,CACpBqB,QAAQ,CAAE,MAAM,CAChBC,UAAU,CAAE,GACd,CAAE,CAAAlC,QAAA,eAEFvP,IAAA,CAACf,IAAI,EAACyQ,IAAI,CAAE,EAAG,CAAE,CAAC,cACP,CAACvO,oBAAoB,CAACwD,MAAM,CAAC,SAAO,CAAClD,SAAS,CAAG,kBAAkB,CAAG,EAAE,CAAC,GACtF,EAAQ,CAAC,cACTzB,IAAA,QAAK2P,KAAK,CAAE,CAAEe,SAAS,CAAE,KAAK,CAAEc,QAAQ,CAAE,MAAM,CAAEpB,KAAK,CAAE,MAAO,CAAE,CAAAb,QAAA,CAAC,4CAEnE,CAAK,CAAC,EACH,CACN,CAEA5N,cAAc,eACbzB,KAAA,QAAKyP,KAAK,CAAE,CAAEmC,SAAS,CAAE,QAAQ,CAAE3B,OAAO,CAAE,MAAM,CAAEgC,SAAS,CAAE,+BAAgC,CAAE,CAAA5C,QAAA,eAC/FvP,IAAA,CAACX,MAAM,EAACiQ,SAAS,CAAC,UAAU,CAACI,IAAI,CAAE,EAAG,CAAE,CAAC,cACzC1P,IAAA,SAAM2P,KAAK,CAAE,CAAEoB,UAAU,CAAE,KAAM,CAAE,CAAAxB,QAAA,CAAC,oCAAkC,CAAM,CAAC,EAC1E,CACN,CAGA9N,SAAS,EAAI,CAACE,cAAc,eAC3B3B,IAAA,QACEoS,GAAG,CAAEvQ,iBAAkB,CACvB8N,KAAK,CAAE,CAAE0C,MAAM,CAAE,MAAM,CAAEJ,KAAK,CAAE,MAAO,CAAE,CAC1C,CACF,CAEA9Q,oBAAoB,CAACwD,MAAM,CAAG,CAAC,EAAI,CAAClD,SAAS,eAC5CzB,IAAA,QAAK2P,KAAK,CAAE,CAAEmC,SAAS,CAAE,QAAQ,CAAE3B,OAAO,CAAE,MAAM,CAAEgC,SAAS,CAAE,+BAA+B,CAAE/B,KAAK,CAAE,MAAM,CAAEoB,QAAQ,CAAE,MAAO,CAAE,CAAAjC,QAAA,CAC/HzN,YAAY,cACX5B,KAAA,CAAAE,SAAA,EAAAmP,QAAA,EAAE,UAAQ,CAACtO,iBAAiB,CAAC0D,MAAM,CAAC,MAAI,CAACxD,oBAAoB,CAACwD,MAAM,CAAC,2CAAyC,CAAC7C,YAAY,CAAC,GAAC,EAAE,CAAC,cAEhI5B,KAAA,CAAAE,SAAA,EAAAmP,QAAA,EAAE,MAAI,CAACpO,oBAAoB,CAACwD,MAAM,CAAC,4BAA0B,EAAE,CAChE,CACE,CACN,EACE,CACN,EACD,CAAC,cAEHzE,KAAA,SAAMoS,QAAQ,CAAEjI,YAAa,CAACiF,SAAS,CAAC,wBAAwB,CAAAC,QAAA,eAC9DrP,KAAA,QAAKyP,KAAK,CAAE,CAAEC,OAAO,CAAE,MAAM,CAAEwB,cAAc,CAAE,eAAe,CAAEtB,UAAU,CAAE,QAAQ,CAAEa,YAAY,CAAE,MAAO,CAAE,CAAApB,QAAA,eAC3GvP,IAAA,OAAI2P,KAAK,CAAE,CAAE4B,MAAM,CAAE,CAAC,CAAEC,QAAQ,CAAE,MAAM,CAAEC,UAAU,CAAE,GAAG,CAAErB,KAAK,CAAE,SAAU,CAAE,CAAAb,QAAA,CAAC,mBAE/E,CAAI,CAAC,cACLvP,IAAA,WACE6N,IAAI,CAAC,QAAQ,CACbyB,SAAS,CAAC,eAAe,CACzBE,OAAO,CAAEA,CAAA,GAAMxO,WAAW,CAAC,KAAK,CAAE,CAAAuO,QAAA,CACnC,cAED,CAAQ,CAAC,EACN,CAAC,cAENrP,KAAA,QAAKyP,KAAK,CAAE,CAAEgB,YAAY,CAAE,MAAM,CAAEf,OAAO,CAAE,MAAM,CAAEC,GAAG,CAAE,MAAM,CAAEC,UAAU,CAAE,QAAQ,CAAEwB,QAAQ,CAAE,MAAO,CAAE,CAAA/B,QAAA,eACzGrP,KAAA,WACE2N,IAAI,CAAC,QAAQ,CACbyB,SAAS,CAAC,aAAa,CACvBE,OAAO,CAAExF,aAAc,CACvB2F,KAAK,CAAE,CAAEC,OAAO,CAAE,MAAM,CAAEE,UAAU,CAAE,QAAQ,CAAED,GAAG,CAAE,KAAM,CAAE,CAAAN,QAAA,eAE7DvP,IAAA,CAACf,IAAI,EAACyQ,IAAI,CAAE,EAAG,CAAE,CAAC,iBAEpB,EAAQ,CAAC,cACTxP,KAAA,WACE2N,IAAI,CAAC,QAAQ,CACbyB,SAAS,CAAC,eAAe,CACzBE,OAAO,CAAEhE,kBAAmB,CAC5B+G,QAAQ,CAAEvQ,WAAW,CAAC2C,MAAM,GAAK,CAAE,CACnCgL,KAAK,CAAE,CAAEC,OAAO,CAAE,MAAM,CAAEE,UAAU,CAAE,QAAQ,CAAED,GAAG,CAAE,KAAM,CAAE,CAC7DE,KAAK,CAAC,sCAAsC,CAAAR,QAAA,eAE5CvP,IAAA,CAACV,IAAI,EAACoQ,IAAI,CAAE,EAAG,CAAE,CAAC,gBAEpB,EAAQ,CAAC,cACTxP,KAAA,WACE2N,IAAI,CAAC,QAAQ,CACbyB,SAAS,CAAC,eAAe,CACzBE,OAAO,CAAEA,CAAA,GAAMnM,wBAAwB,CAAC,IAAI,CAAE,CAC9CkP,QAAQ,CAAEzP,cAAc,CAAC6B,MAAM,GAAK,CAAE,CACtCgL,KAAK,CAAE,CAAEC,OAAO,CAAE,MAAM,CAAEE,UAAU,CAAE,QAAQ,CAAED,GAAG,CAAE,KAAM,CAAE,CAC7DE,KAAK,CAAC,uBAAuB,CAAAR,QAAA,eAE7BvP,IAAA,CAACR,UAAU,EAACkQ,IAAI,CAAE,EAAG,CAAE,CAAC,gBAE1B,EAAQ,CAAC,EACN,CAAC,CAEL1N,WAAW,CAACkF,GAAG,CAAC,CAACmB,UAAU,CAAEoC,KAAK,GAAKwE,oBAAoB,CAAC5G,UAAU,CAAEoC,KAAK,CAAC,CAAC,cAEhFvK,KAAA,QAAKoP,SAAS,CAAC,cAAc,CAAAC,QAAA,eAC3BvP,IAAA,WACE6N,IAAI,CAAC,QAAQ,CACbyB,SAAS,CAAC,eAAe,CACzBE,OAAO,CAAElE,YAAa,CAAAiE,QAAA,CACvB,QAED,CAAQ,CAAC,cACTvP,IAAA,WACE6N,IAAI,CAAC,QAAQ,CACbyB,SAAS,CAAC,aAAa,CACvBiD,QAAQ,CAAE1R,UAAW,CAAA0O,QAAA,CAEpB1O,UAAU,CAAG,aAAa,WAAAkH,MAAA,CAAa/F,WAAW,CAAC2C,MAAM,gBAAAoD,MAAA,CAAc/F,WAAW,CAAC2C,MAAM,CAAG,CAAC,CAAG,GAAG,CAAG,EAAE,CAAE,CACrG,CAAC,EACN,CAAC,EACF,CACP,CAGA3B,iBAAiB,eAChBhD,IAAA,QAAK2P,KAAK,CAAE,CACV6C,QAAQ,CAAE,OAAO,CACjBC,GAAG,CAAE,CAAC,CACNC,IAAI,CAAE,CAAC,CACPC,KAAK,CAAE,CAAC,CACRC,MAAM,CAAE,CAAC,CACT5C,UAAU,CAAE,oBAAoB,CAChCJ,OAAO,CAAE,MAAM,CACfE,UAAU,CAAE,QAAQ,CACpBsB,cAAc,CAAE,QAAQ,CACxByB,MAAM,CAAE,IACV,CAAE,CAAAtD,QAAA,cACArP,KAAA,QAAKyP,KAAK,CAAE,CACVK,UAAU,CAAE,OAAO,CACnBG,OAAO,CAAE,MAAM,CACfwB,YAAY,CAAE,KAAK,CACnBC,QAAQ,CAAE,OAAO,CACjBkB,QAAQ,CAAE,OACZ,CAAE,CAAAvD,QAAA,eACAvP,IAAA,OAAI2P,KAAK,CAAE,CAAE4B,MAAM,CAAE,YAAY,CAAEC,QAAQ,CAAE,MAAM,CAAEC,UAAU,CAAE,GAAI,CAAE,CAAAlC,QAAA,CAAC,eAAa,CAAI,CAAC,cAC1FrP,KAAA,QAAKyP,KAAK,CAAE,CAAEgB,YAAY,CAAE,MAAO,CAAE,CAAApB,QAAA,eACnCvP,IAAA,UAAO2P,KAAK,CAAE,CAAEC,OAAO,CAAE,OAAO,CAAEe,YAAY,CAAE,KAAK,CAAEa,QAAQ,CAAE,MAAM,CAAEC,UAAU,CAAE,GAAI,CAAE,CAAAlC,QAAA,CAAC,gBAE5F,CAAO,CAAC,cACRvP,IAAA,UACE6N,IAAI,CAAC,MAAM,CACXhE,KAAK,CAAE3G,YAAa,CACpBmN,QAAQ,CAAG/F,CAAC,EAAKnH,eAAe,CAACmH,CAAC,CAACzC,MAAM,CAACgC,KAAK,CAAE,CACjDyG,WAAW,CAAC,qBAAqB,CACjCX,KAAK,CAAE,CACLsC,KAAK,CAAE,MAAM,CACb9B,OAAO,CAAE,UAAU,CACnBF,MAAM,CAAE,+BAA+B,CACvC0B,YAAY,CAAE,KAAK,CACnBH,QAAQ,CAAE,MACZ,CAAE,CACFuB,SAAS,MACTC,UAAU,CAAG1I,CAAC,EAAK,CACjB,GAAIA,CAAC,CAAC2I,GAAG,GAAK,OAAO,CAAE,CACrBxH,mBAAmB,CAAC,CAAC,CACvB,CACF,CAAE,CACH,CAAC,EACC,CAAC,cACNvL,KAAA,QAAKyP,KAAK,CAAE,CAAEC,OAAO,CAAE,MAAM,CAAEC,GAAG,CAAE,MAAM,CAAEuB,cAAc,CAAE,UAAW,CAAE,CAAA7B,QAAA,eACvEvP,IAAA,WACE6N,IAAI,CAAC,QAAQ,CACbyB,SAAS,CAAC,eAAe,CACzBE,OAAO,CAAEA,CAAA,GAAM,CACbvM,oBAAoB,CAAC,KAAK,CAAC,CAC3BE,eAAe,CAAC,EAAE,CAAC,CACrB,CAAE,CAAAoM,QAAA,CACH,QAED,CAAQ,CAAC,cACTvP,IAAA,WACE6N,IAAI,CAAC,QAAQ,CACbyB,SAAS,CAAC,aAAa,CACvBE,OAAO,CAAE/D,mBAAoB,CAC7B8G,QAAQ,CAAE,CAACrP,YAAY,CAACuF,IAAI,CAAC,CAAE,CAAA8G,QAAA,CAChC,MAED,CAAQ,CAAC,EACN,CAAC,EACH,CAAC,CACH,CACN,CAGAnM,qBAAqB,eACpBpD,IAAA,QAAK2P,KAAK,CAAE,CACV6C,QAAQ,CAAE,OAAO,CACjBC,GAAG,CAAE,CAAC,CACNC,IAAI,CAAE,CAAC,CACPC,KAAK,CAAE,CAAC,CACRC,MAAM,CAAE,CAAC,CACT5C,UAAU,CAAE,oBAAoB,CAChCJ,OAAO,CAAE,MAAM,CACfE,UAAU,CAAE,QAAQ,CACpBsB,cAAc,CAAE,QAAQ,CACxByB,MAAM,CAAE,IACV,CAAE,CAAAtD,QAAA,cACArP,KAAA,QAAKyP,KAAK,CAAE,CACVK,UAAU,CAAE,OAAO,CACnBG,OAAO,CAAE,MAAM,CACfwB,YAAY,CAAE,KAAK,CACnBC,QAAQ,CAAE,OAAO,CACjBkB,QAAQ,CAAE,OAAO,CACjBf,SAAS,CAAE,MAAM,CACjBmB,QAAQ,CAAE,MACZ,CAAE,CAAA3D,QAAA,eACAvP,IAAA,OAAI2P,KAAK,CAAE,CAAE4B,MAAM,CAAE,YAAY,CAAEC,QAAQ,CAAE,MAAM,CAAEC,UAAU,CAAE,GAAI,CAAE,CAAAlC,QAAA,CAAC,eAAa,CAAI,CAAC,CACzFzM,cAAc,CAAC6B,MAAM,GAAK,CAAC,cAC1B3E,IAAA,MAAG2P,KAAK,CAAE,CAAES,KAAK,CAAE,MAAM,CAAEoB,QAAQ,CAAE,MAAO,CAAE,CAAAjC,QAAA,CAAC,2BAAyB,CAAG,CAAC,cAE5EvP,IAAA,QAAK2P,KAAK,CAAE,CAAEC,OAAO,CAAE,MAAM,CAAEuD,aAAa,CAAE,QAAQ,CAAEtD,GAAG,CAAE,MAAO,CAAE,CAAAN,QAAA,CACnEzM,cAAc,CAACoE,GAAG,CAAEwE,QAAQ,eAC3BxL,KAAA,QAEEyP,KAAK,CAAE,CACLQ,OAAO,CAAE,MAAM,CACfF,MAAM,CAAE,+BAA+B,CACvC0B,YAAY,CAAE,KAAK,CACnB/B,OAAO,CAAE,MAAM,CACfwB,cAAc,CAAE,eAAe,CAC/BtB,UAAU,CAAE,QACd,CAAE,CAAAP,QAAA,eAEFrP,KAAA,QAAAqP,QAAA,eACEvP,IAAA,QAAK2P,KAAK,CAAE,CAAE8B,UAAU,CAAE,GAAG,CAAED,QAAQ,CAAE,MAAM,CAAEb,YAAY,CAAE,KAAM,CAAE,CAAApB,QAAA,CACpE7D,QAAQ,CAAClC,IAAI,CACX,CAAC,cACNtJ,KAAA,QAAKyP,KAAK,CAAE,CAAE6B,QAAQ,CAAE,MAAM,CAAEpB,KAAK,CAAE,MAAO,CAAE,CAAAb,QAAA,EAC7C7D,QAAQ,CAAC1J,WAAW,CAAC2C,MAAM,CAAC,gCAAyB,CAAC,GAAI,CAAAxC,IAAI,CAACuJ,QAAQ,CAACC,SAAS,CAAC,CAACyH,kBAAkB,CAAC,CAAC,EACrG,CAAC,EACH,CAAC,cACNlT,KAAA,QAAKyP,KAAK,CAAE,CAAEC,OAAO,CAAE,MAAM,CAAEC,GAAG,CAAE,KAAM,CAAE,CAAAN,QAAA,eAC1CvP,IAAA,WACE6N,IAAI,CAAC,QAAQ,CACbyB,SAAS,CAAC,aAAa,CACvBE,OAAO,CAAEA,CAAA,GAAMxD,kBAAkB,CAACN,QAAQ,CAAE,CAC5CiE,KAAK,CAAE,CAAE6B,QAAQ,CAAE,MAAM,CAAErB,OAAO,CAAE,UAAW,CAAE,CAAAZ,QAAA,CAClD,MAED,CAAQ,CAAC,cACTvP,IAAA,WACE6N,IAAI,CAAC,QAAQ,CACbyB,SAAS,CAAC,eAAe,CACzBE,OAAO,CAAEA,CAAA,GAAMpD,oBAAoB,CAACV,QAAQ,CAACxJ,EAAE,CAAE,CACjDyN,KAAK,CAAE,CAAE6B,QAAQ,CAAE,MAAM,CAAErB,OAAO,CAAE,UAAU,CAAEC,KAAK,CAAE,SAAU,CAAE,CACnEL,KAAK,CAAC,iBAAiB,CAAAR,QAAA,cAEvBvP,IAAA,CAACZ,MAAM,EAACsQ,IAAI,CAAE,EAAG,CAAE,CAAC,CACd,CAAC,EACN,CAAC,GApCDhE,QAAQ,CAACxJ,EAqCX,CACN,CAAC,CACC,CACN,cACDlC,IAAA,QAAK2P,KAAK,CAAE,CAAEC,OAAO,CAAE,MAAM,CAAEwB,cAAc,CAAE,UAAU,CAAEV,SAAS,CAAE,MAAO,CAAE,CAAAnB,QAAA,cAC7EvP,IAAA,WACE6N,IAAI,CAAC,QAAQ,CACbyB,SAAS,CAAC,eAAe,CACzBE,OAAO,CAAEA,CAAA,GAAMnM,wBAAwB,CAAC,KAAK,CAAE,CAAAkM,QAAA,CAChD,OAED,CAAQ,CAAC,CACN,CAAC,EACH,CAAC,CACH,CACN,EACE,CACN,CAED;AACA,KAAM,CAAA8D,kBAAkB,CAAG/P,iBAAiB,eACtCtD,IAAA,QAAK2P,KAAK,CAAE,CACV6C,QAAQ,CAAE,OAAO,CACjBC,GAAG,CAAE,CAAC,CACNC,IAAI,CAAE,CAAC,CACPC,KAAK,CAAE,CAAC,CACRC,MAAM,CAAE,CAAC,CACT5C,UAAU,CAAE,oBAAoB,CAChCJ,OAAO,CAAE,MAAM,CACfE,UAAU,CAAE,QAAQ,CACpBsB,cAAc,CAAE,QAAQ,CACxByB,MAAM,CAAE,IACV,CAAE,CAAAtD,QAAA,cACArP,KAAA,QAAKyP,KAAK,CAAE,CACVK,UAAU,CAAE,OAAO,CACnBG,OAAO,CAAE,MAAM,CACfwB,YAAY,CAAE,KAAK,CACnBC,QAAQ,CAAE,OAAO,CACjBkB,QAAQ,CAAE,MAAM,CAChBf,SAAS,CAAE,MAAM,CACjBnC,OAAO,CAAE,MAAM,CACfuD,aAAa,CAAE,QACjB,CAAE,CAAA5D,QAAA,eACArP,KAAA,QAAKyP,KAAK,CAAE,CAAEC,OAAO,CAAE,MAAM,CAAEwB,cAAc,CAAE,eAAe,CAAEtB,UAAU,CAAE,QAAQ,CAAEa,YAAY,CAAE,MAAO,CAAE,CAAApB,QAAA,eAC3GvP,IAAA,OAAI2P,KAAK,CAAE,CAAE4B,MAAM,CAAE,CAAC,CAAEC,QAAQ,CAAE,MAAM,CAAEC,UAAU,CAAE,GAAI,CAAE,CAAAlC,QAAA,CAAC,gBAAc,CAAI,CAAC,cAChFvP,IAAA,WACEwP,OAAO,CAAEA,CAAA,GAAM,CACbjM,oBAAoB,CAAC,KAAK,CAAC,CAC3BE,sBAAsB,CAAC,EAAE,CAAC,CAC1BI,sBAAsB,CAAC,KAAK,CAAC,CAC/B,CAAE,CACF8L,KAAK,CAAE,CACLK,UAAU,CAAE,MAAM,CAClBC,MAAM,CAAE,MAAM,CACdC,MAAM,CAAE,SAAS,CACjBC,OAAO,CAAE,KAAK,CACdP,OAAO,CAAE,MAAM,CACfE,UAAU,CAAE,QACd,CAAE,CAAAP,QAAA,cAEFvP,IAAA,CAACjB,CAAC,EAAC2Q,IAAI,CAAE,EAAG,CAAE,CAAC,CACT,CAAC,EACN,CAAC,CAEL9L,mBAAmB,eAClB1D,KAAA,QAAKyP,KAAK,CAAE,CAAEQ,OAAO,CAAE,MAAM,CAAEH,UAAU,CAAE,SAAS,CAAE2B,YAAY,CAAE,KAAK,CAAEhB,YAAY,CAAE,MAAM,CAAEf,OAAO,CAAE,MAAM,CAAEE,UAAU,CAAE,QAAQ,CAAED,GAAG,CAAE,KAAM,CAAE,CAAAN,QAAA,eACnJvP,IAAA,CAACX,MAAM,EAACiQ,SAAS,CAAC,UAAU,CAACI,IAAI,CAAE,EAAG,CAACC,KAAK,CAAE,CAAES,KAAK,CAAE,SAAU,CAAE,CAAE,CAAC,cACtEpQ,IAAA,SAAM2P,KAAK,CAAE,CAAE6B,QAAQ,CAAE,MAAM,CAAEpB,KAAK,CAAE,SAAU,CAAE,CAAAb,QAAA,CAAC,iCAA+B,CAAM,CAAC,EACxF,CACN,cAEDvP,IAAA,QAAK2P,KAAK,CAAE,CAAE2D,IAAI,CAAE,CAAC,CAAEJ,QAAQ,CAAE,MAAM,CAAEvC,YAAY,CAAE,MAAO,CAAE,CAAApB,QAAA,cAC9DrP,KAAA,UAAOyP,KAAK,CAAE,CAAEsC,KAAK,CAAE,MAAM,CAAEsB,cAAc,CAAE,UAAU,CAAE/B,QAAQ,CAAE,MAAO,CAAE,CAAAjC,QAAA,eAC5EvP,IAAA,UAAAuP,QAAA,cACErP,KAAA,OAAAqP,QAAA,eACEvP,IAAA,OAAAuP,QAAA,CAAI,yBAAuB,CAAI,CAAC,cAChCvP,IAAA,OAAAuP,QAAA,CAAI,mBAAiB,CAAI,CAAC,cAC1BvP,IAAA,OAAAuP,QAAA,CAAI,oBAAkB,CAAI,CAAC,cAC3BvP,IAAA,OAAAuP,QAAA,CAAI,8BAA4B,CAAI,CAAC,cACrCvP,IAAA,OAAAuP,QAAA,CAAI,eAAa,CAAI,CAAC,EACpB,CAAC,CACA,CAAC,cACRvP,IAAA,UAAAuP,QAAA,CACG/L,mBAAmB,CAAC0D,GAAG,CAAC,CAACuC,EAAE,CAAEgB,KAAK,GAAK,CACtC,KAAM,CAAA/E,KAAK,CAAG0E,kBAAkB,CAACX,EAAE,CAAC,CACpC,mBACEvJ,KAAA,OAAgByP,KAAK,CAAE,CAAEK,UAAU,CAAEtK,KAAK,CAAG,MAAM,CAAG,OAAQ,CAAE,CAAA6J,QAAA,eAC9DvP,IAAA,OAAI2P,KAAK,CAAE,CAAEQ,OAAO,CAAE,KAAK,CAAEF,MAAM,CAAE,mBAAoB,CAAE,CAAAV,QAAA,CAAE9F,EAAE,CAACpH,qBAAqB,EAAI,IAAI,CAAK,CAAC,cACnGrC,IAAA,OAAI2P,KAAK,CAAE,CAAEQ,OAAO,CAAE,KAAK,CAAEF,MAAM,CAAE,mBAAoB,CAAE,CAAAV,QAAA,CAAE9F,EAAE,CAACnH,gBAAgB,EAAI,IAAI,CAAK,CAAC,cAC9FtC,IAAA,OAAI2P,KAAK,CAAE,CAAEQ,OAAO,CAAE,KAAK,CAAEF,MAAM,CAAE,mBAAoB,CAAE,CAAAV,QAAA,CAAE9F,EAAE,CAAChH,gBAAgB,EAAI,IAAI,CAAK,CAAC,cAC9FzC,IAAA,OAAI2P,KAAK,CAAE,CAAEQ,OAAO,CAAE,KAAK,CAAEF,MAAM,CAAE,mBAAoB,CAAE,CAAAV,QAAA,CAAE9F,EAAE,CAAC/G,0BAA0B,EAAI,IAAI,CAAK,CAAC,cACxGxC,KAAA,OAAIyP,KAAK,CAAE,CAAEQ,OAAO,CAAE,KAAK,CAAEF,MAAM,CAAE,mBAAoB,CAAE,CAAAV,QAAA,EACxD9F,EAAE,CAAC9G,aAAa,EAAI,IAAI,CACxB+C,KAAK,eAAI1F,IAAA,QAAK2P,KAAK,CAAE,CAAE6B,QAAQ,CAAE,MAAM,CAAEpB,KAAK,CAAE,MAAM,CAAEM,SAAS,CAAE,KAAM,CAAE,CAAAnB,QAAA,CAAE7J,KAAK,CAAM,CAAC,EACxF,CAAC,GARE+E,KASL,CAAC,CAET,CAAC,CAAC,CACG,CAAC,EACH,CAAC,CACL,CAAC,cAENvK,KAAA,QAAKyP,KAAK,CAAE,CAAEC,OAAO,CAAE,MAAM,CAAEwB,cAAc,CAAE,UAAU,CAAEvB,GAAG,CAAE,KAAM,CAAE,CAAAN,QAAA,eACtEvP,IAAA,WACEwP,OAAO,CAAEA,CAAA,GAAM,CACbjM,oBAAoB,CAAC,KAAK,CAAC,CAC3BE,sBAAsB,CAAC,EAAE,CAAC,CAC5B,CAAE,CACF6L,SAAS,CAAC,eAAe,CAAAC,QAAA,CAC1B,QAED,CAAQ,CAAC,cACTvP,IAAA,WACEwP,OAAO,CAAEX,sBAAuB,CAChC0D,QAAQ,CAAE7O,SAAS,EAAIF,mBAAmB,CAACgQ,IAAI,CAAC/J,EAAE,EAAIW,kBAAkB,CAACX,EAAE,CAAC,CAAE,CAC9E6F,SAAS,CAAC,aAAa,CAAAC,QAAA,CAEtB7L,SAAS,CAAG,aAAa,WAAAqE,MAAA,CAAavE,mBAAmB,CAACmB,MAAM,kBAAgB,CAC3E,CAAC,EACN,CAAC,EACH,CAAC,CACH,CACN,CAEL,GAAIpE,UAAU,CAAE,CACd,mBACEL,KAAA,CAAAE,SAAA,EAAAmP,QAAA,eACEvP,IAAA,QAAKsP,SAAS,CAAC,mCAAmC,CAAAC,QAAA,CAAE4B,OAAO,CAAM,CAAC,CACjEkC,kBAAkB,EACnB,CAAC,CAEP,CAEA,mBACEnT,KAAA,QAAKoP,SAAS,CAAC,kBAAkB,CAAAC,QAAA,eAC/BvP,IAAA,CAACtB,OAAO,EAAC+U,MAAM,CAAE/S,WAAY,CAACgT,aAAa,CAAEA,CAAA,GAAM/S,cAAc,CAAC,CAACD,WAAW,CAAE,CAAE,CAAC,cAEnFV,IAAA,QAAKsP,SAAS,CAAC,mBAAmB,CAACK,KAAK,CAAE,CAAEoB,UAAU,IAAAhJ,MAAA,CAAKnH,YAAY,MAAI,CAAEqR,KAAK,gBAAAlK,MAAA,CAAiBnH,YAAY,OAAK,CAAE+S,UAAU,CAAE,wCAAyC,CAAE,CAAApE,QAAA,cAC3KrP,KAAA,QAAKoP,SAAS,CAAC,6BAA6B,CAAAC,QAAA,eAC1CvP,IAAA,QAAKsP,SAAS,CAAC,0BAA0B,CAAAC,QAAA,cACvCrP,KAAA,QAAKoP,SAAS,CAAC,gBAAgB,CAAAC,QAAA,eAC7BrP,KAAA,QAAKoP,SAAS,CAAC,aAAa,CAAAC,QAAA,eAC1BvP,IAAA,WACEsP,SAAS,CAAC,oBAAoB,CAC9BE,OAAO,CAAEA,CAAA,GAAM7O,cAAc,CAAC,CAACD,WAAW,CAAE,CAC5C,aAAW,gBAAgB,CAAA6O,QAAA,cAE3BvP,IAAA,CAACpB,IAAI,EAAC8Q,IAAI,CAAE,EAAG,CAAE,CAAC,CACZ,CAAC,cACTxP,KAAA,QAAAqP,QAAA,eACEvP,IAAA,OAAIsP,SAAS,CAAC,YAAY,CAAAC,QAAA,CAAC,wBAAsB,CAAI,CAAC,cACtDvP,IAAA,MAAGsP,SAAS,CAAC,eAAe,CAAAC,QAAA,CAAC,iCAA+B,CAAG,CAAC,EAC7D,CAAC,EACH,CAAC,cACNvP,IAAA,QAAKsP,SAAS,CAAC,qBAAqB,CAAAC,QAAA,cAClCrP,KAAA,QAAKoP,SAAS,CAAC,cAAc,CAAAC,QAAA,eAC3BvP,IAAA,QAAKsP,SAAS,CAAC,aAAa,CAAAC,QAAA,CACzB,CAAC,CAAA/O,IAAI,SAAJA,IAAI,iBAAJA,IAAI,CAAEoT,KAAK,GAAI,GAAG,EAAEC,MAAM,CAAC,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC,CAC1C,CAAC,cACN9T,IAAA,SAAMsP,SAAS,CAAC,WAAW,CAAAC,QAAA,CAAE,CAAA/O,IAAI,SAAJA,IAAI,iBAAJA,IAAI,CAAEoT,KAAK,GAAI,MAAM,CAAO,CAAC,cAC1D5T,IAAA,WAAQsP,SAAS,CAAC,YAAY,CAACE,OAAO,CAAE/O,MAAO,CAACsP,KAAK,CAAC,QAAQ,CAAAR,QAAA,cAC5DvP,IAAA,CAACnB,MAAM,EAAC6Q,IAAI,CAAE,EAAG,CAAE,CAAC,CACd,CAAC,EACN,CAAC,CACH,CAAC,EACH,CAAC,CACH,CAAC,CACLyB,OAAO,EACL,CAAC,CACH,CAAC,CACLkC,kBAAkB,EAChB,CAAC,CAEV,CAAC,CAED,cAAe,CAAAhT,gBAAgB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}