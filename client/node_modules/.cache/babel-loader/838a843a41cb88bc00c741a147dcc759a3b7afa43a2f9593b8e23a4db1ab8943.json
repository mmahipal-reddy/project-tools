{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Drag}from'lucide-react';import apiClient from'../../../config/api';import toast from'react-hot-toast';import'../../../styles/ObjectBrowser.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ObjectBrowser=_ref=>{let{selectedObject,onObjectSelect,onFieldDrag,searchTerm}=_ref;const[availableObjects,setAvailableObjects]=useState([]);const[availableFields,setAvailableFields]=useState([]);const[loading,setLoading]=useState(false);useEffect(()=>{loadAvailableObjects();},[]);useEffect(()=>{if(selectedObject){loadFieldsForObject(selectedObject);}else{setAvailableFields([]);}},[selectedObject]);const loadAvailableObjects=async()=>{try{const response=await apiClient.get('/update-object-fields/objects');if(response.data.success){setAvailableObjects(response.data.objects||[]);}}catch(error){console.error('Error loading objects:',error);}};const loadFieldsForObject=async objectType=>{setLoading(true);try{const response=await apiClient.get(\"/update-object-fields/fields/\".concat(encodeURIComponent(objectType),\"?forReporting=true\"));if(response.data.success){setAvailableFields(response.data.fields||[]);}}catch(error){console.error('Error loading fields:',error);toast.error('Failed to load fields');}finally{setLoading(false);}};const handleDragStart=(e,field)=>{e.dataTransfer.setData('application/json',JSON.stringify({type:'field',field:field}));e.dataTransfer.effectAllowed='move';};const filteredFields=availableFields.filter(field=>{var _field$label,_field$name;return searchTerm===''||((_field$label=field.label)===null||_field$label===void 0?void 0:_field$label.toLowerCase().includes(searchTerm.toLowerCase()))||((_field$name=field.name)===null||_field$name===void 0?void 0:_field$name.toLowerCase().includes(searchTerm.toLowerCase()));});return/*#__PURE__*/_jsxs(\"div\",{className:\"object-browser\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"object-selector\",children:/*#__PURE__*/_jsxs(\"select\",{value:selectedObject||'',onChange:e=>onObjectSelect(e.target.value),className:\"object-select-input\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select Object\"}),availableObjects.map(obj=>/*#__PURE__*/_jsx(\"option\",{value:obj.value,children:obj.label},obj.value))]})}),selectedObject&&/*#__PURE__*/_jsx(\"div\",{className:\"fields-list\",children:loading?/*#__PURE__*/_jsx(\"div\",{className:\"fields-loading\",children:\"Loading fields...\"}):filteredFields.length===0?/*#__PURE__*/_jsx(\"div\",{className:\"fields-empty\",children:\"No fields found\"}):filteredFields.map(field=>/*#__PURE__*/_jsxs(\"div\",{className:\"field-item\",draggable:true,onDragStart:e=>handleDragStart(e,field),children:[/*#__PURE__*/_jsx(Drag,{size:14,className:\"drag-handle\"}),/*#__PURE__*/_jsx(\"span\",{className:\"field-label\",children:field.label||field.name}),/*#__PURE__*/_jsxs(\"span\",{className:\"field-name\",children:[\"(\",field.name,\")\"]})]},field.name))})]});};export default ObjectBrowser;","map":{"version":3,"names":["React","useState","useEffect","Drag","apiClient","toast","jsx","_jsx","jsxs","_jsxs","ObjectBrowser","_ref","selectedObject","onObjectSelect","onFieldDrag","searchTerm","availableObjects","setAvailableObjects","availableFields","setAvailableFields","loading","setLoading","loadAvailableObjects","loadFieldsForObject","response","get","data","success","objects","error","console","objectType","concat","encodeURIComponent","fields","handleDragStart","e","field","dataTransfer","setData","JSON","stringify","type","effectAllowed","filteredFields","filter","_field$label","_field$name","label","toLowerCase","includes","name","className","children","value","onChange","target","map","obj","length","draggable","onDragStart","size"],"sources":["/Users/mmoola/Cursor/ProjectSetup/client/src/components/AdvancedReportBuilder/ObjectPanel/ObjectBrowser.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Drag } from 'lucide-react';\nimport apiClient from '../../../config/api';\nimport toast from 'react-hot-toast';\nimport '../../../styles/ObjectBrowser.css';\n\nconst ObjectBrowser = ({ selectedObject, onObjectSelect, onFieldDrag, searchTerm }) => {\n  const [availableObjects, setAvailableObjects] = useState([]);\n  const [availableFields, setAvailableFields] = useState([]);\n  const [loading, setLoading] = useState(false);\n\n  useEffect(() => {\n    loadAvailableObjects();\n  }, []);\n\n  useEffect(() => {\n    if (selectedObject) {\n      loadFieldsForObject(selectedObject);\n    } else {\n      setAvailableFields([]);\n    }\n  }, [selectedObject]);\n\n  const loadAvailableObjects = async () => {\n    try {\n      const response = await apiClient.get('/update-object-fields/objects');\n      if (response.data.success) {\n        setAvailableObjects(response.data.objects || []);\n      }\n    } catch (error) {\n      console.error('Error loading objects:', error);\n    }\n  };\n\n  const loadFieldsForObject = async (objectType) => {\n    setLoading(true);\n    try {\n      const response = await apiClient.get(\n        `/update-object-fields/fields/${encodeURIComponent(objectType)}?forReporting=true`\n      );\n      if (response.data.success) {\n        setAvailableFields(response.data.fields || []);\n      }\n    } catch (error) {\n      console.error('Error loading fields:', error);\n      toast.error('Failed to load fields');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleDragStart = (e, field) => {\n    e.dataTransfer.setData('application/json', JSON.stringify({\n      type: 'field',\n      field: field\n    }));\n    e.dataTransfer.effectAllowed = 'move';\n  };\n\n  const filteredFields = availableFields.filter(field =>\n    searchTerm === '' ||\n    field.label?.toLowerCase().includes(searchTerm.toLowerCase()) ||\n    field.name?.toLowerCase().includes(searchTerm.toLowerCase())\n  );\n\n  return (\n    <div className=\"object-browser\">\n      {/* Object Selector */}\n      <div className=\"object-selector\">\n        <select\n          value={selectedObject || ''}\n          onChange={(e) => onObjectSelect(e.target.value)}\n          className=\"object-select-input\"\n        >\n          <option value=\"\">Select Object</option>\n          {availableObjects.map(obj => (\n            <option key={obj.value} value={obj.value}>\n              {obj.label}\n            </option>\n          ))}\n        </select>\n      </div>\n\n      {/* Fields List */}\n      {selectedObject && (\n        <div className=\"fields-list\">\n          {loading ? (\n            <div className=\"fields-loading\">Loading fields...</div>\n          ) : filteredFields.length === 0 ? (\n            <div className=\"fields-empty\">No fields found</div>\n          ) : (\n            filteredFields.map(field => (\n              <div\n                key={field.name}\n                className=\"field-item\"\n                draggable\n                onDragStart={(e) => handleDragStart(e, field)}\n              >\n                <Drag size={14} className=\"drag-handle\" />\n                <span className=\"field-label\">{field.label || field.name}</span>\n                <span className=\"field-name\">({field.name})</span>\n              </div>\n            ))\n          )}\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default ObjectBrowser;\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}